!function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var r=function(e){return e&&e.Math==Math&&e},n=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof e&&e)||function(){return this}()||Function("return this")(),o={exports:{}},a=n,i=function(e,t){try{Object.defineProperty(a,e,{value:t,configurable:!0,writable:!0})}catch(r){a[e]=t}return t},s=i,c=n["__core-js_shared__"]||s("__core-js_shared__",{}),l=c;(o.exports=function(e,t){return l[e]||(l[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.18.3",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"});var u,d,f=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},h=f,p=function(e){return Object(h(e))},v=p,y={}.hasOwnProperty,m=Object.hasOwn||function(e,t){return y.call(v(e),t)},g=0,S=Math.random(),b=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++g+S).toString(36)},N=function(e){return"function"==typeof e},T=n,w=N,E=function(e){return w(e)?e:void 0},_=function(e,t){return arguments.length<2?E(T[e]):T[e]&&T[e][t]},O=_("navigator","userAgent")||"",R=n,I=O,x=R.process,C=R.Deno,A=x&&x.versions||C&&C.version,k=A&&A.v8;k?d=(u=k.split("."))[0]<4?1:u[0]+u[1]:I&&(!(u=I.match(/Edge\/(\d+)/))||u[1]>=74)&&(u=I.match(/Chrome\/(\d+)/))&&(d=u[1]);var L=d&&+d,M=function(e){try{return!!e()}catch(e){return!0}},P=L,H=M,D=!!Object.getOwnPropertySymbols&&!H((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&P&&P<41})),F=D&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,j=n,U=o.exports,B=m,Y=b,V=D,J=F,G=U("wks"),K=j.Symbol,q=J?K:K&&K.withoutSetter||Y,W=function(e){return B(G,e)&&(V||"string"==typeof G[e])||(V&&B(K,e)?G[e]=K[e]:G[e]=q("Symbol."+e)),G[e]},X={};X[W("toStringTag")]="z";var Q="[object z]"===String(X),z={exports:{}},Z=!M((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),ee={},te=N,re=function(e){return"object"==typeof e?null!==e:te(e)},ne=re,oe=n.document,ae=ne(oe)&&ne(oe.createElement),ie=function(e){return ae?oe.createElement(e):{}},se=ie,ce=!Z&&!M((function(){return 7!=Object.defineProperty(se("div"),"a",{get:function(){return 7}}).a})),le=re,ue=function(e){if(le(e))return e;throw TypeError(String(e)+" is not an object")},de=N,fe=_,he=F?function(e){return"symbol"==typeof e}:function(e){var t=fe("Symbol");return de(t)&&Object(e)instanceof t},pe=function(e){try{return String(e)}catch(e){return"Object"}},ve=N,ye=pe,me=function(e){if(ve(e))return e;throw TypeError(ye(e)+" is not a function")},ge=me,Se=function(e,t){var r=e[t];return null==r?void 0:ge(r)},be=N,Ne=re,Te=function(e,t){var r,n;if("string"===t&&be(r=e.toString)&&!Ne(n=r.call(e)))return n;if(be(r=e.valueOf)&&!Ne(n=r.call(e)))return n;if("string"!==t&&be(r=e.toString)&&!Ne(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")},we=re,Ee=he,_e=Se,Oe=Te,Re=W("toPrimitive"),Ie=function(e,t){if(!we(e)||Ee(e))return e;var r,n=_e(e,Re);if(n){if(void 0===t&&(t="default"),r=n.call(e,t),!we(r)||Ee(r))return r;throw TypeError("Can't convert object to primitive value")}return void 0===t&&(t="number"),Oe(e,t)},xe=Ie,Ce=he,Ae=function(e){var t=xe(e,"string");return Ce(t)?t:String(t)},ke=Z,Le=ce,Me=ue,Pe=Ae,He=Object.defineProperty;ee.f=ke?He:function(e,t,r){if(Me(e),t=Pe(t),Me(r),Le)try{return He(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var De=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},Fe=ee,je=De,Ue=Z?function(e,t,r){return Fe.f(e,t,je(1,r))}:function(e,t,r){return e[t]=r,e},Be=N,Ye=c,Ve=Function.toString;Be(Ye.inspectSource)||(Ye.inspectSource=function(e){return Ve.call(e)});var Je,Ge,Ke,qe=Ye.inspectSource,We=N,Xe=qe,Qe=n.WeakMap,ze=We(Qe)&&/native code/.test(Xe(Qe)),$e=o.exports,Ze=b,et=$e("keys"),tt=function(e){return et[e]||(et[e]=Ze(e))},rt={},nt=ze,ot=re,at=Ue,it=m,st=c,ct=tt,lt=rt,ut=n.WeakMap;if(nt||st.state){var dt=st.state||(st.state=new ut),ft=dt.get,ht=dt.has,pt=dt.set;Je=function(e,t){if(ht.call(dt,e))throw new TypeError("Object already initialized");return t.facade=e,pt.call(dt,e,t),t},Ge=function(e){return ft.call(dt,e)||{}},Ke=function(e){return ht.call(dt,e)}}else{var vt=ct("state");lt[vt]=!0,Je=function(e,t){if(it(e,vt))throw new TypeError("Object already initialized");return t.facade=e,at(e,vt,t),t},Ge=function(e){return it(e,vt)?e[vt]:{}},Ke=function(e){return it(e,vt)}}var yt={set:Je,get:Ge,has:Ke,enforce:function(e){return Ke(e)?Ge(e):Je(e,{})},getterFor:function(e){return function(t){var r;if(!ot(t)||(r=Ge(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return r}}},mt=Z,gt=m,St=Function.prototype,bt=mt&&Object.getOwnPropertyDescriptor,Nt=gt(St,"name"),Tt={EXISTS:Nt,PROPER:Nt&&"something"===function(){}.name,CONFIGURABLE:Nt&&(!mt||mt&&bt(St,"name").configurable)},wt=n,Et=N,_t=m,Ot=Ue,Rt=i,It=qe,xt=Tt.CONFIGURABLE,Ct=yt.get,At=yt.enforce,kt=String(String).split("String");(z.exports=function(e,t,r,n){var o,a=!!n&&!!n.unsafe,i=!!n&&!!n.enumerable,s=!!n&&!!n.noTargetGet,c=n&&void 0!==n.name?n.name:t;Et(r)&&("Symbol("===String(c).slice(0,7)&&(c="["+String(c).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!_t(r,"name")||xt&&r.name!==c)&&Ot(r,"name",c),(o=At(r)).source||(o.source=kt.join("string"==typeof c?c:""))),e!==wt?(a?!s&&e[t]&&(i=!0):delete e[t],i?e[t]=r:Ot(e,t,r)):i?e[t]=r:Rt(t,r)})(Function.prototype,"toString",(function(){return Et(this)&&Ct(this).source||It(this)}));var Lt={}.toString,Mt=function(e){return Lt.call(e).slice(8,-1)},Pt=Q,Ht=N,Dt=Mt,Ft=W("toStringTag"),jt="Arguments"==Dt(function(){return arguments}()),Ut=Pt?Dt:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),Ft))?r:jt?Dt(t):"Object"==(n=Dt(t))&&Ht(t.callee)?"Arguments":n},Bt=Ut,Yt=Q?{}.toString:function(){return"[object "+Bt(this)+"]"},Vt=Q,Jt=z.exports,Gt=Yt;Vt||Jt(Object.prototype,"toString",Gt,{unsafe:!0});var Kt={},qt={},Wt={}.propertyIsEnumerable,Xt=Object.getOwnPropertyDescriptor,Qt=Xt&&!Wt.call({1:2},1);qt.f=Qt?function(e){var t=Xt(this,e);return!!t&&t.enumerable}:Wt;var zt=Mt,$t="".split,Zt=M((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==zt(e)?$t.call(e,""):Object(e)}:Object,er=Zt,tr=f,rr=function(e){return er(tr(e))},nr=Z,or=qt,ar=De,ir=rr,sr=Ae,cr=m,lr=ce,ur=Object.getOwnPropertyDescriptor;Kt.f=nr?ur:function(e,t){if(e=ir(e),t=sr(t),lr)try{return ur(e,t)}catch(e){}if(cr(e,t))return ar(!or.f.call(e,t),e[t])};var dr={},fr=Math.ceil,hr=Math.floor,pr=function(e){var t=+e;return t!=t||0===t?0:(t>0?hr:fr)(t)},vr=pr,yr=Math.max,mr=Math.min,gr=function(e,t){var r=vr(e);return r<0?yr(r+t,0):mr(r,t)},Sr=pr,br=Math.min,Nr=function(e){return e>0?br(Sr(e),9007199254740991):0},Tr=Nr,wr=function(e){return Tr(e.length)},Er=rr,_r=gr,Or=wr,Rr=function(e){return function(t,r,n){var o,a=Er(t),i=Or(a),s=_r(n,i);if(e&&r!=r){for(;i>s;)if((o=a[s++])!=o)return!0}else for(;i>s;s++)if((e||s in a)&&a[s]===r)return e||s||0;return!e&&-1}},Ir={includes:Rr(!0),indexOf:Rr(!1)},xr=m,Cr=rr,Ar=Ir.indexOf,kr=rt,Lr=function(e,t){var r,n=Cr(e),o=0,a=[];for(r in n)!xr(kr,r)&&xr(n,r)&&a.push(r);for(;t.length>o;)xr(n,r=t[o++])&&(~Ar(a,r)||a.push(r));return a},Mr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Pr=Lr,Hr=Mr.concat("length","prototype");dr.f=Object.getOwnPropertyNames||function(e){return Pr(e,Hr)};var Dr={};Dr.f=Object.getOwnPropertySymbols;var Fr=dr,jr=Dr,Ur=ue,Br=_("Reflect","ownKeys")||function(e){var t=Fr.f(Ur(e)),r=jr.f;return r?t.concat(r(e)):t},Yr=m,Vr=Br,Jr=Kt,Gr=ee,Kr=function(e,t){for(var r=Vr(t),n=Gr.f,o=Jr.f,a=0;a<r.length;a++){var i=r[a];Yr(e,i)||n(e,i,o(t,i))}},qr=M,Wr=N,Xr=/#|\.prototype\./,Qr=function(e,t){var r=$r[zr(e)];return r==en||r!=Zr&&(Wr(t)?qr(t):!!t)},zr=Qr.normalize=function(e){return String(e).replace(Xr,".").toLowerCase()},$r=Qr.data={},Zr=Qr.NATIVE="N",en=Qr.POLYFILL="P",tn=Qr,rn=n,nn=Kt.f,on=Ue,an=z.exports,sn=i,cn=Kr,ln=tn,un=function(e,t){var r,n,o,a,i,s=e.target,c=e.global,l=e.stat;if(r=c?rn:l?rn[s]||sn(s,{}):(rn[s]||{}).prototype)for(n in t){if(a=t[n],o=e.noTargetGet?(i=nn(r,n))&&i.value:r[n],!ln(c?n:s+(l?".":"#")+n,e.forced)&&void 0!==o){if(typeof a==typeof o)continue;cn(a,o)}(e.sham||o&&o.sham)&&on(a,"sham",!0),an(r,n,a,e)}},dn=n.Promise,fn=z.exports,hn=function(e,t,r){for(var n in t)fn(e,n,t[n],r);return e},pn=N,vn=function(e){if("object"==typeof e||pn(e))return e;throw TypeError("Can't set "+String(e)+" as a prototype")},yn=ue,mn=vn,gn=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),t=r instanceof Array}catch(e){}return function(r,n){return yn(r),mn(n),t?e.call(r,n):r.__proto__=n,r}}():void 0),Sn=ee.f,bn=m,Nn=W("toStringTag"),Tn=function(e,t,r){e&&!bn(e=r?e:e.prototype,Nn)&&Sn(e,Nn,{configurable:!0,value:t})},wn=_,En=ee,_n=Z,On=W("species"),Rn=function(e){var t=wn(e),r=En.f;_n&&t&&!t[On]&&r(t,On,{configurable:!0,get:function(){return this}})},In=function(e,t,r){if(e instanceof t)return e;throw TypeError("Incorrect "+(r?r+" ":"")+"invocation")},xn={},Cn=xn,An=W("iterator"),kn=Array.prototype,Ln=function(e){return void 0!==e&&(Cn.Array===e||kn[An]===e)},Mn=me,Pn=function(e,t,r){if(Mn(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}},Hn=Ut,Dn=Se,Fn=xn,jn=W("iterator"),Un=function(e){if(null!=e)return Dn(e,jn)||Dn(e,"@@iterator")||Fn[Hn(e)]},Bn=me,Yn=ue,Vn=Un,Jn=function(e,t){var r=arguments.length<2?Vn(e):t;if(Bn(r))return Yn(r.call(e));throw TypeError(String(e)+" is not iterable")},Gn=ue,Kn=Se,qn=function(e,t,r){var n,o;Gn(e);try{if(!(n=Kn(e,"return"))){if("throw"===t)throw r;return r}n=n.call(e)}catch(e){o=!0,n=e}if("throw"===t)throw r;if(o)throw n;return Gn(n),r},Wn=ue,Xn=Ln,Qn=wr,zn=Pn,$n=Jn,Zn=Un,eo=qn,to=function(e,t){this.stopped=e,this.result=t},ro=function(e,t,r){var n,o,a,i,s,c,l,u=r&&r.that,d=!(!r||!r.AS_ENTRIES),f=!(!r||!r.IS_ITERATOR),h=!(!r||!r.INTERRUPTED),p=zn(t,u,1+d+h),v=function(e){return n&&eo(n,"normal",e),new to(!0,e)},y=function(e){return d?(Wn(e),h?p(e[0],e[1],v):p(e[0],e[1])):h?p(e,v):p(e)};if(f)n=e;else{if(!(o=Zn(e)))throw TypeError(String(e)+" is not iterable");if(Xn(o)){for(a=0,i=Qn(e);i>a;a++)if((s=y(e[a]))&&s instanceof to)return s;return new to(!1)}n=$n(e,o)}for(c=n.next;!(l=c.call(n)).done;){try{s=y(l.value)}catch(e){eo(n,"throw",e)}if("object"==typeof s&&s&&s instanceof to)return s}return new to(!1)},no=W("iterator"),oo=!1;try{var ao=0,io={next:function(){return{done:!!ao++}},return:function(){oo=!0}};io[no]=function(){return this},Array.from(io,(function(){throw 2}))}catch(e){}var so,co,lo,uo,fo=function(e,t){if(!t&&!oo)return!1;var r=!1;try{var n={};n[no]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch(e){}return r},ho=M,po=N,vo=Ut,yo=qe,mo=[],go=_("Reflect","construct"),So=/^\s*(?:class|function)\b/,bo=So.exec,No=!So.exec((function(){})),To=function(e){if(!po(e))return!1;try{return go(Object,mo,e),!0}catch(e){return!1}},wo=!go||ho((function(){var e;return To(To.call)||!To(Object)||!To((function(){e=!0}))||e}))?function(e){if(!po(e))return!1;switch(vo(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}return No||!!bo.call(So,yo(e))}:To,Eo=wo,_o=pe,Oo=function(e){if(Eo(e))return e;throw TypeError(_o(e)+" is not a constructor")},Ro=ue,Io=Oo,xo=W("species"),Co=function(e,t){var r,n=Ro(e).constructor;return void 0===n||null==(r=Ro(n)[xo])?t:Io(r)},Ao=_("document","documentElement"),ko=/(?:ipad|iphone|ipod).*applewebkit/i.test(O),Lo="process"==Mt(n.process),Mo=n,Po=N,Ho=M,Do=Pn,Fo=Ao,jo=ie,Uo=ko,Bo=Lo,Yo=Mo.setImmediate,Vo=Mo.clearImmediate,Jo=Mo.process,Go=Mo.MessageChannel,Ko=Mo.Dispatch,qo=0,Wo={};try{so=Mo.location}catch(e){}var Xo=function(e){if(Wo.hasOwnProperty(e)){var t=Wo[e];delete Wo[e],t()}},Qo=function(e){return function(){Xo(e)}},zo=function(e){Xo(e.data)},$o=function(e){Mo.postMessage(String(e),so.protocol+"//"+so.host)};Yo&&Vo||(Yo=function(e){for(var t=[],r=arguments.length,n=1;r>n;)t.push(arguments[n++]);return Wo[++qo]=function(){(Po(e)?e:Function(e)).apply(void 0,t)},co(qo),qo},Vo=function(e){delete Wo[e]},Bo?co=function(e){Jo.nextTick(Qo(e))}:Ko&&Ko.now?co=function(e){Ko.now(Qo(e))}:Go&&!Uo?(uo=(lo=new Go).port2,lo.port1.onmessage=zo,co=Do(uo.postMessage,uo,1)):Mo.addEventListener&&Po(Mo.postMessage)&&!Mo.importScripts&&so&&"file:"!==so.protocol&&!Ho($o)?(co=$o,Mo.addEventListener("message",zo,!1)):co="onreadystatechange"in jo("script")?function(e){Fo.appendChild(jo("script")).onreadystatechange=function(){Fo.removeChild(this),Xo(e)}}:function(e){setTimeout(Qo(e),0)});var Zo,ea,ta,ra,na,oa,aa,ia,sa={set:Yo,clear:Vo},ca=n,la=/ipad|iphone|ipod/i.test(O)&&void 0!==ca.Pebble,ua=/web0s(?!.*chrome)/i.test(O),da=n,fa=Kt.f,ha=sa.set,pa=ko,va=la,ya=ua,ma=Lo,ga=da.MutationObserver||da.WebKitMutationObserver,Sa=da.document,ba=da.process,Na=da.Promise,Ta=fa(da,"queueMicrotask"),wa=Ta&&Ta.value;wa||(Zo=function(){var e,t;for(ma&&(e=ba.domain)&&e.exit();ea;){t=ea.fn,ea=ea.next;try{t()}catch(e){throw ea?ra():ta=void 0,e}}ta=void 0,e&&e.enter()},pa||ma||ya||!ga||!Sa?!va&&Na&&Na.resolve?((aa=Na.resolve(void 0)).constructor=Na,ia=aa.then,ra=function(){ia.call(aa,Zo)}):ra=ma?function(){ba.nextTick(Zo)}:function(){ha.call(da,Zo)}:(na=!0,oa=Sa.createTextNode(""),new ga(Zo).observe(oa,{characterData:!0}),ra=function(){oa.data=na=!na}));var Ea=wa||function(e){var t={fn:e,next:void 0};ta&&(ta.next=t),ea||(ea=t,ra()),ta=t},_a={},Oa=me,Ra=function(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=Oa(t),this.reject=Oa(r)};_a.f=function(e){return new Ra(e)};var Ia,xa,Ca,Aa,ka=ue,La=re,Ma=_a,Pa=function(e,t){if(ka(e),La(t)&&t.constructor===e)return t;var r=Ma.f(e);return(0,r.resolve)(t),r.promise},Ha=n,Da=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},Fa="object"==typeof window,ja=un,Ua=n,Ba=_,Ya=dn,Va=z.exports,Ja=hn,Ga=gn,Ka=Tn,qa=Rn,Wa=me,Xa=N,Qa=re,za=In,$a=qe,Za=ro,ei=fo,ti=Co,ri=sa.set,ni=Ea,oi=Pa,ai=function(e,t){var r=Ha.console;r&&r.error&&(1===arguments.length?r.error(e):r.error(e,t))},ii=_a,si=Da,ci=yt,li=tn,ui=Fa,di=Lo,fi=L,hi=W("species"),pi="Promise",vi=ci.get,yi=ci.set,mi=ci.getterFor(pi),gi=Ya&&Ya.prototype,Si=Ya,bi=gi,Ni=Ua.TypeError,Ti=Ua.document,wi=Ua.process,Ei=ii.f,_i=Ei,Oi=!!(Ti&&Ti.createEvent&&Ua.dispatchEvent),Ri=Xa(Ua.PromiseRejectionEvent),Ii=!1,xi=li(pi,(function(){var e=$a(Si),t=e!==String(Si);if(!t&&66===fi)return!0;if(fi>=51&&/native code/.test(e))return!1;var r=new Si((function(e){e(1)})),n=function(e){e((function(){}),(function(){}))};return(r.constructor={})[hi]=n,!(Ii=r.then((function(){}))instanceof n)||!t&&ui&&!Ri})),Ci=xi||!ei((function(e){Si.all(e).catch((function(){}))})),Ai=function(e){var t;return!(!Qa(e)||!Xa(t=e.then))&&t},ki=function(e,t){if(!e.notified){e.notified=!0;var r=e.reactions;ni((function(){for(var n=e.value,o=1==e.state,a=0;r.length>a;){var i,s,c,l=r[a++],u=o?l.ok:l.fail,d=l.resolve,f=l.reject,h=l.domain;try{u?(o||(2===e.rejection&&Hi(e),e.rejection=1),!0===u?i=n:(h&&h.enter(),i=u(n),h&&(h.exit(),c=!0)),i===l.promise?f(Ni("Promise-chain cycle")):(s=Ai(i))?s.call(i,d,f):d(i)):f(n)}catch(e){h&&!c&&h.exit(),f(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&Mi(e)}))}},Li=function(e,t,r){var n,o;Oi?((n=Ti.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),Ua.dispatchEvent(n)):n={promise:t,reason:r},!Ri&&(o=Ua["on"+e])?o(n):"unhandledrejection"===e&&ai("Unhandled promise rejection",r)},Mi=function(e){ri.call(Ua,(function(){var t,r=e.facade,n=e.value;if(Pi(e)&&(t=si((function(){di?wi.emit("unhandledRejection",n,r):Li("unhandledrejection",r,n)})),e.rejection=di||Pi(e)?2:1,t.error))throw t.value}))},Pi=function(e){return 1!==e.rejection&&!e.parent},Hi=function(e){ri.call(Ua,(function(){var t=e.facade;di?wi.emit("rejectionHandled",t):Li("rejectionhandled",t,e.value)}))},Di=function(e,t,r){return function(n){e(t,n,r)}},Fi=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,ki(e,!0))},ji=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw Ni("Promise can't be resolved itself");var n=Ai(t);n?ni((function(){var r={done:!1};try{n.call(t,Di(ji,r,e),Di(Fi,r,e))}catch(t){Fi(r,t,e)}})):(e.value=t,e.state=1,ki(e,!1))}catch(t){Fi({done:!1},t,e)}}};if(xi&&(bi=(Si=function(e){za(this,Si,pi),Wa(e),Ia.call(this);var t=vi(this);try{e(Di(ji,t),Di(Fi,t))}catch(e){Fi(t,e)}}).prototype,(Ia=function(e){yi(this,{type:pi,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=Ja(bi,{then:function(e,t){var r=mi(this),n=Ei(ti(this,Si));return n.ok=!Xa(e)||e,n.fail=Xa(t)&&t,n.domain=di?wi.domain:void 0,r.parent=!0,r.reactions.push(n),0!=r.state&&ki(r,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),xa=function(){var e=new Ia,t=vi(e);this.promise=e,this.resolve=Di(ji,t),this.reject=Di(Fi,t)},ii.f=Ei=function(e){return e===Si||e===Ca?new xa(e):_i(e)},Xa(Ya)&&gi!==Object.prototype)){Aa=gi.then,Ii||(Va(gi,"then",(function(e,t){var r=this;return new Si((function(e,t){Aa.call(r,e,t)})).then(e,t)}),{unsafe:!0}),Va(gi,"catch",bi.catch,{unsafe:!0}));try{delete gi.constructor}catch(e){}Ga&&Ga(gi,bi)}ja({global:!0,wrap:!0,forced:xi},{Promise:Si}),Ka(Si,pi,!1),qa(pi),Ca=Ba(pi),ja({target:pi,stat:!0,forced:xi},{reject:function(e){var t=Ei(this);return t.reject.call(void 0,e),t.promise}}),ja({target:pi,stat:!0,forced:xi},{resolve:function(e){return oi(this,e)}}),ja({target:pi,stat:!0,forced:Ci},{all:function(e){var t=this,r=Ei(t),n=r.resolve,o=r.reject,a=si((function(){var r=Wa(t.resolve),a=[],i=0,s=1;Za(e,(function(e){var c=i++,l=!1;a.push(void 0),s++,r.call(t,e).then((function(e){l||(l=!0,a[c]=e,--s||n(a))}),o)})),--s||n(a)}));return a.error&&o(a.value),r.promise},race:function(e){var t=this,r=Ei(t),n=r.reject,o=si((function(){var o=Wa(t.resolve);Za(e,(function(e){o.call(t,e).then(r.resolve,n)}))}));return o.error&&n(o.value),r.promise}});var Ui=un,Bi=dn,Yi=M,Vi=_,Ji=N,Gi=Co,Ki=Pa,qi=z.exports;if(Ui({target:"Promise",proto:!0,real:!0,forced:!!Bi&&Yi((function(){Bi.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=Gi(this,Vi("Promise")),r=Ji(e);return this.then(r?function(r){return Ki(t,e()).then((function(){return r}))}:e,r?function(r){return Ki(t,e()).then((function(){throw r}))}:e)}}),Ji(Bi)){var Wi=Vi("Promise").prototype.finally;Bi.prototype.finally!==Wi&&qi(Bi.prototype,"finally",Wi,{unsafe:!0})}function Xi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zi(e,t,r){return t&&Qi(e.prototype,t),r&&Qi(e,r),e}function $i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zi(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ts(e,t)}function es(e){return(es=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ts(e,t){return(ts=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ns(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return rs(e)}function os(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=es(e);if(t){var o=es(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ns(this,r)}}function as(e,t,r){return(as="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=es(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function is(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,o,a=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return a}(e,t)||cs(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ss(e){return function(e){if(Array.isArray(e))return ls(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||cs(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cs(e,t){if(e){if("string"==typeof e)return ls(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ls(e,t):void 0}}function ls(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function us(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=cs(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function ds(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,hs(e,t,"get"))}function fs(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,hs(e,t,"set"),r),r}function hs(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function ps(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function vs(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ys(e,t,r){vs(e,t),t.set(e,r)}function ms(e,t){vs(e,t),t.add(e)}var gs=Mt,Ss=Array.isArray||function(e){return"Array"==gs(e)},bs=Ae,Ns=ee,Ts=De,ws=function(e,t,r){var n=bs(t);n in e?Ns.f(e,n,Ts(0,r)):e[n]=r},Es=Ss,_s=wo,Os=re,Rs=W("species"),Is=function(e){var t;return Es(e)&&(t=e.constructor,(_s(t)&&(t===Array||Es(t.prototype))||Os(t)&&null===(t=t[Rs]))&&(t=void 0)),void 0===t?Array:t},xs=function(e,t){return new(Is(e))(0===t?0:t)},Cs=M,As=L,ks=W("species"),Ls=function(e){return As>=51||!Cs((function(){var t=[];return(t.constructor={})[ks]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Ms=un,Ps=M,Hs=Ss,Ds=re,Fs=p,js=wr,Us=ws,Bs=xs,Ys=Ls,Vs=L,Js=W("isConcatSpreadable"),Gs=Vs>=51||!Ps((function(){var e=[];return e[Js]=!1,e.concat()[0]!==e})),Ks=Ys("concat"),qs=function(e){if(!Ds(e))return!1;var t=e[Js];return void 0!==t?!!t:Hs(e)};Ms({target:"Array",proto:!0,forced:!Gs||!Ks},{concat:function(e){var t,r,n,o,a,i=Fs(this),s=Bs(i,0),c=0;for(t=-1,n=arguments.length;t<n;t++)if(qs(a=-1===t?i:arguments[t])){if(c+(o=js(a))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(r=0;r<o;r++,c++)r in a&&Us(s,c,a[r])}else{if(c>=9007199254740991)throw TypeError("Maximum allowed index exceeded");Us(s,c++,a)}return s.length=c,s}});var Ws,Xs=Lr,Qs=Mr,zs=Object.keys||function(e){return Xs(e,Qs)},$s=ee,Zs=ue,ec=zs,tc=Z?Object.defineProperties:function(e,t){Zs(e);for(var r,n=ec(t),o=n.length,a=0;o>a;)$s.f(e,r=n[a++],t[r]);return e},rc=ue,nc=tc,oc=Mr,ac=rt,ic=Ao,sc=ie,cc=tt("IE_PROTO"),lc=function(){},uc=function(e){return"<script>"+e+"<\/script>"},dc=function(e){e.write(uc("")),e.close();var t=e.parentWindow.Object;return e=null,t},fc=function(){try{Ws=new ActiveXObject("htmlfile")}catch(e){}var e,t;fc="undefined"!=typeof document?document.domain&&Ws?dc(Ws):((t=sc("iframe")).style.display="none",ic.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(uc("document.F=Object")),e.close(),e.F):dc(Ws);for(var r=oc.length;r--;)delete fc.prototype[oc[r]];return fc()};ac[cc]=!0;var hc=Object.create||function(e,t){var r;return null!==e?(lc.prototype=rc(e),r=new lc,lc.prototype=null,r[cc]=e):r=fc(),void 0===t?r:nc(r,t)},pc=hc,vc=ee,yc=W("unscopables"),mc=Array.prototype;null==mc[yc]&&vc.f(mc,yc,{configurable:!0,value:pc(null)});var gc,Sc,bc,Nc=function(e){mc[yc][e]=!0},Tc=!M((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),wc=m,Ec=N,_c=p,Oc=Tc,Rc=tt("IE_PROTO"),Ic=Object.prototype,xc=Oc?Object.getPrototypeOf:function(e){var t=_c(e);if(wc(t,Rc))return t[Rc];var r=t.constructor;return Ec(r)&&t instanceof r?r.prototype:t instanceof Object?Ic:null},Cc=M,Ac=N,kc=xc,Lc=z.exports,Mc=W("iterator"),Pc=!1;[].keys&&("next"in(bc=[].keys())?(Sc=kc(kc(bc)))!==Object.prototype&&(gc=Sc):Pc=!0),(null==gc||Cc((function(){var e={};return gc[Mc].call(e)!==e})))&&(gc={}),Ac(gc[Mc])||Lc(gc,Mc,(function(){return this}));var Hc={IteratorPrototype:gc,BUGGY_SAFARI_ITERATORS:Pc},Dc=Hc.IteratorPrototype,Fc=hc,jc=De,Uc=Tn,Bc=xn,Yc=function(){return this},Vc=function(e,t,r){var n=t+" Iterator";return e.prototype=Fc(Dc,{next:jc(1,r)}),Uc(e,n,!1),Bc[n]=Yc,e},Jc=un,Gc=Tt,Kc=N,qc=Vc,Wc=xc,Xc=gn,Qc=Tn,zc=Ue,$c=z.exports,Zc=xn,el=Gc.PROPER,tl=Gc.CONFIGURABLE,rl=Hc.IteratorPrototype,nl=Hc.BUGGY_SAFARI_ITERATORS,ol=W("iterator"),al=function(){return this},il=function(e,t,r,n,o,a,i){qc(r,t,n);var s,c,l,u=function(e){if(e===o&&v)return v;if(!nl&&e in h)return h[e];switch(e){case"keys":case"values":case"entries":return function(){return new r(this,e)}}return function(){return new r(this)}},d=t+" Iterator",f=!1,h=e.prototype,p=h[ol]||h["@@iterator"]||o&&h[o],v=!nl&&p||u(o),y="Array"==t&&h.entries||p;if(y&&(s=Wc(y.call(new e)))!==Object.prototype&&s.next&&(Wc(s)!==rl&&(Xc?Xc(s,rl):Kc(s[ol])||$c(s,ol,al)),Qc(s,d,!0)),el&&"values"==o&&p&&"values"!==p.name&&(tl?zc(h,"name","values"):(f=!0,v=function(){return p.call(this)})),o)if(c={values:u("values"),keys:a?v:u("keys"),entries:u("entries")},i)for(l in c)(nl||f||!(l in h))&&$c(h,l,c[l]);else Jc({target:t,proto:!0,forced:nl||f},c);return h[ol]!==v&&$c(h,ol,v,{name:o}),Zc[t]=v,c},sl=rr,cl=Nc,ll=xn,ul=yt,dl=il,fl=ul.set,hl=ul.getterFor("Array Iterator"),pl=dl(Array,"Array",(function(e,t){fl(this,{type:"Array Iterator",target:sl(e),index:0,kind:t})}),(function(){var e=hl(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values");ll.Arguments=ll.Array,cl("keys"),cl("values"),cl("entries");var vl=Ut,yl=function(e){if("Symbol"===vl(e))throw TypeError("Cannot convert a Symbol value to a string");return String(e)},ml=pr,gl=yl,Sl=f,bl=function(e){return function(t,r){var n,o,a=gl(Sl(t)),i=ml(r),s=a.length;return i<0||i>=s?e?"":void 0:(n=a.charCodeAt(i))<55296||n>56319||i+1===s||(o=a.charCodeAt(i+1))<56320||o>57343?e?a.charAt(i):n:e?a.slice(i,i+2):o-56320+(n-55296<<10)+65536}},Nl={codeAt:bl(!1),charAt:bl(!0)},Tl=Nl.charAt,wl=yl,El=yt,_l=il,Ol=El.set,Rl=El.getterFor("String Iterator");_l(String,"String",(function(e){Ol(this,{type:"String Iterator",string:wl(e),index:0})}),(function(){var e,t=Rl(this),r=t.string,n=t.index;return n>=r.length?{value:void 0,done:!0}:(e=Tl(r,n),t.index+=e.length,{value:e,done:!1})}));var Il={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},xl=ie("span").classList,Cl=xl&&xl.constructor&&xl.constructor.prototype,Al=Cl===Object.prototype?void 0:Cl,kl=n,Ll=Il,Ml=Al,Pl=pl,Hl=Ue,Dl=W,Fl=Dl("iterator"),jl=Dl("toStringTag"),Ul=Pl.values,Bl=function(e,t){if(e){if(e[Fl]!==Ul)try{Hl(e,Fl,Ul)}catch(t){e[Fl]=Ul}if(e[jl]||Hl(e,jl,t),Ll[t])for(var r in Pl)if(e[r]!==Pl[r])try{Hl(e,r,Pl[r])}catch(t){e[r]=Pl[r]}}};for(var Yl in Ll)Bl(kl[Yl]&&kl[Yl].prototype,Yl);Bl(Ml,"DOMTokenList");var Vl=Ir.includes,Jl=Nc;un({target:"Array",proto:!0},{includes:function(e){return Vl(this,e,arguments.length>1?arguments[1]:void 0)}}),Jl("includes");var Gl=re,Kl=Mt,ql=W("match"),Wl=function(e){var t;return Gl(e)&&(void 0!==(t=e[ql])?!!t:"RegExp"==Kl(e))},Xl=Wl,Ql=function(e){if(Xl(e))throw TypeError("The method doesn't accept regular expressions");return e},zl=W("match"),$l=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[zl]=!1,"/./"[e](t)}catch(e){}}return!1},Zl=Ql,eu=f,tu=yl;un({target:"String",proto:!0,forced:!$l("includes")},{includes:function(e){return!!~tu(eu(this)).indexOf(tu(Zl(e)),arguments.length>1?arguments[1]:void 0)}});var ru=ue,nu=function(){var e=ru(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},ou={},au=M,iu=n.RegExp;ou.UNSUPPORTED_Y=au((function(){var e=iu("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),ou.BROKEN_CARET=au((function(){var e=iu("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));var su=M,cu=n.RegExp,lu=su((function(){var e=cu(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),uu=M,du=n.RegExp,fu=uu((function(){var e=du("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),hu=yl,pu=nu,vu=ou,yu=o.exports,mu=hc,gu=yt.get,Su=lu,bu=fu,Nu=RegExp.prototype.exec,Tu=yu("native-string-replace",String.prototype.replace),wu=Nu,Eu=function(){var e=/a/,t=/b*/g;return Nu.call(e,"a"),Nu.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),_u=vu.UNSUPPORTED_Y||vu.BROKEN_CARET,Ou=void 0!==/()??/.exec("")[1];(Eu||Ou||_u||Su||bu)&&(wu=function(e){var t,r,n,o,a,i,s,c=this,l=gu(c),u=hu(e),d=l.raw;if(d)return d.lastIndex=c.lastIndex,t=wu.call(d,u),c.lastIndex=d.lastIndex,t;var f=l.groups,h=_u&&c.sticky,p=pu.call(c),v=c.source,y=0,m=u;if(h&&(-1===(p=p.replace("y","")).indexOf("g")&&(p+="g"),m=u.slice(c.lastIndex),c.lastIndex>0&&(!c.multiline||c.multiline&&"\n"!==u.charAt(c.lastIndex-1))&&(v="(?: "+v+")",m=" "+m,y++),r=new RegExp("^(?:"+v+")",p)),Ou&&(r=new RegExp("^"+v+"$(?!\\s)",p)),Eu&&(n=c.lastIndex),o=Nu.call(h?r:c,m),h?o?(o.input=o.input.slice(y),o[0]=o[0].slice(y),o.index=c.lastIndex,c.lastIndex+=o[0].length):c.lastIndex=0:Eu&&o&&(c.lastIndex=c.global?o.index+o[0].length:n),Ou&&o&&o.length>1&&Tu.call(o[0],r,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(o[a]=void 0)})),o&&f)for(o.groups=i=mu(null),a=0;a<f.length;a++)i[(s=f[a])[0]]=o[s[1]];return o});var Ru=wu;un({target:"RegExp",proto:!0,forced:/./.exec!==Ru},{exec:Ru});var Iu=z.exports,xu=Ru,Cu=M,Au=W,ku=Ue,Lu=Au("species"),Mu=RegExp.prototype,Pu=function(e,t,r,n){var o=Au(e),a=!Cu((function(){var t={};return t[o]=function(){return 7},7!=""[e](t)})),i=a&&!Cu((function(){var t=!1,r=/a/;return"split"===e&&((r={}).constructor={},r.constructor[Lu]=function(){return r},r.flags="",r[o]=/./[o]),r.exec=function(){return t=!0,null},r[o](""),!t}));if(!a||!i||r){var s=/./[o],c=t(o,""[e],(function(e,t,r,n,o){var i=t.exec;return i===xu||i===Mu.exec?a&&!o?{done:!0,value:s.call(t,r,n)}:{done:!0,value:e.call(r,t,n)}:{done:!1}}));Iu(String.prototype,e,c[0]),Iu(Mu,o,c[1])}n&&ku(Mu[o],"sham",!0)},Hu=Nl.charAt,Du=function(e,t,r){return t+(r?Hu(e,t).length:1)},Fu=ue,ju=N,Uu=Mt,Bu=Ru,Yu=function(e,t){var r=e.exec;if(ju(r)){var n=r.call(e,t);return null!==n&&Fu(n),n}if("RegExp"===Uu(e))return Bu.call(e,t);throw TypeError("RegExp#exec called on incompatible receiver")},Vu=Pu,Ju=Wl,Gu=ue,Ku=f,qu=Co,Wu=Du,Xu=Nr,Qu=yl,zu=Se,$u=Yu,Zu=Ru,ed=M,td=ou.UNSUPPORTED_Y,rd=[].push,nd=Math.min;Vu("split",(function(e,t,r){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var n=Qu(Ku(this)),o=void 0===r?4294967295:r>>>0;if(0===o)return[];if(void 0===e)return[n];if(!Ju(e))return t.call(n,e,o);for(var a,i,s,c=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),u=0,d=new RegExp(e.source,l+"g");(a=Zu.call(d,n))&&!((i=d.lastIndex)>u&&(c.push(n.slice(u,a.index)),a.length>1&&a.index<n.length&&rd.apply(c,a.slice(1)),s=a[0].length,u=i,c.length>=o));)d.lastIndex===a.index&&d.lastIndex++;return u===n.length?!s&&d.test("")||c.push(""):c.push(n.slice(u)),c.length>o?c.slice(0,o):c}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t,[function(t,r){var o=Ku(this),a=null==t?void 0:zu(t,e);return a?a.call(t,o,r):n.call(Qu(o),t,r)},function(e,o){var a=Gu(this),i=Qu(e),s=r(n,a,i,o,n!==t);if(s.done)return s.value;var c=qu(a,RegExp),l=a.unicode,u=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(td?"g":"y"),d=new c(td?"^(?:"+a.source+")":a,u),f=void 0===o?4294967295:o>>>0;if(0===f)return[];if(0===i.length)return null===$u(d,i)?[i]:[];for(var h=0,p=0,v=[];p<i.length;){d.lastIndex=td?0:p;var y,m=$u(d,td?i.slice(p):i);if(null===m||(y=nd(Xu(d.lastIndex+(td?p:0)),i.length))===h)p=Wu(i,p,l);else{if(v.push(i.slice(h,p)),v.length===f)return v;for(var g=1;g<=m.length-1;g++)if(v.push(m[g]),v.length===f)return v;p=h=y}}return v.push(i.slice(h)),v}]}),!!ed((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]})),td);var od={exports:{}};
/*!
	    localForage -- Offline Storage, Improved
	    Version 1.10.0
	    https://localforage.github.io/localForage
	    (c) 2013-2017 Mozilla, Apache License 2.0
	*/od.exports=function e(r,n,o){function a(s,c){if(!n[s]){if(!r[s]){if(!c&&t)return t(s);if(i)return i(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[s]={exports:{}};r[s][0].call(u.exports,(function(e){var t=r[s][1][e];return a(t||e)}),u,u.exports,e,r,n,o)}return n[s].exports}for(var i=t,s=0;s<o.length;s++)a(o[s]);return a}({1:[function(t,r,n){(function(e){var t,n,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var a=0,i=new o(u),s=e.document.createTextNode("");i.observe(s,{characterData:!0}),t=function(){s.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)t="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var c=new e.MessageChannel;c.port1.onmessage=u,t=function(){c.port2.postMessage(0)}}var l=[];function u(){var e,t;n=!0;for(var r=l.length;r;){for(t=l,l=[],e=-1;++e<r;)t[e]();r=l.length}n=!1}r.exports=function(e){1!==l.push(e)||n||t()}}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,r){var n=e(1);function o(){}var a={},i=["REJECTED"],s=["FULFILLED"],c=["PENDING"];function l(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==o&&h(this,e)}function u(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function d(e,t,r){n((function(){var n;try{n=t(r)}catch(t){return a.reject(e,t)}n===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,n)}))}function f(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var r=!1;function n(t){r||(r=!0,a.reject(e,t))}function o(t){r||(r=!0,a.resolve(e,t))}var i=p((function(){t(o,n)}));"error"===i.status&&n(i.value)}function p(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}t.exports=l,l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===i)return this;var r=new this.constructor(o);return this.state!==c?d(r,this.state===s?e:t,this.outcome):this.queue.push(new u(r,e,t)),r},u.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){a.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},a.resolve=function(e,t){var r=p(f,t);if("error"===r.status)return a.reject(e,r.value);var n=r.value;if(n)h(e,n);else{e.state=s,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},a.reject=function(e,t){e.state=i,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},l.resolve=function(e){return e instanceof this?e:a.resolve(new this(o),e)},l.reject=function(e){var t=new this(o);return a.reject(t,e)},l.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var i=new Array(r),s=0,c=-1,l=new this(o);++c<r;)u(e[c],c);return l;function u(e,o){t.resolve(e).then((function(e){i[o]=e,++s!==r||n||(n=!0,a.resolve(l,i))}),(function(e){n||(n=!0,a.reject(l,e))}))}},l.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var i,s=-1,c=new this(o);++s<r;)i=e[s],t.resolve(i).then((function(e){n||(n=!0,a.resolve(c,e))}),(function(e){n||(n=!0,a.reject(c,e))}));return c}},{1:1}],3:[function(t,r,n){(function(e){"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function a(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)r.append(e[n]);return r.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var i=Promise;function s(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function c(e,t,r){"function"==typeof t&&e.then(t),"function"==typeof r&&e.catch(r)}function l(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function u(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var d=void 0,f={},h=Object.prototype.toString;function p(e){return"boolean"==typeof d?i.resolve(d):function(e){return new i((function(t){var r=e.transaction("local-forage-detect-blob-support","readwrite"),n=a([""]);r.objectStore("local-forage-detect-blob-support").put(n,"key"),r.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},r.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),r=navigator.userAgent.match(/Edge\//);t(r||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}(e).then((function(e){return d=e}))}function v(e){var t=f[e.name],r={};r.promise=new i((function(e,t){r.resolve=e,r.reject=t})),t.deferredOperations.push(r),t.dbReady?t.dbReady=t.dbReady.then((function(){return r.promise})):t.dbReady=r.promise}function y(e){var t=f[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function m(e,t){var r=f[e.name].deferredOperations.pop();if(r)return r.reject(t),r.promise}function g(e,t){return new i((function(r,n){if(f[e.name]=f[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return r(e.db);v(e),e.db.close()}var a=[e.name];t&&a.push(e.version);var i=o.open.apply(o,a);t&&(i.onupgradeneeded=function(t){var r=i.result;try{r.createObjectStore(e.storeName),t.oldVersion<=1&&r.createObjectStore("local-forage-detect-blob-support")}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),i.onerror=function(e){e.preventDefault(),n(i.error)},i.onsuccess=function(){var t=i.result;t.onversionchange=function(e){e.target.close()},r(t),y(e)}}))}function S(e){return g(e,!1)}function b(e){return g(e,!0)}function N(e,t){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,o=e.version>e.db.version;if(n&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||r){if(r){var a=e.db.version+1;a>e.version&&(e.version=a)}return!0}return!1}function T(e){return a([function(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),o=0;o<t;o++)n[o]=e.charCodeAt(o);return r}(atob(e.data))],{type:e.type})}function w(e){return e&&e.__local_forage_encoded_blob}function E(e){var t=this,r=t._initReady().then((function(){var e=f[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return c(r,e,e),r}function _(e,t,r,n){void 0===n&&(n=1);try{var o=e.db.transaction(e.storeName,t);r(null,o)}catch(o){if(n>0&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return i.resolve().then((function(){if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),b(e)})).then((function(){return function(e){v(e);for(var t=f[e.name],r=t.forages,n=0;n<r.length;n++){var o=r[n];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return e.db=null,S(e).then((function(t){return e.db=t,N(e)?b(e):t})).then((function(n){e.db=t.db=n;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=n})).catch((function(t){throw m(e,t),t}))}(e).then((function(){_(e,t,r,n-1)}))})).catch(r);r(o)}}var O={_driver:"asyncStorage",_initStorage:function(e){var t=this,r={db:null};if(e)for(var n in e)r[n]=e[n];var o=f[r.name];o||(o={forages:[],db:null,dbReady:null,deferredOperations:[]},f[r.name]=o),o.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=E);var a=[];function s(){return i.resolve()}for(var c=0;c<o.forages.length;c++){var l=o.forages[c];l!==t&&a.push(l._initReady().catch(s))}var u=o.forages.slice(0);return i.all(a).then((function(){return r.db=o.db,S(r)})).then((function(e){return r.db=e,N(r,t._defaultConfig.version)?b(r):e})).then((function(e){r.db=o.db=e,t._dbInfo=r;for(var n=0;n<u.length;n++){var a=u[n];a!==t&&(a._dbInfo.db=r.db,a._dbInfo.version=r.version)}}))},_support:function(){try{if(!o||!o.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var r=this,n=new i((function(t,n){r.ready().then((function(){_(r._dbInfo,"readonly",(function(o,a){if(o)return n(o);try{var i=a.objectStore(r._dbInfo.storeName).openCursor(),s=1;i.onsuccess=function(){var r=i.result;if(r){var n=r.value;w(n)&&(n=T(n));var o=e(n,r.key,s++);void 0!==o?t(o):r.continue()}else t()},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return s(n,t),n},getItem:function(e,t){var r=this;e=l(e);var n=new i((function(t,n){r.ready().then((function(){_(r._dbInfo,"readonly",(function(o,a){if(o)return n(o);try{var i=a.objectStore(r._dbInfo.storeName).get(e);i.onsuccess=function(){var e=i.result;void 0===e&&(e=null),w(e)&&(e=T(e)),t(e)},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return s(n,t),n},setItem:function(e,t,r){var n=this;e=l(e);var o=new i((function(r,o){var a;n.ready().then((function(){return a=n._dbInfo,"[object Blob]"===h.call(t)?p(a.db).then((function(e){return e?t:(r=t,new i((function(e,t){var n=new FileReader;n.onerror=t,n.onloadend=function(t){var n=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:n,type:r.type})},n.readAsBinaryString(r)})));var r})):t})).then((function(t){_(n._dbInfo,"readwrite",(function(a,i){if(a)return o(a);try{var s=i.objectStore(n._dbInfo.storeName);null===t&&(t=void 0);var c=s.put(t,e);i.oncomplete=function(){void 0===t&&(t=null),r(t)},i.onabort=i.onerror=function(){var e=c.error?c.error:c.transaction.error;o(e)}}catch(e){o(e)}}))})).catch(o)}));return s(o,r),o},removeItem:function(e,t){var r=this;e=l(e);var n=new i((function(t,n){r.ready().then((function(){_(r._dbInfo,"readwrite",(function(o,a){if(o)return n(o);try{var i=a.objectStore(r._dbInfo.storeName).delete(e);a.oncomplete=function(){t()},a.onerror=function(){n(i.error)},a.onabort=function(){var e=i.error?i.error:i.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return s(n,t),n},clear:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){_(t._dbInfo,"readwrite",(function(n,o){if(n)return r(n);try{var a=o.objectStore(t._dbInfo.storeName).clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=a.error?a.error:a.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return s(r,e),r},length:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){_(t._dbInfo,"readonly",(function(n,o){if(n)return r(n);try{var a=o.objectStore(t._dbInfo.storeName).count();a.onsuccess=function(){e(a.result)},a.onerror=function(){r(a.error)}}catch(e){r(e)}}))})).catch(r)}));return s(r,e),r},key:function(e,t){var r=this,n=new i((function(t,n){e<0?t(null):r.ready().then((function(){_(r._dbInfo,"readonly",(function(o,a){if(o)return n(o);try{var i=a.objectStore(r._dbInfo.storeName),s=!1,c=i.openKeyCursor();c.onsuccess=function(){var r=c.result;r?0===e||s?t(r.key):(s=!0,r.advance(e)):t(null)},c.onerror=function(){n(c.error)}}catch(e){n(e)}}))})).catch(n)}));return s(n,t),n},keys:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){_(t._dbInfo,"readonly",(function(n,o){if(n)return r(n);try{var a=o.objectStore(t._dbInfo.storeName).openKeyCursor(),i=[];a.onsuccess=function(){var t=a.result;t?(i.push(t.key),t.continue()):e(i)},a.onerror=function(){r(a.error)}}catch(e){r(e)}}))})).catch(r)}));return s(r,e),r},dropInstance:function(e,t){t=u.apply(this,arguments);var r=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n,a=this;if(e.name){var c=e.name===r.name&&a._dbInfo.db,l=c?i.resolve(a._dbInfo.db):S(e).then((function(t){var r=f[e.name],n=r.forages;r.db=t;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=t;return t}));n=e.storeName?l.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var r=t.version+1;v(e);var n=f[e.name],a=n.forages;t.close();for(var s=0;s<a.length;s++){var c=a[s];c._dbInfo.db=null,c._dbInfo.version=r}return new i((function(t,n){var a=o.open(e.name,r);a.onerror=function(e){a.result.close(),n(e)},a.onupgradeneeded=function(){a.result.deleteObjectStore(e.storeName)},a.onsuccess=function(){var e=a.result;e.close(),t(e)}})).then((function(e){n.db=e;for(var t=0;t<a.length;t++){var r=a[t];r._dbInfo.db=e,y(r._dbInfo)}})).catch((function(t){throw(m(e,t)||i.resolve()).catch((function(){})),t}))}})):l.then((function(t){v(e);var r=f[e.name],n=r.forages;t.close();for(var a=0;a<n.length;a++)n[a]._dbInfo.db=null;return new i((function(t,r){var n=o.deleteDatabase(e.name);n.onerror=function(){var e=n.result;e&&e.close(),r(n.error)},n.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},n.onsuccess=function(){var e=n.result;e&&e.close(),t(e)}})).then((function(e){r.db=e;for(var t=0;t<n.length;t++)y(n[t]._dbInfo)})).catch((function(t){throw(m(e,t)||i.resolve()).catch((function(){})),t}))}))}else n=i.reject("Invalid arguments");return s(n,t),n}},R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",I=/^~~local_forage_type~([^~]+)~/,x="__lfsc__:".length,C=x+"arbf".length,A=Object.prototype.toString;function k(e){var t,r,n,o,a,i=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);var l=new ArrayBuffer(i),u=new Uint8Array(l);for(t=0;t<s;t+=4)r=R.indexOf(e[t]),n=R.indexOf(e[t+1]),o=R.indexOf(e[t+2]),a=R.indexOf(e[t+3]),u[c++]=r<<2|n>>4,u[c++]=(15&n)<<4|o>>2,u[c++]=(3&o)<<6|63&a;return l}function L(e){var t,r=new Uint8Array(e),n="";for(t=0;t<r.length;t+=3)n+=R[r[t]>>2],n+=R[(3&r[t])<<4|r[t+1]>>4],n+=R[(15&r[t+1])<<2|r[t+2]>>6],n+=R[63&r[t+2]];return r.length%3==2?n=n.substring(0,n.length-1)+"=":r.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}var M={serialize:function(e,t){var r="";if(e&&(r=A.call(e)),e&&("[object ArrayBuffer]"===r||e.buffer&&"[object ArrayBuffer]"===A.call(e.buffer))){var n,o="__lfsc__:";e instanceof ArrayBuffer?(n=e,o+="arbf"):(n=e.buffer,"[object Int8Array]"===r?o+="si08":"[object Uint8Array]"===r?o+="ui08":"[object Uint8ClampedArray]"===r?o+="uic8":"[object Int16Array]"===r?o+="si16":"[object Uint16Array]"===r?o+="ur16":"[object Int32Array]"===r?o+="si32":"[object Uint32Array]"===r?o+="ui32":"[object Float32Array]"===r?o+="fl32":"[object Float64Array]"===r?o+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(o+L(n))}else if("[object Blob]"===r){var a=new FileReader;a.onload=function(){var r="~~local_forage_type~"+e.type+"~"+L(this.result);t("__lfsc__:blob"+r)},a.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(r){console.error("Couldn't convert value into a JSON string: ",e),t(null,r)}},deserialize:function(e){if("__lfsc__:"!==e.substring(0,x))return JSON.parse(e);var t,r=e.substring(C),n=e.substring(x,C);if("blob"===n&&I.test(r)){var o=r.match(I);t=o[1],r=r.substring(o[0].length)}var i=k(r);switch(n){case"arbf":return i;case"blob":return a([i],{type:t});case"si08":return new Int8Array(i);case"ui08":return new Uint8Array(i);case"uic8":return new Uint8ClampedArray(i);case"si16":return new Int16Array(i);case"ur16":return new Uint16Array(i);case"si32":return new Int32Array(i);case"ui32":return new Uint32Array(i);case"fl32":return new Float32Array(i);case"fl64":return new Float64Array(i);default:throw new Error("Unkown type: "+n)}},stringToBuffer:k,bufferToString:L};function P(e,t,r,n){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,n)}function H(e,t,r,n,o,a){e.executeSql(r,n,o,(function(e,i){i.code===i.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,s){s.rows.length?a(e,i):P(e,t,(function(){e.executeSql(r,n,o,a)}),a)}),a):a(e,i)}),a)}function D(e,t,r,n){var o=this;e=l(e);var a=new i((function(a,i){o.ready().then((function(){void 0===t&&(t=null);var s=t,c=o._dbInfo;c.serializer.serialize(t,(function(t,l){l?i(l):c.db.transaction((function(r){H(r,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){a(s)}),(function(e,t){i(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(n>0)return void a(D.apply(o,[e,s,r,n-1]));i(t)}}))}))})).catch(i)}));return s(a,r),a}function F(e){return new i((function(t,r){e.transaction((function(n){n.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(r,n){for(var o=[],a=0;a<n.rows.length;a++)o.push(n.rows.item(a).name);t({db:e,storeNames:o})}),(function(e,t){r(t)}))}),(function(e){r(e)}))}))}var j={_driver:"webSQLStorage",_initStorage:function(e){var t=this,r={db:null};if(e)for(var n in e)r[n]="string"!=typeof e[n]?e[n].toString():e[n];var o=new i((function(e,n){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(e){return n(e)}r.db.transaction((function(o){P(o,r,(function(){t._dbInfo=r,e()}),(function(e,t){n(t)}))}),n)}));return r.serializer=M,o},_support:"function"==typeof openDatabase,iterate:function(e,t){var r=this,n=new i((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){H(r,o,"SELECT * FROM "+o.storeName,[],(function(r,n){for(var a=n.rows,i=a.length,s=0;s<i;s++){var c=a.item(s),l=c.value;if(l&&(l=o.serializer.deserialize(l)),void 0!==(l=e(l,c.key,s+1)))return void t(l)}t()}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,t),n},getItem:function(e,t){var r=this;e=l(e);var n=new i((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){H(r,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,r){var n=r.rows.length?r.rows.item(0).value:null;n&&(n=o.serializer.deserialize(n)),t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,t),n},setItem:function(e,t,r){return D.apply(this,[e,t,r,1])},removeItem:function(e,t){var r=this;e=l(e);var n=new i((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){H(r,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,t),n},clear:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){H(t,n,"DELETE FROM "+n.storeName,[],(function(){e()}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,e),r},length:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){H(t,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],(function(t,r){var n=r.rows.item(0).c;e(n)}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,e),r},key:function(e,t){var r=this,n=new i((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){H(r,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,r){var n=r.rows.length?r.rows.item(0).key:null;t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,t),n},keys:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){H(t,n,"SELECT key FROM "+n.storeName,[],(function(t,r){for(var n=[],o=0;o<r.rows.length;o++)n.push(r.rows.item(o).key);e(n)}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,e),r},dropInstance:function(e,t){t=u.apply(this,arguments);var r=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n,o=this;return s(n=e.name?new i((function(t){var n;n=e.name===r.name?o._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:n,storeNames:[e.storeName]}):t(F(n))})).then((function(e){return new i((function(t,r){e.db.transaction((function(n){function o(e){return new i((function(t,r){n.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){r(t)}))}))}for(var a=[],s=0,c=e.storeNames.length;s<c;s++)a.push(o(e.storeNames[s]));i.all(a).then((function(){t()})).catch((function(e){r(e)}))}),(function(e){r(e)}))}))})):i.reject("Invalid arguments"),t),n}};function U(e,t){var r=e.name+"/";return e.storeName!==t.storeName&&(r+=e.storeName+"/"),r}function B(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(e){return!0}}()||localStorage.length>0}var Y={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var r in e)t[r]=e[r];return t.keyPrefix=U(e,this._defaultConfig),B()?(this._dbInfo=t,t.serializer=M,i.resolve()):i.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var r=this,n=r.ready().then((function(){for(var t=r._dbInfo,n=t.keyPrefix,o=n.length,a=localStorage.length,i=1,s=0;s<a;s++){var c=localStorage.key(s);if(0===c.indexOf(n)){var l=localStorage.getItem(c);if(l&&(l=t.serializer.deserialize(l)),void 0!==(l=e(l,c.substring(o),i++)))return l}}}));return s(n,t),n},getItem:function(e,t){var r=this;e=l(e);var n=r.ready().then((function(){var t=r._dbInfo,n=localStorage.getItem(t.keyPrefix+e);return n&&(n=t.serializer.deserialize(n)),n}));return s(n,t),n},setItem:function(e,t,r){var n=this;e=l(e);var o=n.ready().then((function(){void 0===t&&(t=null);var r=t;return new i((function(o,a){var i=n._dbInfo;i.serializer.serialize(t,(function(t,n){if(n)a(n);else try{localStorage.setItem(i.keyPrefix+e,t),o(r)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||a(e),a(e)}}))}))}));return s(o,r),o},removeItem:function(e,t){var r=this;e=l(e);var n=r.ready().then((function(){var t=r._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return s(n,t),n},clear:function(e){var t=this,r=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,r=localStorage.length-1;r>=0;r--){var n=localStorage.key(r);0===n.indexOf(e)&&localStorage.removeItem(n)}}));return s(r,e),r},length:function(e){var t=this.keys().then((function(e){return e.length}));return s(t,e),t},key:function(e,t){var r=this,n=r.ready().then((function(){var t,n=r._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(n.keyPrefix.length)),t}));return s(n,t),n},keys:function(e){var t=this,r=t.ready().then((function(){for(var e=t._dbInfo,r=localStorage.length,n=[],o=0;o<r;o++){var a=localStorage.key(o);0===a.indexOf(e.keyPrefix)&&n.push(a.substring(e.keyPrefix.length))}return n}));return s(r,e),r},dropInstance:function(e,t){if(t=u.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var n,o=this;return s(n=e.name?new i((function(t){e.storeName?t(U(e,o._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var r=localStorage.key(t);0===r.indexOf(e)&&localStorage.removeItem(r)}})):i.reject("Invalid arguments"),t),n}},V=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},J=function(e,t){for(var r=e.length,n=0;n<r;){if(V(e[n],t))return!0;n++}return!1},G=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},K={},q={},W={INDEXEDDB:O,WEBSQL:j,LOCALSTORAGE:Y},X=[W.INDEXEDDB._driver,W.WEBSQL._driver,W.LOCALSTORAGE._driver],Q=["dropInstance"],z=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Q),$={description:"",driver:X.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Z(e,t){e[t]=function(){var r=arguments;return e.ready().then((function(){return e[t].apply(e,r)}))}}function ee(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var r in t)t.hasOwnProperty(r)&&(G(t[r])?arguments[0][r]=t[r].slice():arguments[0][r]=t[r])}return arguments[0]}var te=new(function(){function e(t){for(var r in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),W)if(W.hasOwnProperty(r)){var n=W[r],o=n._driver;this[r]=o,K[o]||this.defineDriver(n)}this._defaultConfig=ee({},$),this._config=ee({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":n(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,r){var n=new i((function(t,r){try{var n=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void r(o);for(var a=z.concat("_initStorage"),c=0,l=a.length;c<l;c++){var u=a[c];if((!J(Q,u)||e[u])&&"function"!=typeof e[u])return void r(o)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),r=i.reject(t);return s(r,arguments[arguments.length-1]),r}},r=0,n=Q.length;r<n;r++){var o=Q[r];e[o]||(e[o]=t(o))}}();var d=function(r){K[n]&&console.info("Redefining LocalForage driver: "+n),K[n]=e,q[n]=r,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(d,r):d(!!e._support):d(!0)}catch(e){r(e)}}));return c(n,t,r),n},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,r){var n=K[e]?i.resolve(K[e]):i.reject(new Error("Driver not found."));return c(n,t,r),n},e.prototype.getSerializer=function(e){var t=i.resolve(M);return c(t,e),t},e.prototype.ready=function(e){var t=this,r=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return c(r,e,e),r},e.prototype.setDriver=function(e,t,r){var n=this;G(e)||(e=[e]);var o=this._getSupportedDrivers(e);function a(){n._config.driver=n.driver()}function s(e){return n._extend(e),a(),n._ready=n._initStorage(n._config),n._ready}var l=null!==this._driverSet?this._driverSet.catch((function(){return i.resolve()})):i.resolve();return this._driverSet=l.then((function(){var e=o[0];return n._dbInfo=null,n._ready=null,n.getDriver(e).then((function(e){n._driver=e._driver,a(),n._wrapLibraryMethodsWithReady(),n._initDriver=function(e){return function(){var t=0;return function r(){for(;t<e.length;){var o=e[t];return t++,n._dbInfo=null,n._ready=null,n.getDriver(o).then(s).catch(r)}a();var c=new Error("No available storage method found.");return n._driverSet=i.reject(c),n._driverSet}()}}(o)}))})).catch((function(){a();var e=new Error("No available storage method found.");return n._driverSet=i.reject(e),n._driverSet})),c(this._driverSet,t,r),this._driverSet},e.prototype.supports=function(e){return!!q[e]},e.prototype._extend=function(e){ee(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],r=0,n=e.length;r<n;r++){var o=e[r];this.supports(o)&&t.push(o)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=z.length;e<t;e++)Z(this,z[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=te},{3:3}]},{},[4])(4);var ad=od.exports;function id(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sd(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function cd(e,t,r){return t&&sd(e.prototype,t),r&&sd(e,r),e}function ld(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ud(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}function dd(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}var fd=function(){function e(){id(this,e),ld(this,"route",null),ld(this,"view",void 0),ld(this,"title","untitled"),ld(this,"handle",void 0),ld(this,"app",void 0)}return cd(e,[{key:"initialise",value:function(){this.view.initialise()}},{key:"registerRoute",value:function(e){if(null===this.route)throw new Error("No route set for '".concat(this.title,"' controller."));console.log({route:this.route}),e.on(this.route,this.routeHandler.bind(this),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null})}},{key:"routeHandler",value:function(e,t){}}],[{key:"nextHandle",get:function(){var t,r,n;return function(e,t,r,n){dd(e,t),ud(r,"set"),function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,r,n)}(e,e,hd,(n=hd,dd(r=e,e),ud(n,"get"),1+(t=+function(e,t){return t.get?t.get.call(e):t.value}(r,n)))),t}}]),e}(),hd={writable:!0,value:0},pd="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function vd(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var yd=function(e){return e&&e.Math==Math&&e},md=yd("object"==typeof globalThis&&globalThis)||yd("object"==typeof window&&window)||yd("object"==typeof self&&self)||yd("object"==typeof pd&&pd)||function(){return this}()||Function("return this")(),gd={},Sd=function(e){try{return!!e()}catch(e){return!0}},bd=!Sd((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),Nd={},Td={}.propertyIsEnumerable,wd=Object.getOwnPropertyDescriptor,Ed=wd&&!Td.call({1:2},1);Nd.f=Ed?function(e){var t=wd(this,e);return!!t&&t.enumerable}:Td;var _d,Od,Rd=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},Id={}.toString,xd=function(e){return Id.call(e).slice(8,-1)},Cd=xd,Ad="".split,kd=Sd((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==Cd(e)?Ad.call(e,""):Object(e)}:Object,Ld=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},Md=kd,Pd=Ld,Hd=function(e){return Md(Pd(e))},Dd=function(e){return"function"==typeof e},Fd=Dd,jd=function(e){return"object"==typeof e?null!==e:Fd(e)},Ud=md,Bd=Dd,Yd=function(e){return Bd(e)?e:void 0},Vd=function(e,t){return arguments.length<2?Yd(Ud[e]):Ud[e]&&Ud[e][t]},Jd=Vd("navigator","userAgent")||"",Gd=md,Kd=Jd,qd=Gd.process,Wd=Gd.Deno,Xd=qd&&qd.versions||Wd&&Wd.version,Qd=Xd&&Xd.v8;Qd?Od=(_d=Qd.split("."))[0]<4?1:_d[0]+_d[1]:Kd&&(!(_d=Kd.match(/Edge\/(\d+)/))||_d[1]>=74)&&(_d=Kd.match(/Chrome\/(\d+)/))&&(Od=_d[1]);var zd=Od&&+Od,$d=zd,Zd=Sd,ef=!!Object.getOwnPropertySymbols&&!Zd((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&$d&&$d<41})),tf=ef&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,rf=Dd,nf=Vd,of=tf?function(e){return"symbol"==typeof e}:function(e){var t=nf("Symbol");return rf(t)&&Object(e)instanceof t},af=function(e){try{return String(e)}catch(e){return"Object"}},sf=Dd,cf=af,lf=function(e){if(sf(e))return e;throw TypeError(cf(e)+" is not a function")},uf=lf,df=function(e,t){var r=e[t];return null==r?void 0:uf(r)},ff=Dd,hf=jd,pf={exports:{}},vf=md,yf=function(e,t){try{Object.defineProperty(vf,e,{value:t,configurable:!0,writable:!0})}catch(r){vf[e]=t}return t},mf=yf,gf=md["__core-js_shared__"]||mf("__core-js_shared__",{}),Sf=gf;(pf.exports=function(e,t){return Sf[e]||(Sf[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.18.2",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"});var bf=Ld,Nf=function(e){return Object(bf(e))},Tf=Nf,wf={}.hasOwnProperty,Ef=Object.hasOwn||function(e,t){return wf.call(Tf(e),t)},_f=0,Of=Math.random(),Rf=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++_f+Of).toString(36)},If=md,xf=pf.exports,Cf=Ef,Af=Rf,kf=ef,Lf=tf,Mf=xf("wks"),Pf=If.Symbol,Hf=Lf?Pf:Pf&&Pf.withoutSetter||Af,Df=function(e){return Cf(Mf,e)&&(kf||"string"==typeof Mf[e])||(kf&&Cf(Pf,e)?Mf[e]=Pf[e]:Mf[e]=Hf("Symbol."+e)),Mf[e]},Ff=jd,jf=of,Uf=df,Bf=Df("toPrimitive"),Yf=function(e,t){if(!Ff(e)||jf(e))return e;var r,n=Uf(e,Bf);if(n){if(void 0===t&&(t="default"),r=n.call(e,t),!Ff(r)||jf(r))return r;throw TypeError("Can't convert object to primitive value")}return void 0===t&&(t="number"),function(e,t){var r,n;if("string"===t&&ff(r=e.toString)&&!hf(n=r.call(e)))return n;if(ff(r=e.valueOf)&&!hf(n=r.call(e)))return n;if("string"!==t&&ff(r=e.toString)&&!hf(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")}(e,t)},Vf=of,Jf=function(e){var t=Yf(e,"string");return Vf(t)?t:String(t)},Gf=jd,Kf=md.document,qf=Gf(Kf)&&Gf(Kf.createElement),Wf=function(e){return qf?Kf.createElement(e):{}},Xf=Wf,Qf=!bd&&!Sd((function(){return 7!=Object.defineProperty(Xf("div"),"a",{get:function(){return 7}}).a})),zf=bd,$f=Nd,Zf=Rd,eh=Hd,th=Jf,rh=Ef,nh=Qf,oh=Object.getOwnPropertyDescriptor;gd.f=zf?oh:function(e,t){if(e=eh(e),t=th(t),nh)try{return oh(e,t)}catch(e){}if(rh(e,t))return Zf(!$f.f.call(e,t),e[t])};var ah={},ih=jd,sh=function(e){if(ih(e))return e;throw TypeError(String(e)+" is not an object")},ch=bd,lh=Qf,uh=sh,dh=Jf,fh=Object.defineProperty;ah.f=ch?fh:function(e,t,r){if(uh(e),t=dh(t),uh(r),lh)try{return fh(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var hh=ah,ph=Rd,vh=bd?function(e,t,r){return hh.f(e,t,ph(1,r))}:function(e,t,r){return e[t]=r,e},yh={exports:{}},mh=Dd,gh=gf,Sh=Function.toString;mh(gh.inspectSource)||(gh.inspectSource=function(e){return Sh.call(e)});var bh,Nh,Th,wh=gh.inspectSource,Eh=Dd,_h=wh,Oh=md.WeakMap,Rh=Eh(Oh)&&/native code/.test(_h(Oh)),Ih=pf.exports,xh=Rf,Ch=Ih("keys"),Ah=function(e){return Ch[e]||(Ch[e]=xh(e))},kh={},Lh=Rh,Mh=jd,Ph=vh,Hh=Ef,Dh=gf,Fh=Ah,jh=kh,Uh=md.WeakMap;if(Lh||Dh.state){var Bh=Dh.state||(Dh.state=new Uh),Yh=Bh.get,Vh=Bh.has,Jh=Bh.set;bh=function(e,t){if(Vh.call(Bh,e))throw new TypeError("Object already initialized");return t.facade=e,Jh.call(Bh,e,t),t},Nh=function(e){return Yh.call(Bh,e)||{}},Th=function(e){return Vh.call(Bh,e)}}else{var Gh=Fh("state");jh[Gh]=!0,bh=function(e,t){if(Hh(e,Gh))throw new TypeError("Object already initialized");return t.facade=e,Ph(e,Gh,t),t},Nh=function(e){return Hh(e,Gh)?e[Gh]:{}},Th=function(e){return Hh(e,Gh)}}var Kh={set:bh,get:Nh,has:Th,enforce:function(e){return Th(e)?Nh(e):bh(e,{})},getterFor:function(e){return function(t){var r;if(!Mh(t)||(r=Nh(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return r}}},qh=bd,Wh=Ef,Xh=Function.prototype,Qh=qh&&Object.getOwnPropertyDescriptor,zh=Wh(Xh,"name"),$h={EXISTS:zh,PROPER:zh&&"something"===function(){}.name,CONFIGURABLE:zh&&(!qh||qh&&Qh(Xh,"name").configurable)},Zh=md,ep=Dd,tp=Ef,rp=vh,np=yf,op=wh,ap=$h.CONFIGURABLE,ip=Kh.get,sp=Kh.enforce,cp=String(String).split("String");(yh.exports=function(e,t,r,n){var o,a=!!n&&!!n.unsafe,i=!!n&&!!n.enumerable,s=!!n&&!!n.noTargetGet,c=n&&void 0!==n.name?n.name:t;ep(r)&&("Symbol("===String(c).slice(0,7)&&(c="["+String(c).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!tp(r,"name")||ap&&r.name!==c)&&rp(r,"name",c),(o=sp(r)).source||(o.source=cp.join("string"==typeof c?c:""))),e!==Zh?(a?!s&&e[t]&&(i=!0):delete e[t],i?e[t]=r:rp(e,t,r)):i?e[t]=r:np(t,r)})(Function.prototype,"toString",(function(){return ep(this)&&ip(this).source||op(this)}));var lp={},up=Math.ceil,dp=Math.floor,fp=function(e){var t=+e;return t!=t||0===t?0:(t>0?dp:up)(t)},hp=fp,pp=Math.max,vp=Math.min,yp=function(e,t){var r=hp(e);return r<0?pp(r+t,0):vp(r,t)},mp=fp,gp=Math.min,Sp=function(e){return e>0?gp(mp(e),9007199254740991):0},bp=Sp,Np=function(e){return bp(e.length)},Tp=Hd,wp=yp,Ep=Np,_p=function(e){return function(t,r,n){var o,a=Tp(t),i=Ep(a),s=wp(n,i);if(e&&r!=r){for(;i>s;)if((o=a[s++])!=o)return!0}else for(;i>s;s++)if((e||s in a)&&a[s]===r)return e||s||0;return!e&&-1}},Op={includes:_p(!0),indexOf:_p(!1)},Rp=Ef,Ip=Hd,xp=Op.indexOf,Cp=kh,Ap=function(e,t){var r,n=Ip(e),o=0,a=[];for(r in n)!Rp(Cp,r)&&Rp(n,r)&&a.push(r);for(;t.length>o;)Rp(n,r=t[o++])&&(~xp(a,r)||a.push(r));return a},kp=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Lp=Ap,Mp=kp.concat("length","prototype");lp.f=Object.getOwnPropertyNames||function(e){return Lp(e,Mp)};var Pp={};Pp.f=Object.getOwnPropertySymbols;var Hp=lp,Dp=Pp,Fp=sh,jp=Vd("Reflect","ownKeys")||function(e){var t=Hp.f(Fp(e)),r=Dp.f;return r?t.concat(r(e)):t},Up=Ef,Bp=jp,Yp=gd,Vp=ah,Jp=function(e,t){for(var r=Bp(t),n=Vp.f,o=Yp.f,a=0;a<r.length;a++){var i=r[a];Up(e,i)||n(e,i,o(t,i))}},Gp=Sd,Kp=Dd,qp=/#|\.prototype\./,Wp=function(e,t){var r=Qp[Xp(e)];return r==$p||r!=zp&&(Kp(t)?Gp(t):!!t)},Xp=Wp.normalize=function(e){return String(e).replace(qp,".").toLowerCase()},Qp=Wp.data={},zp=Wp.NATIVE="N",$p=Wp.POLYFILL="P",Zp=Wp,ev=md,tv=gd.f,rv=vh,nv=yh.exports,ov=yf,av=Jp,iv=Zp,sv=function(e,t){var r,n,o,a,i,s=e.target,c=e.global,l=e.stat;if(r=c?ev:l?ev[s]||ov(s,{}):(ev[s]||{}).prototype)for(n in t){if(a=t[n],o=e.noTargetGet?(i=tv(r,n))&&i.value:r[n],!iv(c?n:s+(l?".":"#")+n,e.forced)&&void 0!==o){if(typeof a==typeof o)continue;av(a,o)}(e.sham||o&&o.sham)&&rv(a,"sham",!0),nv(r,n,a,e)}},cv={};cv[Df("toStringTag")]="z";var lv,uv="[object z]"===String(cv),dv=uv,fv=Dd,hv=xd,pv=Df("toStringTag"),vv="Arguments"==hv(function(){return arguments}()),yv=dv?hv:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),pv))?r:vv?hv(t):"Object"==(n=hv(t))&&fv(t.callee)?"Arguments":n},mv=Sd,gv=Dd,Sv=yv,bv=wh,Nv=[],Tv=Vd("Reflect","construct"),wv=/^\s*(?:class|function)\b/,Ev=wv.exec,_v=!wv.exec((function(){})),Ov=function(e){if(!gv(e))return!1;try{return Tv(Object,Nv,e),!0}catch(e){return!1}},Rv=!Tv||mv((function(){var e;return Ov(Ov.call)||!Ov(Object)||!Ov((function(){e=!0}))||e}))?function(e){if(!gv(e))return!1;switch(Sv(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}return _v||!!Ev.call(wv,bv(e))}:Ov,Iv=Rv,xv=af,Cv=function(e){if(Iv(e))return e;throw TypeError(xv(e)+" is not a constructor")},Av=Ap,kv=kp,Lv=Object.keys||function(e){return Av(e,kv)},Mv=ah,Pv=sh,Hv=Lv,Dv=bd?Object.defineProperties:function(e,t){Pv(e);for(var r,n=Hv(t),o=n.length,a=0;o>a;)Mv.f(e,r=n[a++],t[r]);return e},Fv=Vd("document","documentElement"),jv=sh,Uv=Dv,Bv=kp,Yv=kh,Vv=Fv,Jv=Wf,Gv=Ah("IE_PROTO"),Kv=function(){},qv=function(e){return"<script>"+e+"<\/script>"},Wv=function(e){e.write(qv("")),e.close();var t=e.parentWindow.Object;return e=null,t},Xv=function(){try{lv=new ActiveXObject("htmlfile")}catch(e){}var e,t;Xv="undefined"!=typeof document?document.domain&&lv?Wv(lv):((t=Jv("iframe")).style.display="none",Vv.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(qv("document.F=Object")),e.close(),e.F):Wv(lv);for(var r=Bv.length;r--;)delete Xv.prototype[Bv[r]];return Xv()};Yv[Gv]=!0;var Qv=Object.create||function(e,t){var r;return null!==e?(Kv.prototype=jv(e),r=new Kv,Kv.prototype=null,r[Gv]=e):r=Xv(),void 0===t?r:Uv(r,t)},zv=lf,$v=jd,Zv=[].slice,ey={},ty=function(e,t,r){if(!(t in ey)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";ey[t]=Function("C,a","return new C("+n.join(",")+")")}return ey[t](e,r)},ry=Function.bind||function(e){var t=zv(this),r=Zv.call(arguments,1),n=function(){var o=r.concat(Zv.call(arguments));return this instanceof n?ty(t,o.length,o):t.apply(e,o)};return $v(t.prototype)&&(n.prototype=t.prototype),n},ny=sv,oy=Cv,ay=sh,iy=jd,sy=Qv,cy=ry,ly=Sd,uy=Vd("Reflect","construct"),dy=ly((function(){function e(){}return!(uy((function(){}),[],e)instanceof e)})),fy=!ly((function(){uy((function(){}))})),hy=dy||fy;function py(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vy(e,t){return(vy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yy(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vy(e,t)}function my(e){return(my="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gy(e,t){if(t&&("object"===my(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return py(e)}function Sy(e){return(Sy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function by(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Ny(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,by(e,t,"set"),r),r}function Ty(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,by(e,t,"get"))}ny({target:"Reflect",stat:!0,forced:hy,sham:hy},{construct:function(e,t){oy(e),ay(t);var r=arguments.length<3?e:oy(arguments[2]);if(fy&&!dy)return uy(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(cy.apply(e,n))}var o=r.prototype,a=sy(iy(o)?o:Object.prototype),i=Function.apply.call(e,a,t);return iy(i)?i:a}});var wy=Qv,Ey=ah,_y=Df("unscopables"),Oy=Array.prototype;null==Oy[_y]&&Ey.f(Oy,_y,{configurable:!0,value:wy(null)});var Ry,Iy,xy,Cy=function(e){Oy[_y][e]=!0},Ay={},ky=!Sd((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Ly=Ef,My=Dd,Py=Nf,Hy=ky,Dy=Ah("IE_PROTO"),Fy=Object.prototype,jy=Hy?Object.getPrototypeOf:function(e){var t=Py(e);if(Ly(t,Dy))return t[Dy];var r=t.constructor;return My(r)&&t instanceof r?r.prototype:t instanceof Object?Fy:null},Uy=Sd,By=Dd,Yy=jy,Vy=yh.exports,Jy=Df("iterator"),Gy=!1;[].keys&&("next"in(xy=[].keys())?(Iy=Yy(Yy(xy)))!==Object.prototype&&(Ry=Iy):Gy=!0),(null==Ry||Uy((function(){var e={};return Ry[Jy].call(e)!==e})))&&(Ry={}),By(Ry[Jy])||Vy(Ry,Jy,(function(){return this}));var Ky={IteratorPrototype:Ry,BUGGY_SAFARI_ITERATORS:Gy},qy=ah.f,Wy=Ef,Xy=Df("toStringTag"),Qy=function(e,t,r){e&&!Wy(e=r?e:e.prototype,Xy)&&qy(e,Xy,{configurable:!0,value:t})},zy=Ky.IteratorPrototype,$y=Qv,Zy=Rd,em=Qy,tm=Ay,rm=function(){return this},nm=function(e,t,r){var n=t+" Iterator";return e.prototype=$y(zy,{next:Zy(1,r)}),em(e,n,!1),tm[n]=rm,e},om=Dd,am=sh,im=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),t=r instanceof Array}catch(e){}return function(r,n){return am(r),function(e){if("object"==typeof e||om(e))return e;throw TypeError("Can't set "+String(e)+" as a prototype")}(n),t?e.call(r,n):r.__proto__=n,r}}():void 0),sm=sv,cm=$h,lm=Dd,um=nm,dm=jy,fm=im,hm=Qy,pm=vh,vm=yh.exports,ym=Ay,mm=cm.PROPER,gm=cm.CONFIGURABLE,Sm=Ky.IteratorPrototype,bm=Ky.BUGGY_SAFARI_ITERATORS,Nm=Df("iterator"),Tm=function(){return this},wm=function(e,t,r,n,o,a,i){um(r,t,n);var s,c,l,u=function(e){if(e===o&&v)return v;if(!bm&&e in h)return h[e];switch(e){case"keys":case"values":case"entries":return function(){return new r(this,e)}}return function(){return new r(this)}},d=t+" Iterator",f=!1,h=e.prototype,p=h[Nm]||h["@@iterator"]||o&&h[o],v=!bm&&p||u(o),y="Array"==t&&h.entries||p;if(y&&(s=dm(y.call(new e)))!==Object.prototype&&s.next&&(dm(s)!==Sm&&(fm?fm(s,Sm):lm(s[Nm])||vm(s,Nm,Tm)),hm(s,d,!0)),mm&&"values"==o&&p&&"values"!==p.name&&(gm?pm(h,"name","values"):(f=!0,v=function(){return p.call(this)})),o)if(c={values:u("values"),keys:a?v:u("keys"),entries:u("entries")},i)for(l in c)(bm||f||!(l in h))&&vm(h,l,c[l]);else sm({target:t,proto:!0,forced:bm||f},c);return h[Nm]!==v&&vm(h,Nm,v,{name:o}),ym[t]=v,c},Em=Hd,_m=Cy,Om=Ay,Rm=Kh,Im=wm,xm=Rm.set,Cm=Rm.getterFor("Array Iterator"),Am=Im(Array,"Array",(function(e,t){xm(this,{type:"Array Iterator",target:Em(e),index:0,kind:t})}),(function(){var e=Cm(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values");Om.Arguments=Om.Array,_m("keys"),_m("values"),_m("entries");var km=yv,Lm=uv?{}.toString:function(){return"[object "+km(this)+"]"},Mm=uv,Pm=yh.exports,Hm=Lm;Mm||Pm(Object.prototype,"toString",Hm,{unsafe:!0});var Dm=yv,Fm=function(e){if("Symbol"===Dm(e))throw TypeError("Cannot convert a Symbol value to a string");return String(e)},jm=fp,Um=Fm,Bm=Ld,Ym=function(e){return function(t,r){var n,o,a=Um(Bm(t)),i=jm(r),s=a.length;return i<0||i>=s?e?"":void 0:(n=a.charCodeAt(i))<55296||n>56319||i+1===s||(o=a.charCodeAt(i+1))<56320||o>57343?e?a.charAt(i):n:e?a.slice(i,i+2):o-56320+(n-55296<<10)+65536}},Vm={codeAt:Ym(!1),charAt:Ym(!0)},Jm=Vm.charAt,Gm=Fm,Km=Kh,qm=wm,Wm=Km.set,Xm=Km.getterFor("String Iterator");qm(String,"String",(function(e){Wm(this,{type:"String Iterator",string:Gm(e),index:0})}),(function(){var e,t=Xm(this),r=t.string,n=t.index;return n>=r.length?{value:void 0,done:!0}:(e=Jm(r,n),t.index+=e.length,{value:e,done:!1})}));var Qm=yh.exports,zm=function(e,t,r){for(var n in t)Qm(e,n,t[n],r);return e},$m={exports:{}},Zm={},eg=Hd,tg=lp.f,rg={}.toString,ng="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];Zm.f=function(e){return ng&&"[object Window]"==rg.call(e)?function(e){try{return tg(e)}catch(e){return ng.slice()}}(e):tg(eg(e))};var og=!Sd((function(){return Object.isExtensible(Object.preventExtensions({}))})),ag=sv,ig=kh,sg=jd,cg=Ef,lg=ah.f,ug=lp,dg=Zm,fg=og,hg=!1,pg=Rf("meta"),vg=0,yg=Object.isExtensible||function(){return!0},mg=function(e){lg(e,pg,{value:{objectID:"O"+vg++,weakData:{}}})},gg=$m.exports={enable:function(){gg.enable=function(){},hg=!0;var e=ug.f,t=[].splice,r={};r[pg]=1,e(r).length&&(ug.f=function(r){for(var n=e(r),o=0,a=n.length;o<a;o++)if(n[o]===pg){t.call(n,o,1);break}return n},ag({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:dg.f}))},fastKey:function(e,t){if(!sg(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!cg(e,pg)){if(!yg(e))return"F";if(!t)return"E";mg(e)}return e[pg].objectID},getWeakData:function(e,t){if(!cg(e,pg)){if(!yg(e))return!0;if(!t)return!1;mg(e)}return e[pg].weakData},onFreeze:function(e){return fg&&hg&&yg(e)&&!cg(e,pg)&&mg(e),e}};ig[pg]=!0;var Sg=Ay,bg=Df("iterator"),Ng=Array.prototype,Tg=function(e){return void 0!==e&&(Sg.Array===e||Ng[bg]===e)},wg=lf,Eg=function(e,t,r){if(wg(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}},_g=yv,Og=df,Rg=Ay,Ig=Df("iterator"),xg=function(e){if(null!=e)return Og(e,Ig)||Og(e,"@@iterator")||Rg[_g(e)]},Cg=lf,Ag=sh,kg=xg,Lg=function(e,t){var r=arguments.length<2?kg(e):t;if(Cg(r))return Ag(r.call(e));throw TypeError(String(e)+" is not iterable")},Mg=sh,Pg=df,Hg=function(e,t,r){var n,o;Mg(e);try{if(!(n=Pg(e,"return"))){if("throw"===t)throw r;return r}n=n.call(e)}catch(e){o=!0,n=e}if("throw"===t)throw r;if(o)throw n;return Mg(n),r},Dg=sh,Fg=Tg,jg=Np,Ug=Eg,Bg=Lg,Yg=xg,Vg=Hg,Jg=function(e,t){this.stopped=e,this.result=t},Gg=function(e,t,r){var n,o,a,i,s,c,l,u=r&&r.that,d=!(!r||!r.AS_ENTRIES),f=!(!r||!r.IS_ITERATOR),h=!(!r||!r.INTERRUPTED),p=Ug(t,u,1+d+h),v=function(e){return n&&Vg(n,"normal",e),new Jg(!0,e)},y=function(e){return d?(Dg(e),h?p(e[0],e[1],v):p(e[0],e[1])):h?p(e,v):p(e)};if(f)n=e;else{if(!(o=Yg(e)))throw TypeError(String(e)+" is not iterable");if(Fg(o)){for(a=0,i=jg(e);i>a;a++)if((s=y(e[a]))&&s instanceof Jg)return s;return new Jg(!1)}n=Bg(e,o)}for(c=n.next;!(l=c.call(n)).done;){try{s=y(l.value)}catch(e){Vg(n,"throw",e)}if("object"==typeof s&&s&&s instanceof Jg)return s}return new Jg(!1)},Kg=function(e,t,r){if(e instanceof t)return e;throw TypeError("Incorrect "+(r?r+" ":"")+"invocation")},qg=Df("iterator"),Wg=!1;try{var Xg=0,Qg={next:function(){return{done:!!Xg++}},return:function(){Wg=!0}};Qg[qg]=function(){return this},Array.from(Qg,(function(){throw 2}))}catch(id){}var zg=function(e,t){if(!t&&!Wg)return!1;var r=!1;try{var n={};n[qg]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch(e){}return r},$g=Dd,Zg=jd,eS=im,tS=function(e,t,r){var n,o;return eS&&$g(n=t.constructor)&&n!==r&&Zg(o=n.prototype)&&o!==r.prototype&&eS(e,o),e},rS=sv,nS=md,oS=Zp,aS=yh.exports,iS=$m.exports,sS=Gg,cS=Kg,lS=Dd,uS=jd,dS=Sd,fS=zg,hS=Qy,pS=tS,vS=function(e,t,r){var n=-1!==e.indexOf("Map"),o=-1!==e.indexOf("Weak"),a=n?"set":"add",i=nS[e],s=i&&i.prototype,c=i,l={},u=function(e){var t=s[e];aS(s,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(o&&!uS(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return o&&!uS(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(o&&!uS(e))&&t.call(this,0===e?0:e)}:function(e,r){return t.call(this,0===e?0:e,r),this})};if(oS(e,!lS(i)||!(o||s.forEach&&!dS((function(){(new i).entries().next()})))))c=r.getConstructor(t,e,n,a),iS.enable();else if(oS(e,!0)){var d=new c,f=d[a](o?{}:-0,1)!=d,h=dS((function(){d.has(1)})),p=fS((function(e){new i(e)})),v=!o&&dS((function(){for(var e=new i,t=5;t--;)e[a](t,t);return!e.has(-0)}));p||((c=t((function(t,r){cS(t,c,e);var o=pS(new i,t,c);return null!=r&&sS(r,o[a],{that:o,AS_ENTRIES:n}),o}))).prototype=s,s.constructor=c),(h||v)&&(u("delete"),u("has"),n&&u("get")),(v||f)&&u(a),o&&s.clear&&delete s.clear}return l[e]=c,rS({global:!0,forced:c!=i},l),hS(c,e),o||r.setStrong(c,e,n),c},yS=xd,mS=Array.isArray||function(e){return"Array"==yS(e)},gS=mS,SS=Rv,bS=jd,NS=Df("species"),TS=function(e,t){return new(function(e){var t;return gS(e)&&(t=e.constructor,(SS(t)&&(t===Array||gS(t.prototype))||bS(t)&&null===(t=t[NS]))&&(t=void 0)),void 0===t?Array:t}(e))(0===t?0:t)},wS=Eg,ES=kd,_S=Nf,OS=Np,RS=TS,IS=[].push,xS=function(e){var t=1==e,r=2==e,n=3==e,o=4==e,a=6==e,i=7==e,s=5==e||a;return function(c,l,u,d){for(var f,h,p=_S(c),v=ES(p),y=wS(l,u,3),m=OS(v),g=0,S=d||RS,b=t?S(c,m):r||i?S(c,0):void 0;m>g;g++)if((s||g in v)&&(h=y(f=v[g],g,p),e))if(t)b[g]=h;else if(h)switch(e){case 3:return!0;case 5:return f;case 6:return g;case 2:IS.call(b,f)}else switch(e){case 4:return!1;case 7:IS.call(b,f)}return a?-1:n||o?o:b}},CS={forEach:xS(0),map:xS(1),filter:xS(2),some:xS(3),every:xS(4),find:xS(5),findIndex:xS(6),filterReject:xS(7)},AS=zm,kS=$m.exports.getWeakData,LS=sh,MS=jd,PS=Kg,HS=Gg,DS=Ef,FS=Kh.set,jS=Kh.getterFor,US=CS.find,BS=CS.findIndex,YS=0,VS=function(e){return e.frozen||(e.frozen=new JS)},JS=function(){this.entries=[]},GS=function(e,t){return US(e.entries,(function(e){return e[0]===t}))};JS.prototype={get:function(e){var t=GS(this,e);if(t)return t[1]},has:function(e){return!!GS(this,e)},set:function(e,t){var r=GS(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=BS(this.entries,(function(t){return t[0]===e}));return~t&&this.entries.splice(t,1),!!~t}};var KS,qS={getConstructor:function(e,t,r,n){var o=e((function(e,a){PS(e,o,t),FS(e,{type:t,id:YS++,frozen:void 0}),null!=a&&HS(a,e[n],{that:e,AS_ENTRIES:r})})),a=jS(t),i=function(e,t,r){var n=a(e),o=kS(LS(t),!0);return!0===o?VS(n).set(t,r):o[n.id]=r,e};return AS(o.prototype,{delete:function(e){var t=a(this);if(!MS(e))return!1;var r=kS(e);return!0===r?VS(t).delete(e):r&&DS(r,t.id)&&delete r[t.id]},has:function(e){var t=a(this);if(!MS(e))return!1;var r=kS(e);return!0===r?VS(t).has(e):r&&DS(r,t.id)}}),AS(o.prototype,r?{get:function(e){var t=a(this);if(MS(e)){var r=kS(e);return!0===r?VS(t).get(e):r?r[t.id]:void 0}},set:function(e,t){return i(this,e,t)}}:{add:function(e){return i(this,e,!0)}}),o}},WS=md,XS=zm,QS=$m.exports,zS=vS,$S=qS,ZS=jd,eb=Kh.enforce,tb=Rh,rb=!WS.ActiveXObject&&"ActiveXObject"in WS,nb=Object.isExtensible,ob=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},ab=zS("WeakMap",ob,$S);if(tb&&rb){KS=$S.getConstructor(ob,"WeakMap",!0),QS.enable();var ib=ab.prototype,sb=ib.delete,cb=ib.has,lb=ib.get,ub=ib.set;XS(ib,{delete:function(e){if(ZS(e)&&!nb(e)){var t=eb(this);return t.frozen||(t.frozen=new KS),sb.call(this,e)||t.frozen.delete(e)}return sb.call(this,e)},has:function(e){if(ZS(e)&&!nb(e)){var t=eb(this);return t.frozen||(t.frozen=new KS),cb.call(this,e)||t.frozen.has(e)}return cb.call(this,e)},get:function(e){if(ZS(e)&&!nb(e)){var t=eb(this);return t.frozen||(t.frozen=new KS),cb.call(this,e)?lb.call(this,e):t.frozen.get(e)}return lb.call(this,e)},set:function(e,t){if(ZS(e)&&!nb(e)){var r=eb(this);r.frozen||(r.frozen=new KS),cb.call(this,e)?ub.call(this,e,t):r.frozen.set(e,t)}else ub.call(this,e,t);return this}})}var db={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},fb=Wf("span").classList,hb=fb&&fb.constructor&&fb.constructor.prototype,pb=hb===Object.prototype?void 0:hb,vb=md,yb=db,mb=pb,gb=Am,Sb=vh,bb=Df,Nb=bb("iterator"),Tb=bb("toStringTag"),wb=gb.values,Eb=function(e,t){if(e){if(e[Nb]!==wb)try{Sb(e,Nb,wb)}catch(t){e[Nb]=wb}if(e[Tb]||Sb(e,Tb,t),yb[t])for(var r in gb)if(e[r]!==gb[r])try{Sb(e,r,gb[r])}catch(t){e[r]=gb[r]}}};for(var _b in yb)Eb(vb[_b]&&vb[_b].prototype,_b);function Ob(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Rb(e,t,r){return(Rb=Ob()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&vy(o,r.prototype),o}).apply(null,arguments)}function Ib(e){var t="function"==typeof Map?new Map:void 0;return(Ib=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return Rb(e,arguments,Sy(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),vy(n,e)})(e)}Eb(mb,"DOMTokenList");var xb=function(e){yy(r,Ib(Error));var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(e){return id(this,r),t.call(this,e)}return r}();function Cb(e,t,r){return(Cb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sy(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}var Ab=Jf,kb=ah,Lb=Rd,Mb=function(e,t,r){var n=Ab(t);n in e?kb.f(e,n,Lb(0,r)):e[n]=r},Pb=Sd,Hb=zd,Db=Df("species"),Fb=function(e){return Hb>=51||!Pb((function(){var t=[];return(t.constructor={})[Db]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},jb=sv,Ub=Sd,Bb=mS,Yb=jd,Vb=Nf,Jb=Np,Gb=Mb,Kb=TS,qb=Fb,Wb=zd,Xb=Df("isConcatSpreadable"),Qb=Wb>=51||!Ub((function(){var e=[];return e[Xb]=!1,e.concat()[0]!==e})),zb=qb("concat"),$b=function(e){if(!Yb(e))return!1;var t=e[Xb];return void 0!==t?!!t:Bb(e)};jb({target:"Array",proto:!0,forced:!Qb||!zb},{concat:function(e){var t,r,n,o,a,i=Vb(this),s=Kb(i,0),c=0;for(t=-1,n=arguments.length;t<n;t++)if($b(a=-1===t?i:arguments[t])){if(c+(o=Jb(a))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(r=0;r<o;r++,c++)r in a&&Gb(s,c,a[r])}else{if(c>=9007199254740991)throw TypeError("Maximum allowed index exceeded");Gb(s,c++,a)}return s.length=c,s}});var Zb=sh,eN=function(){var e=Zb(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},tN=$h.PROPER,rN=yh.exports,nN=sh,oN=Fm,aN=Sd,iN=eN,sN=RegExp.prototype,cN=sN.toString,lN=aN((function(){return"/a/b"!=cN.call({source:"a",flags:"b"})})),uN=tN&&"toString"!=cN.name;(lN||uN)&&rN(RegExp.prototype,"toString",(function(){var e=nN(this),t=oN(e.source),r=e.flags;return"/"+t+"/"+oN(void 0===r&&e instanceof RegExp&&!("flags"in sN)?iN.call(e):r)}),{unsafe:!0});var dN,fN,hN,pN,vN=md.Promise,yN=Vd,mN=ah,gN=bd,SN=Df("species"),bN=function(e){var t=yN(e),r=mN.f;gN&&t&&!t[SN]&&r(t,SN,{configurable:!0,get:function(){return this}})},NN=sh,TN=Cv,wN=Df("species"),EN=function(e,t){var r,n=NN(e).constructor;return void 0===n||null==(r=NN(n)[wN])?t:TN(r)},_N=/(?:ipad|iphone|ipod).*applewebkit/i.test(Jd),ON="process"==xd(md.process),RN=md,IN=Dd,xN=Sd,CN=Eg,AN=Fv,kN=Wf,LN=_N,MN=ON,PN=RN.setImmediate,HN=RN.clearImmediate,DN=RN.process,FN=RN.MessageChannel,jN=RN.Dispatch,UN=0,BN={};try{dN=RN.location}catch(id){}var YN=function(e){if(BN.hasOwnProperty(e)){var t=BN[e];delete BN[e],t()}},VN=function(e){return function(){YN(e)}},JN=function(e){YN(e.data)},GN=function(e){RN.postMessage(String(e),dN.protocol+"//"+dN.host)};PN&&HN||(PN=function(e){for(var t=[],r=arguments.length,n=1;r>n;)t.push(arguments[n++]);return BN[++UN]=function(){(IN(e)?e:Function(e)).apply(void 0,t)},fN(UN),UN},HN=function(e){delete BN[e]},MN?fN=function(e){DN.nextTick(VN(e))}:jN&&jN.now?fN=function(e){jN.now(VN(e))}:FN&&!LN?(pN=(hN=new FN).port2,hN.port1.onmessage=JN,fN=CN(pN.postMessage,pN,1)):RN.addEventListener&&IN(RN.postMessage)&&!RN.importScripts&&dN&&"file:"!==dN.protocol&&!xN(GN)?(fN=GN,RN.addEventListener("message",JN,!1)):fN="onreadystatechange"in kN("script")?function(e){AN.appendChild(kN("script")).onreadystatechange=function(){AN.removeChild(this),YN(e)}}:function(e){setTimeout(VN(e),0)});var KN,qN,WN,XN,QN,zN,$N,ZN,eT={set:PN,clear:HN},tT=md,rT=/ipad|iphone|ipod/i.test(Jd)&&void 0!==tT.Pebble,nT=/web0s(?!.*chrome)/i.test(Jd),oT=md,aT=gd.f,iT=eT.set,sT=_N,cT=rT,lT=nT,uT=ON,dT=oT.MutationObserver||oT.WebKitMutationObserver,fT=oT.document,hT=oT.process,pT=oT.Promise,vT=aT(oT,"queueMicrotask"),yT=vT&&vT.value;yT||(KN=function(){var e,t;for(uT&&(e=hT.domain)&&e.exit();qN;){t=qN.fn,qN=qN.next;try{t()}catch(e){throw qN?XN():WN=void 0,e}}WN=void 0,e&&e.enter()},sT||uT||lT||!dT||!fT?!cT&&pT&&pT.resolve?(($N=pT.resolve(void 0)).constructor=pT,ZN=$N.then,XN=function(){ZN.call($N,KN)}):XN=uT?function(){hT.nextTick(KN)}:function(){iT.call(oT,KN)}:(QN=!0,zN=fT.createTextNode(""),new dT(KN).observe(zN,{characterData:!0}),XN=function(){zN.data=QN=!QN}));var mT=yT||function(e){var t={fn:e,next:void 0};WN&&(WN.next=t),qN||(qN=t,XN()),WN=t},gT={},ST=lf,bT=function(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=ST(t),this.reject=ST(r)};gT.f=function(e){return new bT(e)};var NT,TT,wT,ET,_T=sh,OT=jd,RT=gT,IT=function(e,t){if(_T(e),OT(t)&&t.constructor===e)return t;var r=RT.f(e);return(0,r.resolve)(t),r.promise},xT=md,CT="object"==typeof window,AT=sv,kT=md,LT=Vd,MT=vN,PT=yh.exports,HT=zm,DT=im,FT=Qy,jT=bN,UT=lf,BT=Dd,YT=jd,VT=Kg,JT=wh,GT=Gg,KT=zg,qT=EN,WT=eT.set,XT=mT,QT=IT,zT=gT,$T=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},ZT=Kh,ew=Zp,tw=CT,rw=ON,nw=zd,ow=Df("species"),aw="Promise",iw=ZT.get,sw=ZT.set,cw=ZT.getterFor(aw),lw=MT&&MT.prototype,uw=MT,dw=lw,fw=kT.TypeError,hw=kT.document,pw=kT.process,vw=zT.f,yw=vw,mw=!!(hw&&hw.createEvent&&kT.dispatchEvent),gw=BT(kT.PromiseRejectionEvent),Sw=!1,bw=ew(aw,(function(){var e=JT(uw),t=e!==String(uw);if(!t&&66===nw)return!0;if(nw>=51&&/native code/.test(e))return!1;var r=new uw((function(e){e(1)})),n=function(e){e((function(){}),(function(){}))};return(r.constructor={})[ow]=n,!(Sw=r.then((function(){}))instanceof n)||!t&&tw&&!gw})),Nw=bw||!KT((function(e){uw.all(e).catch((function(){}))})),Tw=function(e){var t;return!(!YT(e)||!BT(t=e.then))&&t},ww=function(e,t){if(!e.notified){e.notified=!0;var r=e.reactions;XT((function(){for(var n=e.value,o=1==e.state,a=0;r.length>a;){var i,s,c,l=r[a++],u=o?l.ok:l.fail,d=l.resolve,f=l.reject,h=l.domain;try{u?(o||(2===e.rejection&&Rw(e),e.rejection=1),!0===u?i=n:(h&&h.enter(),i=u(n),h&&(h.exit(),c=!0)),i===l.promise?f(fw("Promise-chain cycle")):(s=Tw(i))?s.call(i,d,f):d(i)):f(n)}catch(e){h&&!c&&h.exit(),f(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&_w(e)}))}},Ew=function(e,t,r){var n,o;mw?((n=hw.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),kT.dispatchEvent(n)):n={promise:t,reason:r},!gw&&(o=kT["on"+e])?o(n):"unhandledrejection"===e&&function(e,t){var r=xT.console;r&&r.error&&(1===arguments.length?r.error(e):r.error(e,t))}("Unhandled promise rejection",r)},_w=function(e){WT.call(kT,(function(){var t,r=e.facade,n=e.value;if(Ow(e)&&(t=$T((function(){rw?pw.emit("unhandledRejection",n,r):Ew("unhandledrejection",r,n)})),e.rejection=rw||Ow(e)?2:1,t.error))throw t.value}))},Ow=function(e){return 1!==e.rejection&&!e.parent},Rw=function(e){WT.call(kT,(function(){var t=e.facade;rw?pw.emit("rejectionHandled",t):Ew("rejectionhandled",t,e.value)}))},Iw=function(e,t,r){return function(n){e(t,n,r)}},xw=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,ww(e,!0))},Cw=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw fw("Promise can't be resolved itself");var n=Tw(t);n?XT((function(){var r={done:!1};try{n.call(t,Iw(Cw,r,e),Iw(xw,r,e))}catch(t){xw(r,t,e)}})):(e.value=t,e.state=1,ww(e,!1))}catch(t){xw({done:!1},t,e)}}};if(bw&&(dw=(uw=function(e){VT(this,uw,aw),UT(e),NT.call(this);var t=iw(this);try{e(Iw(Cw,t),Iw(xw,t))}catch(e){xw(t,e)}}).prototype,(NT=function(e){sw(this,{type:aw,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=HT(dw,{then:function(e,t){var r=cw(this),n=vw(qT(this,uw));return n.ok=!BT(e)||e,n.fail=BT(t)&&t,n.domain=rw?pw.domain:void 0,r.parent=!0,r.reactions.push(n),0!=r.state&&ww(r,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),TT=function(){var e=new NT,t=iw(e);this.promise=e,this.resolve=Iw(Cw,t),this.reject=Iw(xw,t)},zT.f=vw=function(e){return e===uw||e===wT?new TT(e):yw(e)},BT(MT)&&lw!==Object.prototype)){ET=lw.then,Sw||(PT(lw,"then",(function(e,t){var r=this;return new uw((function(e,t){ET.call(r,e,t)})).then(e,t)}),{unsafe:!0}),PT(lw,"catch",dw.catch,{unsafe:!0}));try{delete lw.constructor}catch(id){}DT&&DT(lw,dw)}AT({global:!0,wrap:!0,forced:bw},{Promise:uw}),FT(uw,aw,!1),jT(aw),wT=LT(aw),AT({target:aw,stat:!0,forced:bw},{reject:function(e){var t=vw(this);return t.reject.call(void 0,e),t.promise}}),AT({target:aw,stat:!0,forced:bw},{resolve:function(e){return QT(this,e)}}),AT({target:aw,stat:!0,forced:Nw},{all:function(e){var t=this,r=vw(t),n=r.resolve,o=r.reject,a=$T((function(){var r=UT(t.resolve),a=[],i=0,s=1;GT(e,(function(e){var c=i++,l=!1;a.push(void 0),s++,r.call(t,e).then((function(e){l||(l=!0,a[c]=e,--s||n(a))}),o)})),--s||n(a)}));return a.error&&o(a.value),r.promise},race:function(e){var t=this,r=vw(t),n=r.reject,o=$T((function(){var o=UT(t.resolve);GT(e,(function(e){o.call(t,e).then(r.resolve,n)}))}));return o.error&&n(o.value),r.promise}});var Aw={},kw=Sd,Lw=md.RegExp;Aw.UNSUPPORTED_Y=kw((function(){var e=Lw("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),Aw.BROKEN_CARET=kw((function(){var e=Lw("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));var Mw=Sd,Pw=md.RegExp,Hw=Mw((function(){var e=Pw(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),Dw=Sd,Fw=md.RegExp,jw=Dw((function(){var e=Fw("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),Uw=Fm,Bw=eN,Yw=Aw,Vw=pf.exports,Jw=Qv,Gw=Kh.get,Kw=Hw,qw=jw,Ww=RegExp.prototype.exec,Xw=Vw("native-string-replace",String.prototype.replace),Qw=Ww,zw=function(){var e=/a/,t=/b*/g;return Ww.call(e,"a"),Ww.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),$w=Yw.UNSUPPORTED_Y||Yw.BROKEN_CARET,Zw=void 0!==/()??/.exec("")[1];(zw||Zw||$w||Kw||qw)&&(Qw=function(e){var t,r,n,o,a,i,s,c=this,l=Gw(c),u=Uw(e),d=l.raw;if(d)return d.lastIndex=c.lastIndex,t=Qw.call(d,u),c.lastIndex=d.lastIndex,t;var f=l.groups,h=$w&&c.sticky,p=Bw.call(c),v=c.source,y=0,m=u;if(h&&(-1===(p=p.replace("y","")).indexOf("g")&&(p+="g"),m=u.slice(c.lastIndex),c.lastIndex>0&&(!c.multiline||c.multiline&&"\n"!==u.charAt(c.lastIndex-1))&&(v="(?: "+v+")",m=" "+m,y++),r=new RegExp("^(?:"+v+")",p)),Zw&&(r=new RegExp("^"+v+"$(?!\\s)",p)),zw&&(n=c.lastIndex),o=Ww.call(h?r:c,m),h?o?(o.input=o.input.slice(y),o[0]=o[0].slice(y),o.index=c.lastIndex,c.lastIndex+=o[0].length):c.lastIndex=0:zw&&o&&(c.lastIndex=c.global?o.index+o[0].length:n),Zw&&o&&o.length>1&&Xw.call(o[0],r,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(o[a]=void 0)})),o&&f)for(o.groups=i=Jw(null),a=0;a<f.length;a++)i[(s=f[a])[0]]=o[s[1]];return o});var eE=Qw;sv({target:"RegExp",proto:!0,forced:/./.exec!==eE},{exec:eE});var tE=yh.exports,rE=eE,nE=Sd,oE=Df,aE=vh,iE=oE("species"),sE=RegExp.prototype,cE=function(e,t,r,n){var o=oE(e),a=!nE((function(){var t={};return t[o]=function(){return 7},7!=""[e](t)})),i=a&&!nE((function(){var t=!1,r=/a/;return"split"===e&&((r={}).constructor={},r.constructor[iE]=function(){return r},r.flags="",r[o]=/./[o]),r.exec=function(){return t=!0,null},r[o](""),!t}));if(!a||!i||r){var s=/./[o],c=t(o,""[e],(function(e,t,r,n,o){var i=t.exec;return i===rE||i===sE.exec?a&&!o?{done:!0,value:s.call(t,r,n)}:{done:!0,value:e.call(r,t,n)}:{done:!1}}));tE(String.prototype,e,c[0]),tE(sE,o,c[1])}n&&aE(sE[o],"sham",!0)},lE=Vm.charAt,uE=function(e,t,r){return t+(r?lE(e,t).length:1)},dE=Nf,fE=Math.floor,hE="".replace,pE=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,vE=/\$([$&'`]|\d{1,2})/g,yE=sh,mE=Dd,gE=xd,SE=eE,bE=function(e,t){var r=e.exec;if(mE(r)){var n=r.call(e,t);return null!==n&&yE(n),n}if("RegExp"===gE(e))return SE.call(e,t);throw TypeError("RegExp#exec called on incompatible receiver")},NE=cE,TE=Sd,wE=sh,EE=Dd,_E=fp,OE=Sp,RE=Fm,IE=Ld,xE=uE,CE=df,AE=function(e,t,r,n,o,a){var i=r+e.length,s=n.length,c=vE;return void 0!==o&&(o=dE(o),c=pE),hE.call(a,c,(function(a,c){var l;switch(c.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(i);case"<":l=o[c.slice(1,-1)];break;default:var u=+c;if(0===u)return a;if(u>s){var d=fE(u/10);return 0===d?a:d<=s?void 0===n[d-1]?c.charAt(1):n[d-1]+c.charAt(1):a}l=n[u-1]}return void 0===l?"":l}))},kE=bE,LE=Df("replace"),ME=Math.max,PE=Math.min,HE="$0"==="a".replace(/./,"$0"),DE=!!/./[LE]&&""===/./[LE]("a","$0");NE("replace",(function(e,t,r){var n=DE?"$":"$0";return[function(e,r){var n=IE(this),o=null==e?void 0:CE(e,LE);return o?o.call(e,n,r):t.call(RE(n),e,r)},function(e,o){var a=wE(this),i=RE(e);if("string"==typeof o&&-1===o.indexOf(n)&&-1===o.indexOf("$<")){var s=r(t,a,i,o);if(s.done)return s.value}var c=EE(o);c||(o=RE(o));var l=a.global;if(l){var u=a.unicode;a.lastIndex=0}for(var d=[];;){var f=kE(a,i);if(null===f)break;if(d.push(f),!l)break;""===RE(f[0])&&(a.lastIndex=xE(i,OE(a.lastIndex),u))}for(var h,p="",v=0,y=0;y<d.length;y++){f=d[y];for(var m=RE(f[0]),g=ME(PE(_E(f.index),i.length),0),S=[],b=1;b<f.length;b++)S.push(void 0===(h=f[b])?h:String(h));var N=f.groups;if(c){var T=[m].concat(S,g,i);void 0!==N&&T.push(N);var w=RE(o.apply(void 0,T))}else w=AE(m,i,g,S,N,o);g>=v&&(p+=i.slice(v,g)+w,v=g+m.length)}return p+i.slice(v)}]}),!!TE((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!HE||DE);var FE=sv,jE=vN,UE=Sd,BE=Vd,YE=Dd,VE=EN,JE=IT,GE=yh.exports;if(FE({target:"Promise",proto:!0,real:!0,forced:!!jE&&UE((function(){jE.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=VE(this,BE("Promise")),r=YE(e);return this.then(r?function(r){return JE(t,e()).then((function(){return r}))}:e,r?function(r){return JE(t,e()).then((function(){throw r}))}:e)}}),YE(jE)){var KE=BE("Promise").prototype.finally;jE.prototype.finally!==KE&&GE(jE.prototype,"finally",KE,{unsafe:!0})}var qE=Nf,WE=Lv;sv({target:"Object",stat:!0,forced:Sd((function(){WE(1)}))},{keys:function(e){return WE(qE(e))}});var XE={},QE=Df;XE.f=QE;var zE=md,$E=Ef,ZE=XE,e_=ah.f,t_=function(e){var t=zE.Symbol||(zE.Symbol={});$E(t,e)||e_(t,e,{value:ZE.f(e)})},r_=sv,n_=md,o_=Vd,a_=bd,i_=ef,s_=Sd,c_=Ef,l_=mS,u_=Dd,d_=jd,f_=of,h_=sh,p_=Nf,v_=Hd,y_=Jf,m_=Fm,g_=Rd,S_=Qv,b_=Lv,N_=lp,T_=Zm,w_=Pp,E_=gd,__=ah,O_=Nd,R_=yh.exports,I_=pf.exports,x_=kh,C_=Rf,A_=Df,k_=XE,L_=t_,M_=Qy,P_=Kh,H_=CS.forEach,D_=Ah("hidden"),F_=A_("toPrimitive"),j_=P_.set,U_=P_.getterFor("Symbol"),B_=Object.prototype,Y_=n_.Symbol,V_=o_("JSON","stringify"),J_=E_.f,G_=__.f,K_=T_.f,q_=O_.f,W_=I_("symbols"),X_=I_("op-symbols"),Q_=I_("string-to-symbol-registry"),z_=I_("symbol-to-string-registry"),$_=I_("wks"),Z_=n_.QObject,eO=!Z_||!Z_.prototype||!Z_.prototype.findChild,tO=a_&&s_((function(){return 7!=S_(G_({},"a",{get:function(){return G_(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=J_(B_,t);n&&delete B_[t],G_(e,t,r),n&&e!==B_&&G_(B_,t,n)}:G_,rO=function(e,t){var r=W_[e]=S_(Y_.prototype);return j_(r,{type:"Symbol",tag:e,description:t}),a_||(r.description=t),r},nO=function(e,t,r){e===B_&&nO(X_,t,r),h_(e);var n=y_(t);return h_(r),c_(W_,n)?(r.enumerable?(c_(e,D_)&&e[D_][n]&&(e[D_][n]=!1),r=S_(r,{enumerable:g_(0,!1)})):(c_(e,D_)||G_(e,D_,g_(1,{})),e[D_][n]=!0),tO(e,n,r)):G_(e,n,r)},oO=function(e,t){h_(e);var r=v_(t),n=b_(r).concat(cO(r));return H_(n,(function(t){a_&&!aO.call(r,t)||nO(e,t,r[t])})),e},aO=function(e){var t=y_(e),r=q_.call(this,t);return!(this===B_&&c_(W_,t)&&!c_(X_,t))&&(!(r||!c_(this,t)||!c_(W_,t)||c_(this,D_)&&this[D_][t])||r)},iO=function(e,t){var r=v_(e),n=y_(t);if(r!==B_||!c_(W_,n)||c_(X_,n)){var o=J_(r,n);return!o||!c_(W_,n)||c_(r,D_)&&r[D_][n]||(o.enumerable=!0),o}},sO=function(e){var t=K_(v_(e)),r=[];return H_(t,(function(e){c_(W_,e)||c_(x_,e)||r.push(e)})),r},cO=function(e){var t=e===B_,r=K_(t?X_:v_(e)),n=[];return H_(r,(function(e){!c_(W_,e)||t&&!c_(B_,e)||n.push(W_[e])})),n};if(i_||(R_((Y_=function(){if(this instanceof Y_)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?m_(arguments[0]):void 0,t=C_(e),r=function(e){this===B_&&r.call(X_,e),c_(this,D_)&&c_(this[D_],t)&&(this[D_][t]=!1),tO(this,t,g_(1,e))};return a_&&eO&&tO(B_,t,{configurable:!0,set:r}),rO(t,e)}).prototype,"toString",(function(){return U_(this).tag})),R_(Y_,"withoutSetter",(function(e){return rO(C_(e),e)})),O_.f=aO,__.f=nO,E_.f=iO,N_.f=T_.f=sO,w_.f=cO,k_.f=function(e){return rO(A_(e),e)},a_&&(G_(Y_.prototype,"description",{configurable:!0,get:function(){return U_(this).description}}),R_(B_,"propertyIsEnumerable",aO,{unsafe:!0}))),r_({global:!0,wrap:!0,forced:!i_,sham:!i_},{Symbol:Y_}),H_(b_($_),(function(e){L_(e)})),r_({target:"Symbol",stat:!0,forced:!i_},{for:function(e){var t=m_(e);if(c_(Q_,t))return Q_[t];var r=Y_(t);return Q_[t]=r,z_[r]=t,r},keyFor:function(e){if(!f_(e))throw TypeError(e+" is not a symbol");if(c_(z_,e))return z_[e]},useSetter:function(){eO=!0},useSimple:function(){eO=!1}}),r_({target:"Object",stat:!0,forced:!i_,sham:!a_},{create:function(e,t){return void 0===t?S_(e):oO(S_(e),t)},defineProperty:nO,defineProperties:oO,getOwnPropertyDescriptor:iO}),r_({target:"Object",stat:!0,forced:!i_},{getOwnPropertyNames:sO,getOwnPropertySymbols:cO}),r_({target:"Object",stat:!0,forced:s_((function(){w_.f(1)}))},{getOwnPropertySymbols:function(e){return w_.f(p_(e))}}),V_&&r_({target:"JSON",stat:!0,forced:!i_||s_((function(){var e=Y_();return"[null]"!=V_([e])||"{}"!=V_({a:e})||"{}"!=V_(Object(e))}))},{stringify:function(e,t,r){for(var n,o=[e],a=1;arguments.length>a;)o.push(arguments[a++]);if(n=t,(d_(t)||void 0!==e)&&!f_(e))return l_(t)||(t=function(e,t){if(u_(n)&&(t=n.call(this,e,t)),!f_(t))return t}),o[1]=t,V_.apply(null,o)}}),!Y_.prototype[F_]){var lO=Y_.prototype.valueOf;R_(Y_.prototype,F_,(function(){return lO.apply(this,arguments)}))}M_(Y_,"Symbol"),x_[D_]=!0;var uO=CS.filter;sv({target:"Array",proto:!0,forced:!Fb("filter")},{filter:function(e){return uO(this,e,arguments.length>1?arguments[1]:void 0)}});var dO=sv,fO=Sd,hO=Hd,pO=gd.f,vO=bd,yO=fO((function(){pO(1)}));dO({target:"Object",stat:!0,forced:!vO||yO,sham:!vO},{getOwnPropertyDescriptor:function(e,t){return pO(hO(e),t)}});var mO=Sd,gO=function(e,t){var r=[][e];return!!r&&mO((function(){r.call(null,t||function(){throw 1},1)}))},SO=CS.forEach,bO=md,NO=db,TO=pb,wO=gO("forEach")?[].forEach:function(e){return SO(this,e,arguments.length>1?arguments[1]:void 0)},EO=vh,_O=function(e){if(e&&e.forEach!==wO)try{EO(e,"forEach",wO)}catch(t){e.forEach=wO}};for(var OO in NO)NO[OO]&&_O(bO[OO]&&bO[OO].prototype);_O(TO);var RO=jp,IO=Hd,xO=gd,CO=Mb;function AO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function kO(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?AO(Object(r),!0).forEach((function(t){ld(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AO(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}sv({target:"Object",stat:!0,sham:!bd},{getOwnPropertyDescriptors:function(e){for(var t,r,n=IO(e),o=xO.f,a=RO(n),i={},s=0;a.length>s;)void 0!==(r=o(n,t=a[s++]))&&CO(i,t,r);return i}});var LO=new WeakMap,MO=function(){function e(){id(this,e),function(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}(this,LO,{writable:!0,value:[]})}return cd(e,[{key:"bindListener",value:function(e,t,r,n){Ny(this,LO,Ty(this,LO)||[]);var o=function(e,o,a){return r.call(t,e,o,a,n)};return Ty(this,LO)[e]?Ty(this,LO)[e].push(o)-1:(Ty(this,LO)[e]=[o],0)}},{key:"addListener",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Ny(this,LO,Ty(this,LO)||[]);var n=function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t(kO(kO({context:e,eventName:n},o),r))};return Ty(this,LO)[e]?Ty(this,LO)[e].push(n)-1:(Ty(this,LO)[e]=[n],0)}},{key:"removeListener",value:function(e,t){Ty(this,LO)[e]&&Ty(this,LO)[e][t]?delete Ty(this,LO)[e][t]:console.log("trying to remove non-existent event handler, event = "+e+" handle = "+t)}},{key:"destructor",value:function(){Ny(this,LO,null)}},{key:"fireEvent",value:function(t,r){if(Ty(this,LO))for(var n in Ty(this,LO)[t])if(Ty(this,LO)[t].hasOwnProperty(n)&&Ty(this,LO)[t][n](this,t,arguments[1])===e.STOP_PROPAGATION)break}}]),e}();ld(MO,"STOP_PROPAGATION","STOP_PROPAGATION");var PO=function e(t,r,n){function o(i,s){if(!r[i]){if(!t[i]){if(!s&&vd)return vd(i);if(a)return a(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[i]={exports:{}};t[i][0].call(l.exports,(function(e){return o(t[i][1][e]||e)}),l,l.exports,e,t,r,n)}return r[i].exports}for(var a=vd,i=0;i<n.length;i++)o(n[i]);return o}({1:[function(e,t,r){(function(e){var r,n,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var a=0,i=new o(u),s=e.document.createTextNode("");i.observe(s,{characterData:!0}),r=function(){s.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var c=new e.MessageChannel;c.port1.onmessage=u,r=function(){c.port2.postMessage(0)}}var l=[];function u(){var e,t;n=!0;for(var r=l.length;r;){for(t=l,l=[],e=-1;++e<r;)t[e]();r=l.length}n=!1}t.exports=function(e){1!==l.push(e)||n||r()}}).call(this,void 0!==pd?pd:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,r){var n=e(1);function o(){}var a={},i=["REJECTED"],s=["FULFILLED"],c=["PENDING"];function l(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==o&&h(this,e)}function u(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function d(e,t,r){n((function(){var n;try{n=t(r)}catch(t){return a.reject(e,t)}n===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,n)}))}function f(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var r=!1;function n(t){r||(r=!0,a.reject(e,t))}function o(t){r||(r=!0,a.resolve(e,t))}var i=p((function(){t(o,n)}));"error"===i.status&&n(i.value)}function p(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}t.exports=l,l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===i)return this;var r=new this.constructor(o);return this.state!==c?d(r,this.state===s?e:t,this.outcome):this.queue.push(new u(r,e,t)),r},u.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){a.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},a.resolve=function(e,t){var r=p(f,t);if("error"===r.status)return a.reject(e,r.value);var n=r.value;if(n)h(e,n);else{e.state=s,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},a.reject=function(e,t){e.state=i,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},l.resolve=function(e){return e instanceof this?e:a.resolve(new this(o),e)},l.reject=function(e){var t=new this(o);return a.reject(t,e)},l.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var i=new Array(r),s=0,c=-1,l=new this(o);++c<r;)u(e[c],c);return l;function u(e,o){t.resolve(e).then((function(e){i[o]=e,++s!==r||n||(n=!0,a.resolve(l,i))}),(function(e){n||(n=!0,a.reject(l,e))}))}},l.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,r=!1;if(!t)return this.resolve([]);for(var n,i=-1,s=new this(o);++i<t;)n=e[i],this.resolve(n).then((function(e){r||(r=!0,a.resolve(s,e))}),(function(e){r||(r=!0,a.reject(s,e))}));return s}},{1:1}],3:[function(e,t,r){(function(t){"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==pd?pd:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function a(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)r.append(e[n]);return r.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var i=Promise;function s(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function c(e,t,r){"function"==typeof t&&e.then(t),"function"==typeof r&&e.catch(r)}function l(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function u(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var d=void 0,f={},h=Object.prototype.toString;function p(e){return"boolean"==typeof d?i.resolve(d):function(e){return new i((function(t){var r=e.transaction("local-forage-detect-blob-support","readwrite"),n=a([""]);r.objectStore("local-forage-detect-blob-support").put(n,"key"),r.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},r.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),r=navigator.userAgent.match(/Edge\//);t(r||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}(e).then((function(e){return d=e}))}function v(e){var t=f[e.name],r={};r.promise=new i((function(e,t){r.resolve=e,r.reject=t})),t.deferredOperations.push(r),t.dbReady?t.dbReady=t.dbReady.then((function(){return r.promise})):t.dbReady=r.promise}function y(e){var t=f[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function m(e,t){var r=f[e.name].deferredOperations.pop();if(r)return r.reject(t),r.promise}function g(e,t){return new i((function(r,n){if(f[e.name]=f[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return r(e.db);v(e),e.db.close()}var a=[e.name];t&&a.push(e.version);var i=o.open.apply(o,a);t&&(i.onupgradeneeded=function(t){var r=i.result;try{r.createObjectStore(e.storeName),t.oldVersion<=1&&r.createObjectStore("local-forage-detect-blob-support")}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),i.onerror=function(e){e.preventDefault(),n(i.error)},i.onsuccess=function(){var t=i.result;t.onversionchange=function(e){e.target.close()},r(t),y(e)}}))}function S(e){return g(e,!1)}function b(e){return g(e,!0)}function N(e,t){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,o=e.version>e.db.version;if(n&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||r){if(r){var a=e.db.version+1;a>e.version&&(e.version=a)}return!0}return!1}function T(e){return a([function(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),o=0;o<t;o++)n[o]=e.charCodeAt(o);return r}(atob(e.data))],{type:e.type})}function w(e){return e&&e.__local_forage_encoded_blob}function E(e){var t=this,r=t._initReady().then((function(){var e=f[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return c(r,e,e),r}function _(e,t,r,n){void 0===n&&(n=1);try{var o=e.db.transaction(e.storeName,t);r(null,o)}catch(o){if(n>0&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return i.resolve().then((function(){if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),b(e)})).then((function(){return function(e){v(e);for(var t=f[e.name],r=t.forages,n=0;n<r.length;n++){var o=r[n];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return e.db=null,S(e).then((function(t){return e.db=t,N(e)?b(e):t})).then((function(n){e.db=t.db=n;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=n})).catch((function(t){throw m(e,t),t}))}(e).then((function(){_(e,t,r,n-1)}))})).catch(r);r(o)}}var O={_driver:"asyncStorage",_initStorage:function(e){var t=this,r={db:null};if(e)for(var n in e)r[n]=e[n];var o=f[r.name];o||(o={forages:[],db:null,dbReady:null,deferredOperations:[]},f[r.name]=o),o.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=E);var a=[];function s(){return i.resolve()}for(var c=0;c<o.forages.length;c++){var l=o.forages[c];l!==t&&a.push(l._initReady().catch(s))}var u=o.forages.slice(0);return i.all(a).then((function(){return r.db=o.db,S(r)})).then((function(e){return r.db=e,N(r,t._defaultConfig.version)?b(r):e})).then((function(e){r.db=o.db=e,t._dbInfo=r;for(var n=0;n<u.length;n++){var a=u[n];a!==t&&(a._dbInfo.db=r.db,a._dbInfo.version=r.version)}}))},_support:function(){try{if(!o||!o.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var r=this,n=new i((function(t,n){r.ready().then((function(){_(r._dbInfo,"readonly",(function(o,a){if(o)return n(o);try{var i=a.objectStore(r._dbInfo.storeName).openCursor(),s=1;i.onsuccess=function(){var r=i.result;if(r){var n=r.value;w(n)&&(n=T(n));var o=e(n,r.key,s++);void 0!==o?t(o):r.continue()}else t()},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return s(n,t),n},getItem:function(e,t){var r=this;e=l(e);var n=new i((function(t,n){r.ready().then((function(){_(r._dbInfo,"readonly",(function(o,a){if(o)return n(o);try{var i=a.objectStore(r._dbInfo.storeName).get(e);i.onsuccess=function(){var e=i.result;void 0===e&&(e=null),w(e)&&(e=T(e)),t(e)},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return s(n,t),n},setItem:function(e,t,r){var n=this;e=l(e);var o=new i((function(r,o){var a;n.ready().then((function(){return a=n._dbInfo,"[object Blob]"===h.call(t)?p(a.db).then((function(e){return e?t:(r=t,new i((function(e,t){var n=new FileReader;n.onerror=t,n.onloadend=function(t){var n=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:n,type:r.type})},n.readAsBinaryString(r)})));var r})):t})).then((function(t){_(n._dbInfo,"readwrite",(function(a,i){if(a)return o(a);try{var s=i.objectStore(n._dbInfo.storeName);null===t&&(t=void 0);var c=s.put(t,e);i.oncomplete=function(){void 0===t&&(t=null),r(t)},i.onabort=i.onerror=function(){var e=c.error?c.error:c.transaction.error;o(e)}}catch(e){o(e)}}))})).catch(o)}));return s(o,r),o},removeItem:function(e,t){var r=this;e=l(e);var n=new i((function(t,n){r.ready().then((function(){_(r._dbInfo,"readwrite",(function(o,a){if(o)return n(o);try{var i=a.objectStore(r._dbInfo.storeName).delete(e);a.oncomplete=function(){t()},a.onerror=function(){n(i.error)},a.onabort=function(){var e=i.error?i.error:i.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return s(n,t),n},clear:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){_(t._dbInfo,"readwrite",(function(n,o){if(n)return r(n);try{var a=o.objectStore(t._dbInfo.storeName).clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=a.error?a.error:a.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return s(r,e),r},length:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){_(t._dbInfo,"readonly",(function(n,o){if(n)return r(n);try{var a=o.objectStore(t._dbInfo.storeName).count();a.onsuccess=function(){e(a.result)},a.onerror=function(){r(a.error)}}catch(e){r(e)}}))})).catch(r)}));return s(r,e),r},key:function(e,t){var r=this,n=new i((function(t,n){e<0?t(null):r.ready().then((function(){_(r._dbInfo,"readonly",(function(o,a){if(o)return n(o);try{var i=a.objectStore(r._dbInfo.storeName),s=!1,c=i.openKeyCursor();c.onsuccess=function(){var r=c.result;r?0===e||s?t(r.key):(s=!0,r.advance(e)):t(null)},c.onerror=function(){n(c.error)}}catch(e){n(e)}}))})).catch(n)}));return s(n,t),n},keys:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){_(t._dbInfo,"readonly",(function(n,o){if(n)return r(n);try{var a=o.objectStore(t._dbInfo.storeName).openKeyCursor(),i=[];a.onsuccess=function(){var t=a.result;t?(i.push(t.key),t.continue()):e(i)},a.onerror=function(){r(a.error)}}catch(e){r(e)}}))})).catch(r)}));return s(r,e),r},dropInstance:function(e,t){t=u.apply(this,arguments);var r=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n,a=this;if(e.name){var c=e.name===r.name&&a._dbInfo.db,l=c?i.resolve(a._dbInfo.db):S(e).then((function(t){var r=f[e.name],n=r.forages;r.db=t;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=t;return t}));n=e.storeName?l.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var r=t.version+1;v(e);var n=f[e.name],a=n.forages;t.close();for(var s=0;s<a.length;s++){var c=a[s];c._dbInfo.db=null,c._dbInfo.version=r}return new i((function(t,n){var a=o.open(e.name,r);a.onerror=function(e){a.result.close(),n(e)},a.onupgradeneeded=function(){a.result.deleteObjectStore(e.storeName)},a.onsuccess=function(){var e=a.result;e.close(),t(e)}})).then((function(e){n.db=e;for(var t=0;t<a.length;t++){var r=a[t];r._dbInfo.db=e,y(r._dbInfo)}})).catch((function(t){throw(m(e,t)||i.resolve()).catch((function(){})),t}))}})):l.then((function(t){v(e);var r=f[e.name],n=r.forages;t.close();for(var a=0;a<n.length;a++)n[a]._dbInfo.db=null;return new i((function(t,r){var n=o.deleteDatabase(e.name);n.onerror=function(){var e=n.result;e&&e.close(),r(n.error)},n.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},n.onsuccess=function(){var e=n.result;e&&e.close(),t(e)}})).then((function(e){r.db=e;for(var t=0;t<n.length;t++)y(n[t]._dbInfo)})).catch((function(t){throw(m(e,t)||i.resolve()).catch((function(){})),t}))}))}else n=i.reject("Invalid arguments");return s(n,t),n}},R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",I=/^~~local_forage_type~([^~]+)~/,x="__lfsc__:".length,C=x+"arbf".length,A=Object.prototype.toString;function k(e){var t,r,n,o,a,i=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);var l=new ArrayBuffer(i),u=new Uint8Array(l);for(t=0;t<s;t+=4)r=R.indexOf(e[t]),n=R.indexOf(e[t+1]),o=R.indexOf(e[t+2]),a=R.indexOf(e[t+3]),u[c++]=r<<2|n>>4,u[c++]=(15&n)<<4|o>>2,u[c++]=(3&o)<<6|63&a;return l}function L(e){var t,r=new Uint8Array(e),n="";for(t=0;t<r.length;t+=3)n+=R[r[t]>>2],n+=R[(3&r[t])<<4|r[t+1]>>4],n+=R[(15&r[t+1])<<2|r[t+2]>>6],n+=R[63&r[t+2]];return r.length%3==2?n=n.substring(0,n.length-1)+"=":r.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}var M={serialize:function(e,t){var r="";if(e&&(r=A.call(e)),e&&("[object ArrayBuffer]"===r||e.buffer&&"[object ArrayBuffer]"===A.call(e.buffer))){var n,o="__lfsc__:";e instanceof ArrayBuffer?(n=e,o+="arbf"):(n=e.buffer,"[object Int8Array]"===r?o+="si08":"[object Uint8Array]"===r?o+="ui08":"[object Uint8ClampedArray]"===r?o+="uic8":"[object Int16Array]"===r?o+="si16":"[object Uint16Array]"===r?o+="ur16":"[object Int32Array]"===r?o+="si32":"[object Uint32Array]"===r?o+="ui32":"[object Float32Array]"===r?o+="fl32":"[object Float64Array]"===r?o+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(o+L(n))}else if("[object Blob]"===r){var a=new FileReader;a.onload=function(){var r="~~local_forage_type~"+e.type+"~"+L(this.result);t("__lfsc__:blob"+r)},a.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(r){console.error("Couldn't convert value into a JSON string: ",e),t(null,r)}},deserialize:function(e){if("__lfsc__:"!==e.substring(0,x))return JSON.parse(e);var t,r=e.substring(C),n=e.substring(x,C);if("blob"===n&&I.test(r)){var o=r.match(I);t=o[1],r=r.substring(o[0].length)}var i=k(r);switch(n){case"arbf":return i;case"blob":return a([i],{type:t});case"si08":return new Int8Array(i);case"ui08":return new Uint8Array(i);case"uic8":return new Uint8ClampedArray(i);case"si16":return new Int16Array(i);case"ur16":return new Uint16Array(i);case"si32":return new Int32Array(i);case"ui32":return new Uint32Array(i);case"fl32":return new Float32Array(i);case"fl64":return new Float64Array(i);default:throw new Error("Unkown type: "+n)}},stringToBuffer:k,bufferToString:L};function P(e,t,r,n){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,n)}function H(e,t,r,n,o,a){e.executeSql(r,n,o,(function(e,i){i.code===i.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,s){s.rows.length?a(e,i):P(e,t,(function(){e.executeSql(r,n,o,a)}),a)}),a):a(e,i)}),a)}function D(e,t,r,n){var o=this;e=l(e);var a=new i((function(a,i){o.ready().then((function(){void 0===t&&(t=null);var s=t,c=o._dbInfo;c.serializer.serialize(t,(function(t,l){l?i(l):c.db.transaction((function(r){H(r,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){a(s)}),(function(e,t){i(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(n>0)return void a(D.apply(o,[e,s,r,n-1]));i(t)}}))}))})).catch(i)}));return s(a,r),a}function F(e){return new i((function(t,r){e.transaction((function(n){n.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(r,n){for(var o=[],a=0;a<n.rows.length;a++)o.push(n.rows.item(a).name);t({db:e,storeNames:o})}),(function(e,t){r(t)}))}),(function(e){r(e)}))}))}var j={_driver:"webSQLStorage",_initStorage:function(e){var t=this,r={db:null};if(e)for(var n in e)r[n]="string"!=typeof e[n]?e[n].toString():e[n];var o=new i((function(e,n){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(e){return n(e)}r.db.transaction((function(o){P(o,r,(function(){t._dbInfo=r,e()}),(function(e,t){n(t)}))}),n)}));return r.serializer=M,o},_support:"function"==typeof openDatabase,iterate:function(e,t){var r=this,n=new i((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){H(r,o,"SELECT * FROM "+o.storeName,[],(function(r,n){for(var a=n.rows,i=a.length,s=0;s<i;s++){var c=a.item(s),l=c.value;if(l&&(l=o.serializer.deserialize(l)),void 0!==(l=e(l,c.key,s+1)))return void t(l)}t()}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,t),n},getItem:function(e,t){var r=this;e=l(e);var n=new i((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){H(r,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,r){var n=r.rows.length?r.rows.item(0).value:null;n&&(n=o.serializer.deserialize(n)),t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,t),n},setItem:function(e,t,r){return D.apply(this,[e,t,r,1])},removeItem:function(e,t){var r=this;e=l(e);var n=new i((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){H(r,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,t),n},clear:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){H(t,n,"DELETE FROM "+n.storeName,[],(function(){e()}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,e),r},length:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){H(t,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],(function(t,r){var n=r.rows.item(0).c;e(n)}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,e),r},key:function(e,t){var r=this,n=new i((function(t,n){r.ready().then((function(){var o=r._dbInfo;o.db.transaction((function(r){H(r,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,r){var n=r.rows.length?r.rows.item(0).key:null;t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,t),n},keys:function(e){var t=this,r=new i((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){H(t,n,"SELECT key FROM "+n.storeName,[],(function(t,r){for(var n=[],o=0;o<r.rows.length;o++)n.push(r.rows.item(o).key);e(n)}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,e),r},dropInstance:function(e,t){t=u.apply(this,arguments);var r=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n,o=this;return s(n=e.name?new i((function(t){var n;n=e.name===r.name?o._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:n,storeNames:[e.storeName]}):t(F(n))})).then((function(e){return new i((function(t,r){e.db.transaction((function(n){function o(e){return new i((function(t,r){n.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){r(t)}))}))}for(var a=[],s=0,c=e.storeNames.length;s<c;s++)a.push(o(e.storeNames[s]));i.all(a).then((function(){t()})).catch((function(e){r(e)}))}),(function(e){r(e)}))}))})):i.reject("Invalid arguments"),t),n}};function U(e,t){var r=e.name+"/";return e.storeName!==t.storeName&&(r+=e.storeName+"/"),r}var B={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var r in e)t[r]=e[r];return t.keyPrefix=U(e,this._defaultConfig),!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(e){return!0}}()||localStorage.length>0?(this._dbInfo=t,t.serializer=M,i.resolve()):i.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var r=this,n=r.ready().then((function(){for(var t=r._dbInfo,n=t.keyPrefix,o=n.length,a=localStorage.length,i=1,s=0;s<a;s++){var c=localStorage.key(s);if(0===c.indexOf(n)){var l=localStorage.getItem(c);if(l&&(l=t.serializer.deserialize(l)),void 0!==(l=e(l,c.substring(o),i++)))return l}}}));return s(n,t),n},getItem:function(e,t){var r=this;e=l(e);var n=r.ready().then((function(){var t=r._dbInfo,n=localStorage.getItem(t.keyPrefix+e);return n&&(n=t.serializer.deserialize(n)),n}));return s(n,t),n},setItem:function(e,t,r){var n=this;e=l(e);var o=n.ready().then((function(){void 0===t&&(t=null);var r=t;return new i((function(o,a){var i=n._dbInfo;i.serializer.serialize(t,(function(t,n){if(n)a(n);else try{localStorage.setItem(i.keyPrefix+e,t),o(r)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||a(e),a(e)}}))}))}));return s(o,r),o},removeItem:function(e,t){var r=this;e=l(e);var n=r.ready().then((function(){var t=r._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return s(n,t),n},clear:function(e){var t=this,r=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,r=localStorage.length-1;r>=0;r--){var n=localStorage.key(r);0===n.indexOf(e)&&localStorage.removeItem(n)}}));return s(r,e),r},length:function(e){var t=this.keys().then((function(e){return e.length}));return s(t,e),t},key:function(e,t){var r=this,n=r.ready().then((function(){var t,n=r._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(n.keyPrefix.length)),t}));return s(n,t),n},keys:function(e){var t=this,r=t.ready().then((function(){for(var e=t._dbInfo,r=localStorage.length,n=[],o=0;o<r;o++){var a=localStorage.key(o);0===a.indexOf(e.keyPrefix)&&n.push(a.substring(e.keyPrefix.length))}return n}));return s(r,e),r},dropInstance:function(e,t){if(t=u.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var n,o=this;return s(n=e.name?new i((function(t){e.storeName?t(U(e,o._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var r=localStorage.key(t);0===r.indexOf(e)&&localStorage.removeItem(r)}})):i.reject("Invalid arguments"),t),n}},Y=function(e,t){for(var r,n,o=e.length,a=0;a<o;){if((r=e[a])===(n=t)||"number"==typeof r&&"number"==typeof n&&isNaN(r)&&isNaN(n))return!0;a++}return!1},V=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},J={},G={},K={INDEXEDDB:O,WEBSQL:j,LOCALSTORAGE:B},q=[K.INDEXEDDB._driver,K.WEBSQL._driver,K.LOCALSTORAGE._driver],W=["dropInstance"],X=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(W),Q={description:"",driver:q.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function z(e,t){e[t]=function(){var r=arguments;return e.ready().then((function(){return e[t].apply(e,r)}))}}function $(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var r in t)t.hasOwnProperty(r)&&(V(t[r])?arguments[0][r]=t[r].slice():arguments[0][r]=t[r])}return arguments[0]}var Z=new(function(){function e(t){for(var r in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),K)if(K.hasOwnProperty(r)){var n=K[r],o=n._driver;this[r]=o,J[o]||this.defineDriver(n)}this._defaultConfig=$({},Q),this._config=$({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":n(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,r){var n=new i((function(t,r){try{var n=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void r(o);for(var a=X.concat("_initStorage"),c=0,l=a.length;c<l;c++){var u=a[c];if((!Y(W,u)||e[u])&&"function"!=typeof e[u])return void r(o)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),r=i.reject(t);return s(r,arguments[arguments.length-1]),r}},r=0,n=W.length;r<n;r++){var o=W[r];e[o]||(e[o]=t(o))}}();var d=function(r){J[n]&&console.info("Redefining LocalForage driver: "+n),J[n]=e,G[n]=r,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(d,r):d(!!e._support):d(!0)}catch(e){r(e)}}));return c(n,t,r),n},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,r){var n=J[e]?i.resolve(J[e]):i.reject(new Error("Driver not found."));return c(n,t,r),n},e.prototype.getSerializer=function(e){var t=i.resolve(M);return c(t,e),t},e.prototype.ready=function(e){var t=this,r=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return c(r,e,e),r},e.prototype.setDriver=function(e,t,r){var n=this;V(e)||(e=[e]);var o=this._getSupportedDrivers(e);function a(){n._config.driver=n.driver()}function s(e){return n._extend(e),a(),n._ready=n._initStorage(n._config),n._ready}var l=null!==this._driverSet?this._driverSet.catch((function(){return i.resolve()})):i.resolve();return this._driverSet=l.then((function(){var e=o[0];return n._dbInfo=null,n._ready=null,n.getDriver(e).then((function(e){n._driver=e._driver,a(),n._wrapLibraryMethodsWithReady(),n._initDriver=function(e){return function(){var t=0;return function r(){for(;t<e.length;){var o=e[t];return t++,n._dbInfo=null,n._ready=null,n.getDriver(o).then(s).catch(r)}a();var c=new Error("No available storage method found.");return n._driverSet=i.reject(c),n._driverSet}()}}(o)}))})).catch((function(){a();var e=new Error("No available storage method found.");return n._driverSet=i.reject(e),n._driverSet})),c(this._driverSet,t,r),this._driverSet},e.prototype.supports=function(e){return!!G[e]},e.prototype._extend=function(e){$(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],r=0,n=e.length;r<n;r++){var o=e[r];this.supports(o)&&t.push(o)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=X.length;e<t;e++)z(this,X[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=Z},{3:3}]},{},[4])(4);
/*!
	    localForage -- Offline Storage, Improved
	    Version 1.10.0
	    https://localforage.github.io/localForage
	    (c) 2013-2017 Mozilla, Apache License 2.0
	*/function HO(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,HO)}var DO=/^[a-fA-F0-9]{8}-(?:[a-fA-F0-9]{4}-){3}[a-fA-F0-9]{12}$/,FO=function(e){yy(r,MO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(){var e;return id(this,r),ld(py(e=t.call(this)),"_id",void 0),ld(py(e),"_savedRemotely",!1),ld(py(e),"_savedLocally",!1),ld(py(e),"deleted",!1),ld(py(e),"createdStamp",void 0),ld(py(e),"modifiedStamp",void 0),ld(py(e),"projectId",void 0),ld(py(e),"isPristine",!1),e.createdStamp=Math.floor(Date.now()/1e3),e}return cd(r,[{key:"unsaved",value:function(){return!(this._savedLocally&&this._savedRemotely)}},{key:"id",get:function(){return this._id||(this._id=HO()),this._id},set:function(e){if(this._id&&e!==this._id)throw new Error("Occurrence id has already been set, when trying to set new id '".concat(e,"'."));this._id=e}},{key:"queuePost",value:function(e){var t=this;return new Promise((function(n,o){var a=function(){return console.log({"posting form data":e}),t.post(e).then(n,o)};r._tasks.push(a),r._tasks.length>1?console.log("Added post request to the queue."):(console.log("No pending tasks, starting post request immediately."),a().finally(r._next))}))}},{key:"post",value:function(e){var t=this;return fetch(this.SAVE_ENDPOINT,{method:"POST",body:e}).then((function(e){return e.ok?e.clone().json().then((function(r){switch(console.log({"returned to client after save":r}),r.saveState){case"SAVED_TO_SERVER":t._savedLocally=!0,t._savedRemotely=!0;break;case"SAVED_LOCALLY":t._savedLocally=!0,t._savedRemotely=!1;break;default:console.log("Unrecognised save state '".concat(r.saveState,"'"))}return t.createdStamp=parseInt(r.created,10),t.modifiedStamp=parseInt(r.modified,10),e.json()})):(console.log("Save failed, presumably service worker is missing and there is no network connection. Should write to IndexedDb here."),Promise.reject("IndexedDb storage not yet implemented"))}))}},{key:"_parseDescriptor",value:function(e){this._parseAttributes(e.attributes),this._parseSavedState(e.saveState),this.deleted=!0===e.deleted||"true"===e.deleted,this.createdStamp=parseInt(e.created,10),this.modifiedStamp=e.modified?parseInt(e.modified,10):0,this.projectId=parseInt(e.projectId,10)}},{key:"_parseAttributes",value:function(e){"string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)?(console.log("Attributes were spuriously represented as an array rather than as an empty object"),this.attributes={}):this.attributes=e}},{key:"_parseSavedState",value:function(e){switch(e){case"SAVED_LOCALLY":this._savedRemotely=!1,this._savedLocally=!0;break;case"SAVED_TO_SERVER":this._savedRemotely=!0,this._savedLocally=!0;break;default:throw new Error("Unrecognised saved state '".concat(e))}}},{key:"touch",value:function(){this.modifiedStamp=Math.floor(Date.now()/1e3),this.isPristine&&(this.isPristine=!1,this.createdStamp=this.modifiedStamp),this._savedLocally=!1,this._savedRemotely=!1}},{key:"evaluateCompletionStatus",value:function(e){var t={},r=!0;for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];t[n]=o.validator?o.validator(n,o,this.attributes):o.field.isValid(n,o,this.attributes),null!==t[n]&&(r=r&&t[n])}return{requiredFieldsPresent:r,validity:t}}}],[{key:"_next",value:function(){if(r._tasks.shift(),r._tasks.length)return console.log("Running the next task."),r._tasks[0]().finally(r._next)}},{key:"retrieveFromLocal",value:function(e,t){return PO.getItem("".concat(t.TYPE,".").concat(e)).then((function(r){return r?(t.id=e,t._parseDescriptor(r),t):Promise.reject("Failed to retrieve ".concat(t.TYPE,".").concat(e," locally"))}))}}]),r}();ld(FO,"_tasks",[]);var jO=function(e){yy(r,Ib(Error));var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(){return id(this,r),t.apply(this,arguments)}return r}();function UO(e){try{var t=document.createElement("textarea");return t.innerHTML=e,t.innerHTML.replace(/"/g,"&quot;")}catch(t){var r=document.createElement("pre");return r.appendChild(document.createTextNode(e)),r.innerHTML.replace(/"/g,"&quot;")}}var BO=function(){function e(){id(this,e),ld(this,"id",void 0),ld(this,"nameString",""),ld(this,"canonical",""),ld(this,"hybridCanonical",""),ld(this,"acceptedEntityId",""),ld(this,"qualifier",""),ld(this,"authority",""),ld(this,"vernacular",""),ld(this,"vernacularRoot",""),ld(this,"used",void 0),ld(this,"sortOrder",void 0),ld(this,"parentIds",[])}return cd(e,[{key:"formattedHTML",value:function(t){var r;return this.id!==this.acceptedEntityId&&(r=e.fromId(this.acceptedEntityId)),e.showVernacular?t?r?"<q><b>".concat(UO(this.vernacular),'</b></q> <span class="italictaxon">').concat(this.nameString).concat(this.qualifier?" <b>".concat(this.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(UO(this.authority),"</span>")+' = <span class="italictaxon">'.concat(r.nameString).concat(r.qualifier?" <b>".concat(r.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(UO(r.authority),"</span>"):"<q><b>".concat(UO(this.vernacular),'</b></q> <span class="italictaxon">').concat(this.nameString).concat(this.qualifier?" <b>".concat(this.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(UO(this.authority),"</span>"):r?'<span class="italictaxon">'.concat(this.nameString).concat(this.qualifier?" <b>".concat(this.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(this.authority,"</span>").concat(this.vernacular?" <q><b>".concat(UO(this.vernacular),"</b></q>"):"",' = <span class="italictaxon">').concat(r.nameString).concat(r.qualifier?" <b>".concat(r.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(UO(r.authority),"</span>"):'<span class="italictaxon">'.concat(this.nameString).concat(this.qualifier?" <b>".concat(this.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(UO(this.authority),"</span>").concat(this.vernacular?" <q><b>".concat(UO(this.vernacular),"</b></q>"):""):r?'<span class="italictaxon">'.concat(this.nameString).concat(this.qualifier?" <b>".concat(this.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(this.authority,"</span>")+' = <span class="italictaxon">'.concat(r.nameString).concat(r.qualifier?" <b>".concat(r.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(UO(r.authority),"</span>"):'<span class="italictaxon">'.concat(this.nameString).concat(this.qualifier?" <b>".concat(this.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(UO(this.authority),"</span>")}}],[{key:"fromId",value:function(t){if(!e.rawTaxa){if(!BsbiDb.TaxonNames)throw new jO("Taxon.fromId() called before taxon list has loaded.");e.rawTaxa=BsbiDb.TaxonNames}if(!e.rawTaxa.hasOwnProperty(t))throw new jO("Taxon id '".concat(t,"' not found."));var r=e.rawTaxa[t],n=new e;return n.id=t,n.nameString=r[0],n.canonical=r[1]||r[0],n.hybridCanonical=r[2]||n.canonical,n.acceptedEntityId=r[3]||t,n.qualifier=r[4],n.authority=r[5],n.vernacular=r[6],n.vernacularRoot=r[7],n.used=r[8],n.sortOrder=r[9],n.parentIds=r[10],n}}]),e}();ld(BO,"rawTaxa",void 0),ld(BO,"showVernacular",!0);var YO=Ld,VO=Fm,JO="[\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff]",GO=RegExp("^"+JO+JO+"*"),KO=RegExp(JO+JO+"*$"),qO=function(e){return function(t){var r=VO(YO(t));return 1&e&&(r=r.replace(GO,"")),2&e&&(r=r.replace(KO,"")),r}},WO={start:qO(1),end:qO(2),trim:qO(3)},XO=$h.PROPER,QO=Sd,zO="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff",$O=function(e){return QO((function(){return!!zO[e]()||"âÂá "!=="âÂá "[e]()||XO&&zO[e].name!==e}))},ZO=WO.trim;function eR(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}function tR(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}sv({target:"String",proto:!0,forced:$O("trim")},{trim:function(){return ZO(this)}});var rR=function(e){yy(r,MO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(e){var n;return id(this,r),ld(py(n=t.call(this)),"_value",void 0),ld(py(n),"_fieldEl",void 0),ld(py(n),"label","field label"),ld(py(n),"helpText",""),ld(py(n),"validationMessage",""),ld(py(n),"completion",r.COMPLETION_OPTIONAL),ld(py(n),"parentForm",void 0),ld(py(n),"attributeName",void 0),e&&(e.label&&(n.label=e.label),e.helpText&&(n.helpText=e.helpText),e.validationMessage&&(n.validationMessage=e.validationMessage),e.completion&&(n.completion=e.completion)),n}return cd(r,[{key:"value",get:function(){return this._value},set:function(e){}},{key:"fieldElement",get:function(){return this._fieldEl||this.buildField(),this._fieldEl}},{key:"addField",value:function(){this.parentForm.formElement.appendChild(this.fieldElement)}},{key:"markValidity",value:function(e){}}],[{key:"nextId",get:function(){var e,t,n;return"field".concat((function(e,t,r,n){tR(e,t),eR(r,"set"),function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,r,n)}(r,r,nR,(n=nR,tR(t=r,r),eR(n,"get"),1+(e=+function(e,t){return t.get?t.get.call(e):t.value}(t,n)))),e))}},{key:"cleanRawInput",value:function(e){return e.value.trim().replace(/\s\s+/g," ")}},{key:"cleanRawString",value:function(e){return e.trim().replace(/\s\s+/g," ")}},{key:"isEmpty",value:function(e){return""===e}},{key:"isValid",value:function(e,t,n){return!t.attributes.completion||t.attributes.completion!==r.COMPLETION_COMPULSORY&&t.attributes.completion!==r.COMPLETION_DESIRED?null:!(!n.hasOwnProperty(e)||t.field.isEmpty(n[e]))}},{key:"summarise",value:function(e,t,r){return!t.summary||t.summary.hasOwnProperty("summarise")&&!0!==t.summary.summarise?"":t.field.summariseImpl(e,t,r)}},{key:"summariseImpl",value:function(e,t,r){return""}}]),r}();ld(rR,"COMPLETION_COMPULSORY","compulsory"),ld(rR,"COMPLETION_DESIRED","desired"),ld(rR,"COMPLETION_OPTIONAL","optional");var nR={writable:!0,value:1};function oR(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}function aR(e,t,r,n){return cR(e,t),sR(r,"set"),function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,r,n),n}function iR(e,t,r){return cR(e,t),sR(r,"get"),function(e,t){return t.get?t.get.call(e):t.value}(e,r)}function sR(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}function cR(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}ld(rR,"EVENT_CHANGE","fieldChange");var lR=new WeakMap,uR=function(e){yy(r,MO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(){var e;id(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return oR(py(e=t.call.apply(t,[this].concat(o))),lR,{writable:!0,value:void 0}),ld(py(e),"_formId",void 0),ld(py(e),"_formContentContainer",void 0),ld(py(e),"fields",void 0),ld(py(e),"liveValidation",!1),ld(py(e),"isValid",null),ld(py(e),"_formFieldsBuilt",!1),e}return cd(r,[{key:"formElement",get:function(){var e,t=this;return Ty(this,lR)||(Ny(this,lR,document.createElement("form")),Ty(this,lR).id=this._formId="form".concat((aR(r,r,dR,1+(e=+iR(r,r,dR))),e)),Ty(this,lR).noValidate=!0,this.liveValidation&&(Ty(this,lR).className="needs-validation"),this.buildContentContainer(Ty(this,lR)),Ty(this,lR).addEventListener("change",(function(e){t.changeHandler(e)}),{capture:!1})),Ty(this,lR)}},{key:"buildContentContainer",value:function(e){return this._formContentContainer=e,this._formContentContainer}},{key:"changeHandler",value:function(e){console.log({"form change event":e})}},{key:"destructor",value:function(){Cb(Sy(r.prototype),"destructor",this).call(this),Ny(this,lR,null)}},{key:"buildFormFields",value:function(){for(var e in this.initialiseFormFields(),this.fields)if(this.fields.hasOwnProperty(e)){var t=this.fields[e];t.parentForm=this,t.attributeName=e,this._formContentContainer.appendChild(t.fieldElement),t.addListener(rR.EVENT_CHANGE,this.changeHandler.bind(this))}this._formFieldsBuilt=!0}},{key:"conditionallyValidateForm",value:function(){this.liveValidation&&this.validateForm()}},{key:"validateForm",value:function(){this.liveValidation=!0,this.formElement.classList.add("needs-validation");var e=this.model.evaluateCompletionStatus(this.getFormSectionProperties());for(var t in this.fields)this.fields.hasOwnProperty(t)&&this.fields[t].markValidity(e.validity[t]);return this.isValid!==e.requiredFieldsPresent&&(this.isValid=e.requiredFieldsPresent,this.fireEvent(r.EVENT_VALIDATION_STATE_CHANGE,{isValid:this.isValid})),e.requiredFieldsPresent}},{key:"populateFormContent",value:function(){if(this._formFieldsBuilt){var e=this.model;for(var t in this.fields)this.fields.hasOwnProperty(t)&&(this.fields[t].value=e.attributes[t]);this.conditionallyValidateForm()}}}],[{key:"nextId",get:function(){var e;return"id".concat((aR(r,r,fR,1+(e=+iR(r,r,fR))),e))}}]),r}();ld(uR,"CHANGE_EVENT","change");var dR={writable:!0,value:0};ld(uR,"EVENT_VALIDATION_STATE_CHANGE","validationstatechange");var fR={writable:!0,value:0};ld(uR,"COMPLETION_STATUS_UNSTARTED","unstarted"),ld(uR,"COMPLETION_STATUS_COMPLETE","complete"),ld(uR,"COMPLETION_STATUS_IN_PROGRESS","inProgress");var hR=function(e){yy(r,FO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(){var e;id(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return ld(py(e=t.call.apply(t,[this].concat(o))),"attributes",{}),ld(py(e),"_savedRemotely",!1),ld(py(e),"_savedLocally",!1),ld(py(e),"SAVE_ENDPOINT","/saveoccurrence.php"),ld(py(e),"TYPE","occurrence"),ld(py(e),"isNew",!1),e}return cd(r,[{key:"taxon",get:function(){return this.attributes.taxon&&this.attributes.taxon.taxonId?BO.fromId(this.attributes.taxon.taxonId):null}},{key:"setForm",value:function(e){return this.isNew||(e.liveValidation=!0),e.addListener(uR.CHANGE_EVENT,this.formChangedHandler.bind(this)),e}},{key:"formChangedHandler",value:function(e){console.log("Occurrence change handler invoked."),e.form.updateModelFromContent(),e.form.conditionallyValidateForm(),this.touch(),this.fireEvent(r.EVENT_MODIFIED,{occurrenceId:this.id})}},{key:"delete",value:function(){this.deleted||(this.touch(),this.deleted=!0,this.fireEvent(r.EVENT_MODIFIED,{occurrenceId:this.id}))}},{key:"save",value:function(e){if(this._savedRemotely)return Promise.reject("".concat(this.id," has already been saved."));var t=new FormData;return!e&&this.surveyId&&(e=this.surveyId),t.append("type",this.TYPE),t.append("surveyId",e),t.append("occurrenceId",this.id),t.append("id",this.id),t.append("projectId",this.projectId.toString()),t.append("attributes",JSON.stringify(this.attributes)),t.append("deleted",this.deleted.toString()),t.append("created",this.createdStamp.toString()),console.log("queueing occurrence post"),this.queuePost(t)}},{key:"_parseDescriptor",value:function(e){Cb(Sy(r.prototype),"_parseDescriptor",this).call(this,e),this.surveyId=e.surveyId}}]),r}();ld(hR,"EVENT_MODIFIED","modified");var pR=function(e){yy(r,Ib(Error));var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(){return id(this,r),t.apply(this,arguments)}return r}();var vR=new WeakMap,yR=function(e){yy(r,fd);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(e){var n;return id(this,r),ld(py(n=t.call(this)),"route","/list/:action/:id"),ld(py(n),"title","App homepage"),ld(py(n),"app",void 0),ld(py(n),"view",void 0),function(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}(py(n),vR,{writable:!0,value:""}),ld(py(n),"needsFullRefresh",!0),ld(py(n),"needRightPanelRefresh",!0),ld(py(n),"viewSubcontext",""),ld(py(n),"surveySection",void 0),ld(py(n),"leftPanelBaseRoute",""),ld(py(n),"viewContexts",{record:function(e){this.surveySection=null,e?Ty(this,vR)!==e.id?(this.needRightPanelRefresh=!0,this.currentOccurrenceId=e.id?e.id:""):this.needRightPanelRefresh=!1:(this.currentOccurrenceId="",this.needRightPanelRefresh=!0),this.leftPanelBaseRoute="/list/record"},survey:function(e){console.log("in survey section ".concat(e.section)),this.currentOccurrenceId="",this.needRightPanelRefresh=!0,this.surveySection=e.section,this.leftPanelBaseRoute="/list/survey/".concat(e.section)}}),n.view=e,e.controller=py(n),n.handle=fd.nextHandle,e.addListener(r.EVENT_SELECT_OCCURRENCE,n.occurrenceSelectionHandler.bind(py(n))),e.addListener(r.EVENT_SELECT_SURVEY_SECTION,n.surveyPartSelectionHandler.bind(py(n))),e.addListener(r.EVENT_NEW_RECORD,n.newRecordHandler.bind(py(n))),e.addListener(r.EVENT_DELETE_OCCURRENCE,n.deleteOccurrenceHandler.bind(py(n))),e.addListener(r.EVENT_BACK,n.backHandler.bind(py(n))),e.addListener(r.EVENT_NEXT_TO_RECORDS,n.nextTransitionToRecordsHandler.bind(py(n))),n}return cd(r,[{key:"occurrences",get:function(){return this.app.occurrences}},{key:"currentOccurrence",get:function(){if(Ty(this,vR)){if(this.app.occurrences.has(Ty(this,vR)))return this.app.occurrences.get(Ty(this,vR));throw new xb("Record id '".concat(Ty(this,vR),"' was not found."))}return null}},{key:"currentOccurrenceId",get:function(){return Ty(this,vR)},set:function(e){Ny(this,vR,e)}},{key:"survey",get:function(){return this.app.currentSurvey}},{key:"nextTransitionToRecordsHandler",value:function(){console.log("in nextTransitionToRecordsHandler()"),this.app.haveExtantOccurrences()?this.app.router.navigate("/list/record/"):this.newRecordHandler()}},{key:"deleteOccurrenceHandler",value:function(e){console.log({deleting:e.occurrenceId});var t=this.app.occurrences.get(e.occurrenceId);if(!t)throw new pR("Occurrence id '".concat(e.occurrenceId,"' not found when trying to delete."));t.delete(),this.currentOccurrenceId===e.occurrenceId&&this.app.router.navigate("/list/record/")}},{key:"surveyPartSelectionHandler",value:function(e){console.log({"In surveyPartSelectionHandler":e}),"record"===e.sectionKey?this.app.router.navigate("/list/record/"):e.sectionKey?this.app.router.navigate("/list/survey/".concat(e.sectionKey)):this.app.router.navigate("/list/")}},{key:"newRecordHandler",value:function(){var e=this.app.addNewOccurrence();this.app.router.navigate("/list/record/".concat(e.id))}},{key:"occurrenceSelectionHandler",value:function(e){console.log({"In occurrenceSelectionHandler":e}),this.currentOccurrenceId&&e.occurrenceId&&this.currentOccurrenceId===e.occurrenceId?console.log("ignoring spurious navigation event for '".concat(e.occurrenceId,"'")):this.app.router.navigate("/list/record/".concat(e.occurrenceId))}},{key:"registerRoute",value:function(e){e.on("/list",this.mainRouteHandler.bind(this,"list","",""),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null}),e.on("/list/help",this.mainRouteHandler.bind(this,"list","","help")),e.on("/list/record/",this.mainRouteHandler.bind(this,"list","record",""),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null}),e.on("/list/record/help",this.mainRouteHandler.bind(this,"list","record","help")),e.on("/list/record/:id",this.mainRouteHandler.bind(this,"list","record","form"),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null}),e.on("/list/survey/:section",this.mainRouteHandler.bind(this,"list","survey",""),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null}),e.on("/list/survey/:section/help",this.mainRouteHandler.bind(this,"list","survey","help"))}},{key:"mainRouteHandler",value:function(e,t,r,n){console.log("reached special route handler for MainController.js"),console.log({context:e,params:t,query:n}),this.app.saveRoute();try{this.viewSubcontext=t,t&&this.viewContexts[t].call(this,n),this.app.currentControllerHandle!==this.handle&&(this.needsFullRefresh=!0,this.needRightPanelRefresh=!0,this.app.currentControllerHandle=this.handle),this.view.panelKey=r,this.view.display(),this.needsFullRefresh=!1}catch(e){this.error=e,console.log({error:e});try{this.needsFullRefresh=!0,this.view.display()}catch(e){console.log({rethrownError:e}),document.body.innerHTML="<h2>Internal error</h2><p>Please report this problem:</p><p>".concat(e.message,"</p>")}}}},{key:"backHandler",value:function(){this.app.routeHistory.length>=2&&this.app.routeHistory[this.app.routeHistory.length-2].url===this.leftPanelBaseRoute?(this.app.routeHistory.length-=1,console.log("using standard back navigation"),window.history.back()):(console.log("navigating back using base address '".concat(this.leftPanelBaseRoute,"'")),this.app.router.navigate(this.leftPanelBaseRoute))}}]),r}();ld(yR,"EVENT_SELECT_OCCURRENCE","selectoccurrence"),ld(yR,"EVENT_SELECT_SURVEY_SECTION","selectsurveysection"),ld(yR,"EVENT_NEW_RECORD","newrecord"),ld(yR,"EVENT_DELETE_OCCURRENCE","deleteoccurrence"),ld(yR,"EVENT_BACK","back"),ld(yR,"EVENT_NEXT_TO_RECORDS","nexttorecords");var mR=function(e){yy(r,fd);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(e,n){var o;return id(this,r),ld(py(o=t.call(this)),"route",void 0),o.view=e,o.route=n,o.handle=fd.nextHandle,o}return cd(r,[{key:"routeHandler",value:function(e,t){this.app.currentControllerHandle=this.handle,this.view.display()}}]),r}(),gR=sh,SR=Sp,bR=Fm,NR=Ld,TR=df,wR=uE,ER=bE;cE("match",(function(e,t,r){return[function(t){var r=NR(this),n=null==t?void 0:TR(t,e);return n?n.call(t,r):new RegExp(t)[e](bR(r))},function(e){var n=gR(this),o=bR(e),a=r(t,n,o);if(a.done)return a.value;if(!n.global)return ER(n,o);var i=n.unicode;n.lastIndex=0;for(var s,c=[],l=0;null!==(s=ER(n,o));){var u=bR(s[0]);c[l]=u,""===u&&(n.lastIndex=wR(o,SR(n.lastIndex),i)),l++}return 0===l?null:c}]}));var _R=sv,OR=mS,RR=Rv,IR=jd,xR=yp,CR=Np,AR=Hd,kR=Mb,LR=Df,MR=Fb("slice"),PR=LR("species"),HR=[].slice,DR=Math.max;_R({target:"Array",proto:!0,forced:!MR},{slice:function(e,t){var r,n,o,a=AR(this),i=CR(a),s=xR(e,i),c=xR(void 0===t?i:t,i);if(OR(a)&&(r=a.constructor,(RR(r)&&(r===Array||OR(r.prototype))||IR(r)&&null===(r=r[PR]))&&(r=void 0),r===Array||void 0===r))return HR.call(a,s,c);for(n=new(void 0===r?Array:r)(DR(c-s,0)),o=0;s<c;s++,o++)s in a&&kR(n,o,a[s]);return n.length=o,n}});var FR=bd,jR=$h.EXISTS,UR=ah.f,BR=Function.prototype,YR=BR.toString,VR=/^\s*function ([^ (]*)/;FR&&!jR&&UR(BR,"name",{configurable:!0,get:function(){try{return YR.call(this).match(VR)[1]}catch(e){return""}}});var JR=sh,GR=Hg,KR=Eg,qR=Nf,WR=function(e,t,r,n){try{return n?t(JR(r)[0],r[1]):t(r)}catch(t){GR(e,"throw",t)}},XR=Tg,QR=Rv,zR=Np,$R=Mb,ZR=Lg,eI=xg;sv({target:"Array",stat:!0,forced:!zg((function(e){Array.from(e)}))},{from:function(e){var t=qR(e),r=QR(this),n=arguments.length,o=n>1?arguments[1]:void 0,a=void 0!==o;a&&(o=KR(o,n>2?arguments[2]:void 0,2));var i,s,c,l,u,d,f=eI(t),h=0;if(!f||this==Array&&XR(f))for(i=zR(t),s=r?new this(i):Array(i);i>h;h++)d=a?o(t[h],h):t[h],$R(s,h,d);else for(u=(l=ZR(t,f)).next,s=r?new this:[];!(c=u.call(l)).done;h++)d=a?WR(l,o,[c.value,h],!0):c.value,$R(s,h,d);return s.length=h,s}});var tI=sv,rI=bd,nI=md,oI=Ef,aI=Dd,iI=jd,sI=ah.f,cI=Jp,lI=nI.Symbol;if(rI&&aI(lI)&&(!("description"in lI.prototype)||void 0!==lI().description)){var uI={},dI=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof dI?new lI(e):void 0===e?lI():lI(e);return""===e&&(uI[t]=!0),t};cI(dI,lI);var fI=dI.prototype=lI.prototype;fI.constructor=dI;var hI=fI.toString,pI="Symbol(test)"==String(lI("test")),vI=/^Symbol\((.*)\)[^)]+$/;sI(fI,"description",{configurable:!0,get:function(){var e=iI(this)?this.valueOf():this,t=hI.call(e);if(oI(uI,e))return"";var r=pI?t.slice(7,-1):t.replace(vI,"$1");return""===r?void 0:r}}),tI({global:!0,forced:!0},{Symbol:dI})}t_("iterator");var yI=sv,mI=Hd,gI=[].join,SI=kd!=Object,bI=gO("join",",");function NI(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TI(e,t){if(e){if("string"==typeof e)return NI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?NI(e,t):void 0}}function wI(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return a}}(e,t)||TI(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}yI({target:"Array",proto:!0,forced:SI||!bI},{join:function(e){return gI.call(mI(this),void 0===e?",":e)}});var EI=ah.f,_I=Qv,OI=zm,RI=Eg,II=Kg,xI=Gg,CI=wm,AI=bN,kI=bd,LI=$m.exports.fastKey,MI=Kh.set,PI=Kh.getterFor;vS("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),{getConstructor:function(e,t,r,n){var o=e((function(e,a){II(e,o,t),MI(e,{type:t,index:_I(null),first:void 0,last:void 0,size:0}),kI||(e.size=0),null!=a&&xI(a,e[n],{that:e,AS_ENTRIES:r})})),a=PI(t),i=function(e,t,r){var n,o,i=a(e),c=s(e,t);return c?c.value=r:(i.last=c={index:o=LI(t,!0),key:t,value:r,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=c),n&&(n.next=c),kI?i.size++:e.size++,"F"!==o&&(i.index[o]=c)),e},s=function(e,t){var r,n=a(e),o=LI(t);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key==t)return r};return OI(o.prototype,{clear:function(){for(var e=a(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,kI?e.size=0:this.size=0},delete:function(e){var t=a(this),r=s(this,e);if(r){var n=r.next,o=r.previous;delete t.index[r.index],r.removed=!0,o&&(o.next=n),n&&(n.previous=o),t.first==r&&(t.first=n),t.last==r&&(t.last=o),kI?t.size--:this.size--}return!!r},forEach:function(e){for(var t,r=a(this),n=RI(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!s(this,e)}}),OI(o.prototype,r?{get:function(e){var t=s(this,e);return t&&t.value},set:function(e,t){return i(this,0===e?0:e,t)}}:{add:function(e){return i(this,e=0===e?0:e,e)}}),kI&&EI(o.prototype,"size",{get:function(){return a(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=PI(t),a=PI(n);CI(e,t,(function(e,t){MI(this,{type:n,target:e,state:o(e),kind:t,last:void 0})}),(function(){for(var e=a(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),AI(t)}});var HI=Op.includes,DI=Cy;sv({target:"Array",proto:!0},{includes:function(e){return HI(this,e,arguments.length>1?arguments[1]:void 0)}}),DI("includes");var FI=jd,jI=xd,UI=Df("match"),BI=function(e){var t;return FI(e)&&(void 0!==(t=e[UI])?!!t:"RegExp"==jI(e))},YI=BI,VI=Df("match"),JI=function(e){if(YI(e))throw TypeError("The method doesn't accept regular expressions");return e},GI=Ld,KI=Fm;sv({target:"String",proto:!0,forced:!function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[VI]=!1,"/./"[e](t)}catch(e){}}return!1}("includes")},{includes:function(e){return!!~KI(GI(this)).indexOf(KI(JI(e)),arguments.length>1?arguments[1]:void 0)}});var qI=cE,WI=BI,XI=sh,QI=Ld,zI=EN,$I=uE,ZI=Sp,ex=Fm,tx=df,rx=bE,nx=eE,ox=Sd,ax=Aw.UNSUPPORTED_Y,ix=[].push,sx=Math.min;qI("split",(function(e,t,r){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var n=ex(QI(this)),o=void 0===r?4294967295:r>>>0;if(0===o)return[];if(void 0===e)return[n];if(!WI(e))return t.call(n,e,o);for(var a,i,s,c=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),u=0,d=new RegExp(e.source,l+"g");(a=nx.call(d,n))&&!((i=d.lastIndex)>u&&(c.push(n.slice(u,a.index)),a.length>1&&a.index<n.length&&ix.apply(c,a.slice(1)),s=a[0].length,u=i,c.length>=o));)d.lastIndex===a.index&&d.lastIndex++;return u===n.length?!s&&d.test("")||c.push(""):c.push(n.slice(u)),c.length>o?c.slice(0,o):c}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t,[function(t,r){var o=QI(this),a=null==t?void 0:tx(t,e);return a?a.call(t,o,r):n.call(ex(o),t,r)},function(e,o){var a=XI(this),i=ex(e),s=r(n,a,i,o,n!==t);if(s.done)return s.value;var c=zI(a,RegExp),l=a.unicode,u=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(ax?"g":"y"),d=new c(ax?"^(?:"+a.source+")":a,u),f=void 0===o?4294967295:o>>>0;if(0===f)return[];if(0===i.length)return null===rx(d,i)?[i]:[];for(var h=0,p=0,v=[];p<i.length;){d.lastIndex=ax?0:p;var y,m=rx(d,ax?i.slice(p):i);if(null===m||(y=sx(ZI(d.lastIndex+(ax?p:0)),i.length))===h)p=$I(i,p,l);else{if(v.push(i.slice(h,p)),v.length===f)return v;for(var g=1;g<=m.length-1;g++)if(v.push(m[g]),v.length===f)return v;p=h=y}}return v.push(i.slice(h)),v}]}),!!ox((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]})),ax);var cx=function(e){yy(r,MO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(){var e;id(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return ld(py(e=t.call.apply(t,[this].concat(o))),"controller",void 0),e}return cd(r,[{key:"initialise",value:function(){}},{key:"display",value:function(){console.log("got to view display"),this.refreshHeader(),this.body()}},{key:"refreshHeader",value:function(){}},{key:"body",value:function(){}},{key:"card",value:function(e){var t=document.createElement("div");t.id=e.cardId,t.className="card";var r=t.appendChild(document.createElement("div"));r.className="card-header pointer",e.cardHeadingId&&(r.id=e.cardHeadingId),r.setAttribute("data-toggle","collapse"),r.setAttribute("data-target","#".concat(e.cardDescriptionId));var n=r.appendChild(document.createElement("h2"));n.className="mb-0";var o=n.appendChild(document.createElement("button"));if(o.className="btn btn-link".concat(e.collapsed?" collapsed":""),e.headingButtonId&&(o.id=e.headingButtonId),o.type="button",o.setAttribute("data-toggle","collapse"),e.buttonStyleString&&(o.style.cssText=e.buttonStyleString),e.cardDescriptionId&&(o.setAttribute("data-target","#".concat(e.cardDescriptionId)),o.setAttribute("aria-controls",e.cardDescriptionId)),o.setAttribute("aria-expanded",e.collapsed?"false":"true"),o.innerHTML=e.headingHTML,e.headingNonbuttonHTML){var a=n.appendChild(document.createElement("span"));a.style.display="inline-block",a.innerHTML=e.headingNonbuttonHTML}if(e.headingValidationWarningHTML){var i=r.appendChild(document.createElement("div"));i.className="card-invalid-feedback",i.innerHTML="<small>".concat(e.headingValidationWarningHTML,"</small>")}var s=t.appendChild(document.createElement("div"));if(e.cardDescriptionId&&(s.id=e.cardDescriptionId),s.className="collapse".concat(e.collapsed?"":" show"),e.cardHeadingId&&s.setAttribute("aria-labelledby",e.cardHeadingId),s.setAttribute("data-parent","#".concat(e.parentContainerId)),e.dataAttributes)for(var c in e.dataAttributes)e.dataAttributes.hasOwnProperty(c)&&s.setAttribute("data-".concat(c),e.dataAttributes[c]);var l=s.appendChild(document.createElement("div"));return l.className="card-body pl-2 pr-2 pl-md-3 pr-md-3",l.appendChild(e.bodyContentElement),t}}]),r}();var lx=function(e){yy(r,cx);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(){return id(this,r),t.apply(this,arguments)}return cd(r,[{key:"body",value:function(){document.getElementById("body").innerHTML='<h2>Page not found</h2><p><a href="/app/list">Return to the homepage.</a>'}}]),r}();var ux=function(e){yy(r,uR);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(e){var n;return id(this,r),ld(py(n=t.call(this)),"_survey",void 0),ld(py(n),"section",void 0),n.section=e,n}return cd(r,[{key:"formElement",get:function(){var e=Cb(Sy(r.prototype),"formElement",this);return this._formFieldsBuilt||this.buildFormFields(),e}},{key:"updateModelFromContent",value:function(){for(var e in console.log("updating survey from SurveyForm content"),this.fields)if(this.fields.hasOwnProperty(e)){var t=this.fields[e];this._survey.attributes[e]=t.value}console.log({survey:this._survey})}},{key:"model",get:function(){return this._survey},set:function(e){this._survey=e,this.populateFormContent()}},{key:"changeHandler",value:function(e){console.log("survey form change event"),console.log({event:e}),this.fireEvent(uR.CHANGE_EVENT,{form:this})}},{key:"destructor",value:function(){Cb(Sy(r.prototype),"destructor",this).call(this),this._survey=null}},{key:"initialiseFormFields",value:function(){var e=this.section.properties;for(var t in this.fields={},e)e.hasOwnProperty(t)&&(this.fields[t]=new e[t].field(e[t].attributes))}},{key:"getFormSectionProperties",value:function(){return this.section.properties}}],[{key:"registerSection",value:function(e){r.sections[e.sectionSortOrder]=e,r.sectionsByKey[e.sectionNavigationKey]=e}}]),r}();ld(ux,"sections",[]),ld(ux,"sectionsByKey",{});var dx=function(e){yy(r,FO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(){var e;id(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return ld(py(e=t.call.apply(t,[this].concat(o))),"SAVE_ENDPOINT","/savesurvey.php"),ld(py(e),"TYPE","survey"),ld(py(e),"attributes",{}),e}return cd(r,[{key:"formChangedHandler",value:function(e){console.log("Survey change handler invoked."),e.form.updateModelFromContent(),e.form.conditionallyValidateForm(),this.touch(),this.fireEvent(r.EVENT_MODIFIED,{surveyId:this.id})}},{key:"registerForm",value:function(e){e.model=this,e.addListener(uR.CHANGE_EVENT,this.formChangedHandler.bind(this))}},{key:"save",value:function(){if(this._savedRemotely)return Promise.reject("".concat(this.id," has already been saved."));var e=new FormData;return e.append("type",this.TYPE),e.append("surveyId",this.id),e.append("id",this.id),e.append("projectId",this.projectId.toString()),e.append("attributes",JSON.stringify(this.attributes)),e.append("deleted",this.deleted.toString()),e.append("created",this.createdStamp.toString()),console.log("queueing survey post"),this.queuePost(e)}},{key:"generateSurveyName",value:function(){var e,t=(this.attributes.place||this.attributes.georef||"(unlocalised)").trim(),r=new Date(1e3*this.createdStamp);try{e=r.toLocaleString("default",{year:"numeric",month:"long",day:"numeric"})}catch(t){e=r.toLocaleString("en-GB",{year:"numeric",month:"long",day:"numeric"})}return"".concat(UO(t)," ").concat(e)}}]),r}();ld(dx,"EVENT_MODIFIED","modified");var fx=function(e){yy(r,FO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(){var e;id(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return ld(py(e=t.call.apply(t,[this].concat(o))),"file",void 0),ld(py(e),"TYPE","image"),ld(py(e),"SAVE_ENDPOINT","/saveimage.php"),e}return cd(r,[{key:"getUrl",value:function(){}},{key:"save",value:function(e,t,r){if(this._savedRemotely)return Promise.reject("".concat(this.id," has already been saved."));var n=new FormData;return n.append("type",this.TYPE),n.append("surveyId",e||""),n.append("occurrenceId",t||this.occurrenceId),n.append("projectId",r?r.toString():""),n.append("imageId",this.id),n.append("id",this.id),n.append("image",this.file),n.append("deleted",this.deleted.toString()),console.log("queueing image post, image id ".concat(this.id)),this.queuePost(n)}},{key:"_parseDescriptor",value:function(e){Cb(Sy(r.prototype),"_parseDescriptor",this).call(this,e),this.surveyId=e.surveyId,this.occurrenceId=e.occurrenceId,this.file=e.image}}],[{key:"fromFile",value:function(e){var t=new r;return t.file=e,t}},{key:"placeholder",value:function(e){var t=new r;return t._id=e,r.imageCache.set(e,t),t}},{key:"imageLink",value:function(e,t,r,n){t=t||0,r=r||0;var o="";n.className&&(o+=' class="'.concat(n.className,'"'));var a=t>r?'width="'.concat(t,'"'):'height="'.concat(r,'"');return'<picture><source srcset="/image.php?imageid='.concat(e,'&amp;height=128&amp;format=webp" type="image/webp"><img').concat(o,' src="/image.php?imageid=').concat(e,"&amp;width=").concat(t,"&amp;height=").concat(r,'&amp;format=jpeg" ').concat(a,' alt="photo"></picture>')}}]),r}();function hx(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return px(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?px(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function px(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vx(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}ld(fx,"imageCache",new Map),ld(fx,"EVENT_MODIFIED","modified");var yx=new WeakMap,mx=new WeakMap,gx=function(e){yy(r,MO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(){var e;return id(this,r),vx(py(e=t.call(this)),yx,{writable:!0,value:void 0}),vx(py(e),mx,{writable:!0,value:void 0}),ld(py(e),"controllers",[]),ld(py(e),"currentControllerHandle",!1),ld(py(e),"routeHistory",[]),ld(py(e),"occurrences",void 0),ld(py(e),"surveys",void 0),ld(py(e),"currentSurvey",void 0),ld(py(e),"layout",void 0),e.reset(),e}return cd(r,[{key:"reset",value:function(){this.surveys=new Map,this.clearCurrentSurvey()}},{key:"clearCurrentSurvey",value:function(){this.occurrences=new Map,this.currentSurvey=null}},{key:"router",get:function(){return Ty(this,yx)},set:function(e){Ny(this,yx,e)}},{key:"containerId",set:function(e){var t=document.getElementById(e);if(!t)throw new Error("App container '".concat(e,"' not found."));Ny(this,mx,t)}},{key:"container",get:function(){return Ty(this,mx)}},{key:"registerController",value:function(e){e.handle=this.controllers.length,this.controllers[this.controllers.length]=e,e.app=this,e.registerRoute(Ty(this,yx))}},{key:"initialise",value:function(){var e=this;this.layout.initialise(),Ty(this,yx).notFound((function(e){console.log("no route found for '".concat(e,"'")),(new lx).display()})),Ty(this,yx).on((function(){console.log("redirecting from '/' to '/list'"),Ty(e,yx).pause(),e.currentSurvey&&e.currentSurvey.isPristine?Ty(e,yx).navigate("/list/survey/welcome").resume():Ty(e,yx).navigate("/list").resume(),Ty(e,yx).resolve()}));var t,r=hx(this.controllers);try{for(r.s();!(t=r.n()).done;)t.value.initialise()}catch(e){r.e(e)}finally{r.f()}}},{key:"display",value:function(){console.log("App display"),Ty(this,yx).resolve()}},{key:"saveRoute",value:function(){var e=Ty(this,yx).lastRouteResolved();this.routeHistory.length?this.routeHistory[this.routeHistory.length-1]!==e&&(this.routeHistory[this.routeHistory.length]=e):this.routeHistory[0]=e}},{key:"markAllNotPristine",value:function(){var e,t=hx(this.occurrences);try{for(t.s();!(e=t.n()).done;)e.value[1].isPristine=!1}catch(e){t.e(e)}finally{t.f()}}},{key:"setLayout",value:function(e){this.layout=e,e.setApp(this)}},{key:"addSurvey",value:function(e){var t=this;if(e.projectId!==this.projectId)throw new Error("Survey project id '".concat(e.projectId," does not match with current project ('").concat(this.projectId,"')"));this.surveys.has(e.id)||(console.log("setting survey's modified/save handler"),e.addListener(dx.EVENT_MODIFIED,(function(){return t.fireEvent(r.EVENT_SURVEYS_CHANGED),e.save()}))),this.surveys.set(e.id,e),this.fireEvent(r.EVENT_SURVEYS_CHANGED)}},{key:"haveExtantOccurrences",value:function(){var e,t=hx(this.occurrences);try{for(t.s();!(e=t.n()).done;)if(!e.value.deleted)return!0}catch(e){t.e(e)}finally{t.f()}return!1}},{key:"addOccurrence",value:function(e){var t=this;if(!e.surveyId)throw new pR("Survey id must set prior to registering occurrence.");0===this.occurrences.size&&(this.surveys.get(e.surveyId).createdStamp=e.createdStamp),console.log("in addOccurrence setting id '".concat(e.id,"'")),this.occurrences.set(e.id,e),e.addListener(hR.EVENT_MODIFIED,(function(){var r=t.surveys.get(e.surveyId);if(!r)throw new Error("Failed to look up survey id ".concat(e.surveyId));r.isPristine=!1,r.unsaved()&&r.save(),e.save(r.id)}))}},{key:"refreshFromServer",value:function(e){var t,r=this,n=new FormData,o=0,a=hx(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;n.append("surveyId[".concat(o++,"]"),i)}}catch(e){a.e(e)}finally{a.f()}return fetch(ExampleApp.LOAD_SURVEYS_ENDPOINT,{method:"POST",body:n}).then((function(e){return e.ok?e.json():Promise.reject("Invalid response from server when refreshing survey ids")})).then((function(e){console.log({"refresh from server json response":e});var t=[];for(var n in e)if(e.hasOwnProperty(n)){var o,a=hx(e[n]);try{for(a.s();!(o=a.n()).done;){var i=o.value;t.push(r._conditionallyReplaceObject(i))}}catch(e){a.e(e)}finally{a.f()}}return Promise.all(t)}))}},{key:"_conditionallyReplaceObject",value:function(e){var t=e.type,r=e.id,n="".concat(t,".").concat(r);return PO.getItem(n).then((function(t){return t&&!e.deleted&&t.modified>=e.modified?(console.log("Local copy of ".concat(n," is the same or newer than the server copy. (").concat(t.modified," >= ").concat(e.modified,") ")),Promise.resolve()):(console.log("Adding or replacing local copy of ".concat(n)),PO.setItem(n,e))}))}},{key:"seekKeys",value:function(e){return PO.keys().then((function(t){var r,n=hx(t);try{for(n.s();!(r=n.n()).done;){var o,a,i=wI(r.value.split(".",2),2);o=i[0],a=i[1],e.hasOwnProperty(o)?e[o].includes(a)||e[o].push(a):console.log("Unrecognised stored key type '".concat(o,"."))}}catch(e){n.e(e)}finally{n.f()}return e}))}},{key:"syncAll",value:function(){var e=this;return this.seekKeys({survey:[],occurrence:[],image:[]}).then((function(t){return e._syncLocalUnsaved(t)}),(function(e){return console.log("Failed to sync all: ".concat(e)),!1}))}},{key:"_syncLocalUnsaved",value:function(e){var t,r=[],n=hx(e.survey);try{for(n.s();!(t=n.n()).done;){var o=t.value;r.push(dx.retrieveFromLocal(o,new dx).then((function(e){if(e.unsaved())return e.save()})))}}catch(e){n.e(e)}finally{n.f()}var a,i=hx(e.occurrence);try{for(i.s();!(a=i.n()).done;){var s=a.value;r.push(hR.retrieveFromLocal(s,new hR).then((function(e){if(e.unsaved())return e.save()})))}}catch(e){i.e(e)}finally{i.f()}var c,l=hx(e.image);try{for(l.s();!(c=l.n()).done;){var u=c.value;r.push(fx.retrieveFromLocal(u,new fx).then((function(e){if(e.unsaved())return e.save()})))}}catch(e){l.e(e)}finally{l.f()}return Promise.all(r).catch((function(e){console.log("Save failure: ".concat(e))}))}},{key:"restoreOccurrences",value:function(e){var t=this;if(this.surveys.has(e)){var n=this.surveys.get(e);if(n.isPristine)return this.clearCurrentSurvey(),this.currentSurvey=n,this.fireEvent(r.EVENT_SURVEYS_CHANGED),Promise.resolve()}var o={survey:[],occurrence:[],image:[]};return e&&(o.survey[0]=e),console.log("pre-seek keys"),console.log(o),this.seekKeys(o).then((function(e){return e.survey.length?t.refreshFromServer(e.survey).finally((function(){return t.seekKeys(e)})):null})).finally((function(){return o.survey.length?t._restoreSurveyFromLocal(o.survey[0],o).finally((function(){return t.currentSurvey=t.surveys.get(o.survey[0]),t.currentSurvey?(t.currentSurvey.deleted?t.setNewSurvey():t.fireEvent(r.EVENT_SURVEYS_CHANGED),Promise.resolve()):(console.log("Failed to retrieve survey id '".concat(e,"'")),Promise.reject(new Error("Failed to retrieve survey id '".concat(e,"'"))))})):(t.setNewSurvey(),Promise.resolve())}))}},{key:"setNewSurvey",value:function(){this.currentSurvey=new dx,this.currentSurvey.projectId=this.projectId,this.currentSurvey.isPristine=!0,this.addSurvey(this.currentSurvey)}},{key:"addNewOccurrence",value:function(){var e=new hR;return e.surveyId=this.currentSurvey.id,e.projectId=this.projectId,e.isNew=!0,e.isPristine=!0,this.addOccurrence(e),this.fireEvent(ExampleApp.EVENT_OCCURRENCE_ADDED,{occurrenceId:e.id,surveyId:e.surveyId}),e}},{key:"_restoreSurveyFromLocal",value:function(e,t){var r=this;return dx.retrieveFromLocal(e,new dx).then((function(n){r.clearCurrentSurvey(),r.addSurvey(n);var o,a=[],i=hx(t.occurrence);try{var s=function(){var t=o.value;a.push(hR.retrieveFromLocal(t,new hR).then((function(n){n.surveyId===e&&(console.log("adding occurrence ".concat(t)),r.addOccurrence(n))})))};for(i.s();!(o=i.n()).done;)s()}catch(e){i.e(e)}finally{i.f()}return Promise.all(a)})).finally((function(){var r,n=[],o=hx(t.image);try{var a=function(){var t=r.value;n.push(fx.retrieveFromLocal(t,new fx).then((function(r){console.log("restoring image id '".concat(t,"'")),r.surveyId===e&&fx.imageCache.set(t,r)}),(function(e){console.log("Failed to retrieve an image: ".concat(e))})))};for(o.s();!(r=o.n()).done;)a()}catch(e){o.e(e)}finally{o.f()}return Promise.all(n)}))}},{key:"clearLocalForage",value:function(){return PO.clear()}}]),r}();function Sx(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}ld(gx,"EVENT_ADD_SURVEY_USER_REQUEST","useraddsurveyrequest"),ld(gx,"EVENT_RESET_SURVEYS","userresetsurveys"),ld(gx,"LOAD_SURVEYS_ENDPOINT","/loadsurveys.php"),ld(gx,"EVENT_OCCURRENCE_ADDED","occurrenceadded"),ld(gx,"EVENT_SURVEYS_CHANGED","surveyschanged"),ld(gx,"devMode",!1);var bx=function(e){yy(r,MO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(){var e;id(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return ld(py(e=t.call.apply(t,[this].concat(o))),"app",void 0),ld(py(e),"surveysMenuId",void 0),e}return cd(r,[{key:"setApp",value:function(e){var t=this;this.app=e,e.addListener(gx.EVENT_SURVEYS_CHANGED,(function(){t.refreshSurveysMenu()}))}},{key:"initialise",value:function(){var e=this;this.refreshSurveysMenu();var t=document.createElement("div");t.innerHTML='\x3c!-- begin: templates/newSurveyModal.html --\x3e\r\n<div class="modal fade" id="newsurveymodal" tabindex="-1" role="dialog" aria-labelledby="newsurveymodalTitle" aria-hidden="true">\r\n    <div class="modal-dialog modal-dialog-centered" role="document">\r\n        <div class="modal-content">\r\n            <div class="modal-header">\r\n                <h5 class="modal-title" id="newsurveymodalTitle">Start a new survey?</h5>\r\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close">\r\n                    <span aria-hidden="true">&times;</span>\r\n                </button>\r\n            </div>\r\n            <div class="modal-body">\r\n                Please confirm that you wish to start a new survey. You only need to do this if you wish to send a set of records from a different locality, otherwise please add more records to your current report.\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-secondary" data-dismiss="modal">Back</button>\r\n                <button type="button" class="btn btn-danger" data-dismiss="modal" id="newsurveymodalconfirmed">New survey</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\x3c!-- end: templates/newSurveyModal.html --\x3e\r\n',document.body.appendChild(t.getElementsByTagName("div")[0]),(t=document.createElement("div")).innerHTML='\x3c!-- begin: templates/resetModal.html --\x3e\r\n<div class="modal fade" id="resetmodal" tabindex="-1" role="dialog" aria-labelledby="resetmodalTitle" aria-hidden="true">\r\n    <div class="modal-dialog modal-dialog-centered" role="document">\r\n        <div class="modal-content">\r\n            <div class="modal-header">\r\n                <h5 class="modal-title" id="resetmodalTitle">Reset?</h5>\r\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close">\r\n                    <span aria-hidden="true">&times;</span>\r\n                </button>\r\n            </div>\r\n            <div class="modal-body">\r\n                Please confirm that you wish to clear out your survey data.\r\n                <p>Warning: any unsaved changes will be lost.</p>\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-secondary" data-dismiss="modal">Back</button>\r\n                <button type="button" class="btn btn-danger" data-dismiss="modal" id="resetmodalconfirmed">Reset</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\x3c!-- end: templates/resetModal.html --\x3e\r\n',document.body.appendChild(t.getElementsByTagName("div")[0]),(t=document.createElement("div")).innerHTML='\x3c!-- begin: templates/syncSuccessModal.html --\x3e\r\n<div class="modal fade" id="saveallsuccess" tabindex="-1" role="dialog" aria-labelledby="saveallsuccessTitle" aria-hidden="true">\r\n    <div class="modal-dialog modal-dialog-centered" role="document">\r\n        <div class="modal-content">\r\n            <div class="modal-header">\r\n                <h5 class="modal-title" id="saveallsuccessTitle">All records sent</h5>\r\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close">\r\n                    <span aria-hidden="true">&times;</span>\r\n                </button>\r\n            </div>\r\n            <div class="modal-body">\r\n                Your data has been synchronised with the server.\r\n                <p>Thank you.</p>\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\x3c!-- end: templates/syncSuccessModal.html --\x3e\r\n',document.body.appendChild(t.getElementsByTagName("div")[0]),(t=document.createElement("div")).innerHTML='\x3c!-- begin: templates/syncFailureModal.html --\x3e\r\n<div class="modal fade" id="saveallfailure" tabindex="-1" role="dialog" aria-labelledby="saveallfailureTitle" aria-hidden="true">\r\n    <div class="modal-dialog modal-dialog-centered" role="document">\r\n        <div class="modal-content">\r\n            <div class="modal-header">\r\n                <h5 class="modal-title" id="saveallfailureTitle">One or more records could not be saved</h5>\r\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close">\r\n                    <span aria-hidden="true">&times;</span>\r\n                </button>\r\n            </div>\r\n            <div class="modal-body">\r\n                Please check your connection to the network and try again.\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\x3c!-- end: templates/syncFailureModal.html --\x3e\r\n',document.body.appendChild(t.getElementsByTagName("div")[0]),setTimeout((function(){document.getElementById("".concat(r.NEW_SURVEY_MODAL_ID,"confirmed")).addEventListener("click",(function(t){e.app.fireEvent(gx.EVENT_ADD_SURVEY_USER_REQUEST)})),document.getElementById("".concat(r.RESET_MODAL_ID,"confirmed")).addEventListener("click",(function(t){e.app.fireEvent(gx.EVENT_RESET_SURVEYS)}))}),100)}},{key:"refreshSurveysMenu",value:function(){var e,t=document.getElementById(this.surveysMenuId),r=[],n=this.app.currentSurvey?this.app.currentSurvey.id:null,o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Sx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Sx(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}(this.app.surveys);try{for(o.s();!(e=o.n()).done;){var a=e.value,i=a[1].generateSurveyName()+(a[0]===n?' <span style="color: green">â</span>':"");r[r.length]='<a class="dropdown-item" href="/app/survey/add/'.concat(a[0],'" data-navigo="survey/add/').concat(a[0],'">').concat(i,"</a>")}}catch(e){o.e(e)}finally{o.f()}t.innerHTML='<a class="dropdown-item" href="/app/survey/save" data-navigo="survey/save">save all</a>\n    <div class="dropdown-divider"></div>\n    '.concat(r.join(""),'\n    <div class="dropdown-divider"></div>\n    <a class="dropdown-item" href="/app/survey/new" data-navigo="survey/new">new survey</a>\n    <a class="dropdown-item" href="/app/survey/reset" data-navigo="survey/reset">reset</a>'),this.app.router.updatePageLinks()}}]),r}();ld(bx,"NEW_SURVEY_MODAL_ID","newsurveymodal"),ld(bx,"RESET_MODAL_ID","resetmodal"),ld(bx,"SAVE_ALL_SUCCESS_MODAL_ID","saveallsuccess"),ld(bx,"SAVE_ALL_FAILURE_MODAL_ID","saveallfailure");var Nx=function(e){yy(r,fd);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(e){var n;return id(this,r),ld(py(n=t.call(this)),"route","/survey/:action/:id"),ld(py(n),"title","Survey picker"),ld(py(n),"app",void 0),ld(py(n),"view",void 0),n.view=e,e.controller=py(n),n.handle=fd.nextHandle,n}return cd(r,[{key:"survey",get:function(){return this.app.currentSurvey}},{key:"registerRoute",value:function(e){e.on("/survey",this.mainRouteHandler.bind(this,"survey","",""),{}),e.on("/survey/new",this.newSurveyHandler.bind(this,"survey","new",""),{before:this.beforeNewHandler.bind(this)}),e.on("/survey/reset",this.mainRouteHandler.bind(this,"survey","reset",""),{before:this.beforeResetHandler.bind(this)}),e.on("/survey/save",this.mainRouteHandler.bind(this,"survey","save",""),{before:this.beforeSaveAllHandler.bind(this)}),e.on("/survey/add/:surveyId",this.addSurveyHandler.bind(this,"survey","add","")),this.app.addListener(gx.EVENT_ADD_SURVEY_USER_REQUEST,this.addNewSurveyHandler.bind(this)),this.app.addListener(gx.EVENT_RESET_SURVEYS,this.resetSurveysHandler.bind(this))}},{key:"beforeNewHandler",value:function(e){$("#".concat(bx.NEW_SURVEY_MODAL_ID)).modal(),this.app.router.pause(),window.history.back(),this.app.router.resume(),e(!1)}},{key:"beforeResetHandler",value:function(e){$("#".concat(bx.RESET_MODAL_ID)).modal(),this.app.router.pause(),window.history.back(),this.app.router.resume(),e(!1)}},{key:"beforeSaveAllHandler",value:function(e){this.app.syncAll().then((function(e){console.log("In save all handler, success result: ".concat(e)),Array.isArray(e)?$("#".concat(bx.SAVE_ALL_SUCCESS_MODAL_ID)).modal():$("#".concat(bx.SAVE_ALL_FAILURE_MODAL_ID)).modal()}),(function(e){console.log("In save all handler, failure result: ".concat(e)),$("#".concat(bx.SAVE_ALL_FAILURE_MODAL_ID)).modal()})).finally((function(){})),this.app.router.pause(),window.history.back(),this.app.router.resume(),e(!1)}},{key:"newSurveyHandler",value:function(e,t,r,n){}},{key:"addNewSurveyHandler",value:function(){console.log("reached addNewSurveyHandler"),this.app.currentControllerHandle=this.handle,this.app.clearCurrentSurvey(),this.app.setNewSurvey(),this.app.router.pause(),this.app.router.navigate("/list/survey/welcome").resume(),this.app.router.resolve()}},{key:"resetSurveysHandler",value:function(){var e=this;this.app.clearLocalForage().then((function(){e.app.reset(),e.addNewSurveyHandler()}))}},{key:"addSurveyHandler",value:function(e,t,r,n){var o=this;console.log("reached addSurveyHandler"),console.log({context:e,params:t,query:n}),this.app.currentControllerHandle=this.handle;var a=n.surveyId;if(!a||!a.match(DO))throw new xb("Failed to match survey id '".concat(a,"', the id format appears to be incorrect"));a=a.toLowerCase(),this.app.restoreOccurrences(a).then((function(){o.app.markAllNotPristine(),o.app.router.pause(),o.app.router.navigate("/list").resume(),o.app.router.resolve()}),(function(e){console.log({"failed survey restoration":e})}))}},{key:"mainRouteHandler",value:function(e,t,r,n){console.log("reached special route handler for SurveyPickerController.js"),console.log({context:e,params:t,query:n})}}]),r}();ld(Nx,"EVENT_BACK","back");var Tx=sv,wx=nm,Ex=Ld,_x=Sp,Ox=Fm,Rx=sh,Ix=BI,xx=eN,Cx=df,Ax=yh.exports,kx=Sd,Lx=EN,Mx=uE,Px=bE,Hx=Kh,Dx=Df("matchAll"),Fx=Hx.set,jx=Hx.getterFor("RegExp String Iterator"),Ux=RegExp.prototype,Bx="".matchAll,Yx=!!Bx&&!kx((function(){"a".matchAll(/./)})),Vx=wx((function(e,t,r,n){Fx(this,{type:"RegExp String Iterator",regexp:e,string:t,global:r,unicode:n,done:!1})}),"RegExp String",(function(){var e=jx(this);if(e.done)return{value:void 0,done:!0};var t=e.regexp,r=e.string,n=Px(t,r);return null===n?{value:void 0,done:e.done=!0}:e.global?(""===Ox(n[0])&&(t.lastIndex=Mx(r,_x(t.lastIndex),e.unicode)),{value:n,done:!1}):(e.done=!0,{value:n,done:!1})}));Tx({target:"String",proto:!0,forced:Yx},{matchAll:function(e){var t,r,n=Ex(this);if(null!=e){if(Ix(e)&&!~Ox(Ex("flags"in Ux?e.flags:xx.call(e))).indexOf("g"))throw TypeError("`.matchAll` does not allow non-global regexes");if(Yx)return Bx.apply(n,arguments);if(r=Cx(e,Dx))return r.call(e,n)}else if(Yx)return Bx.apply(n,arguments);return t=Ox(n),new RegExp(e,"g")[Dx](t)}}),Dx in Ux||Ax(Ux,Dx,(function(e){var t,r,n,o,a,i,s=Rx(this),c=Ox(e);return t=Lx(s,RegExp),void 0===(r=s.flags)&&s instanceof RegExp&&!("flags"in Ux)&&(r=xx.call(s)),n=void 0===r?"":Ox(r),o=new t(t===RegExp?s.source:s,n),a=!!~n.indexOf("g"),i=!!~n.indexOf("u"),o.lastIndex=_x(s.lastIndex),new Vx(o,c,a,i)}));var Jx=CS.map;function Gx(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}sv({target:"Array",proto:!0,forced:!Fb("map")},{map:function(e){return Jx(this,e,arguments.length>1?arguments[1]:void 0)}});var Kx=function(){function e(){id(this,e)}return cd(e,null,[{key:"fromPostedData",value:function(t){var r,n={saveState:"SAVED_LOCALLY"},o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Gx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Gx(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}(t.entries());try{for(o.s();!(r=o.n()).done;){var a=r.value;n[a[0]]=a[1]}}catch(t){o.e(t)}finally{o.f()}if(!n.type)throw new Error("Missing type in form data.");if(e.responses.hasOwnProperty(n.type))return new e.responses[n.type](n,{});throw new Error("Unrecognised post type '".concat(n.type,"'"))}},{key:"fromPostResponse",value:function(t){if(!t)throw new Error("Invalid empty post response.");if(!t.type)throw new Error("Missing type in returned response.");if(e.responses.hasOwnProperty(t.type))return console.log("in fromPostResponse returning a ".concat(t.type)),new e.responses[t.type]({},t);throw new Error("Unrecognised post type '".concat(t.type,"'"))}}]),e}();function qx(e){var t=new Headers;return t.set("Content-Type","application/json"),new Response(JSON.stringify(e),{status:e.error?500:200,headers:t})}ld(Kx,"responses",{});var Wx=function(){function e(t,r){id(this,e),ld(this,"toSaveLocally",void 0),ld(this,"returnedToClient",void 0),ld(this,"prebuiltResponse",void 0),ld(this,"failureErrorMessage","Failed to save a local copy on your device."),ld(this,"failureErrorHelp","Your internet connection may have failed (or there could be a problem with the server). It wasn't possible to save a temporary copy on your device. Perhaps there is insufficient space? Please try to re-establish a network connection and try again."),this.toSaveLocally=t,this.returnedToClient=r}return cd(e,[{key:"setPrebuiltResponse",value:function(e){return this.prebuiltResponse=e,this}},{key:"storeLocally",value:function(){var e=this;return PO.setItem(this.localKey(),this.toSaveLocally).then((function(){return console.log("Stored object ".concat(e.localKey()," locally")),e.prebuiltResponse?e.prebuiltResponse:qx(e.returnedToClient)}),(function(t){return console.log("Failed to store object ".concat(e.localKey()," locally")),console.log({reason:t}),e.returnedToClient.error=e.failureErrorMessage,e.returnedToClient.errorHelp=e.failureErrorHelp,qx(e.returnedToClient)}))}},{key:"localKey",value:function(){throw new Error("LocalKey must be implemented in a subclass for ".concat(this.toSaveLocally.type))}}]),e}();var Xx=function(e){yy(r,Wx);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(){var e;id(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return ld(py(e=t.call.apply(t,[this].concat(o))),"failureErrorMessage","Failed to store image."),ld(py(e),"failureErrorHelp","Your internet connection may have failed (or there could be a problem with the server). It wasn't possible to save a temporary copy on your device. Perhaps there is insufficient space? Please try to re-establish a network connection and try again."),e}return cd(r,[{key:"populateClientResponse",value:function(){return this.returnedToClient.id=this.toSaveLocally.imageId?this.toSaveLocally.imageId:this.toSaveLocally.id,this.returnedToClient.imageId=this.toSaveLocally.imageId?this.toSaveLocally.imageId:this.toSaveLocally.id,this.returnedToClient.type="image",this.returnedToClient.surveyId=this.toSaveLocally.surveyId,this.returnedToClient.occurrenceId=this.toSaveLocally.occurrenceId,this.returnedToClient.created=parseInt(this.toSaveLocally.created,10),this.returnedToClient.modified=parseInt(this.toSaveLocally.modified,10),this.returnedToClient.saveState="SAVED_LOCALLY",this.returnedToClient.deleted=this.toSaveLocally.deleted,this.returnedToClient.projectId=parseInt(this.toSaveLocally.projectId,10),this}},{key:"populateLocalSave",value:function(){return this.toSaveLocally.surveyId=this.returnedToClient.surveyId,this.toSaveLocally.type="image",this.toSaveLocally.occurrenceId=this.returnedToClient.occurrenceId,this.toSaveLocally.imageId=this.returnedToClient.id?this.returnedToClient.id:this.returnedToClient.imageId,this.toSaveLocally.id=this.returnedToClient.id?this.returnedToClient.id:this.returnedToClient.imageId,this.toSaveLocally.created=parseInt(this.returnedToClient.created,10),this.toSaveLocally.modified=parseInt(this.returnedToClient.modified,10),this.toSaveLocally.saveState="SAVED_TO_SERVER",this.toSaveLocally.deleted=!0===this.returnedToClient.deleted||"true"===this.returnedToClient.deleted,this.toSaveLocally.projectId=parseInt(this.returnedToClient.projectId,10),this}},{key:"localKey",value:function(){return"image.".concat(this.toSaveLocally.imageId)}}],[{key:"register",value:function(){Kx.responses.image=r}}]),r}();var Qx=function(e){yy(r,Wx);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(){var e;id(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return ld(py(e=t.call.apply(t,[this].concat(o))),"failureErrorMessage","Failed to store survey."),ld(py(e),"failureErrorHelp","Your internet connection may have failed (or there could be a problem with the server). It wasn't possible to save a temporary copy on your device. Perhaps there is insufficient space? Please try to re-establish a network connection and try again."),e}return cd(r,[{key:"populateClientResponse",value:function(){return this.toSaveLocally.surveyId=this.returnedToClient.id?this.returnedToClient.id:this.returnedToClient.surveyId,this.toSaveLocally.id=this.returnedToClient.id?this.returnedToClient.id:this.returnedToClient.surveyId,this.returnedToClient.type="survey",this.returnedToClient.attributes=this.toSaveLocally.attributes,this.returnedToClient.created=this.toSaveLocally.created,this.returnedToClient.modified=this.toSaveLocally.modified,this.returnedToClient.saveState="SAVED_LOCALLY",this.returnedToClient.deleted=this.toSaveLocally.deleted,this.returnedToClient.projectId=this.toSaveLocally.projectId,this}},{key:"populateLocalSave",value:function(){return this.toSaveLocally.surveyId=this.returnedToClient.id?this.returnedToClient.id:this.returnedToClient.surveyId,this.toSaveLocally.id=this.returnedToClient.id?this.returnedToClient.id:this.returnedToClient.surveyId,this.toSaveLocally.type="survey",this.toSaveLocally.attributes=this.returnedToClient.attributes,this.toSaveLocally.created=parseInt(this.returnedToClient.created,10),this.toSaveLocally.modified=parseInt(this.returnedToClient.modified,10),this.toSaveLocally.saveState="SAVED_TO_SERVER",this.toSaveLocally.deleted=this.returnedToClient.deleted,this.toSaveLocally.projectId=parseInt(this.returnedToClient.projectId,10),this}},{key:"localKey",value:function(){return"survey.".concat(this.toSaveLocally.surveyId)}}],[{key:"register",value:function(){Kx.responses.survey=r}}]),r}();var zx=function(e){yy(r,Wx);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(){var e;id(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return ld(py(e=t.call.apply(t,[this].concat(o))),"failureErrorMessage","Failed to store occurrence."),ld(py(e),"failureErrorHelp","Your internet connection may have failed (or there could be a problem with the server). It wasn't possible to save a temporary copy on your device. Perhaps there is insufficient space? Please try to re-establish a network connection and try again."),e}return cd(r,[{key:"populateClientResponse",value:function(){return this.returnedToClient.id=this.toSaveLocally.occurrenceId?this.toSaveLocally.occurrenceId:this.toSaveLocally.id,this.returnedToClient.occurrenceId=this.toSaveLocally.occurrenceId?this.toSaveLocally.occurrenceId:this.toSaveLocally.id,this.returnedToClient.type="occurrence",this.returnedToClient.surveyId=this.toSaveLocally.surveyId,this.returnedToClient.attributes=this.toSaveLocally.attributes,this.returnedToClient.created=parseInt(this.toSaveLocally.created,10),this.returnedToClient.modified=parseInt(this.toSaveLocally.modified,10),this.returnedToClient.saveState="SAVED_LOCALLY",this.returnedToClient.deleted=this.toSaveLocally.deleted,this.returnedToClient.projectId=parseInt(this.toSaveLocally.projectId,10),this}},{key:"populateLocalSave",value:function(){return this.toSaveLocally.occurrenceId=this.returnedToClient.id?this.returnedToClient.id:this.returnedToClient.occurrenceId,this.toSaveLocally.id=this.returnedToClient.id?this.returnedToClient.id:this.returnedToClient.occurrenceId,this.toSaveLocally.type="occurrence",this.toSaveLocally.surveyId=this.returnedToClient.surveyId,this.toSaveLocally.attributes=this.returnedToClient.attributes,this.toSaveLocally.created=parseInt(this.returnedToClient.created,10),this.toSaveLocally.modified=parseInt(this.returnedToClient.modified,10),this.toSaveLocally.saveState="SAVED_TO_SERVER",this.toSaveLocally.deleted=!0===this.returnedToClient.deleted||"true"===this.returnedToClient.deleted,this.toSaveLocally.projectId=parseInt(this.returnedToClient.projectId,10),this}},{key:"localKey",value:function(){return"occurrence.".concat(this.toSaveLocally.occurrenceId)}}],[{key:"register",value:function(){Kx.responses.occurrence=r}}]),r}();!function(){function e(){id(this,e),ld(this,"URL_CACHE_SET",void 0)}cd(e,[{key:"initialise",value:function(e){var t=this;Promise.prototype.finally||(Promise.prototype.finally=function(e){return this.then(e).catch(e)}),Xx.register(),Qx.register(),zx.register(),this.CACHE_VERSION="version-1.0.2.1634554032-".concat(e.version);var r=e.postPassThroughWhitelist,n=e.postImageUrlMatch,o=e.getImageUrlMatch,a=e.interceptUrlMatches,i=e.ignoreUrlMatches,s=e.indexUrl;this.URL_CACHE_SET=e.urlCacheSet,PO.config({name:e.forageName}),self.addEventListener("install",(function(e){console.log("BSBI app service worker is being installed."),self.skipWaiting(),e.waitUntil(t.precache().then((function(){return self.skipWaiting()})))})),self.addEventListener("activate",(function(e){e.waitUntil(self.clients.matchAll({includeUncontrolled:!0}).then((function(e){var t=e.map((function(e){return e.url}));console.log("[ServiceWorker] Matching clients:",t.join(", "))})).then((function(){return caches.keys()})).then((function(e){return Promise.all(e.map((function(e){if(e!==t.CACHE_VERSION)return console.log("[ServiceWorker] Deleting old cache:",e),caches.delete(e)})))})).then((function(){return console.log("[ServiceWorker] Claiming clients for version",t.CACHE_VERSION),self.clients.claim()})))})),self.addEventListener("fetch",(function(e){if(console.log("The service worker is serving: '".concat(e.request.url,"'")),e.preventDefault(),"POST"===e.request.method)console.log("Got a post request"),e.request.url.match(r)?(console.log("Passing through whitelisted post request for: ".concat(e.request.url)),e.respondWith(fetch(e.request))):e.request.url.match(n)?t.handle_image_post(e):t.handle_post(e);else if(a.test(e.request.url)&&!i.test(e.request.url)){console.log("redirecting to the root of the SPA");var c=new Request(s);e.respondWith(t.fromCache(c)),e.waitUntil(t.update(c))}else e.request.url.match(o)?(console.log("request is for an image '".concat(e.request.url,"'")),t.handleImageFetch(e)):(console.log("request is for non-image '".concat(e.request.url,"'")),e.respondWith(t.fromCache(e.request)),e.waitUntil(t.update(e.request)))}))}},{key:"handle_post",value:function(e){var t;try{t=e.request.clone()}catch(e){console.log("Failed to clone request."),console.log({"Cloning error":e})}e.respondWith(fetch(e.request).then((function(e){return e.ok?Promise.resolve(e).then((function(e){return e.clone().json()})).then((function(t){return console.log("Following successful remote post about to save locally."),Kx.fromPostResponse(t).setPrebuiltResponse(e).populateLocalSave().storeLocally()})).catch((function(t){return console.log({error:t}),Promise.resolve(e)})):(console.log("Failed to save, moving on to attempt IndexedDb"),Promise.reject("Failed to save to server."))})).catch((function(e){return console.log("post fetch failed (probably no network), (reason: ".concat(e,")")),t.formData().then((function(e){return console.log("got to form data handler"),Kx.fromPostedData(e).populateClientResponse().storeLocally()}),(function(e){return console.log("failed to read form data locally"),console.log({reason:e}),qx({error:"Failed to process posted response data. (internal error)",errorHelp:"Your internet connection may have failed (or there could be a problem with the server). It wasn't possible to save a temporary copy on your device. (an unexpected error occurred) Please try to re-establish a network connection and try again."})}))})))}},{key:"handle_image_post",value:function(e){var t;console.log("posting image");try{t=e.request.clone()}catch(e){console.log("Failed to clone request."),console.log({"Cloning error":e})}e.respondWith(t.formData().then((function(e){return console.log("got to form data handler"),Kx.fromPostedData(e).populateClientResponse().storeLocally()}),(function(e){return console.log("failed to read form data locally"),console.log({reason:e}),qx({error:"Failed to process posted response data. (internal error)",errorHelp:"Your internet connection may have failed (or there could be a problem with the server). It wasn't possible to save a temporary copy on your device. (an unexpected error occurred) Please try to re-establish a network connection and try again."})}))),e.waitUntil(fetch(e.request).then((function(e){return console.log("posted image to server in waitUntil part of fetch cycle"),e.ok?(console.log("posted image to server in waitUntil part of fetch cycle: got OK response"),Promise.resolve(e).then((function(e){return e.clone().json()})).then((function(t){return Kx.fromPostResponse(t).setPrebuiltResponse(e).populateLocalSave().storeLocally()})).catch((function(t){return console.log({error:t}),Promise.resolve(e)}))):qx({error:"Failed to save posted response data. (internal error)",errorHelp:"Your internet connection may have failed (or there could be a problem with the server). It wasn't possible to save a temporary copy on your device. (an unexpected error occurred) Please try to re-establish a network connection and try again."})})))}},{key:"precache",value:function(){var e=this;return caches.open(this.CACHE_VERSION).then((function(t){return t.addAll(e.URL_CACHE_SET)}))}},{key:"fromCache",value:function(e){var t=this;return console.log("attempting fromCache response"),caches.open(this.CACHE_VERSION).then((function(r){return console.log("cache is open"),r.match(e).then((function(r){return console.log(r?"cache matched ".concat(e.url):"no cache match for ".concat(e.url)),r||t.update(e)}))}))}},{key:"handleImageFetch",value:function(e){var t=this;e.respondWith(this.fromCache(e.request).then((function(r){if(console.log("In handleImageFetch promise"),r&&r.ok)return console.log("Responding with image from cache (or remotely if no cache)."),r;var n=e.request.url;console.log("Attempting image match for '".concat(n,"'"));var o=n.match(/imageid=([a-fA-F0-9]{8}-(?:[a-fA-F0-9]{4}-){3}[a-fA-F0-9]{12})/);if(o){var a=o[1];return console.log("Returning image match for '".concat(n,"' from local database")),t.imageFromLocalDatabase(a)}console.log("Failed to match image id in url '".concat(n,"'"))})).catch((function(r){var n=e.request.url;console.log(r),console.log("caught ".concat(r)),console.log("In catch following failed network fetch, attempting image match for '".concat(n,"'"));var o=n.match(/imageid=([a-fA-F0-9]{8}-(?:[a-fA-F0-9]{4}-){3}[a-fA-F0-9]{12})/);if(o){var a=o[1];return console.log("(via catch) Returning image match for '".concat(n,"' from local database")),t.imageFromLocalDatabase(a)}console.log("(via catch) Failed to match image id in url '".concat(n,"'"))})))}},{key:"imageFromLocalDatabase",value:function(e){var t=new fx;return console.log("attempting retrieval of image data from local database"),FO.retrieveFromLocal(e,t).then((function(t){if(console.log("Retrieved image '".concat(e,"' from indexeddb.")),t.file)return(new Headers).append("Content-Type",t.file.type),new Response(t.file,{status:200,statusText:"OK image response from IndexedDb"});console.log("No local file object associated with retrieved image '".concat(e,"' from indexeddb."))}))}},{key:"update",value:function(e){return e=new Request(e,{mode:"cors",credentials:"omit"}),console.log("Attempting fetch and cache update of ".concat(e.url)),caches.open(this.CACHE_VERSION).then((function(t){return fetch(e,{cache:"no-cache"}).then((function(r){return r.ok?(console.log("(re-)caching ".concat(e.url)),t.put(e,r).then((function(){return t.match(e)}))):(console.log("Request during cache update failed for ".concat(e.url)),console.log({"failed cache response":r}),Promise.reject("Request during cache update failed, not caching."))})).catch((function(t){console.log("Cache attempt failed for ".concat(e.url,": error was ").concat(t))}))}))}}])}();var $x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function Zx(){return!("undefined"==typeof window||!window.history||!window.history.pushState)}function eC(e,t,r){this.root=null,this._routes=[],this._useHash=t,this._hash=void 0===r?"#":r,this._paused=!1,this._destroyed=!1,this._lastRouteResolved=null,this._notFoundHandler=null,this._defaultHandler=null,this._usePushState=!t&&Zx(),this._onLocationChange=this._onLocationChange.bind(this),this._genericHooks=null,this._historyAPIUpdateMethod="pushState",e?this.root=t?e.replace(/\/$/,"/"+this._hash):e.replace(/\/$/,""):t&&(this.root=this._cLoc().split(this._hash)[0].replace(/\/$/,"/"+this._hash)),this._listen(),this.updatePageLinks()}function tC(e){return e instanceof RegExp?e:e.replace(/\/+$/,"").replace(/^\/+/,"^/")}function rC(e,t){return 0===t.length?null:e?e.slice(1,e.length).reduce((function(e,r,n){return null===e&&(e={}),e[t[n]]=decodeURIComponent(r),e}),null):null}function nC(e){var t=[];return{regexp:e instanceof RegExp?e:new RegExp(e.replace(eC.PARAMETER_REGEXP,(function(e,r,n){return t.push(n),eC.REPLACE_VARIABLE_REGEXP})).replace(eC.WILDCARD_REGEXP,eC.REPLACE_WILDCARD)+eC.FOLLOWED_BY_SLASH_REGEXP,eC.MATCH_REGEXP_FLAGS),paramNames:t}}function oC(e){return e.replace(/\/$/,"").split("/").length}function aC(e,t){return oC(t)-oC(e)}function iC(e,t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.map((function(t){var r=nC(tC(t.route)),n=r.regexp,o=r.paramNames,a=e.replace(/^\/+/,"/").match(n),i=rC(a,o);return!!a&&{match:a,route:t,params:i}})).filter((function(e){return e}))}(e,t)[0]||!1}function sC(e,t){var r=t.map((function(t){return""===t.route||"*"===t.route?e:e.split(new RegExp(t.route+"($|/)"))[0]})),n=tC(e);return r.length>1?r.reduce((function(e,t){return e.length>t.length&&(e=t),e}),r[0]):1===r.length?r[0]:n}function cC(e,t,r){var n,o=function(e){return e.split(/\?(.*)?$/)[0]};return void 0===r&&(r="#"),Zx()&&!t?o(e).split(r)[0]:(n=e.split(r)).length>1?o(n[1]):o(n[0])}function lC(e,t,r){if(t&&"object"===(void 0===t?"undefined":$x(t))){if(t.before)return void t.before((function(){var n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n&&(e(),t.after&&t.after(r))}),r);if(t.after)return e(),void(t.after&&t.after(r))}e()}eC.prototype={helpers:{match:iC,root:sC,clean:tC,getOnlyURL:cC},navigate:function(e,t){var r;return e=e||"",this._usePushState?(r=(r=(t?"":this._getRoot()+"/")+e.replace(/^\/+/,"/")).replace(/([^:])(\/{2,})/g,"$1/"),history[this._historyAPIUpdateMethod]({},"",r),this.resolve()):"undefined"!=typeof window&&(e=e.replace(new RegExp("^"+this._hash),""),window.location.href=window.location.href.replace(/#$/,"").replace(new RegExp(this._hash+".*$"),"")+this._hash+e),this},on:function(){for(var e=this,t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];if("function"==typeof r[0])this._defaultHandler={handler:r[0],hooks:r[1]};else if(r.length>=2)if("/"===r[0]){var o=r[1];"object"===$x(r[1])&&(o=r[1].uses),this._defaultHandler={handler:o,hooks:r[2]}}else this._add(r[0],r[1],r[2]);else if("object"===$x(r[0])){var a=Object.keys(r[0]).sort(aC);a.forEach((function(t){e.on(t,r[0][t])}))}return this},off:function(e){return null!==this._defaultHandler&&e===this._defaultHandler.handler?this._defaultHandler=null:null!==this._notFoundHandler&&e===this._notFoundHandler.handler&&(this._notFoundHandler=null),this._routes=this._routes.reduce((function(t,r){return r.handler!==e&&t.push(r),t}),[]),this},notFound:function(e,t){return this._notFoundHandler={handler:e,hooks:t},this},resolve:function(e){var t,r,n=this,o=(e||this._cLoc()).replace(this._getRoot(),"");this._useHash&&(o=o.replace(new RegExp("^/"+this._hash),"/"));var a=function(e){return e.split(/\?(.*)?$/).slice(1).join("")}(e||this._cLoc()),i=cC(o,this._useHash,this._hash);return!this._paused&&(this._lastRouteResolved&&i===this._lastRouteResolved.url&&a===this._lastRouteResolved.query?(this._lastRouteResolved.hooks&&this._lastRouteResolved.hooks.already&&this._lastRouteResolved.hooks.already(this._lastRouteResolved.params),!1):(r=iC(i,this._routes))?(this._callLeave(),this._lastRouteResolved={url:i,query:a,hooks:r.route.hooks,params:r.params,name:r.route.name},t=r.route.handler,lC((function(){lC((function(){r.route.route instanceof RegExp?t.apply(void 0,r.match.slice(1,r.match.length)):t(r.params,a)}),r.route.hooks,r.params,n._genericHooks)}),this._genericHooks,r.params),r):this._defaultHandler&&(""===i||"/"===i||i===this._hash||function(e,t,r){if(Zx()&&!t)return!1;if(!e.match(r))return!1;var n=e.split(r);return n.length<2||""===n[1]}(i,this._useHash,this._hash))?(lC((function(){lC((function(){n._callLeave(),n._lastRouteResolved={url:i,query:a,hooks:n._defaultHandler.hooks},n._defaultHandler.handler(a)}),n._defaultHandler.hooks)}),this._genericHooks),!0):(this._notFoundHandler&&lC((function(){lC((function(){n._callLeave(),n._lastRouteResolved={url:i,query:a,hooks:n._notFoundHandler.hooks},n._notFoundHandler.handler(a)}),n._notFoundHandler.hooks)}),this._genericHooks),!1))},destroy:function(){this._routes=[],this._destroyed=!0,this._lastRouteResolved=null,this._genericHooks=null,clearTimeout(this._listeningInterval),"undefined"!=typeof window&&(window.removeEventListener("popstate",this._onLocationChange),window.removeEventListener("hashchange",this._onLocationChange))},updatePageLinks:function(){var e=this;"undefined"!=typeof document&&this._findLinks().forEach((function(t){t.hasListenerAttached||(t.addEventListener("click",(function(r){if((r.ctrlKey||r.metaKey)&&"a"==r.target.tagName.toLowerCase())return!1;var n=e.getLinkPath(t);e._destroyed||(r.preventDefault(),e.navigate(n.replace(/\/+$/,"").replace(/^\/+/,"/")))})),t.hasListenerAttached=!0)}))},generate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this._routes.reduce((function(r,n){var o;if(n.name===e)for(o in r=n.route,t)r=r.toString().replace(":"+o,t[o]);return r}),"");return this._useHash?this._hash+r:r},link:function(e){return this._getRoot()+e},pause:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._paused=e,this._historyAPIUpdateMethod=e?"replaceState":"pushState"},resume:function(){this.pause(!1)},historyAPIUpdateMethod:function(e){return void 0===e?this._historyAPIUpdateMethod:(this._historyAPIUpdateMethod=e,e)},disableIfAPINotAvailable:function(){Zx()||this.destroy()},lastRouteResolved:function(){return this._lastRouteResolved},getLinkPath:function(e){return e.getAttribute("href")},hooks:function(e){this._genericHooks=e},_add:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"string"==typeof e&&(e=encodeURI(e)),this._routes.push("object"===(void 0===t?"undefined":$x(t))?{route:e,handler:t.uses,name:t.as,hooks:r||t.hooks}:{route:e,handler:t,hooks:r}),this._add},_getRoot:function(){return null!==this.root||(this.root=sC(this._cLoc().split("?")[0],this._routes)),this.root},_listen:function(){var e=this;if(this._usePushState)window.addEventListener("popstate",this._onLocationChange);else if("undefined"!=typeof window&&"onhashchange"in window)window.addEventListener("hashchange",this._onLocationChange);else{var t=this._cLoc(),r=void 0,n=void 0;(n=function(){r=e._cLoc(),t!==r&&(t=r,e.resolve()),e._listeningInterval=setTimeout(n,200)})()}},_cLoc:function(){return"undefined"!=typeof window?void 0!==window.__NAVIGO_WINDOW_LOCATION_MOCK__?window.__NAVIGO_WINDOW_LOCATION_MOCK__:tC(window.location.href):""},_findLinks:function(){return[].slice.call(document.querySelectorAll("[data-navigo]"))},_onLocationChange:function(){this.resolve()},_callLeave:function(){var e=this._lastRouteResolved;e&&e.hooks&&e.hooks.leave&&e.hooks.leave(e.params)}},eC.PARAMETER_REGEXP=/([:*])(\w+)/g,eC.WILDCARD_REGEXP=/\*/g,eC.REPLACE_VARIABLE_REGEXP="([^/]+)",eC.REPLACE_WILDCARD="(?:.*)",eC.FOLLOWED_BY_SLASH_REGEXP="(?:/$|$)",eC.MATCH_REGEXP_FLAGS="";var uC=function(e){yy(r,eC);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(){return id(this,r),t.apply(this,arguments)}return cd(r,[{key:"updatePageLinks",value:function(){var e=this;if("undefined"!=typeof document){var t=document.createElement("a");t.href=this.root;var r=t.pathname;this._findLinks().forEach((function(t){t.hasListenerAttached||(t.addEventListener("click",(function(n){if((n.ctrlKey||n.metaKey)&&"a"==n.target.tagName.toLowerCase())return!1;if(!e._destroyed){var o=t.pathname.replace(r,"");n.preventDefault(),e.navigate(o)}})),t.hasListenerAttached=!0)}))}}}]),r}(),dC=bd,fC=md,hC=Zp,pC=tS,vC=vh,yC=ah.f,mC=lp.f,gC=BI,SC=Fm,bC=eN,NC=Aw,TC=yh.exports,wC=Sd,EC=Ef,_C=Kh.enforce,OC=bN,RC=Hw,IC=jw,xC=Df("match"),CC=fC.RegExp,AC=CC.prototype,kC=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,LC=/a/g,MC=/a/g,PC=new CC(LC)!==LC,HC=NC.UNSUPPORTED_Y;if(hC("RegExp",dC&&(!PC||HC||RC||IC||wC((function(){return MC[xC]=!1,CC(LC)!=LC||CC(MC)==MC||"/a/i"!=CC(LC,"i")}))))){for(var DC=function(e,t){var r,n,o,a,i,s,c=this instanceof DC,l=gC(e),u=void 0===t,d=[],f=e;if(!c&&l&&u&&e.constructor===DC)return e;if((l||e instanceof DC)&&(e=e.source,u&&(t="flags"in f?f.flags:bC.call(f))),e=void 0===e?"":SC(e),t=void 0===t?"":SC(t),f=e,RC&&"dotAll"in LC&&(n=!!t&&t.indexOf("s")>-1)&&(t=t.replace(/s/g,"")),r=t,HC&&"sticky"in LC&&(o=!!t&&t.indexOf("y")>-1)&&(t=t.replace(/y/g,"")),IC&&(e=(a=function(e){for(var t,r=e.length,n=0,o="",a=[],i={},s=!1,c=!1,l=0,u="";n<=r;n++){if("\\"===(t=e.charAt(n)))t+=e.charAt(++n);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:kC.test(e.slice(n+1))&&(n+=2,c=!0),o+=t,l++;continue;case">"===t&&c:if(""===u||EC(i,u))throw new SyntaxError("Invalid capture group name");i[u]=!0,a.push([u,l]),c=!1,u="";continue}c?u+=t:o+=t}return[o,a]}(e))[0],d=a[1]),i=pC(CC(e,t),c?this:AC,DC),(n||o||d.length)&&(s=_C(i),n&&(s.dotAll=!0,s.raw=DC(function(e){for(var t,r=e.length,n=0,o="",a=!1;n<=r;n++)"\\"!==(t=e.charAt(n))?a||"."!==t?("["===t?a=!0:"]"===t&&(a=!1),o+=t):o+="[\\s\\S]":o+=t+e.charAt(++n);return o}(e),r)),o&&(s.sticky=!0),d.length&&(s.groups=d)),e!==f)try{vC(i,"source",""===f?"(?:)":f)}catch(e){}return i},FC=function(e){e in DC||yC(DC,e,{configurable:!0,get:function(){return CC[e]},set:function(t){CC[e]=t}})},jC=mC(CC),UC=0;jC.length>UC;)FC(jC[UC++]);AC.constructor=DC,DC.prototype=AC,TC(fC,"RegExp",DC)}OC("RegExp");var BC=Math.floor,YC=function(e,t){var r=e.length,n=BC(r/2);return r<8?VC(e,t):JC(YC(e.slice(0,n),t),YC(e.slice(n),t),t)},VC=function(e,t){for(var r,n,o=e.length,a=1;a<o;){for(n=a,r=e[a];n&&t(e[n-1],r)>0;)e[n]=e[--n];n!==a++&&(e[n]=r)}return e},JC=function(e,t,r){for(var n=e.length,o=t.length,a=0,i=0,s=[];a<n||i<o;)a<n&&i<o?s.push(r(e[a],t[i])<=0?e[a++]:t[i++]):s.push(a<n?e[a++]:t[i++]);return s},GC=YC,KC=Jd.match(/firefox\/(\d+)/i),qC=!!KC&&+KC[1],WC=/MSIE|Trident/.test(Jd),XC=Jd.match(/AppleWebKit\/(\d+)\./),QC=!!XC&&+XC[1],zC=sv,$C=lf,ZC=Nf,eA=Np,tA=Fm,rA=Sd,nA=GC,oA=gO,aA=qC,iA=WC,sA=zd,cA=QC,lA=[],uA=lA.sort,dA=rA((function(){lA.sort(void 0)})),fA=rA((function(){lA.sort(null)})),hA=oA("sort"),pA=!rA((function(){if(sA)return sA<70;if(!(aA&&aA>3)){if(iA)return!0;if(cA)return cA<603;var e,t,r,n,o="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)lA.push({k:t+n,v:r})}for(lA.sort((function(e,t){return t.v-e.v})),n=0;n<lA.length;n++)t=lA[n].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}}));zC({target:"Array",proto:!0,forced:dA||!fA||!hA||!pA},{sort:function(e){void 0!==e&&$C(e);var t=ZC(this);if(pA)return void 0===e?uA.call(t):uA.call(t,e);var r,n,o=[],a=eA(t);for(n=0;n<a;n++)n in t&&o.push(t[n]);for(r=(o=nA(o,function(e){return function(t,r){return void 0===r?-1:void 0===t?1:void 0!==e?+e(t,r)||0:tA(t)>tA(r)?1:-1}}(e))).length,n=0;n<r;)t[n]=o[n++];for(;n<a;)delete t[n++];return t}});var vA=sv,yA=yp,mA=fp,gA=Np,SA=Nf,bA=TS,NA=Mb,TA=Fb("splice"),wA=Math.max,EA=Math.min;vA({target:"Array",proto:!0,forced:!TA},{splice:function(e,t){var r,n,o,a,i,s,c=SA(this),l=gA(c),u=yA(e,l),d=arguments.length;if(0===d?r=n=0:1===d?(r=0,n=l-u):(r=d-2,n=EA(wA(mA(t),0),l-u)),l+r-n>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(o=bA(c,n),a=0;a<n;a++)(i=u+a)in c&&NA(o,a,c[i]);if(o.length=n,r<n){for(a=u;a<l-n;a++)s=a+r,(i=a+n)in c?c[s]=c[i]:delete c[s];for(a=l;a>l-n+r;a--)delete c[a-1]}else if(r>n)for(a=l-n;a>u;a--)s=a+r-1,(i=a+n-1)in c?c[s]=c[i]:delete c[s];for(a=0;a<r;a++)c[a+u]=arguments[a+2];return c.length=l-n+r,o}});var _A=function(){function e(){if(id(this,e),ld(this,"minimumRankSort",null),ld(this,"requireExtantDDbRecords",!1),ld(this,"skipJunk",!0),!BO.rawTaxa&&(BO.rawTaxa=BsbiDb.TaxonNames,!BO.rawTaxa))throw new Error("Taxon list has failed to load in TaxonSearch")}return cd(e,[{key:"lookup",value:function(t){var r,n,o,a,i={};if(n=e.normaliseTaxonName(decodeURIComponent(t).trim()).replace(/\s+x$/i,""),a=/ x\b/.test(n),""!==n){var s=n.match(e.abbreviatedGenusRegex);if(s){var c,l;for(var u in"X"===s[2]||"x"===s[2]?l=c=new RegExp("^(X\\s|X[a-z]+\\s+)(x )?\\b".concat(e.generate_hybrid_combinations_regex(s[3]),".*"),"i"):(c=new RegExp("^(X )?".concat(e.escapeRegExp(s[2]),"[a-z]+ (x )?.*\\b").concat(e.generate_hybrid_combinations_regex(s[3]),".*"),"i"),l=new RegExp("^(X )?".concat(e.escapeRegExp(s[2]),"[a-z]+ (x )?\\b").concat(e.generate_hybrid_combinations_regex(s[3]),".*"),"i")),BO.rawTaxa){var d=BO.rawTaxa[u];o=0===d[e.canonicalColumn]?d[e.nameStringColumn]:d[e.canonicalColumn],(c.test(o)||""!==d[e.hybridCanonicalColumn]&&c.test(d[e.hybridCanonicalColumn]))&&(i[u]={exact:d[e.nameStringColumn]===n,near:l.test(d[e.nameStringColumn])})}r=this.compile_results(i,a)}else{var f,h,p=e.escapeRegExp(n);-1!==n.indexOf(" ")?(f="".concat(e.escapeRegExp(n.substr(0,n.indexOf(" ")))," (x )?.*\\b").concat(e.generate_hybrid_combinations_regex(n.substr(n.indexOf(" ")+1)),".*"),h=new RegExp("^(?:Xs+)?".concat(e.escapeRegExp(n.substr(0,n.indexOf(" ")))," (x )?\\b").concat(e.generate_hybrid_combinations_regex(n.substr(n.indexOf(" ")+1)),".*"),"i")):(f="".concat(p,".*"),h=new RegExp("^".concat(p,".*")));var v="^".concat(p,".*"),y=new RegExp("^(?:Xs+)?".concat(f),"i");if(e.showVernacular){var m=new RegExp(v,"i");for(var g in BO.rawTaxa){var S=BO.rawTaxa[g];o=0===S[e.canonicalColumn]?S[e.nameStringColumn]:S[e.canonicalColumn],y.test(S[e.nameStringColumn])||o!==S[e.nameStringColumn]&&y.test(o)?i[g]={exact:S[e.nameStringColumn]===n,near:h.test(S[e.nameStringColumn])||h.test(o)}:(m.test(S[e.vernacularColumn])||m.test(S[e.vernacularRootColumn]))&&(i[g]={exact:S[e.vernacularColumn]===n,vernacular:!0})}if((r=this.compile_results(i,a)).length<5){var b=new RegExp("\\b".concat(p,".*"),"i");for(var N in BO.rawTaxa)if(!i.hasOwnProperty(N)){var T=BO.rawTaxa[N];b.test(T[e.nameStringColumn])?i[N]={exact:T[e.nameStringColumn]===n}:(0!==T[e.canonicalColumn]&&b.test(T[e.canonicalColumn])||b.test(T[e.vernacularColumn]))&&(i[N]={exact:T[e.nameStringColumn]===n,vernacular:!0})}r=this.compile_results(i,a)}}else{for(var w in BO.rawTaxa){var E=BO.rawTaxa[w];o=0===E[e.canonicalColumn]?E[e.nameStringColumn]:E[e.canonicalColumn],(y.test(E[e.nameStringColumn])||o!==E[e.nameStringColumn]&&y.test(o))&&(i[w]={exact:E[e.nameStringColumn]===n})}r=this.compile_results(i,a)}}}else r=[];return r}},{key:"compile_results",value:function(t,r){var n=[];for(var o in t)if(t.hasOwnProperty(o)){var a=BO.rawTaxa[o];if((!this.requireExtantDDbRecords||this.requireExtantDDbRecords&&1===a[e.usedColumn])&&(!this.minimumRankSort||this.minimumRankSort>0&&a[e.minRankColumn]>=this.minimumRankSort)){var i=a[e.nameStringColumn]+(a[e.qualifierColumn]?" ".concat(a[e.qualifierColumn]):""),s={entityId:o,vernacular:a[e.vernacularColumn],qname:i,name:i,qualifier:a[e.qualifierColumn],authority:a[e.authorityColumn],uname:a[e.nameStringColumn],vernacularMatched:t[o].hasOwnProperty("vernacular"),exact:t[o].hasOwnProperty("exact")&&t[o].exact,near:t[o].hasOwnProperty("near")&&t[o].near};if(s.formatted=e.formatter(s),a[e.acceptedEntityIdColumn]){var c=BO.rawTaxa[a[e.acceptedEntityIdColumn]];if(!c)throw BO.rawTaxa?new Error("Failed to find taxon for accepted entity id ".concat(a[e.acceptedEntityIdColumn])):new Error("Taxon.rawTaxa set is undefined, when trying to find taxon for accepted entity id ".concat(a[e.acceptedEntityIdColumn]));s.acceptedEntityId=a[e.acceptedEntityIdColumn],s.acceptedNameString=c[e.nameStringColumn],s.acceptedQualifier=c[e.qualifierColumn],s.acceptedAuthority=c[e.authorityColumn]}n.push(s)}}return n.length&&(n.sort((function(e,t){if(e.exact)return t.exact?e.acceptedEntityId?1:0:-1;if(t.exact)return 1;if(e.near){if(!t.near)return-1}else if(t.near)return 1;var n=null!==e.uname.match(/\bx\b/i),o=null!==t.uname.match(/\bx\b/i);if(n)return o?e.uname===t.uname?e.acceptedEntityId?1:0:e.qname<t.qname?-1:1:r?-1:1;if(o)return r?1:-1;if(e.uname===t.uname){if(!e.acceptedEntityId&&!t.acceptedEntityId||e.acceptedEntityId&&t.acceptedEntityId){var a=["s.s.","",null,"s.l.","agg."].indexOf(e.qualifier),i=["s.s.","",null,"s.l.","agg."].indexOf(t.qualifier);return a===i?0:a<i?1:-1}return e.acceptedEntityId?1:-1}return e.uname<t.uname?-1:1})),n.length>e.MAXIMUM_RESULTS&&(n.length=e.MAXIMUM_RESULTS)),n}}],[{key:"formatter",value:function(t){return e.showVernacular?t.vernacularMatched?t.acceptedEntityId?"<q><b>".concat(t.vernacular,'</b></q> <span class="italictaxon">').concat(t.uname).concat(t.qualifier?" <b>".concat(t.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.authority,"</span>")+' = <span class="italictaxon">'.concat(t.acceptedNameString).concat(t.acceptedQualifier?" <b>".concat(t.acceptedQualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.acceptedAuthority,"</span>"):"<q><b>".concat(t.vernacular,'</b></q> <span class="italictaxon">').concat(t.uname).concat(t.qualifier?" <b>".concat(t.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.authority,"</span>"):t.acceptedEntityId?'<span class="italictaxon">'.concat(t.uname).concat(t.qualifier?" <b>".concat(t.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.authority,"</span>").concat(t.vernacular?" <q><b>".concat(t.vernacular,"</b></q>"):"",' = <span class="italictaxon">').concat(t.acceptedNameString).concat(t.acceptedQualifier?" <b>".concat(t.acceptedQualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.acceptedAuthority,"</span>"):'<span class="italictaxon">'.concat(t.uname).concat(t.qualifier?" <b>".concat(t.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.authority,"</span>").concat(t.vernacular?" <q><b>".concat(t.vernacular,"</b></q>"):""):t.acceptedEntityId?'<span class="italictaxon">'.concat(t.uname).concat(t.qualifier?" <b>".concat(t.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.authority,"</span>")+' = <span class="italictaxon">'.concat(t.acceptedNameString).concat(t.acceptedQualifier?" <b>".concat(t.acceptedQualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.acceptedAuthority,"</span>"):'<span class="italictaxon">'.concat(t.uname).concat(t.qualifier?" <b>".concat(t.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.authority,"</span>")}},{key:"normaliseTaxonName",value:function(t){for(var r=0,n=e.taxonRankNameSearchRegex.length;r<n;r++)t=t.replace(e.taxonRankNameSearchRegex[r],e.taxonRankNameReplacement[r]);for(var o=0,a=e.taxonQualifierSearchRegex.length;o<a;o++)t=t.replace(e.taxonQualifierSearchRegex[o],e.taxonQualifierReplacement[o]);return t}},{key:"escapeRegExp",value:function(t){return t.replace(e.cleanRegex,"\\$&")}},{key:"generate_hybrid_combinations_regex",value:function(t){var r=e.escapeRegExp(t).split(/\s+x\s+/i);if(r.length<2)return r[0];var n=[];return function e(t,r){if(0===t.length)n[n.length]=r.join("[a-zA-Z]* x ");else for(var o=t.length-1;o>=0;--o){var a=t.slice(0),i=r.slice(0);i.unshift(a.splice(o,1)[0]),e(a,i)}}(r,[]),"(?:".concat(n.join("|"),")")}}]),e}();ld(_A,"showVernacular",!0),ld(_A,"MIN_SEARCH_LENGTH",2),ld(_A,"MAXIMUM_RESULTS",25),ld(_A,"abbreviatedGenusRegex",/^(X\s+)?([a-z])[.\s]+(.*?)$/i),ld(_A,"nameStringColumn",0),ld(_A,"canonicalColumn",1),ld(_A,"hybridCanonicalColumn",2),ld(_A,"acceptedEntityIdColumn",3),ld(_A,"qualifierColumn",4),ld(_A,"authorityColumn",5),ld(_A,"vernacularColumn",6),ld(_A,"vernacularRootColumn",7),ld(_A,"usedColumn",8),ld(_A,"minRankColumn",9),ld(_A,"taxonRankNameSearchRegex",[/\s+sub-?g(?:en(?:us)?)?[.\s]+/i,/\s+sect(?:ion)?[.\s]+/i,/\s+subsect(?:ion)?[.\s]+/i,/\s+ser(?:ies)?[.\s]+/i,/\s+gp[.\s]+/i,/\s+s(?:ub)?-?sp(?:ecies)?[.\s]+/i,/\s+morphotype\s+/i,/\s+var[.\s]+/i,/\s+cv[.\s]+/i,/\s+n(?:otho)?v(?:ar)?[.\s]+/i,/\s+f[.\s]+|\s+forma?\s+/i,/\s+n(?:otho)?ssp[.\s]+/i]),ld(_A,"taxonRankNameReplacement",[" subg. "," sect. "," subsect. "," ser. "," group "," subsp. "," morph. "," var. "," cv. "," nothovar. "," f. "," nothosubsp. "]),ld(_A,"cleanRankNamesRegex",/\s(subfam\.|subg\.|sect\.|subsect\.|ser\.|subser\.|subsp\.|nothosubsp\.|microsp\.|praesp\.|agsp\.|race|convar\.|nm\.|microgene|f\.|subvar\.|var\.|nothovar\.|cv\.|sublusus|taxon|morph\.|group|sp\.)\s/),ld(_A,"taxonQualifierSearchRegex",[/\s*\(?\bf\s*x\s*m or m\s*x\s*f\)?\s*$/i,/\s*\(?\bm\s*x\s*f or f\s*x\s*m\)?\s*$/i,/\s*\(?\bf\s*x\s*m\)?\s*$/i,/\s*\(?\bm\s*x\s*f\)?\s*$/i,/\s*\(?\bfemale\s*x\s*male\)?\s*$/i,/\s*\(?\bmale\s*x\s*female\)?\s*$/i,/\s*'male'\s*$/i,/\s*'female'\s*$/i,/\b\s*sens\.?\s*lat[.\s]+/i,/\b\s*s\.\s*lat\.?\s*\b/i,/\b\s*s\.?\s*l\.?\s+\b/i,/\b\s*sensu\s*lato\s+\b|\(\s*sensu\s*lato\s*\)/i,/\b\s*sensu\s*stricto\s+\b|\(\s*sensu\s*stricto\s*\)/i,/\b\s*sens\.?\s*strict[.\s]+/i,/\b\s*sens\.?\s*str\.?\s*(?=\))|\b\s*sens\.?\s*str[.\s]+/i,/\b\s*s\.\s*str[.\s]+/i,/\b\s*s\.?\s*s\.?\s+\b/i,/\b\s*sens\.?\s*lat\.?\s*$/i,/\b\s*s\.\s*lat\.?\s*$/i,/\b\s*s\.?\s*l\.?\s*$/i,/\b\s*sensu\s*lato\s*$/i,/\b\s*sensu\s*stricto\s*$/i,/\b\s*sens\.?\s*strict\.?\s*$/i,/\b\s*sens\.?\s*str\.?\s*$/i,/\b\s*s\.\s*str\.?\s*$/i,/\b\s*s\.?\s*s\.?\s*$/i,/\b\s*agg\.?\s*$/i,/\b\s*aggregate\s*$/i,/\b\s*sp\.?\s*cultivar\s*$/i,/\b\s*sp\.?\s*cv\.?\s*$/i,/\b\s*cultivars?\s*$/i,/\b\s*cv\s+$/i,/\b\s*cv$/i,/\b\s*cf\s*$/i,/\b\s*aff\s*$/i,/\b\s*s\.?n\.?\s*$/i,/\b\s*sp\.?\s*nov\.?\s*$/i,/\b\s*auct[.\s]*$/i,/\b\s*ined[.\s]*$/i,/\b\s*nom\.?\snud[.\s]*$/i,/\b\s*p\.p[.\s?]*$/i,/\b\s*spp?\.?[\s?]*$/i,/\b\s*species\s*$/i,/\b\s*spp?\.?\s*\(/i,/\b\s*species\s*\(/i]),ld(_A,"taxonQualifierReplacement",[" "," "," (f x m)"," (m x f)"," (f x m)"," (m x f)"," male"," female"," s.l. "," s.l. "," s.l. "," s.l. "," s.s. "," s.s. "," s.s. "," s.s. "," s.s. "," s.l."," s.l."," s.l."," s.l."," s.s."," s.s."," s.s."," s.s."," s.s."," agg."," agg."," cv. "," cv. "," cv. "," cv. "," cv. "," cf."," aff."," sp.nov."," sp.nov."," auct."," ined."," nom. nud."," pro parte","",""," ("," ("]),ld(_A,"cleanRegex",/[.*+?^${}()|[\]\\]/g);var OA=function(){function e(){id(this,e)}return cd(e,null,[{key:"taxaLoadedEntryPoint",value:function(){for(BO.rawTaxa=BsbiDb.TaxonNames;e.callbackStack.length;){var t=e.callbackStack.shift();try{t()}catch(t){console.log({"Exception after taxon load":t})}}}},{key:"onceTaxaLoaded",value:function(){return BsbiDb.hasOwnProperty("TaxonNames")?Promise.resolve():(BsbiDb.taxonNamesLoadedEntryPoint||(BsbiDb.taxonNamesLoadedEntryPoint=e.taxaLoadedEntryPoint),new Promise((function(t){e.callbackStack.push(t)})))}}]),e}();function RA(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}ld(OA,"callbackStack",[]),sv({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}});var IA=new WeakMap,xA=new WeakMap;function CA(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return AA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?AA(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function AA(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kA(e,t){MA(e,t),t.add(e)}function LA(e,t,r){MA(e,t),t.set(e,r)}function MA(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PA(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}!function(e){yy(r,rR);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(e){var n;return id(this,r),RA(py(n=t.call(this,e)),IA,{writable:!0,value:void 0}),RA(py(n),xA,{writable:!0,value:void 0}),ld(py(n),"_value",""),ld(py(n),"_inputType","date"),ld(py(n),"_autocomplete",""),n._value=(new Date).toJSON().slice(0,10),e&&(e.placeholder&&(n.placeholder=e.placeholder),e.autocomplete&&(n._autocomplete=e.autocomplete)),n}cd(r,[{key:"value",get:function(){return this._value},set:function(e){this._value=void 0===e||null==e?(new Date).toJSON().slice(0,10):e.trim(),this.updateView()}},{key:"updateView",value:function(){this._fieldEl&&(document.getElementById(Ty(this,IA)).value=rR.cleanRawString(this._value))}},{key:"buildField",value:function(){var e=document.createElement("div");e.className="form-group",Ny(this,xA,e.id=rR.nextId),Ny(this,IA,rR.nextId);var t=e.appendChild(document.createElement("label"));t.htmlFor=Ty(this,IA),t.textContent=this.label;var r=e.appendChild(document.createElement("input"));r.className="form-control",r.id=Ty(this,IA);try{r.type=this._inputType}catch(e){console.log("Failed to set type '".concat(this._inputType,"'"))}if(this.placeholder&&(r.placeholder=this.placeholder),this._autocomplete&&(r.autocomplete=this._autocomplete,"off"===this._autocomplete&&(r.name=HO())),this.completion===rR.COMPLETION_COMPULSORY&&(r.required=!0),this.validationMessage){var n=e.appendChild(document.createElement("div"));n.className="invalid-feedback",n.innerHTML=this.validationMessage}this.helpText&&(e.appendChild(document.createElement("small")).innerHTML=this.helpText),r.addEventListener("change",this.inputChangeHandler.bind(this)),this._fieldEl=e}},{key:"markValidity",value:function(e){var t=document.getElementById(Ty(this,IA));null===e?t.classList.remove("is-invalid","is-valid"):(t.classList.remove(e?"is-invalid":"is-valid"),t.classList.add(e?"is-valid":"is-invalid"))}},{key:"inputChangeHandler",value:function(e){e.stopPropagation(),console.log("got date field change event"),this.value=rR.cleanRawString(document.getElementById(Ty(this,IA)).value),this.fireEvent(rR.EVENT_CHANGE)}}],[{key:"summariseImpl",value:function(e,t,r){return""!==r[e]&&null!==r[e]&&void 0!==r[e]?UO(r[e].trim()):""}}])}(),vS("WeakSet",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),qS);var HA="imagemodal",DA="imagemodaldelete",FA=new WeakMap,jA=new WeakMap,UA=new WeakMap,BA=new WeakSet,YA=new WeakSet,VA=function(e){yy(r,rR);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(e){var n;return id(this,r),kA(py(n=t.call(this,e)),YA),kA(py(n),BA),LA(py(n),FA,{writable:!0,value:void 0}),LA(py(n),jA,{writable:!0,value:void 0}),LA(py(n),UA,{writable:!0,value:void 0}),ld(py(n),"parentForm",void 0),ld(py(n),"_value",{images:[]}),ld(py(n),"includeCamera",!0),ld(py(n),"placeholder",""),e&&(e.hasOwnProperty("includeCamera")&&(n.includeCamera=e.includeCamera),e.placeholder&&(n.placeholder=e.placeholder)),n}return cd(r,[{key:"value",get:function(){var e=[];if(this._value&&this._value.images){var t,r=CA(this._value.images);try{for(r.s();!(t=r.n()).done;){var n=t.value;e[e.length]=n.id}}catch(e){r.e(e)}finally{r.f()}}return e},set:function(e){if(this._value={images:[]},e){var t,r=CA(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;fx.imageCache.has(n)?this._value.images.push(fx.imageCache.get(n)):(console.log("Creating placeholder image object '".concat(n,"'")),this._value.images.push(fx.placeholder(n)))}}catch(e){r.e(e)}finally{r.f()}}this.updateView()}},{key:"updateView",value:function(){if(this._fieldEl){var e,t=[],r=CA(this._value.images);try{for(r.s();!(e=r.n()).done;){var n=e.value;t.push('<picture style="cursor: pointer;" data-imageid="'.concat(n.id,'"><source srcset="/image.php?imageid=').concat(n.id,'&amp;height=128&amp;format=webp" type="image/webp"><img data-imageid="').concat(n.id,'" src="/image.php?imageid=').concat(n.id,'&amp;height=128&amp;format=jpeg" height="128" alt="photo"></picture>'))}}catch(e){r.e(e)}finally{r.f()}document.getElementById(Ty(this,UA)).innerHTML=t.join("\n")}}},{key:"buildField",value:function(){var e=document.createElement("div");e.className="form-group",Ny(this,jA,e.id=rR.nextId),Ny(this,FA,rR.nextId);var t=e.appendChild(document.createElement("label"));t.htmlFor=Ty(this,FA),t.textContent=this.label;var r=e.appendChild(document.createElement("div"));r.className="input-group";var n=document.createElement("div");n.className="custom-file",r.appendChild(n);var o=n.appendChild(document.createElement("input"));if(o.type="file",o.className="custom-file-input",o.id=Ty(this,FA),o.accept=".jpeg, .jpg, image/png, image/jpeg",o.multiple=!0,this.placeholder){var a=n.appendChild(document.createElement("label"));a.className="custom-file-label",a.htmlFor=Ty(this,FA),a.textContent=this.placeholder}if(this.includeCamera){var i=document.createElement("div");i.className="input-group-append";var s=i.appendChild(document.createElement("span"));s.className="input-group-text";var c=s.appendChild(document.createElement("label"));c.className="pl-0 pr-0 ml-0 mr-0 mt-0 mb-0 pt-0 pb-0 material-icons";var l=c.appendChild(document.createElement("i"));l.className="material-icons pl-0 pr-0 ml-0 mr-0 mt-0 mb-0 pt-0 pb-0",l.textContent="add_a_photo";var u=c.appendChild(document.createElement("input"));u.type="file",u.capture="environment",u.accept="image/*",u.style.display="none",u.id=rR.nextId,r.appendChild(i),u.addEventListener("change",this.inputChangeHandler.bind(this,u.id))}this.helpText&&(e.appendChild(document.createElement("small")).innerHTML=this.helpText);var d=e.appendChild(document.createElement("p"));if(Ny(this,UA,d.id=rR.nextId),d.addEventListener("click",this.imageClickHandler.bind(this)),this.validationMessage){var f=e.appendChild(document.createElement("div"));f.className="invalid-feedback",f.innerHTML=this.validationMessage}o.addEventListener("change",this.inputChangeHandler.bind(this,o.id)),this._fieldEl=e,this.parentForm.addListener("deleteimage",this.deleteImageHandler.bind(this))}},{key:"deleteImageHandler",value:function(e){var t;for(var r in console.log("delete image ".concat(e.imageId)),this._value.images)if(this._value.images.hasOwnProperty(r)&&this._value.images[r].id===e.imageId){t=this._value.images.splice(r,1)[0];break}t?(this.updateView(),this.fireEvent(rR.EVENT_CHANGE)):console.log("Failed to find image id ".concat(e.imageId))}},{key:"imageClickHandler",value:function(e){var t=e.target.closest("picture");t||(t=e.target.closest("img")),console.log({"clicked image":t});var r=t.getAttribute("data-imageid");r&&(document.getElementById("imagemodal").getElementsByTagName("picture")[0].innerHTML='<source srcset="/image.php?imageid='.concat(r,"&amp;width=").concat(window.innerWidth,'&amp;format=webp" type="image/webp">\n                <img src="/image.php?imageid=').concat(r,"&amp;width=").concat(window.innerWidth,'&amp;format=jpeg" width="auto" style="max-height: 48vh; max-width: 100%;" alt="photo">'),document.getElementById("imagemodaldelete").setAttribute("data-imageid",r),$("#".concat("imagemodal")).modal({}))}},{key:"inputChangeHandler",value:function(e,t){var r=this;t.stopPropagation(),console.log("got image field input change event");var n=document.getElementById(e);n.files.length?PA(this,BA,JA).call(this,n.files).then((function(){r.fireEvent(rR.EVENT_CHANGE)})):this.fireEvent(rR.EVENT_CHANGE)}}],[{key:"isEmpty",value:function(e){return!e||0===e.length}},{key:"licenseModal",value:function(){var e=document.createElement("div");return e.innerHTML='<div class="modal fade" id="'.concat(r.LICENSE_MODAL,'" tabindex="-1" role="dialog" aria-labelledby="').concat(r.LICENSE_MODAL,'Title" aria-hidden="true">\n  <div class="modal-dialog modal-dialog-centered" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title" id="').concat(r.LICENSE_MODAL,'Title">Image licensing</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body">\n        <p>By choosing to submit images with your Garden Wildflower Hunt records you agree to license the image under the terms of the Creative Common Attribution 4.0 International license (CC BY 4.0).</p>\n        <p>The following is a summary of (and not a substitute for) the <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">license</a>.</p>\n        <p>Licensees are free to:</p>\n        <ul class="license-properties">\n<li>\n<strong>Share</strong> â copy and redistribute the material in any medium or format\n</li>\n<li>\n<strong>Adapt</strong> â remix, transform, and build upon the material for any purpose, even commercially.\n</li>\n</ul>\n<p>Licensees are most follow these term:</p>\n<ul>\n<li>\n<p>\n<strong>Attribution</strong> â licensees must give appropriate credit, provide a link to the license, and indicate if changes were made.\n</p>\n</li>\n</ul>\n<p>Full details of the license are here: <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0 license</a></p>\n\n      </div>\n      <div class="modal-footer">\n        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\n      </div>\n    </div>\n  </div>\n</div>'),e.firstChild}}]),r}();function JA(e){this.parentForm.pingOccurrence();var t,r=[],n=CA(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;r.push(fx.fromFile(o))}}catch(e){n.e(e)}finally{n.f()}return PA(this,YA,GA).call(this,r)}function GA(e){var t=this;if(e.length){var r=e.shift();return r.save(this.parentForm.surveyId,this.parentForm.occurrenceId,this.parentForm.projectId).then((function(e){console.log("Added image '".concat(r.id,"'")),console.log({jsonDescription:e}),t._value.images.push(r),t.updateView()}),(function(e){console.log("Failed to add image ".concat(r.id)),console.log({"Failure reason":e})})).finally((function(){return PA(t,YA,GA).call(t,e)}))}return Promise.resolve()}function KA(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}ld(VA,"LICENSE_MODAL","imagelicensemodal");var qA=new WeakMap,WA=new WeakMap,XA=function(e){yy(r,rR);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(e){var n;return id(this,r),KA(py(n=t.call(this,e)),qA,{writable:!0,value:void 0}),KA(py(n),WA,{writable:!0,value:void 0}),ld(py(n),"_value",""),ld(py(n),"_inputType","text"),ld(py(n),"_autocomplete",""),e&&(e.type&&(n._inputType=e.type),e.placeholder&&(n.placeholder=e.placeholder),e.autocomplete&&(n._autocomplete=e.autocomplete)),n}return cd(r,[{key:"value",get:function(){return this._value},set:function(e){this._value=void 0===e||null==e?"":e.trim(),this.updateView()}},{key:"updateView",value:function(){this._fieldEl&&(document.getElementById(Ty(this,qA)).value=rR.cleanRawString(this._value))}},{key:"buildField",value:function(){var e=document.createElement("div");e.className="form-group",Ny(this,WA,e.id=rR.nextId),Ny(this,qA,rR.nextId);var t=e.appendChild(document.createElement("label"));t.htmlFor=Ty(this,qA),t.textContent=this.label;var r=e.appendChild(document.createElement("input"));r.className="form-control",r.id=Ty(this,qA);try{r.type=this._inputType}catch(e){console.log("Failed to set type '".concat(this._inputType,"'"))}if(this.placeholder&&(r.placeholder=this.placeholder),this._autocomplete&&(r.autocomplete=this._autocomplete,"off"===this._autocomplete&&(r.name=HO())),this.completion===rR.COMPLETION_COMPULSORY&&(r.required=!0),this.validationMessage){var n=e.appendChild(document.createElement("div"));n.className="invalid-feedback",n.innerHTML=this.validationMessage}this.helpText&&(e.appendChild(document.createElement("small")).innerHTML=this.helpText),r.addEventListener("change",this.inputChangeHandler.bind(this)),this._fieldEl=e}},{key:"markValidity",value:function(e){var t=document.getElementById(Ty(this,qA));null===e?t.classList.remove("is-invalid","is-valid"):(t.classList.remove(e?"is-invalid":"is-valid"),t.classList.add(e?"is-valid":"is-invalid"))}},{key:"inputChangeHandler",value:function(e){e.stopPropagation(),console.log("got input field change event"),this.value=rR.cleanRawString(document.getElementById(Ty(this,qA)).value),this.fireEvent(rR.EVENT_CHANGE)}}],[{key:"summariseImpl",value:function(e,t,r){return""!==r[e]&&null!==r[e]&&void 0!==r[e]?UO(r[e].trim()):""}}]),r}();function QA(e,t,r){if(r.length>2){var n=r.pop();return"".concat(r.join(e+" ")," ").concat(t," ").concat(n)}return r.join(" ".concat(t," "))}function zA(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return $A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$A(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function $A(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZA(e,t,r){ek(e,t),t.set(e,r)}function ek(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tk(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function rk(e,t,r){return function(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}(e,t),function(e,t){if(void 0===e)throw new TypeError("attempted to get private static field before its declaration")}(r),function(e,t){return t.get?t.get.call(e):t.value}(e,r)}var nk=new WeakMap,ok=new WeakMap,ak=new WeakSet,ik=function(e){yy(r,rR);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(e){var n,o,a;return id(this,r),ek(o=py(n=t.call(this,e)),a=ak),a.add(o),ZA(py(n),nk,{writable:!0,value:void 0}),ZA(py(n),ok,{writable:!0,value:void 0}),ld(py(n),"options",{}),ld(py(n),"includeOtherFreeText",!0),ld(py(n),"_value",{selection:[],other:null}),e&&(e.options&&(n.options=e.options),e.hasOwnProperty("includeOtherFreeText")&&(n.includeOtherFreeText=e.includeOtherFreeText)),n}return cd(r,[{key:"value",get:function(){return this._value},set:function(e){this._value=e||{selection:[],other:null},this.updateView()}},{key:"updateView",value:function(){if(this._fieldEl){var e,t=zA(document.querySelectorAll("".concat(rk(r,r,ck),"#").concat(Ty(this,nk),' input[type="checkbox"]')));try{for(t.s();!(e=t.n()).done;){var n=e.value,o=n.checked=this._value.selection.includes(n.name);if(n.name===r.KEY_OTHER&&Ty(this,ok)){var a=document.getElementById(Ty(this,ok));a.style.display=o?"block":"none",a.value=null===this._value.other?"":this._value.other.trim()}}}catch(e){t.e(e)}finally{t.f()}}}},{key:"buildField",value:function(){if(!this.options)throw new Error("Options have not been set before call to buildField()");var e=document.createElement(rk(r,r,ck));e.className="form-group",Ny(this,nk,e.id=rR.nextId);var t=e.appendChild(document.createElement("label"));for(var n in t.style.display="block",t.textContent=this.label,this.helpText&&(e.appendChild(document.createElement("small")).innerHTML=this.helpText),this.options)this.options.hasOwnProperty(n)&&tk(this,ak,sk).call(this,e,n,this.options[n]);if(this.validationMessage){var o=e.appendChild(document.createElement("div"));o.className="invalid-feedback",o.innerHTML=this.validationMessage}e.addEventListener("change",this.inputChangeHandler.bind(this)),this._fieldEl=e}},{key:"inputChangeHandler",value:function(e){e.stopPropagation();var t,n={selection:[],other:null};Ty(this,ok)&&(t=document.getElementById(Ty(this,ok)));var o,a=zA(document.querySelectorAll("".concat(rk(r,r,ck),"#").concat(Ty(this,nk),' input[type="checkbox"]:checked')));try{for(a.s();!(o=a.n()).done;){var i=o.value;n.selection[n.selection.length]=i.name,i.name===r.KEY_OTHER&&Ty(this,ok)&&(n.other=rR.cleanRawInput(t))}}catch(e){a.e(e)}finally{a.f()}this.value=n,this.fireEvent(rR.EVENT_CHANGE)}}],[{key:"summariseImpl",value:function(e,t,r){var n=t.summary,o=[];if(r[e].selection.length){var a,i=zA(r[e].selection);try{for(i.s();!(a=i.n()).done;){var s=a.value;"other"===s&&r[e].other?o[o.length]="".concat(t.attributes.options[s].summary||t.attributes.options[s].label," (").concat(r[e].other,")"):o[o.length]=t.attributes.options[s].summary||t.attributes.options[s].label}}catch(e){i.e(e)}finally{i.f()}return UO("".concat(n.summaryPrefix," ").concat(QA(",","or",o)))}return""}}]),r}();function sk(e,t,r){var n=e.appendChild(document.createElement("div"));n.className="form-check";var o=n.appendChild(document.createElement("input"));o.type="checkbox",o.className="form-check-input",o.id=rR.nextId,o.name=t;var a=n.appendChild(document.createElement("label"));if(a.htmlFor=o.id,a.className="form-check-label",a.textContent=r.label,ik.KEY_OTHER===t&&this.includeOtherFreeText){var i=n.appendChild(document.createElement("input"));i.id=Ny(this,ok,rR.nextId),i.className="form-control",i.style.display="none"}}ld(ik,"KEY_OTHER","other");var ck={writable:!0,value:"fieldset"};function lk(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return uk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?uk(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function uk(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dk(e,t,r){fk(e,t),t.set(e,r)}function fk(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hk(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var pk=new WeakMap,vk=new WeakMap,yk=new WeakMap,mk=new WeakSet,gk=function(e){yy(r,rR);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(e){var n,o,a;return id(this,r),fk(o=py(n=t.call(this,e)),a=mk),a.add(o),dk(py(n),pk,{writable:!0,value:void 0}),dk(py(n),vk,{writable:!0,value:void 0}),dk(py(n),yk,{writable:!0,value:void 0}),ld(py(n),"options",{}),ld(py(n),"placeholder",""),ld(py(n),"includeOtherFreeText",!0),ld(py(n),"_value",{selection:[],other:null}),e&&(e.options&&(n.options=e.options),e.hasOwnProperty("includeOtherFreeText")&&(n.includeOtherFreeText=e.includeOtherFreeText),e.placeholder&&(n.placeholder=e.placeholder)),n}return cd(r,[{key:"value",get:function(){return this._value},set:function(e){this._value=e||{selection:[],other:null},this.updateView()}},{key:"markValidity",value:function(e){var t=document.getElementById(Ty(this,vk));null===e?t.classList.remove("is-invalid","is-valid"):(t.classList.remove(e?"is-invalid":"is-valid"),t.classList.add(e?"is-valid":"is-invalid"))}},{key:"updateView",value:function(){if(this._fieldEl){var e,t=lk(document.querySelectorAll("select#".concat(Ty(this,vk)," option")));try{for(t.s();!(e=t.n()).done;){var r=e.value;if(""!==r.value){var n=r.selected=this._value.selection.includes(r.value);if(r.value===ik.KEY_OTHER&&Ty(this,yk)){var o=document.getElementById(Ty(this,yk));o.style.display=n?"block":"none",o.value=null===this._value.other?"":this._value.other.trim()}}else r.selected=0===this._value.selection.length}}catch(e){t.e(e)}finally{t.f()}}}},{key:"buildField",value:function(){if(!this.options)throw new Error("Options have not been set before call to buildField()");var e=document.createElement(function(e,t,r){return function(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}(e,t),function(e,t){if(void 0===e)throw new TypeError("attempted to get private static field before its declaration")}(r),function(e,t){return t.get?t.get.call(e):t.value}(e,r)}(r,r,bk));e.className="form-group",Ny(this,pk,e.id=rR.nextId),Ny(this,vk,rR.nextId);var t=e.appendChild(document.createElement("label"));t.htmlFor=Ty(this,vk),t.style.display="block",t.innerHTML=this.label;var n=document.createElement("select");for(var o in n.id=Ty(this,vk),n.className="custom-select",this.helpText&&(e.appendChild(document.createElement("small")).innerHTML=this.helpText),this.placeholder&&hk(this,mk,Sk).call(this,e,n,"",{label:this.placeholder}),this.options)this.options.hasOwnProperty(o)&&hk(this,mk,Sk).call(this,e,n,o,this.options[o]);if(e.appendChild(n),this.validationMessage){var a=e.appendChild(document.createElement("div"));a.className="invalid-feedback",a.innerHTML=this.validationMessage}e.addEventListener("change",this.inputChangeHandler.bind(this)),this._fieldEl=e}},{key:"inputChangeHandler",value:function(e){e.stopPropagation();var t,r={selection:[],other:null};Ty(this,yk)&&(t=document.getElementById(Ty(this,yk)));var n,o=lk(document.querySelectorAll("select#".concat(Ty(this,vk)," option:checked")));try{for(o.s();!(n=o.n()).done;){var a=n.value;""!==a.value&&(r.selection[r.selection.length]=a.value,a.name===ik.KEY_OTHER&&Ty(this,yk)&&(r.other=rR.cleanRawInput(t)))}}catch(e){o.e(e)}finally{o.f()}this.value=r,this.fireEvent(rR.EVENT_CHANGE)}}],[{key:"isEmpty",value:function(e){return 0===e.selection.length||""===e.selection[0]}},{key:"summariseImpl",value:function(e,t,r){var n=t.summary,o=[];if(r[e].selection.length){var a,i=lk(r[e].selection);try{for(i.s();!(a=i.n()).done;){var s=a.value;"other"===s&&r[e].other?o[o.length]="".concat(t.attributes.options[s].summary||t.attributes.options[s].label," (").concat(r[e].other,")"):o[o.length]=t.attributes.options[s].summary||t.attributes.options[s].label}}catch(e){i.e(e)}finally{i.f()}return UO("".concat(n.summaryPrefix," ").concat(QA(",","or",o)))}return""}}]),r}();function Sk(e,t,r,n){var o=t.appendChild(document.createElement("option"));if(o.value=r,o.innerText=n.label,ik.KEY_OTHER===r&&this.includeOtherFreeText){var a=e.appendChild(document.createElement("input"));a.id=Ny(this,yk,rR.nextId),a.className="form-control"}}var bk={writable:!0,value:"fieldset"},Nk=sv,Tk=WO.start,wk=$O("trimStart"),Ek=wk?function(){return Tk(this)}:"".trimStart;Nk({target:"String",proto:!0,name:"trimStart",forced:wk},{trimStart:Ek,trimLeft:Ek});var _k=sv,Ok=CS.find,Rk=Cy,Ik=!0;function xk(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ck(e,t,r){Ak(e,t),t.set(e,r)}function Ak(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kk(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}"find"in[]&&Array(1).find((function(){Ik=!1})),_k({target:"Array",proto:!0,forced:Ik},{find:function(e){return Ok(this,e,arguments.length>1?arguments[1]:void 0)}}),Rk("find");var Lk=new WeakMap,Mk=new WeakMap,Pk=new WeakMap,Hk=new WeakMap,Dk=new WeakMap,Fk=new WeakMap,jk=new WeakMap,Uk=new WeakMap,Bk=new WeakSet,Yk=function(e){yy(r,rR);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(e){var n,o,a;return id(this,r),Ak(o=py(n=t.call(this,e)),a=Bk),a.add(o),ld(py(n),"taxonSearch",void 0),Ck(py(n),Lk,{writable:!0,value:void 0}),Ck(py(n),Mk,{writable:!0,value:void 0}),Ck(py(n),Pk,{writable:!0,value:void 0}),Ck(py(n),Hk,{writable:!0,value:void 0}),Ck(py(n),Dk,{writable:!0,value:null}),Ck(py(n),Fk,{writable:!0,value:null}),Ck(py(n),jk,{writable:!0,value:null}),ld(py(n),"_lastInputValue",""),Ck(py(n),Uk,{writable:!0,value:[]}),ld(py(n),"_value",{taxonId:"",taxonName:"",vernacularMatch:!1}),n.taxonSearch=new _A,n}return cd(r,[{key:"value",get:function(){return this._value},set:function(e){var t;e&&e.taxonId?(t=BO.fromId(e.taxonId),this._value={taxonId:t.id,taxonName:e.vernacularMatch?t.vernacular:t.nameString,vernacularMatch:e.vernacularMatch}):this._value={taxonId:"",taxonName:e&&e.taxonName?e.taxonName:"",vernacularMatch:null},this.updateView()}},{key:"updateView",value:function(){this._fieldEl&&(document.getElementById(Ty(this,Lk)).value=this._value.taxonName,this._lastInputValue=this._value.taxonName)}},{key:"markValidity",value:function(e){var t=document.getElementById(Ty(this,Lk));null===e?t.classList.remove("is-invalid","is-valid"):(t.classList.remove(e?"is-invalid":"is-valid"),t.classList.add(e?"is-valid":"is-invalid"))}},{key:"buildField",value:function(){var e=document.createElement("div");e.className="form-group",Ny(this,Hk,e.id=rR.nextId),Ny(this,Lk,rR.nextId);var t=e.appendChild(document.createElement("label"));t.htmlFor=Ty(this,Lk),t.textContent=this.label;var r=e.appendChild(document.createElement("div"));r.className="dropdown-wrapper";var n=r.appendChild(document.createElement("input"));if(n.className="form-control dropdown-input",n.id=Ty(this,Lk),n.autocomplete="off",n.spellcheck=!1,this.validationMessage){var o=r.appendChild(document.createElement("div"));o.className="invalid-feedback",o.innerHTML=this.validationMessage}var a=r.appendChild(document.createElement("div"));a.className="dropdown-list",Ny(this,Mk,a.id=rR.nextId),Ny(this,Pk,rR.nextId),this.helpText&&(e.appendChild(document.createElement("small")).innerHTML=this.helpText),n.addEventListener("keydown",this.keydownHandler.bind(this)),n.addEventListener("input",this.inputHandler.bind(this)),n.addEventListener("change",this.inputChangeHandler.bind(this)),e.addEventListener("focusin",this.focusHandler.bind(this)),e.addEventListener("focusout",this.blurHandler.bind(this)),a.addEventListener("click",this.dropboxClickHandler.bind(this)),this._fieldEl=e}},{key:"keydownHandler",value:function(e){switch(this._lastInputValue=e.target.value.trimLeft(),e.key){case"Enter":case"ArrowUp":case"ArrowDown":e.preventDefault()}}},{key:"inputHandler",value:function(e){e.target.value.trimLeft()!==this._lastInputValue&&kk(this,Bk,Vk).call(this,e.target)}},{key:"keyupHandler",value:function(e){!e.key||1!==e.key.length&&"Backspace"!==e.key&&"Delete"!==e.key||kk(this,Bk,Vk).call(this,e.target)}},{key:"focusHandler",value:function(e){console.log("focused");var t=document.getElementById(Ty(this,Mk));if(!t.classList.contains("dropdown-focused")){var r=document.getElementById(Ty(this,Lk));kk(this,Bk,Vk).call(this,r),t.classList.add("dropdown-focused")}}},{key:"blurHandler",value:function(e){var t=this;Ty(this,Dk)&&(clearTimeout(Ty(this,Dk)),Ny(this,Dk,null)),setTimeout((function(){document.getElementById(Ty(t,Mk)).classList.remove("dropdown-focused")}),500)}},{key:"refreshSearchResultsList",value:function(){var e=document.getElementById(Ty(this,Mk));if(Ty(this,Uk).length){var t,r=[],n=0,o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return xk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xk(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}(Ty(this,Uk));try{for(o.s();!(t=o.n()).done;){var a=t.value;r[r.length]='<a class="list-group-item list-group-item-action" href="#" data-occurrenceId="'.concat(a.entityId,'" data-resultnumber="').concat(n,'">').concat(_A.formatter(a),"</a>"),++n}}catch(e){o.e(e)}finally{o.f()}e.innerHTML='<div class="list-group" id="'.concat(Ty(this,Pk),'">').concat(r.join(""),"</div>")}else e.innerHTML="";Ny(this,jk,null)}},{key:"dropboxClickHandler",value:function(e){console.log("click handler"),console.log(e);var t=e.target.closest("a");if(console.log(t),Ty(this,Fk)&&(clearTimeout(Ty(this,Fk)),Ny(this,Fk,null),console.log("cleared a pending change event")),t&&t.dataset.occurrenceid){e.preventDefault(),console.log("got target ".concat(t.dataset.occurrenceid));var r=Ty(this,Uk)[t.dataset.resultnumber];this.value={taxonId:r.entityId,taxonName:r.vernacularMatched?r.vernacular:r.qname,vernacularMatch:r.vernacularMatched},this.fireEvent(rR.EVENT_CHANGE)}}},{key:"inputChangeHandler",value:function(e){var t=this;e.stopPropagation(),console.log("got taxon field input change event"),Ty(this,Fk)&&clearTimeout(Ty(this,Fk)),Ny(this,Fk,setTimeout((function(){console.log("processing taxon field input change event");var e=Ty(t,Uk).find((function(e){return e.exact}));e?(console.log("exact match"),t.value={taxonId:e.entityId,taxonName:e.vernacularMatched?e.vernacular:e.qname,vernacularMatch:e.vernacularMatched}):(console.log("no match"),t.value={taxonId:"",taxonName:document.getElementById(Ty(t,Lk)).value.trim(),vernacularMatch:null}),console.log(t._value),t.fireEvent(rR.EVENT_CHANGE)}),500))}}],[{key:"isEmpty",value:function(e){return!e||e&&!e.taxonName}},{key:"cleanRawInput",value:function(e){return e.value.trim().replace(/\s\s+/g," ")}}]),r}();function Vk(e){var t=this,r=rR.cleanRawInput(e);Ty(this,Dk)&&clearTimeout(Ty(this,Dk)),r.length>=_A.MIN_SEARCH_LENGTH?Ny(this,Dk,setTimeout((function(){Ny(t,Uk,t.taxonSearch.lookup(rR.cleanRawInput(document.getElementById(Ty(t,Lk))))),console.log(Ty(t,Uk)),t.refreshSearchResultsList(),Ny(t,Dk,null)}),Yk.timeoutDelay)):(Ny(this,Uk,[]),this.refreshSearchResultsList())}function Jk(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}ld(Yk,"timeoutDelay",50);var Gk=new WeakMap,Kk=new WeakMap,qk=function(e){yy(r,rR);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(e){var n;return id(this,r),Jk(py(n=t.call(this,e)),Gk,{writable:!0,value:void 0}),Jk(py(n),Kk,{writable:!0,value:void 0}),ld(py(n),"_value",""),ld(py(n),"_autocomplete",""),e&&(e.options&&(n.options=e.options),e.placeholder&&(n.placeholder=e.placeholder),e.autocomplete&&(n._autocomplete=e.autocomplete)),n}return cd(r,[{key:"value",get:function(){return this._value},set:function(e){this._value=void 0===e||null==e?"":e.trim(),this.updateView()}},{key:"updateView",value:function(){this._fieldEl&&(document.getElementById(Ty(this,Gk)).value=rR.cleanRawString(this._value))}},{key:"buildField",value:function(){var e=document.createElement("div");e.className="form-group",Ny(this,Kk,e.id=rR.nextId),Ny(this,Gk,rR.nextId);var t=e.appendChild(document.createElement("label"));t.htmlFor=Ty(this,Gk),t.textContent=this.label;var r=e.appendChild(document.createElement("textarea"));if(r.className="form-control",r.id=Ty(this,Gk),this.helpText&&(e.appendChild(document.createElement("small")).innerHTML=this.helpText),this._autocomplete&&(r.autocomplete=this._autocomplete,"off"===this._autocomplete&&(r.name=HO())),this.validationMessage){var n=e.appendChild(document.createElement("div"));n.className="invalid-feedback",n.innerHTML=this.validationMessage}r.addEventListener("change",this.inputChangeHandler.bind(this)),this._fieldEl=e}},{key:"inputChangeHandler",value:function(e){e.stopPropagation(),console.log("got text area field input change event"),this.value=rR.cleanRawString(document.getElementById(Ty(this,Gk)).value),this.fireEvent(rR.EVENT_CHANGE)}}],[{key:"summariseImpl",value:function(e,t,r){return""!==r[e]&&null!==r[e]&&void 0!==r[e]?UO(r[e].trim()):""}}]),r}(),Wk=function(){var e=function(){};return e.tetradOffsets={E:[0,8e3],J:[2e3,8e3],P:[4e3,8e3],U:[6e3,8e3],Z:[8e3,8e3],D:[0,6e3],I:[2e3,6e3],N:[4e3,6e3],T:[6e3,6e3],Y:[8e3,6e3],C:[0,4e3],H:[2e3,4e3],M:[4e3,4e3],S:[6e3,4e3],X:[8e3,4e3],B:[0,2e3],G:[2e3,2e3],L:[4e3,2e3],R:[6e3,2e3],W:[8e3,2e3],A:[0,0],F:[2e3,0],K:[4e3,0],Q:[6e3,0],V:[8e3,0]},e.quadrantOffsets={NW:[0,5e3],NE:[5e3,5e3],SW:[0,0],SE:[5e3,0]},e.letterMapping={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,J:8,K:9,L:10,M:11,N:12,O:13,P:14,Q:15,R:16,S:17,T:18,U:19,V:20,W:21,X:22,Y:23,Z:24},e.tetradLetters="ABCDEFGHIJKLMNPQRSTUVWXYZ",e.prototype.preciseGridRef="",e.prototype.length=0,e.prototype.hectad="",e.prototype.tetrad="",e.prototype.tetradLetter="",e.prototype.quadrant="",e.prototype.quadrantCode="",e.prototype.set_tetrad=function(){if(this.tetradLetter=e.tetradLetters.substr(5*(Math.floor(this.gridCoords.x%1e4/1e3)>>1)+(Math.floor(this.gridCoords.y%1e4/1e3)>>1),1),!this.tetradLetter)throw new Error("Failed to get tetrad letter when processing '"+this.preciseGridRef+"', easting="+this.gridCoords.x+" northing="+this.gridCoords.y);this.tetrad=this.hectad+this.tetradLetter},e.get_normalized_precision=function(e,t){return e>2e3?1e4:e>1e3?2e3:e>100?1e3:e>10?100:e>1?10:t||1},e}(),Xk=function(e,t){this.lat=e,this.lng=t},Qk=Math.PI/180,zk=180/Math.PI,$k=function(e,t){this.lat=e,this.lng=t};$k.prototype.to_WGS84=function(){var e=6377563.396,t=.00667054007,r=this.lat*Qk,n=Math.sin(r),o=this.lng*Qk,a=e/Math.sqrt(1-t*(n*n)),i=a*Math.cos(r)*Math.cos(o),s=a*Math.cos(r)*Math.sin(o),c=(1-t)*a*n,l=-204894e-10,u=7.28190110241429e-7,d=119748977294801e-20,f=446.448+i*(1+l)+-u*s+d*c,h=408261589226812e-20*i-124.157+s*(1+l)+-u*c,p=542.06+-d*i+u*s+c*(1+l);e=6378137,t=.00669438003;for(var v=Math.sqrt(f*f+h*h),y=Math.atan(p/(v*(1-t))),m=1;m<10;++m){var g=Math.sin(y);y=Math.atan((p+t*(e/Math.sqrt(1-t*(g*g)))*g)/v)}return new Xk(zk*y,zk*Math.atan(h/f))},$k.from_wgs84=function(e){var t=e.lat*Qk,r=e.lng*Qk,n=.00669438037928458,o=.0066705397616,a=20.4894*1e-6,i=6378137/Math.sqrt(1-n*Math.sin(t)*Math.sin(t)),s=(i+0)*Math.cos(t)*Math.cos(r),c=(i+0)*Math.cos(t)*Math.sin(r),l=((1-n)*i+0)*Math.sin(t),u=-.1502/3600*Qk,d=-.247/3600*Qk,f=-.8421/3600*Qk,h=s+s*a-c*f+l*d-446.448,p=s*f+c+c*a-l*u+125.157,v=-1*s*d+c*u+l+l*a+-542.06,y=Math.atan(p/h),m=Math.sqrt(h*h+p*p),g=Math.atan(v/(m*(1-o)));i=6377563.396/Math.sqrt(1-o*(Math.sin(g)*Math.sin(g)));for(var S=1,b=0;S>.001;)b=Math.atan((v+o*i*Math.sin(g))/m),S=Math.abs(b-g),g=b;return new $k(g*zk,y*zk)};var Zk=function(){var e=function(e,t){this.lat=e,this.lng=t};return e._transform=function(t,r,n,o,a,i,s,c,l,u,d,f,h,p){var v=1e-6*p,y=n/Math.sqrt(1-o*(Math.sin(t)*Math.sin(t))),m=(y+a)*Math.cos(t)*Math.cos(r),g=(y+a)*Math.cos(t)*Math.sin(r),S=((1-o)*y+a)*Math.sin(t),b=d/3600*Qk,N=f/3600*Qk,T=h/3600*Qk,w=m+m*v-g*T+S*N+c,E=m*T+g+g*v-S*b+l,_=-1*m*N+g*b+S+S*v+u;r=Math.atan(E/w);var O=Math.sqrt(w*w+E*E);t=Math.atan(_/(O*(1-s))),y=i/Math.sqrt(1-s*(Math.sin(t)*Math.sin(t)));for(var R=1,I=0;R>.001;)I=Math.atan((_+s*y*Math.sin(t))/O),R=Math.abs(I-t),t=I;return new e(t,r)},e._Marc=function(e,t,r,n){return e*((1+t+5/4*(t*t)+5/4*(t*t*t))*(n-r)-(3*t+t*t*3+21/8*(t*t*t))*Math.sin(n-r)*Math.cos(n+r)+(15/8*(t*t)+15/8*(t*t*t))*Math.sin(2*(n-r))*Math.cos(2*(n+r))-35/24*(t*t*t)*Math.sin(3*(n-r))*Math.cos(3*(n+r)))},e}(),eL=function(){var e=function(e,t){this.lat=e,this.lng=t};return e.from_wgs84=function(t){var r=t.lat*Qk,n=t.lng*Qk,o=Zk._transform(r,n,6378137,.00669438037928458,0,6378388,.0067226700223333,83.901,98.127,118.635,0,0,0,0);return new e(o.lat*zk,o.lng*zk)},e}(),tL=function(e,t){this.lat=e,this.lng=t};tL.prototype.to_WGS84=function(){var e=Zk._transform(this.lat*Qk,this.lng*Qk,6377340.189,.00667054015,0,6378137,.00669438037928458,482.53,-130.596,564.557,-1.042,-.214,-.631,-8.15);return new Xk(e.lat*zk,e.lng*zk)},tL.from_wgs84=function(e){var t=e.lat*Qk,r=e.lng*Qk,n=Zk._transform(t,r,6378137,.00669438037928458,0,6377340.189,.00667054015,-482.53,130.596,-564.557,1.042,.214,.631,8.15);return new tL(n.lat*zk,n.lng*zk)};var rL=function(){};rL.tetradLetters="ABCDEFGHIJKLMNPQRSTUVWXYZ",rL.tetradLettersRowFirst="AFKQVBGLRWCHMSXDINTYEJPUZ",rL.from_latlng=function(e,t){if(t>=-8.74&&e>49.88){var r=new $k.from_wgs84(new Xk(e,t)).to_os_coords();if(r.x>=0&&r.is_gb_hectad())return r}if(t<-5.3&&e>51.34&&t>-11&&e<55.73){var n=new tL.from_wgs84(new Xk(e,t)).to_os_coords();return n.x<0||n.y<0?null:n}var o=new eL.from_wgs84(new Xk(e,t)).to_os_coords();return o.x>=5e5&&o.x<6e5&&o.y>=54e5&&o.y<56e5?o:null},rL.calculate_tetrad=function(e,t){return e>=0&&t>=0?rL.tetradLetters.charAt(5*Math.floor(e%1e4/2e3)+Math.floor(t%1e4/2e3)):""},rL.prototype.toString=function(){return this.x+","+this.y};var nL=function(e,t,r,n){var o="00000"+Math.floor(t),a="00000"+Math.floor(r);if(2e3===n)return e+o.charAt(o.length-5)+a.charAt(a.length-5)+rL.calculate_tetrad(t,r);if(1e5===n)return e;5e3===n&&(n=1e4);var i=Math.round(Math.log10(n));return e+(i?o.slice(-5,-i)+a.slice(-5,-i):o.slice(-5)+a.slice(-5))},oL=function(e,t){this.x=e,this.y=t};(oL.prototype=new rL).constructor=oL,oL.prototype.country="CI",oL.prototype.to_latLng=function(){var e=.0067226700223333,t=6375836.6448,r=this.x-5e5,n=aL(this.y,0,t,0,.0016863406508729017,6354369.181221601),o=t/Math.sqrt(1-e*(Math.sin(n)*Math.sin(n))),a=o*(1-e)/(1-e*Math.sin(n)*Math.sin(n)),i=o/a-1,s=Math.tan(n)*Math.tan(n),c=Math.pow(Math.tan(n),4),l=Math.pow(Math.tan(n),6),u=Math.pow(Math.cos(n),-1),d=Math.tan(n)/(2*a*o),f=Math.tan(n)/(24*a*(o*o*o))*(5+3*s+i-9*i*s),h=Math.tan(n)/(720*a*Math.pow(o,5))*(61+90*s+45*c),p=n-r*r*d+Math.pow(r,4)*f-Math.pow(r,6)*h,v=Math.pow(Math.cos(n),-1)/o,y=u/(o*o*o*6)*(o/a+2*s),m=u/(120*Math.pow(o,5))*(5+28*s+24*c),g=u/(5040*Math.pow(o,7))*(61+662*s+1320*c+720*l),S=r*v-.0523598775598-r*r*r*y+Math.pow(r,5)*m-Math.pow(r,7)*g,b=oL.convert_to_wgs(p,S);return new Xk(b.lat*zk,b.lng*zk)};var aL=function(e,t,r,n,o,a){for(var i=(e-t)/r+n,s=oL.marc(a,o,n,i),c=(e-t-s)/r+i,l=0;Math.abs(e-t-s)>1e-5&&l<20;)l+=1,c=(e-t-s)/r+i,s=Zk._Marc(a,o,n,c),i=c;return c};oL.prototype.to_gridref=function(e){return this.y>=55e5?nL("WA",this.x-5e5,this.y-55e5,e||1):this.y<55e5?nL("WV",this.x-5e5,this.y-54e5,e||1):null},oL.prototype.to_hectad=function(){return this.y>55e5?"WA"+this.x.toString().substring(1,2)+this.y.toString().substring(2,3):this.y<55e5?"WV"+this.x.toString().substring(1,2)+this.y.toString().substring(2,3):null};var iL=function(){var e=function(){};return(e.prototype=new Wk).constructor=e,e.prototype.country="CI",e.prototype.GridCoords=oL,e.prototype.from_string=function(t){var r,n=t.replace(/[\[\]\s\t\.\/-]+/g,"").toUpperCase(),o="";/[ABCDEFGHIJKLMNPQRSTUVWXYZ]$/.test(n)&&(Wk.quadrantOffsets.hasOwnProperty(n.substr(n.length-2))?(this.quadrantCode=n.substr(n.length-2),n=n.substr(0,n.length-2)):(o=n.substr(n.length-1),n=n.substr(0,n.length-1))),/^(W[AV](?:\d\d){1,5})$/.test(n)?(r=e.gridref_string_to_e_n_l(n))?(this.length=r.length,this.gridCoords=new oL(r.e,r.n),this.hectad=this.gridCoords.to_gridref(1e4),1e4===this.length&&(o||this.quadrantCode)?o?(this.preciseGridRef=n+o,this.tetrad=this.hectad+o,this.tetradLetter=o,this.length=2e3,this.gridCoords.x+=Wk.tetradOffsets[o][0],this.gridCoords.y+=Wk.tetradOffsets[o][1]):(this.preciseGridRef=n+this.quadrantCode,this.tetradLetter="",this.tetrad="",this.quadrant=this.preciseGridRef,this.length=5e3,this.gridCoords.x+=Wk.quadrantOffsets[this.quadrantCode][0],this.gridCoords.y+=Wk.quadrantOffsets[this.quadrantCode][1]):(this.preciseGridRef=n,this.length<=1e3&&this.set_tetrad())):(this.error=!0,this.errorMessage="Grid reference format not understood (odd length)."):(this.error=!0,this.errorMessage="Channel Island grid reference format not understood. ('"+t+"')")},e.prototype.parse_well_formed=e.prototype.from_string,e.gridref_string_to_e_n_l=function(e){var t,r,n,o,a=e.substr(0,2);if("WA"===a)t=55e5;else{if("WV"!==a)return Logger("Bad Channel Island grid letters: '"+a+"'"),!1;t=54e5}var i=e.substr(2);switch(i.length){case 2:r=1e4*i.charAt(0),n=1e4*i.charAt(1),o=1e4;break;case 4:r=1e3*i.substr(0,2),n=1e3*i.substr(2),o=1e3;break;case 6:r=100*i.substr(0,3),n=100*i.substr(3),o=100;break;case 8:r=10*i.substr(0,4),n=10*i.substr(4),o=10;break;case 10:r=parseInt(i.substr(0,5),10),n=parseInt(i.substr(5),10),o=1;break;default:return Logger("Bad length for Channel Island grid ref '"+e+"'"),!1}return{e:r+5e5,n:n+t,length:o}},e}(),sL=function(e,t){this.x=e,this.y=t};(sL.prototype=new rL).constructor=sL,sL.prototype.country="GB",sL.gbHectads="SV80SV81SV90SV91SW32SW33SW42SW43SW44SW52SW53SW54SW61SW62SW63SW64SW65SW71SW72SW73SW74SW75SW76SW81SW82SW83SW84SW85SW86SW87SW95SW96SW97SS10SS11SS20SS21SS30SW83SW84SW85SW93SW94SW95SW96SW97SW98SX03SX04SX05SX06SX07SX08SX09SX14SX15SX16SX17SX18SX19SX25SX26SX27SX28SX29SX35SX36SX37SX38SX39SX44SX45SX46SX47SS70SS80SS81SS90SS91ST00ST01ST10ST11ST20ST21ST30SX37SX44SX45SX46SX47SX48SX54SX55SX56SX57SX58SX63SX64SX65SX66SX67SX68SX69SX73SX74SX75SX76SX77SX78SX79SX83SX84SX85SX86SX87SX88SX89SX94SX95SX96SX97SX98SX99SY07SY08SY09SY18SY19SY28SY29SY38SY39SS14SS20SS21SS22SS30SS31SS32SS40SS41SS42SS43SS44SS50SS51SS52SS53SS54SS60SS61SS62SS63SS64SS70SS71SS72SS73SS74SS75SS80SS81SS82SS83SS91SS92ST01ST02SX28SX29SX37SX38SX39SX48SX49SX58SX59SX68SX69SX79SS73SS74SS82SS83SS84SS92SS93SS94ST01ST02ST03ST04ST11ST12ST13ST14ST20ST21ST22ST23ST24ST25ST30ST31ST32ST33ST34ST40ST41ST42ST50ST51ST52ST61ST62ST71ST72ST24ST25ST26ST32ST33ST34ST35ST36ST37ST42ST43ST44ST45ST46ST47ST52ST53ST54ST55ST56ST57ST62ST63ST64ST65ST66ST67ST72ST73ST74ST75ST76ST77ST83ST84ST85ST86SP00SP10ST76ST77ST85ST86ST87ST88ST89ST96ST97ST98ST99SU06SU07SU08SU09SU16SU17SU18SU19SU26SU27SU28SU29SU36SU37ST73ST74ST75ST76ST82ST83ST84ST85ST86ST91ST92ST93ST94ST95ST96SU01SU02SU03SU04SU05SU06SU11SU12SU13SU14SU15SU16SU21SU22SU23SU24SU25SU26SU31SU32SU34SU35SU36ST20ST30ST40ST50ST51ST60ST61ST70ST71ST72ST73ST80ST81ST82ST83ST90ST91ST92SU00SU01SU02SU10SU11SY39SY48SY49SY58SY59SY66SY67SY68SY69SY77SY78SY79SY87SY88SY89SY97SY98SY99SZ07SZ08SZ09SZ28SZ38SZ39SZ47SZ48SZ49SZ57SZ58SZ59SZ68SZ69SU00SU01SU02SU10SU11SU12SU20SU21SU22SU23SU30SU31SU32SU33SU40SU41SU42SU43SU50SU51SU52SU60SU61SU62SU70SU71SU72SZ08SZ09SZ19SZ29SZ38SZ39SZ49SZ59SZ69SZ79SU23SU24SU25SU33SU34SU35SU36SU42SU43SU44SU45SU46SU52SU53SU54SU55SU56SU62SU63SU64SU65SU66SU72SU73SU74SU75SU76SU82SU83SU84SU85SU86SU70SU71SU72SU80SU81SU82SU83SU90SU91SU92SU93SZ79SZ89SZ99TQ00TQ01TQ02TQ03TQ10TQ11TQ12TQ13TQ20TQ21TQ22TQ23TQ30TQ31TQ32TQ20TQ21TQ22TQ23TQ30TQ31TQ32TQ33TQ40TQ41TQ42TQ43TQ44TQ50TQ51TQ52TQ53TQ54TQ60TQ61TQ62TQ63TQ70TQ71TQ72TQ80TQ81TQ82TQ91TQ92TV49TV59TV69TQ65TQ72TQ73TQ74TQ75TQ76TQ77TQ82TQ83TQ84TQ85TQ86TQ87TQ91TQ92TQ93TQ94TQ95TQ96TQ97TR01TR02TR03TR04TR05TR06TR07TR12TR13TR14TR15TR16TR23TR24TR25TR26TR27TR33TR34TR35TR36TR37TR46TR47TQ35TQ36TQ37TQ38TQ43TQ44TQ45TQ46TQ47TQ48TQ53TQ54TQ55TQ56TQ57TQ58TQ63TQ64TQ65TQ66TQ67TQ72TQ73TQ74TQ75TQ76TQ77TQ78TQ87TQ88TQ97SU83SU84SU85SU86SU93SU94SU95SU96SU97TQ03TQ04TQ05TQ06TQ07TQ13TQ14TQ15TQ16TQ17TQ23TQ24TQ25TQ26TQ27TQ33TQ34TQ35TQ36TQ37TQ38TQ43TQ44TQ45TL30TL40TL50TL60TL70TL80TL90TM00TQ38TQ39TQ47TQ48TQ49TQ57TQ58TQ59TQ67TQ68TQ69TQ77TQ78TQ79TQ88TQ89TQ98TQ99TR08TR09TR19TL30TL31TL34TL40TL41TL42TL43TL44TL50TL51TL52TL53TL54TL60TL61TL62TL63TL64TL70TL71TL72TL73TL74TL80TL81TL82TL83TL84TL90TL91TL92TL93TM01TM02TM03TM11TM12TM13TM21TM22TM23TQ49SP81SP90SP91TL00TL01TL02TL10TL11TL12TL13TL20TL21TL22TL23TL24TL30TL31TL32TL33TL34TL41TL42TL43TL44TL51TL52TQ09TQ19TQ29TQ39TL20TL30TQ06TQ07TQ08TQ09TQ16TQ17TQ18TQ19TQ27TQ28TQ29TQ37TQ38TQ39SP20SP30SP40SP41SP50SU19SU26SU27SU28SU29SU36SU37SU38SU39SU46SU47SU48SU49SU56SU57SU58SU59SU66SU67SU68SU69SU76SU77SU78SU86SU87SU88SU96SU97SU98SP10SP20SP21SP22SP23SP30SP31SP32SP33SP34SP40SP41SP42SP43SP44SP45SP50SP51SP52SP53SP54SP60SP61SP62SP63SP70SU29SU39SU49SU57SU58SU59SU67SU68SU69SU77SU78SU79SP51SP53SP60SP61SP62SP63SP64SP70SP71SP72SP73SP74SP80SP81SP82SP83SP84SP85SP90SP91SP92SP93SP94SP95SU78SU79SU88SU89SU97SU98SU99TL00TL01TQ07TQ08TQ09TG40TG50TM03TM04TM05TM06TM07TM13TM14TM15TM16TM17TM23TM24TM25TM26TM27TM28TM33TM34TM35TM36TM37TM38TM39TM44TM45TM46TM47TM48TM49TM57TM58TM59TL64TL65TL66TL67TL68TL74TL75TL76TL77TL78TL83TL84TL85TL86TL87TL88TL93TL94TL95TL96TL97TL98TM03TM04TM05TM06TM07TM08TG00TG01TG02TG03TG04TG10TG11TG12TG13TG14TG20TG21TG22TG23TG24TG30TG31TG32TG33TG40TG41TG42TG50TG51TM07TM08TM09TM17TM18TM19TM27TM28TM29TM38TM39TM49TM59TF40TF41TF42TF50TF51TF52TF53TF60TF61TF62TF63TF64TF70TF71TF72TF73TF74TF80TF81TF82TF83TF84TF90TF91TF92TF93TF94TG00TG01TG02TG03TG04TL49TL59TL68TL69TL78TL79TL87TL88TL89TL98TL99TM07TM08TM09TF20TF30TF31TF40TF41TF50TL15TL19TL23TL24TL25TL26TL28TL29TL33TL34TL35TL36TL37TL38TL39TL44TL45TL46TL47TL48TL49TL54TL55TL56TL57TL58TL59TL63TL64TL65TL66TL67TL68TL69TL75TL76SP91SP92SP93SP94SP95SP96TL01TL02TL03TL04TL05TL06TL07TL11TL12TL13TL14TL15TL16TL23TL24TL25TL06TL07TL08TL09TL15TL16TL17TL18TL19TL25TL26TL27TL28TL29TL36TL37TL38TL39SK90SP43SP44SP45SP46SP53SP54SP55SP56SP57SP58SP63SP64SP65SP66SP67SP68SP73SP74SP75SP76SP77SP78SP79SP84SP85SP86SP87SP88SP89SP95SP96SP97SP98SP99TF00TF10TF20TL06TL07TL08TL09TL18TL19TL29SO70SO71SO80SO81SO82SO83SO90SO91SO92SO93SO94SP00SP01SP02SP03SP04SP10SP11SP12SP13SP14SP15SP20SP21SP22SP23SP24SP25ST99SU09SU19SU29SO50SO51SO60SO61SO62SO63SO70SO71SO72SO73SO80SO81SO82SO83SO90ST57ST58ST59ST66ST67ST68ST69ST76ST77ST78ST79ST87ST88ST89ST98ST99SO10SO11SO20SO21SO22SO23SO30SO31SO32SO40SO41SO42SO50SO51ST18ST19ST27ST28ST29ST37ST38ST39ST47ST48ST49ST58ST59SO22SO23SO24SO25SO26SO32SO33SO34SO35SO36SO37SO41SO42SO43SO44SO45SO46SO47SO51SO52SO53SO54SO55SO56SO57SO61SO62SO63SO64SO65SO66SO73SO74SO75SO76SO56SO64SO65SO66SO67SO72SO73SO74SO75SO76SO77SO78SO82SO83SO84SO85SO86SO87SO88SO93SO94SO95SO96SO97SO98SO99SP03SP04SP05SP06SP07SP08SP13SP14SP16SP17SP18SK10SK20SK30SP04SP05SP06SP07SP08SP09SP14SP15SP16SP17SP18SP19SP22SP23SP24SP25SP26SP27SP28SP29SP33SP34SP35SP36SP37SP38SP39SP44SP45SP46SP47SP48SP49SP55SP56SP57SP58SJ63SJ70SJ71SJ72SJ73SJ74SJ75SJ80SJ81SJ82SJ83SJ84SJ85SJ86SJ90SJ91SJ92SJ93SJ94SJ95SJ96SK00SK01SK02SK03SK04SK05SK06SK10SK11SK12SK13SK14SK15SK16SK20SK21SK22SO77SO78SO79SO88SO89SO98SO99SP08SP09SP19SP29SJ20SJ21SJ22SJ23SJ30SJ31SJ32SJ33SJ34SJ40SJ41SJ42SJ43SJ50SJ51SJ52SJ53SJ54SJ60SJ61SJ62SJ63SJ64SJ70SJ71SJ72SJ73SJ74SJ80SO17SO18SO27SO28SO29SO37SO38SO39SO46SO47SO48SO49SO56SO57SO58SO59SO66SO67SO68SO69SO77SO78SO79SO88SO89SN50SN60SN61SN70SN71SN80SN81SN90SO00SO01SO10SO11SS38SS39SS48SS49SS58SS59SS68SS69SS77SS78SS79SS87SS88SS89SS96SS97SS98SS99ST06ST07ST08ST09ST16ST17ST18ST19ST26ST27ST28SN70SN71SN74SN80SN81SN82SN83SN84SN85SN86SN90SN91SN92SN93SN94SN95SN96SO00SO01SO02SO03SO04SO05SO06SO10SO11SO12SO13SO14SO21SO22SO23SO24SN86SN87SN96SN97SO04SO05SO06SO07SO08SO13SO14SO15SO16SO17SO18SO24SO25SO26SO27SO36SO37SN01SN02SN10SN11SN12SN20SN21SN22SN23SN24SN30SN31SN32SN33SN34SN40SN41SN42SN43SN44SN50SN51SN52SN53SN54SN60SN61SN62SN63SN64SN65SN71SN72SN73SN74SN75SN81SN82SN83SN84SS39SS49SS59SM50SM62SM70SM71SM72SM73SM80SM81SM82SM83SM84SM90SM91SM92SM93SM94SN00SN01SN02SN03SN04SN10SN11SN12SN13SN14SN22SN23SN24SR89SR99SS09SS19SN14SN15SN24SN25SN33SN34SN35SN36SN44SN45SN46SN54SN55SN56SN57SN58SN64SN65SN66SN67SN68SN69SN74SN75SN76SN77SN78SN79SN84SN85SN86SN87SN88SN89SH70SH71SH80SH81SH90SH91SH92SJ00SJ01SJ02SJ03SJ10SJ11SJ12SJ20SJ21SJ22SJ31SN69SN78SN79SN87SN88SN89SN97SN98SN99SO07SO08SO09SO18SO19SO28SO29SO39SH50SH51SH52SH53SH54SH60SH61SH62SH63SH64SH70SH71SH72SH73SH74SH80SH81SH82SH83SH84SH91SH92SH93SH94SH95SJ03SJ04SJ05SJ13SJ14SN59SN69SN79SH12SH13SH22SH23SH24SH32SH33SH34SH43SH44SH45SH46SH53SH54SH55SH56SH57SH64SH65SH66SH67SH74SH75SH76SH77SH78SH84SH85SH86SH87SH88SH74SH75SH76SH77SH84SH85SH86SH87SH88SH94SH95SH96SH97SH98SJ02SJ03SJ04SJ05SJ06SJ07SJ08SJ12SJ13SJ14SJ15SJ16SJ17SJ22SJ23SJ24SJ25SJ26SJ33SJ34SJ35SJ43SJ44SJ45SJ53SJ54SH97SH98SJ06SJ07SJ08SJ15SJ16SJ17SJ18SJ25SJ26SJ27SJ35SJ36SJ37SH27SH28SH29SH36SH37SH38SH39SH46SH47SH48SH49SH56SH57SH58SH59SH67SH68SK81SK82SK83SK84SK85SK86SK87SK90SK91SK92SK93SK94SK95SK96SK97TF00TF01TF02TF03TF04TF05TF06TF07TF10TF11TF12TF13TF14TF15TF16TF17TF20TF21TF22TF23TF24TF25TF30TF31TF32TF33TF34TF41TF42TF43TF44TF52SE60SE70SE71SE80SE81SE82SE90SE91SE92SK78SK79SK87SK88SK89SK97SK98SK99TA00TA01TA02TA10TA11TA12TA20TA21TA30TA31TA40TF07TF08TF09TF15TF16TF17TF18TF19TF24TF25TF26TF27TF28TF29TF33TF34TF35TF36TF37TF38TF39TF43TF44TF45TF46TF47TF48TF49TF54TF55TF56TF57TF58SK20SK21SK30SK31SK32SK40SK41SK42SK43SK50SK51SK52SK60SK61SK62SK70SK71SK72SK73SK74SK80SK81SK82SK83SK84SK90SK91SP39SP48SP49SP57SP58SP59SP68SP69SP78SP79SP89SP99TF00TF01SE60SE70SK42SK43SK44SK45SK46SK52SK53SK54SK55SK56SK57SK58SK59SK62SK63SK64SK65SK66SK67SK68SK69SK72SK73SK74SK75SK76SK77SK78SK79SK84SK85SK86SK87SK88SK89SK97SJ98SJ99SK03SK06SK07SK08SK09SK11SK12SK13SK14SK15SK16SK17SK18SK19SK21SK22SK23SK24SK25SK26SK27SK28SK31SK32SK33SK34SK35SK36SK37SK38SK42SK43SK44SK45SK46SK47SK48SK53SK56SK57SD90SE00SE10SJ18SJ19SJ27SJ28SJ29SJ35SJ36SJ37SJ38SJ39SJ44SJ45SJ46SJ47SJ48SJ54SJ55SJ56SJ57SJ58SJ63SJ64SJ65SJ66SJ67SJ68SJ69SJ74SJ75SJ76SJ77SJ78SJ79SJ85SJ86SJ87SJ88SJ89SJ96SJ97SJ98SJ99SK06SK07SK08SK09SK19SD20SD21SD22SD30SD31SD32SD40SD41SD42SD50SD51SD52SD53SD60SD61SD62SD63SD70SD71SD72SD73SD74SD80SD81SD82SD83SD84SD90SD91SD92SD93SD94SJ29SJ38SJ39SJ48SJ49SJ58SJ59SJ68SJ69SJ79SJ88SJ89SJ99SD22SD23SD32SD33SD34SD35SD36SD42SD43SD44SD45SD46SD47SD52SD53SD54SD55SD56SD57SD63SD64SD65SD66SD67SD68SD73SD78SE53SE54SE62SE63SE64SE65SE72SE73SE74SE75SE76SE82SE83SE84SE85SE86SE87SE92SE93SE94SE95SE96SE97SE98TA02TA03TA04TA05TA06TA07TA08TA12TA13TA14TA15TA16TA17TA18TA21TA22TA23TA24TA26TA27TA31TA32TA33TA41TA42NZ30NZ31NZ40NZ41NZ42NZ50NZ51NZ52NZ60NZ61NZ62NZ70NZ71NZ72NZ80NZ81NZ90NZ91SE37SE38SE39SE46SE47SE48SE49SE55SE56SE57SE58SE59SE64SE65SE66SE67SE68SE69SE75SE76SE77SE78SE79SE86SE87SE88SE89SE97SE98SE99TA08TA09TA18SD84SD90SD91SD92SD93SD94SD95SE00SE01SE02SE03SE04SE10SE11SE12SE13SE14SE20SE21SE22SE23SE30SE31SE32SE33SE40SE41SE42SE50SE51SE52SE60SE61SE62SE70SE71SE72SE81SE82SK18SK19SK28SK29SK38SK39SK47SK48SK49SK57SK58SK59SK69SD54SD55SD64SD65SD66SD67SD68SD73SD74SD75SD76SD77SD78SD84SD85SD86SD87SD88SD94SD95SD96SD97SD98SE04SE05SE06SE07SE13SE14SE15SE16SE17SE23SE24SE25SE26SE27SE32SE33SE34SE35SE36SE37SE42SE43SE44SE45SE46SE52SE53SE54SE55SE56SE62SE63SE64SE65SE72NY72NY80NY81NY82NY90NY91NY92NZ00NZ01NZ02NZ10NZ11NZ20NZ21NZ30NZ31SD68SD69SD78SD79SD88SD89SD97SD98SD99SE07SE08SE09SE17SE18SE19SE27SE28SE29SE36SE37SE38SE39SE46SE47NY73NY74NY82NY83NY84NY92NY93NY94NY95NZ01NZ02NZ03NZ04NZ05NZ11NZ12NZ13NZ14NZ15NZ16NZ20NZ21NZ22NZ23NZ24NZ25NZ26NZ30NZ31NZ32NZ33NZ34NZ35NZ36NZ41NZ42NZ43NZ44NZ45NZ46NZ52NZ53NT60NT70NT80NT90NU00NU10NU20NY58NY59NY64NY65NY66NY67NY68NY69NY74NY75NY76NY77NY78NY79NY84NY85NY86NY87NY88NY89NY94NY95NY96NY97NY98NY99NZ04NZ05NZ06NZ07NZ08NZ09NZ15NZ16NZ17NZ18NZ19NZ26NZ27NZ28NZ29NZ36NZ37NZ38NZ39NT70NT71NT73NT80NT81NT82NT83NT84NT90NT91NT92NT93NT94NT95NU00NU01NU02NU03NU04NU05NU10NU11NU12NU13NU14NU20NU21NU22NU23NZ09NZ19NY20NY21NY30NY31NY40NY41NY42NY50NY51NY52NY53NY60NY61NY62NY63NY70NY71NY72NY73NY80NY81NY82NY83SD16SD17SD18SD19SD26SD27SD28SD29SD36SD37SD38SD39SD46SD47SD48SD49SD57SD58SD59SD67SD68SD69SD78SD79SD89NX90NX91NX92NX93NY00NY01NY02NY03NY04NY05NY10NY11NY12NY13NY14NY15NY16NY20NY21NY22NY23NY24NY25NY26NY31NY32NY33NY34NY35NY36NY37NY41NY42NY43NY44NY45NY46NY47NY48NY52NY53NY54NY55NY56NY57NY58NY62NY63NY64NY65NY66NY67NY68NY73NY74NY75NY84SD08SD09SD17SD18SD19SD28SD29NX30NX40SC16SC17SC26SC27SC28SC36SC37SC38SC39SC47SC48SC49NS60NS61NS70NS71NS72NS80NS81NS90NT00NT01NT10NT11NT20NT21NT30NX69NX78NX79NX88NX89NX96NX97NX98NX99NY05NY06NY07NY08NY09NY16NY17NY18NY19NY26NY27NY28NY29NY36NY37NY38NY39NY47NY48NY49NS50NS60NX36NX37NX38NX45NX46NX47NX48NX49NX54NX55NX56NX57NX58NX59NX64NX65NX66NX67NX68NX69NX74NX75NX76NX77NX78NX79NX84NX85NX86NX87NX88NX95NX96NX97NX98NY05NY06NW95NW96NW97NX03NX04NX05NX06NX07NX13NX14NX15NX16NX17NX24NX25NX26NX27NX33NX34NX35NX36NX37NX43NX44NX45NX46NS00NS10NS14NS15NS16NS20NS21NS23NS24NS25NS26NS30NS31NS32NS33NS34NS35NS36NS40NS41NS42NS43NS44NS45NS50NS51NS52NS53NS54NS55NS60NS61NS62NS63NS64NS71NS72NS73NX07NX08NX09NX17NX18NX19NX27NX28NX29NX37NX38NX39NX48NX49NX59NS16NS17NS26NS27NS35NS36NS37NS44NS45NS46NS47NS54NS55NS56NS64NS65NS66NS53NS54NS55NS56NS57NS63NS64NS65NS66NS67NS71NS72NS73NS74NS75NS76NS77NS80NS81NS82NS83NS84NS85NS86NS87NS90NS91NS92NS93NS94NS95NS96NT00NT01NT02NT03NT04NT05NT14NT01NT02NT03NT04NT05NT11NT12NT13NT14NT15NT21NT22NT23NT24NT25NT32NT33NT34NT10NT11NT20NT21NT22NT23NT30NT31NT32NT33NT34NT41NT42NT43NT44NT53NT20NT30NT31NT40NT41NT42NT43NT44NT50NT51NT52NT53NT54NT60NT61NT62NT63NT64NT70NT71NT72NT73NT74NT81NT82NT83NY39NY47NY48NY49NY58NY59NY69NT44NT45NT46NT53NT54NT55NT56NT63NT64NT65NT66NT73NT74NT75NT76NT77NT83NT84NT85NT86NT87NT94NT95NT96NT36NT37NT45NT46NT47NT48NT55NT56NT57NT58NT65NT66NT67NT68NT76NT77NS95NS96NT05NT06NT15NT16NT17NT24NT25NT26NT27NT34NT35NT36NT37NT43NT44NT45NT46NS86NS87NS95NS96NS97NS98NT06NT07NT08NT16NT17NO00NO01NO10NO11NO20NO21NO22NO30NO31NO32NO40NO41NO42NO50NO51NO52NO60NO61NS99NT08NT09NT18NT19NT28NT29NT39NT49NT59NT69NN30NN31NN40NN41NS38NS39NS47NS48NS49NS57NS58NS59NS67NS68NS69NS77NS78NS79NS86NS87NS88NS89NS97NS98NN21NN22NN30NN31NN32NN40NN41NN42NN50NN51NN52NN60NN61NN70NN71NN80NN81NN90NN91NO00NS49NS59NS69NS79NS88NS89NS98NS99NT08NT09NN22NN23NN32NN33NN34NN35NN42NN43NN44NN45NN46NN47NN51NN52NN53NN54NN55NN56NN57NN61NN62NN63NN64NN65NN66NN67NN71NN72NN73NN74NN75NN76NN77NN81NN82NN83NN84NN85NN86NN90NN91NN92NN93NN94NN95NN96NO00NO01NO02NO03NO04NO11NO12NO13NO21NN56NN57NN66NN67NN68NN76NN77NN78NN86NN87NN88NN94NN95NN96NN97NN98NO02NO03NO04NO05NO06NO07NO08NO11NO12NO13NO14NO15NO16NO17NO21NO22NO23NO24NO25NO32NO33NO34NO15NO16NO17NO23NO24NO25NO26NO27NO28NO32NO33NO34NO35NO36NO37NO38NO42NO43NO44NO45NO46NO47NO48NO53NO54NO55NO56NO57NO58NO63NO64NO65NO66NO67NO74NO75NO76NJ60NJ70NJ80NJ90NO57NO58NO66NO67NO68NO69NO76NO77NO78NO79NO86NO87NO88NO89NO99NH90NJ00NJ10NJ11NJ20NJ21NJ30NJ31NJ32NJ40NJ41NJ42NJ50NJ51NJ52NJ60NJ61NJ62NJ70NJ71NJ72NJ80NJ81NJ82NJ90NJ91NJ92NK02NN98NN99NO07NO08NO09NO17NO18NO19NO27NO28NO29NO37NO38NO39NO48NO49NO58NO59NO68NO69NO79NO89NJ31NJ32NJ33NJ34NJ42NJ43NJ44NJ52NJ53NJ54NJ55NJ62NJ63NJ64NJ65NJ72NJ73NJ74NJ75NJ76NJ82NJ83NJ84NJ85NJ86NJ92NJ93NJ94NJ95NJ96NK02NK03NK04NK05NK06NK13NK14NK15NH90NJ00NJ01NJ10NJ11NJ12NJ13NJ14NJ21NJ22NJ23NJ24NJ25NJ32NJ33NJ34NJ35NJ36NJ42NJ43NJ44NJ45NJ46NJ54NJ55NJ56NJ64NJ65NJ66NJ74NJ75NJ76NJ86NN99NH72NH81NH82NH91NH92NH93NH94NH95NH96NJ00NJ01NJ02NJ03NJ04NJ05NJ06NJ11NJ12NJ13NJ14NJ15NJ16NJ17NJ23NJ24NJ25NJ26NJ27NJ34NJ35NJ36NJ45NH01NH02NH10NH11NH12NH13NH14NH20NH21NH22NH23NH24NH30NH31NH32NH33NH34NH40NH41NH42NH43NH44NH50NH51NH52NH53NH54NH60NH61NH62NH63NH64NH70NH71NH72NH73NH74NH75NH80NH81NH82NH83NH84NH85NH90NH91NH92NH93NH94NH95NH96NJ00NJ01NN39NN46NN47NN48NN49NN56NN57NN58NN59NN67NN68NN69NN77NN78NN79NN88NN89NN98NN99NG60NG70NG71NG72NG80NG81NG82NG90NG91NH00NH01NH10NH20NH30NM46NM47NM54NM55NM56NM57NM64NM65NM66NM67NM68NM69NM74NM75NM76NM77NM78NM79NM84NM85NM86NM87NM88NM89NM95NM96NM97NM98NM99NN05NN06NN07NN08NN09NN16NN17NN18NN19NN26NN27NN28NN29NN35NN36NN37NN38NN39NN46NN47NN48NN49NN57NN58NN59NM70NM71NM72NM73NM80NM81NM82NM83NM84NM90NM91NM92NM93NM94NM95NN00NN01NN02NN03NN04NN05NN10NN11NN12NN13NN14NN15NN16NN20NN21NN22NN23NN24NN25NN26NN30NN33NN34NN35NN36NN44NN45NN46NR79NR88NR89NR96NR97NR98NR99NS06NS07NS08NS09NS16NS17NS18NS19NS28NS29NN20NN21NN30NN31NS28NS29NS37NS38NS39NS46NS47NS48NS56NS57NR82NR83NR84NR92NR93NR94NR95NR96NR97NS01NS02NS03NS04NS05NS06NS07NS15NS16NR50NR51NR60NR61NR62NR63NR64NR65NR67NR68NR70NR71NR72NR73NR74NR75NR76NR77NR78NR79NR83NR84NR85NR86NR87NR88NR89NR95NR96NM40NM60NM61NM70NM71NR15NR16NR24NR25NR26NR27NR34NR35NR36NR37NR38NR39NR44NR45NR46NR47NR48NR49NR56NR57NR58NR59NR67NR68NR69NR79NL93NL94NM04NM05NM15NM16NM21NM22NM23NM24NM25NM26NM31NM32NM33NM34NM35NM41NM42NM43NM44NM45NM51NM52NM53NM54NM55NM61NM62NM63NM64NM72NM73NG13NG14NG15NG20NG23NG24NG25NG26NG30NG31NG32NG33NG34NG35NG36NG37NG38NG40NG41NG42NG43NG44NG45NG46NG47NG50NG51NG52NG53NG54NG55NG56NG60NG61NG62NG63NG64NG65NG66NG71NG72NG82NM19NM29NM37NM38NM39NM47NM48NM49NM59NB90NB91NC00NC01NC10NC11NC20NC21NG63NG64NG65NG72NG73NG74NG75NG76NG77NG78NG79NG82NG83NG84NG85NG86NG87NG88NG89NG91NG92NG93NG94NG95NG96NG97NG98NG99NH00NH01NH02NH03NH04NH05NH06NH07NH08NH09NH10NH11NH15NH16NH17NH18NH19NH27NH28NH29NC10NC20NC21NC30NC31NC40NH02NH03NH04NH05NH06NH07NH12NH13NH14NH15NH16NH17NH19NH23NH24NH25NH26NH27NH28NH29NH34NH35NH36NH37NH38NH39NH44NH45NH46NH47NH48NH49NH54NH55NH56NH57NH58NH59NH64NH65NH66NH67NH68NH69NH75NH76NH77NH78NH86NH87NH88NH97NH98NC22NC30NC31NC32NC33NC40NC41NC42NC43NC50NC51NC52NC60NC61NC62NC63NC70NC71NC72NC73NC74NC80NC81NC82NC83NC84NC90NC91NC92NC93ND01ND02NH49NH59NH68NH69NH78NH79NH88NH89NC01NC02NC03NC10NC11NC12NC13NC14NC15NC16NC20NC21NC22NC23NC24NC25NC26NC27NC31NC32NC33NC34NC35NC36NC37NC42NC43NC44NC45NC46NC52NC53NC54NC55NC56NC62NC63NC64NC65NC66NC73NC74NC75NC76NC83NC84NC85NC86NC93NC94NC95NC96NC92NC93NC94NC95NC96ND01ND02ND03ND04ND05ND06ND07ND12ND13ND14ND15ND16ND17ND23ND24ND25ND26ND27ND33ND34ND35ND36ND37ND47HW63HW83HX62NA00NA10NA64NA74NA81NA90NA91NA92NA93NB00NB01NB02NB03NB10NB11NB12NB13NB14NB20NB21NB22NB23NB24NB30NB31NB32NB33NB34NB35NB40NB41NB42NB43NB44NB45NB46NB52NB53NB54NB55NB56NF09NF19NF56NF58NF60NF61NF66NF67NF68NF70NF71NF72NF73NF74NF75NF76NF77NF80NF81NF82NF83NF84NF85NF86NF87NF88NF89NF95NF96NF97NF98NF99NG07NG08NG09NG18NG19NG29NG49NL57NL58NL68NL69NL79HY10HY20HY21HY22HY23HY30HY31HY32HY33HY34HY35HY40HY41HY42HY43HY44HY45HY50HY51HY52HY53HY54HY55HY60HY61HY62HY63HY64HY73HY74HY75ND19ND28ND29ND38ND39ND47ND48ND49ND59HP40HP50HP51HP60HP61HT93HT94HU14HU15HU16HU24HU25HU26HU27HU28HU30HU31HU32HU33HU34HU35HU36HU37HU38HU39HU40HU41HU42HU43HU44HU45HU46HU47HU48HU49HU53HU54HU55HU56HU57HU58HU59HU66HU67HU68HU69HZ16HZ17HZ26HZ27",sL.prototype.to_gridref=function(e){var t,r=this.x/1e5|0,n=this.y/1e5|0;t=n<5?r<5?"S":"T":n<10?r<5?"N":"O":r<5?"H":"J";var o=65+5*(4-n%5)+r%5;o>=73&&o++;var a=String.fromCharCode(o);return nL(t+a,this.x-1e5*r,this.y-1e5*n,e||1)},sL.prototype.to_hectad=function(){var e=this.x/1e5|0,t=this.y/1e5|0,r=65+5*(4-t%5)+e%5;return r>=73&&r++,(t<5?e<5?"S":"T":t<10?e<5?"N":"O":e<5?"H":"J")+String.fromCharCode(r)+((this.x-1e5*e)/1e4|0)+((this.y-1e5*t)/1e4|0)},sL.prototype.is_gb_hectad=function(){return-1!==sL.gbHectads.indexOf(this.to_hectad())},sL.prototype.to_latLng=function(){var e,t=4e5,r=.85521133347722,n=6377563.396,o=this.x,a=this.y,i=.0016732203289875,s=(a+1e5)/(.9996012717*n)+r;do{s+=(e=a+1e5-6353722.489*(1.0016767257674*(s-r)-.00502807228247412*Math.sin(s-r)*Math.cos(s+r)+5258157614724887e-21*Math.sin(2*(s-r))*Math.cos(2*(s+r))-35/24*i*i*i*Math.sin(3*(s-r))*Math.cos(3*(s+r))))/6375020.48098897}while(e>=.001);var c=Math.sin(s)*Math.sin(s),l=Math.tan(s)*Math.tan(s),u=1/Math.cos(s),d=.9996012717*n*Math.pow(1-.00667054007*c,-.5),f=6332495.651423464*Math.pow(1-.00667054007*c,-1.5),h=d/f-1,p=Math.tan(s)/(2*f*d),v=Math.tan(s)/(24*f*Math.pow(d,3))*(5+3*l+h-9*l*h),y=Math.tan(s)/(720*f*Math.pow(d,5))*(61+90*l+45*l*l),m=u/d,g=u/(6*d*d*d)*(d/f+2*l),S=u/(120*Math.pow(d,5))*(5+28*l+24*l*l),b=u/(5040*Math.pow(d,7))*(61+662*l+1320*l*l+720*l*l*l),N=s-p*Math.pow(o-t,2)+v*Math.pow(o-t,4)-y*Math.pow(o-t,6),T=m*(o-t)-.034906585039887-g*Math.pow(o-t,3)+S*Math.pow(o-t,5)-b*Math.pow(o-t,7);return new $k(zk*N,zk*T).to_WGS84()};var cL=function(){var e=function(){};return(e.prototype=new Wk).constructor=e,e.prototype.country="GB",e.prototype.GridCoords=sL,e.prototype.parse_well_formed=function(e){e.length>=5&&/^[A-Z]/.test(e.charAt(4))&&(Wk.quadrantOffsets.hasOwnProperty(e.substr(e.length-2))?this.quadrantCode=e.substr(e.length-2):this.tetradLetter=e.charAt(4),e=e.substr(0,4)),this.parse_wellformed_gb_gr_string_no_tetrads(e),this.tetradLetter||this.quadrantCode?this.tetradLetter?(this.preciseGridRef=this.tetrad=this.hectad+this.tetradLetter,this.length=2e3,this.gridCoords.x+=Wk.tetradOffsets[this.tetradLetter][0],this.gridCoords.y+=Wk.tetradOffsets[this.tetradLetter][1]):(this.preciseGridRef=this.quadrant=e+this.quadrantCode,this.length=5e3,this.gridCoords.x+=Wk.quadrantOffsets[this.quadrantCode][0],this.gridCoords.y+=Wk.quadrantOffsets[this.quadrantCode][1]):(this.preciseGridRef=e,this.length<=1e3&&this.set_tetrad())},e.prototype.from_string=function(e){var t,r=e.replace(/[\[\]\s\t\.-]+/g,"").toUpperCase(),n="";if(/[ABCDEFGHIJKLMNPQRSTUVWXYZ]$/.test(r)&&(Wk.quadrantOffsets.hasOwnProperty(r.substr(r.length-2))?(this.quadrantCode=r.substr(r.length-2),r=r.substr(0,r.length-2)):(n=r.substr(r.length-1),r=r.substr(0,r.length-1))),r===parseInt(r,10).toString()?r=r.substr(0,2)+"/"+r.substr(2):r.length>3&&"/"===r.charAt(2)&&/^[A-Z]{2}$/.test(r.substr(0,2))&&(r=r.replace("/","")),"VC"===r.substr(0,2))this.error=!0,this.errorMessage="Misplaced vice-county code in grid-reference field. ('"+r+"')",this.gridCoords=null,this.length=0;else if(null!==(t=r.match(/^([A-Z]{2}(?:\d\d){1,5})$/)))r=t[0],this.parse_wellformed_gb_gr_string_no_tetrads(r),this.length>0?1e4===this.length&&(n||this.quadrantCode)?n?(this.preciseGridRef=r+n,this.tetradLetter=n,this.tetrad=this.hectad+n,this.length=2e3,this.gridCoords.x+=Wk.tetradOffsets[n][0],this.gridCoords.y+=Wk.tetradOffsets[n][1]):(this.preciseGridRef=r+this.quadrantCode,this.tetradLetter="",this.tetrad="",this.quadrant=this.preciseGridRef,this.length=5e3,this.gridCoords.x+=Wk.quadrantOffsets[this.quadrantCode][0],this.gridCoords.y+=Wk.quadrantOffsets[this.quadrantCode][1]):(this.preciseGridRef=r,this.length<=1e3&&this.set_tetrad()):(this.error=!0,this.errorMessage="GB grid reference format not understood (strange length).");else if(/^([\d]{2})\/((?:\d\d){1,5})$/.test(r)){switch(this.parse_gr_string_without_tetrads(r),this.length){case 1e4:r=this.gridCoords.to_gridref(1e4),this.hectad=r,n?(r+=n,this.tetradLetter=n,this.tetrad=this.hectad+n,this.length=2e3,this.gridCoords.x+=Wk.tetradOffsets[n][0],this.gridCoords.y+=Wk.tetradOffsets[n][1]):this.quadrantCode&&(r+=this.quadrantCode,this.quadrant=r,this.length=5e3,this.gridCoords.x+=Wk.quadrantOffsets[this.quadrantCode][0],this.gridCoords.y+=Wk.quadrantOffsets[this.quadrantCode][1]);break;case 1e3:case 100:case 10:case 1:r=this.gridCoords.to_gridref(this.length),this.hectad=this.gridCoords.to_gridref(1e4),this.set_tetrad();break;default:this.error=!0,this.errorMessage="Bad grid square dimension ("+this.length+" m).",this.gridCoords=null,this.length=0}this.preciseGridRef=r}else this.gridCoords=null,this.length=0,this.error=!0,this.errorMessage="Grid reference format not understood. ('"+e+"')"},e.prototype.parse_gr_string_without_tetrads=function(e){var t,r,n,o;if(null!==(t=e.match(/^(\d{2})\/((?:\d\d){1,5})$/))){switch(t[1]){case"57":r=3e5,n=1e6;break;case"67":r=4e5,n=1e6;break;case"58":r=3e5,n=11e5;break;case"68":r=4e5,n=11e5;break;case"69":r=4e5,n=12e5;break;default:r=1e5*e.charAt(0),n=1e5*e.charAt(1)}o=t[2]}else{if(!Wk.letterMapping.hasOwnProperty(e.charAt(0))||!Wk.letterMapping.hasOwnProperty(e.charAt(1)))return this.length=0,void(this.gridCoords=null);var a=Wk.letterMapping[e.charAt(0)],i=Wk.letterMapping[e.charAt(1)];o=e.substr(2),r=a%5*5e5+i%5*1e5-1e6,n=5e5*-Math.floor(a/5)-1e5*Math.floor(i/5)+19e5}switch(o.length){case 2:this.gridCoords=new sL(r+1e4*o.charAt(0),n+1e4*o.charAt(1)),this.length=1e4;break;case 4:this.gridCoords=new sL(r+1e3*Math.floor(o/100),n+o%100*1e3),this.length=1e3;break;case 6:this.gridCoords=new sL(r+100*Math.floor(o/1e3),n+o%1e3*100),this.length=100;break;case 8:this.gridCoords=new sL(r+10*Math.floor(o/1e4),n+o%1e4*10),this.length=10;break;case 10:this.gridCoords=new sL(r+Math.floor(o/1e5),n+o%1e5),this.length=1;break;default:Logger("Bad grid ref length, ref="+e),this.gridCoords=null,this.length=0}},e.prototype.parse_wellformed_gb_gr_string_no_tetrads=function(e){var t,r,n,o,a;switch(t=Wk.letterMapping[e.charAt(0)],r=Wk.letterMapping[e.charAt(1)],n=e.substr(2),o=t%5*5e5+r%5*1e5-1e6,a=5e5*-Math.floor(t/5)-1e5*Math.floor(r/5)+19e5,n.length){case 2:this.gridCoords=new sL(o+1e4*n.charAt(0),a+1e4*n.charAt(1)),this.length=1e4,this.hectad=e;break;case 4:this.gridCoords=new sL(o+1e3*Math.floor(n/100),a+n%100*1e3),this.length=1e3,this.hectad=e.substr(0,3)+e.substr(4,1);break;case 6:this.gridCoords=new sL(o+100*Math.floor(n/1e3),a+n%1e3*100),this.length=100,this.hectad=e.substr(0,3)+e.substr(5,1);break;case 8:this.gridCoords=new sL(o+10*Math.floor(n/1e4),a+n%1e4*10),this.length=10,this.hectad=e.substr(0,3)+e.substr(6,1);break;case 10:this.gridCoords=new sL(o+Math.floor(n/1e5),a+n%1e5),this.length=1,this.hectad=e.substr(0,3)+e.substr(7,1);break;default:throw this.gridCoords=null,new Error("Bad grid ref length when parsing supposedly well-formed ref, ref='"+e+"'")}},e}(),lL=function(){var e=function(e,t){this.x=e,this.y=t};return(e.prototype=new rL).constructor=e,e.prototype.country="IE",e.irishGrid={0:["V","Q","L","F","A"],1:["W","R","M","G","B"],2:["X","S","N","H","C"],3:["Y","T","O","J","D"]},e.prototype.to_latLng=function(){var e=6377340.189,t=.0066705402933363,r=.0016732203841521,n=this.x-2e5,o=(5929615.3530033+(this.y-25e4)/1.000035)/6366691.7742864415,a=o+.002509826623715886*Math.sin(2*o)+36745487490091978e-22*Math.sin(4*o)+151*r*r*r/96*Math.sin(6*o),i=e/Math.sqrt(1-t*Math.sin(a)*Math.sin(a)),s=Math.tan(a)*Math.tan(a),c=.0067153352074207*Math.cos(a)*Math.cos(a),l=e*(1-t)/Math.pow(1-t*Math.sin(a)*Math.sin(a),1.5),u=n/(1.000035*i),d=a-i*Math.tan(a)/l*(u*u/2-(5+3*s+10*c-4*c*c-.0604380168667863)*u*u*u*u/24+(61+90*s+298*c+45*s*s-1.6922644722700164-3*c*c)*u*u*u*u*u*u/720);d*=zk;var f=(u-(1+2*s+c)*u*u*u/6+(5-2*c+28*s-3*c*c+.0537226816593656+24*s*s)*u*u*u*u*u/120)/Math.cos(a);return new tL(d,f=f*zk-8).to_WGS84()},e.prototype.to_gridref=function(t){var r=Math.floor(this.x/1e5),n=Math.floor(this.y/1e5);return e.irishGrid[r]&&e.irishGrid[r][n]?nL(e.irishGrid[r][n],this.x-1e5*r,this.y-1e5*n,t||1):null},e.prototype.to_hectad=function(){var t=Math.floor(this.x/1e5),r=Math.floor(this.y/1e5);return e.irishGrid[t]&&e.irishGrid[t][r]?e.irishGrid[t][r]+Math.floor(this.x%1e5/1e4)+Math.floor(this.y%1e5/1e4):""},e}(),uL=function(){var e=function(){};return(e.prototype=new Wk).constructor=e,e.prototype.country="IE",e.prototype.GridCoords=lL,e.gridLetter={A:[0,4],B:[1,4],C:[2,4],D:[3,4],F:[0,3],G:[1,3],H:[2,3],J:[3,3],L:[0,2],M:[1,2],N:[2,2],O:[3,2],Q:[0,1],R:[1,1],S:[2,1],T:[3,1],V:[0,0],W:[1,0],X:[2,0],Y:[3,0]},e.prototype.from_string=function(t){var r=t.replace(/[\[\]\s\t\.-]+/g,"").toUpperCase();/[ABCDEFGHIJKLMNPQRSTUVWXYZ]$/.test(r)&&(e.quadrantOffsets.hasOwnProperty(r.substr(r.length-2))?(this.quadrantCode=r.substr(r.length-2),r=r.substr(0,r.length-2)):(this.tetradLetter=r.substr(r.length-1),r=r.substr(0,r.length-1))),this.parse_gr_string_without_tetrads(r),this.length>0?this.tetradLetter||this.quadrantCode?this.tetradLetter?(this.preciseGridRef=this.hectad+this.tetradLetter,this.tetrad=this.preciseGridRef,this.length=2e3,this.gridCoords.x+=e.tetradOffsets[this.tetradLetter][0],this.gridCoords.y+=e.tetradOffsets[this.tetradLetter][1]):(this.preciseGridRef=this.hectad+this.quadrantCode,this.quadrant=this.preciseGridRef,this.length=5e3,this.gridCoords.x+=e.quadrantOffsets[this.quadrantCode][0],this.gridCoords.y+=e.quadrantOffsets[this.quadrantCode][1]):(this.preciseGridRef=r,this.length<=1e3&&this.set_tetrad()):(this.error=!0,this.errorMessage="Irish grid reference format not understood. ('"+t+"')")},e.prototype.parse_well_formed=e.prototype.from_string,e._IE_GRID_LETTERS="VQLFAWRMGBXSNHCYTOJD",e.prototype.parse_gr_string_without_tetrads=function(t){var r,n,o,a;if(/^\d{2}\/(?:\d\d){1,5}$/.test(t)){if(r=parseInt(t.charAt(0),10),n=parseInt(t.charAt(1),10),r>3||n>4)return Logger("bad grid square, ref='"+t+"' (Ireland)"),this.length=0,!1;o=t.substr(3),a=e._IE_GRID_LETTERS.charAt(5*r+n),r*=1e5,n*=1e5}else{if(t=t.replace("/",""),!/^[ABCDFGHJLMNOQRSTVWXY](?:\d\d){1,5}$/.test(t))return this.length=0,this.gridCoords=null,!1;if(!t)return Logger("Bad (empty) Irish grid ref"),this.length=0,this.gridCoords=null,!1;a=t.charAt(0);var i=e._IE_GRID_LETTERS.indexOf(a);if(-1===i)return Logger("Bad grid ref grid-letter, ref='"+t+"' (Ireland)"),this.length=0,this.gridCoords=null,!1;r=1e5*Math.floor(i/5),n=i%5*1e5,o=t.substr(1)}switch(o.length){case 2:this.gridCoords=new lL(r+1e4*o.charAt(0),n+1e4*o.charAt(1)),this.length=1e4,this.hectad=a+o;break;case 4:this.gridCoords=new lL(r+1e3*Math.floor(o/100),n+o%100*1e3),this.length=1e3,this.hectad=a+o.charAt(0)+o.charAt(2);break;case 6:this.gridCoords=new lL(r+100*Math.floor(o/1e3),n+o%1e3*100),this.length=100,this.hectad=a+o.charAt(0)+o.charAt(3);break;case 8:this.gridCoords=new lL(r+10*Math.floor(o/1e4),n+o%1e4*10),this.length=10,this.hectad=a+o.charAt(0)+o.charAt(4);break;case 10:this.gridCoords=new lL(r+Math.floor(o/1e5),n+o%1e5),this.length=1,this.hectad=a+o.charAt(0)+o.charAt(5);break;default:return Logger("Bad grid ref length, ref='"+t+"' (Ireland)"),this.length=0,this.gridCoords=null,!1}return!0},e}();Wk.from_string=function(e){var t,r=e.replace(/\s+/g,"").toUpperCase();if(!r)return!1;if(/^[A-Z]{1,2}\d{2}(?:[A-Z]|[NS][EW]|(?:\d{2}){0,4})?$/.test(r))return(t=/^.\d/.test(r)?new Wk.GridRefIE:"W"===r.charAt(0)?new iL:new cL).parse_well_formed(r),!(!t.length||t.error)&&t;if((t=new cL).from_string(r),t.length&&!t.error)return t;if("W"===r.charAt(0)){if((t=new iL).from_string(r),t.length&&!t.error)return t}else if((t=new uL).from_string(r),t.length&&!t.error)return t;return!1};var dL=sL;$k.prototype.to_os_coords=function(){var e=this.lat*Qk,t=this.lng*Qk,r=.0066705397616,n=Math.sin(e)*Math.sin(e),o=6375020.480988971/Math.sqrt(1-r*n),a=o*(1-r)/(1-r*n),i=o/a-1,s=t- -.03490658503988659,c=o*Math.cos(e),l=Math.pow(Math.cos(e),3),u=Math.tan(e)*Math.tan(e),d=o/6*l*(o/a-u),f=Math.pow(Math.cos(e),5),h=Math.pow(Math.tan(e),4),p=o/120*f*(5-18*u+h+14*i-58*u*i),v=4e5+s*c+Math.pow(s,3)*d+Math.pow(s,5)*p,y=Zk._Marc(6353722.490487913,.0016732202503250907,.8552113334772214,e)+-1e5,m=o/2*Math.sin(e)*Math.cos(e),g=o/24*Math.sin(e)*Math.pow(Math.cos(e),3)*(5-Math.pow(Math.tan(e),2)+9*i),S=o/720*Math.sin(e)*f*(61-58*u+h),b=y+s*s*m+Math.pow(s,4)*g+Math.pow(s,6)*S;return new dL(Math.round(v),Math.round(b))};var fL=lL;tL.prototype.to_os_coords=function(){var e=this.lat*Qk,t=this.lng*Qk,r=.00667054015,n=Math.sin(e)*Math.sin(e),o=6377563.395906615/Math.sqrt(1-r*n),a=o*(1-r)/(1-r*n),i=o/a-1,s=t- -.13962634015954636,c=o*Math.cos(e),l=Math.pow(Math.cos(e),3),u=Math.tan(e)*Math.tan(e),d=o/6*l*(o/a-u),f=Math.pow(Math.cos(e),5),h=Math.pow(Math.tan(e),4),p=o/120*f*(5-18*u+h+14*i-58*u*i),v=2e5+s*c+Math.pow(s,3)*d+Math.pow(s,5)*p,y=Zk._Marc(6356256.908205645,.0016732203841520518,.9337511498169663,e)+25e4,m=o/2*Math.sin(e)*Math.cos(e),g=o/24*Math.sin(e)*Math.pow(Math.cos(e),3)*(5-Math.pow(Math.tan(e),2)+9*i),S=o/720*Math.sin(e)*f*(61-58*u+h),b=y+s*s*m+Math.pow(s,4)*g+Math.pow(s,6)*S;return new fL(Math.round(v),Math.round(b))};var hL=oL;function pL(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}eL.prototype.to_os_coords=function(){var e=this.lat*Qk,t=this.lng*Qk,r=.0067226700223333,n=Math.sin(e)*Math.sin(e),o=6375836.6448/Math.sqrt(1-r*n),a=o*(1-r)/(1-r*n),i=o/a-1,s=t- -.0523598775598,c=o*Math.cos(e),l=Math.pow(Math.cos(e),3),u=Math.tan(e)*Math.tan(e),d=o/6*l*(o/a-u),f=Math.pow(Math.cos(e),5),h=Math.pow(Math.tan(e),4),p=o/120*f*(5-18*u+h+14*i-58*u*i),v=5e5+s*c+Math.pow(s,3)*d+Math.pow(s,5)*p,y=Zk._Marc(6354369.181221601,.0016863406508729017,0,e)+0,m=o/2*Math.sin(e)*Math.cos(e),g=o/24*Math.sin(e)*Math.pow(Math.cos(e),3)*(5-Math.pow(Math.tan(e),2)+9*i),S=o/720*Math.sin(e)*f*(61-58*u+h),b=y+s*s*m+Math.pow(s,4)*g+Math.pow(s,6)*S;return new hL(Math.round(v),Math.round(b))};var vL=new WeakMap,yL=new WeakMap;!function(e){yy(r,rR);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(e){var n;return id(this,r),pL(py(n=t.call(this,e)),vL,{writable:!0,value:void 0}),pL(py(n),yL,{writable:!0,value:void 0}),ld(py(n),"_value",""),ld(py(n),"_inputType","text"),ld(py(n),"_autocomplete",""),e&&(e.type&&(n._inputType=e.type),e.placeholder&&(n.placeholder=e.placeholder),e.autocomplete&&(n._autocomplete=e.autocomplete)),n}cd(r,[{key:"value",get:function(){return this._value},set:function(e){this._value=void 0===e||null==e?"":e.trim(),this.updateView()}},{key:"updateView",value:function(){this._fieldEl&&(document.getElementById(Ty(this,vL)).value=rR.cleanRawString(this._value))}},{key:"buildField",value:function(){var e=document.createElement("div");e.className="form-group",Ny(this,yL,e.id=rR.nextId),Ny(this,vL,rR.nextId);var t=e.appendChild(document.createElement("label"));t.htmlFor=Ty(this,vL),t.textContent=this.label;var r=e.appendChild(document.createElement("div"));r.className="input-group";var n=r.appendChild(document.createElement("input"));n.className="form-control",n.id=Ty(this,vL),n.type="text",this.placeholder&&(n.placeholder=this.placeholder),this._autocomplete&&(n.autocomplete=this._autocomplete,"off"===this._autocomplete&&(n.name=HO()));var o=r.appendChild(document.createElement("span"));if(o.className="input-group-btn",navigator.geolocation){var a=o.appendChild(document.createElement("button"));a.id=rR.nextId,a.type="button",a.className="btn btn-outline-secondary btn-sm",a.title="use GPS";var i=a.appendChild(document.createElement("span"));i.className="material-icons",i.innerText="gps_not_fixed",a.addEventListener("click",this.gpsButtonClickHandler.bind(this))}if(this.completion===rR.COMPLETION_COMPULSORY&&(n.required=!0),this.validationMessage){var s=e.appendChild(document.createElement("div"));s.className="invalid-feedback",s.innerHTML=this.validationMessage}this.helpText&&(e.appendChild(document.createElement("small")).innerHTML=this.helpText),n.addEventListener("change",this.inputChangeHandler.bind(this)),this._fieldEl=e}},{key:"markValidity",value:function(e){var t=document.getElementById(Ty(this,vL));null===e?t.classList.remove("is-invalid","is-valid"):(t.classList.remove(e?"is-invalid":"is-valid"),t.classList.add(e?"is-valid":"is-invalid"))}},{key:"inputChangeHandler",value:function(e){e.stopPropagation(),console.log("got input field change event"),this.value=rR.cleanRawString(document.getElementById(Ty(this,vL)).value),this.fireEvent(rR.EVENT_CHANGE)}},{key:"gpsButtonClickHandler",value:function(e){var t=this;console.log("got gps button click event"),navigator.geolocation.getCurrentPosition((function(e){var r=e.coords.latitude,n=e.coords.longitude;console.log("Got GPS fix ".concat(r," , ").concat(n));var o=rL.from_latlng(r,n).to_gridref(1e3);console.log("Got grid-ref: ".concat(o)),t.value=o,t.fireEvent(rR.EVENT_CHANGE)}),(function(e){console.log("gps look-up failed"),console.log(e)}))}}],[{key:"summariseImpl",value:function(e,t,r){return""!==r[e]&&null!==r[e]&&void 0!==r[e]?UO(r[e].trim()):""}}])}();var mL=function(e){yy(r,uR);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(e){var n;if(id(this,r),ld(py(n=t.call(this)),"_occurrence",void 0),ld(py(n),"surveyId",""),(this instanceof r?this.constructor:void 0)===r)throw new TypeError("Cannot construct OccurrenceForm instances directly, class should be overridden.");return e&&(n.model=e),n}return cd(r,[{key:"formElement",get:function(){var e=arguments,t=Cb(Sy(r.prototype),"formElement",this);return this._formFieldsBuilt||(this.buildFormFields(),t.addEventListener("change",(function(){console.log("occurrence form change event"),console.log(e)}),{capture:!1})),t}},{key:"buildContentContainer",value:function(e){var t=e.appendChild(document.createElement("div"));t.className="card mt-3 ml-0 mr-0 mb-3";var n=t.appendChild(document.createElement("div"));return n.className="card-header",n.textContent=r.sectionTitle,this._formContentContainer=t.appendChild(document.createElement("div")),this._formContentContainer.className="card-body",this._formContentContainer}},{key:"occurrenceId",get:function(){return this._occurrence?this._occurrence.id:null}},{key:"projectId",get:function(){return this._occurrence?this._occurrence.projectId:null}},{key:"initialiseFormFields",value:function(){var e=r.properties;for(var t in this.fields={},e)e.hasOwnProperty(t)&&(this.fields[t]=new e[t].field(e[t].attributes))}},{key:"updateModelFromContent",value:function(){for(var e in console.log("updating occurrence from OccurrenceForm content"),this.fields)if(this.fields.hasOwnProperty(e)){var t=this.fields[e];this._occurrence.attributes[e]=t.value}console.log({occurrence:this._occurrence})}},{key:"model",get:function(){return this._occurrence},set:function(e){this._occurrence=e,this.populateFormContent()}},{key:"changeHandler",value:function(e){console.log("occurrence form change event"),console.log({event:e}),this.fireEvent(uR.CHANGE_EVENT,{form:this})}},{key:"pingOccurrence",value:function(){this._occurrence.unsaved()&&this.fireEvent(uR.CHANGE_EVENT,{form:this})}},{key:"destructor",value:function(){this._occurrence=null,Cb(Sy(r.prototype),"destructor",this).call(this)}},{key:"getFormSectionProperties",value:function(){return r.properties}}]),r}();ld(mL,"properties",void 0),ld(mL,"sectionTitle","Occurrence form"),ld(mL,"help","Records help text, should normally be initialised with an imported html template");var gL=function e(){id(this,e)};function SL(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return bL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?bL(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function bL(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NL(e,t){wL(e,t),t.add(e)}function TL(e,t,r){wL(e,t),t.set(e,r)}function wL(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function EL(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}ld(gL,"sectionTitle",void 0),ld(gL,"sectionSortOrder",void 0),ld(gL,"sectionNavigationKey",void 0),ld(gL,"help",""),ld(gL,"properties",void 0);var _L=new WeakMap,OL=new WeakMap,RL=new WeakMap,IL=new WeakSet,xL=new WeakSet,CL=new WeakSet,AL=new WeakSet,kL=new WeakSet,LL=new WeakSet,ML=new WeakSet,PL=new WeakSet,HL=new WeakSet,DL=new WeakSet,FL=new WeakSet,jL=new WeakSet,UL=function(e){yy(r,cx);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sy(e);if(t){var o=Sy(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gy(this,r)}}(r);function r(){var e;id(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return NL(py(e=t.call.apply(t,[this].concat(o))),jL),NL(py(e),FL),NL(py(e),DL),NL(py(e),HL),NL(py(e),PL),NL(py(e),ML),NL(py(e),LL),NL(py(e),kL),NL(py(e),AL),NL(py(e),CL),NL(py(e),xL),NL(py(e),IL),ld(py(e),"controller",void 0),TL(py(e),_L,{writable:!0,value:{}}),TL(py(e),OL,{writable:!0,value:void 0}),TL(py(e),RL,{writable:!0,value:{}}),ld(py(e),"panelKey",""),ld(py(e),"OCCURRENCES_ARE_LAST_SECTION",!0),ld(py(e),"occurrenceSummaryText","Placeholder occurrence summary text in MainView.js"),ld(py(e),"welcomeContent","Placeholder welcome text in MainView.js"),ld(py(e),"defaultRightHandSideHelp","Default right-hand side help text in MainView.js"),e}return cd(r,[{key:"initialise",value:function(){this.controller.app.addListener(gx.EVENT_OCCURRENCE_ADDED,this.occurrenceAddedHandler.bind(this))}},{key:"setLayout",value:function(){var e=this;document.getElementById("body").innerHTML='\r\n<div class="container-fluid">\r\n    <div class="row" style="height: 90vh;">\r\n        <div class="col d-md-block pr-md-0 pt-3" id="col1panel" style="overflow-y: auto; max-height: calc(100vh - 5rem);">\r\n        </div>\r\n        <div class="col d-md-none pl-0 pr-0" id="ctrlpanel" style="background-color: aliceblue; width: 28px; max-width: 28px; overflow-y: hidden; ">\r\n            <button class="navbar-light navbar-toggler pl-0 pr-0" type="button" aria-label="Back" id="right-panel-back">\r\n                <i class="material-icons-round" style="color: gray;">view_list</i>\r\n            </button>\r\n        </div>\r\n        <div class="col d-md-block pr-md-0" id="col2panel" style="overflow-y: auto; height: 100%;">\r\n        </div>\r\n    </div>\r\n</div>\r\n',document.getElementById("right-panel-back").addEventListener("click",(function(t){t.stopPropagation(),t.preventDefault(),e.fireEvent(yR.EVENT_BACK)}))}},{key:"refreshLeftPanelAccordionState",value:function(){var e,t=document.querySelectorAll("div#".concat(this.leftPanelAccordionId,' div[data-parent="#').concat(this.leftPanelAccordionId,'"].collapse'));e=this.controller.viewSubcontext?"record"===this.controller.viewSubcontext?"record":this.controller.surveySection:"";var r,n=SL(t);try{for(n.s();!(r=n.n()).done;){var o=r.value;o.getAttribute("data-sectionkey")===e?o.classList.add("show"):o.classList.remove("show")}}catch(e){n.e(e)}finally{n.f()}this._refreshOccurrenceAccordionState()}},{key:"_refreshOccurrenceAccordionState",value:function(){var e,t=document.querySelectorAll("div#".concat("occurrencelistcontainer",' div[data-parent="#').concat("occurrencelistcontainer",'"].collapse')),r=this.controller.currentOccurrenceId,n=SL(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;o.getAttribute("data-occurrenceid")===r?o.classList.add("show"):o.classList.remove("show")}}catch(e){n.e(e)}finally{n.f()}}},{key:"display",value:function(){if(this.controller.needsFullRefresh?(console.log("Full refresh triggered."),this.setLayout(),EL(this,kL,GL).call(this)):this.refreshLeftPanelAccordionState(),this.controller.needRightPanelRefresh)switch(this.controller.viewSubcontext){case"record":EL(this,xL,YL).call(this);break;case"survey":EL(this,IL,BL).call(this);break;default:EL(this,CL,VL).call(this)}this.setResponsivePanel(""===this.panelKey?"left":"right")}},{key:"refreshOccurrenceFooterControls",value:function(e){var t=this,r=e.appendChild(document.createElement("div")),n=r.appendChild(document.createElement("button"));if(n.className="btn btn-secondary btn-md-lg mt-2 mb-3 mr-2",n.type="button",n.textContent="back to list",n.setAttribute("data-buttonaction","back"),this.occurrenceIsMostRecent(this.controller.currentOccurrence)){var o=r.appendChild(document.createElement("button"));o.className="btn btn-primary btn-md-lg mt-2 mb-3 mr-2",o.type="button",o.textContent="add another",o.setAttribute("data-buttonaction","new")}if(this.OCCURRENCES_ARE_LAST_SECTION){var a=r.appendChild(document.createElement("button"));a.className="btn btn-primary btn-md-lg mt-2 mb-3",a.type="button",a.textContent="finish",a.setAttribute("data-buttonaction","finish")}else{var i=ux.sections[1],s=r.appendChild(document.createElement("button"));s.className="btn btn-primary btn-md-lg mt-2 mb-3",s.type="button",s.textContent="next Â»",s.setAttribute("data-buttonaction","next"),s.title=i.sectionTitle}r.addEventListener("click",(function(e){var r=e.target.closest("button");if(r&&r.hasAttribute("data-buttonaction"))switch(r.getAttribute("data-buttonaction")){case"new":t.fireEvent(yR.EVENT_NEW_RECORD);break;case"back":t.controller.app.router.navigate("/list/record/");break;case"finish":t.controller.app.router.navigate("/list/record/"),$("#".concat("finishmodal")).modal();break;case"next":t.controller.app.router.navigate("/list/survey/".concat(nextSection.sectionNavigationKey));break;default:throw new Error("Unrecognised button action ".concat(r.getAttribute("data-buttonaction")))}}))}},{key:"occurrenceIsMostRecent",value:function(e){var t,r=SL(this.controller.occurrences.entries());try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n[1].createdStamp>e.createdStamp&&!n[1].deleted)return!1}}catch(e){r.e(e)}finally{r.f()}return!0}},{key:"newButtonClickHandler",value:function(e){e.preventDefault(),e.stopPropagation(),this.fireEvent(yR.EVENT_NEW_RECORD)}},{key:"occurrenceAddedHandler",value:function(e){var t=document.getElementById("occurrencelistcontainer");if(t){var r=this.controller.occurrences.get(e.occurrenceId),n=document.createElement("div");n.className="card",n.id="card_".concat(r.id),n.innerHTML=EL(this,jL,$L).call(this,r),Ty(this,RL)[r.id]=r.addListener(hR.EVENT_MODIFIED,this.occurrenceChangeHandler.bind(this),{occurrenceId:r.id}),t.insertBefore(n,t.firstChild)}}},{key:"refreshOccurrenceValiditySummary",value:function(e){var t=document.getElementById("card_".concat(e.id));t&&(e.evaluateCompletionStatus(mL.properties).requiredFieldsPresent?t.classList.remove("is-invalid"):t.classList.add("is-invalid"))}},{key:"occurrenceChangeHandler",value:function(e){var t=this.controller.occurrences.get(e.occurrenceId),r=document.getElementById("card_".concat(e.occurrenceId));r&&(t.deleted?(r.parentElement.removeChild(r),Ty(this,RL)[e.occurrenceId]&&(t.removeListener(hR.EVENT_MODIFIED,Ty(this,RL)[e.occurrenceId]),Ty(this,RL)[e.occurrenceId]=null)):(r.innerHTML=EL(this,jL,$L).call(this,t),this.refreshOccurrenceValiditySummary(t)))}},{key:"occurrenceSummaryBodyHTML",value:function(e){var t="";for(var r in e.attributes)if(e.attributes.hasOwnProperty(r)&&mL.properties.hasOwnProperty(r)&&!mL.properties[r].field.isEmpty(e.attributes[r])){var n=mL.properties[r].field.summarise(r,mL.properties[r],e.attributes);n&&(t+='<p class="ellipsed-line mb-0">'.concat(n,"</p>"))}return gx.devMode&&(t+='<p class="mb-0">(<i>id '.concat(e.id,"</i>)</p>")),t}},{key:"occurrenceSummaryHeadingHTML",value:function(e){var t="";if(e.attributes.hasOwnProperty("images")&&e.attributes.images.length){var r=e.attributes.images[0];t+=fx.imageLink(r,48,48,{className:"mr-1"})}return e.attributes.taxon&&e.attributes.taxon.taxonId?t+=e.taxon.formattedHTML(e.attributes.taxon.vernacularMatch):e.attributes.taxon&&e.attributes.taxon.taxonName?t+=UO(e.attributes.taxon.taxonName):t+="<span>(unnamed plant)</span>",t}},{key:"setResponsivePanel",value:function(e){var t=document.getElementById("col2panel"),r=document.getElementById("col1panel"),n=document.getElementById("ctrlpanel");switch(e){case"left":r.classList.remove("d-none"),r.classList.add("d-block"),t.classList.remove("d-block"),t.classList.add("d-none"),n.classList.remove("d-md-none"),n.classList.add("d-none");break;case"right":r.classList.remove("d-block"),r.classList.add("d-none"),t.classList.remove("d-none"),t.classList.add("d-block"),n.classList.remove("d-none"),n.classList.add("d-md-none");break;default:throw new Error("Unrecognised panel value '".concat(e))}}}]),r}();function BL(){var e=document.getElementById("col2panel"),t=this.controller.surveySection,r=ux.sectionsByKey[t]?ux.sectionsByKey[t].help:"";e.innerHTML=r||("welcome"===t?this.defaultRightHandSideHelp:"<p>placeholder survey help content for '".concat(t,"'</p>"))}function YL(){try{var e=this.controller.currentOccurrence,t=document.getElementById("col2panel");if(e){Ty(this,OL)&&Ty(this,OL).occurrenceId===e.id||(Ty(this,OL)&&Ty(this,OL).destructor(),Ny(this,OL,e.setForm(new mL(e))),Ty(this,OL).surveyId=this.controller.app.currentSurvey.id,t.scrollTop=0),t.innerHTML="";var r=Ty(this,OL).formElement;t.appendChild(r),Ty(this,OL).populateFormContent(),this.refreshOccurrenceFooterControls(t),$("#description_".concat(e.id)).collapse("show")}else EL(this,CL,VL).call(this,mL.help)}catch(e){console.log({error:e});var n=document.getElementById("col2panel");n?n.innerHTML="<p>".concat(e.message,"</p>"):document.body.innerHTML="<h2>Internal error</h2><p>Please report this problem:</p><p>".concat(e.message,"</p>")}}function VL(e){document.getElementById("col2panel").innerHTML=e||this.defaultRightHandSideHelp}function JL(){for(var e in Ty(this,RL)){var t=this.controller.occurrences.get[e];t&&t.removeListener(hR.EVENT_MODIFIED,Ty(this,RL)[e])}Ny(this,RL,{})}function GL(){var e=this,t=document.getElementById("col1panel").appendChild(document.createElement("div"));t.className="accordion",this.leftPanelAccordionId=t.id=uR.nextId,EL(this,PL,WL).call(this),EL(this,HL,XL).call(this,0,t,UL.NEXT_RECORDS),EL(this,DL,QL).call(this),EL(this,FL,zL).call(this),t.addEventListener("click",(function(t){var r=t.target.closest("a");r&&r.hasAttribute("data-help-link")&&(t.preventDefault(),t.stopPropagation(),e.controller.app.router.navigate(r.getAttribute("data-help-link")))})),EL(this,ML,qL).call(this),EL(this,LL,KL).call(this)}function KL(){var e=this,t=document.body,r='<div class="modal fade" id="'.concat("deleteoccurrencemodal",'" tabindex="-1" role="dialog" aria-labelledby="').concat("deleteoccurrencemodal",'Title" aria-hidden="true">\n  <div class="modal-dialog modal-dialog-centered" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title" id="').concat("deleteoccurrencemodal",'Title">Delete record?</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body">\n        Please confirm that you wish to delete the record.\n      </div>\n      <div class="modal-footer">\n        <button type="button" class="btn btn-secondary" data-dismiss="modal">Back</button>\n        <button type="button" class="btn btn-danger" data-dismiss="modal" id="').concat("deleteoccurrencemodal",'confirmed">Delete record</button>\n      </div>\n    </div>\n  </div>\n</div>'),n=document.createElement("div");n.innerHTML=r,t.appendChild(n.firstChild),$("#".concat("deleteoccurrencemodal")).on("show.bs.modal",(function(e){var t=$(e.relatedTarget);if(t&&t.data("occurrenceid")){var r=t.data("occurrenceid");document.getElementById("".concat("deleteoccurrencemodal","confirmed")).setAttribute("data-occurrenceid",r)}})),document.getElementById("".concat("deleteoccurrencemodal","confirmed")).addEventListener("click",(function(t){var r=t.target.closest("button");if(r&&r.hasAttribute("data-occurrenceid")){var n=r.getAttribute("data-occurrenceid");console.log("Deleting occurrence ".concat(n,".")),e.fireEvent(yR.EVENT_DELETE_OCCURRENCE,{occurrenceId:n})}}));var o=document.createElement("div");o.innerHTML='<div class="modal fade" id="'.concat("finishmodal",'" tabindex="-1" role="dialog" aria-labelledby="').concat("finishmodal",'Title" aria-hidden="true">\n  <div class="modal-dialog modal-dialog-centered" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title" id="').concat("finishmodal",'Title">Thank you</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body">\n        <p>Thank you! Your form responses have been sent. If you wish, you can continue to make changes and edit or add further records.</p>\n        <p>If you provided an email address, then we will send you a message with a link to this form, so that you can return to it later if needed.</p>\n      </div>\n      <div class="modal-footer">\n        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\n      </div>\n    </div>\n  </div>\n</div>'),t.appendChild(o.firstChild),t.appendChild(VA.licenseModal());var a=document.createElement("div");a.innerHTML='<div class="modal fade" id="'.concat("imagemodal",'" tabindex="-1" role="dialog" aria-labelledby="').concat("imagemodal",'Title" aria-hidden="true">\n  <div class="modal-dialog modal-dialog-centered" role="document">\n    <div class="modal-content">\n      <div class="modal-header d-none d-md-flex">\n        <h5 class="modal-title" id="').concat("imagemodal",'Title">Photo</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body" style="position: relative;">\n        <picture>\n        </picture>\n      </div>\n      <div class="modal-footer">\n        <button type="button" id="').concat("imagemodaldelete",'" class="btn btn-outline-danger delete-occurrence-button mr-3" data-toggle="modal" data-target="#').concat("deleteimagemodal",'" data-imageid=""><i class="material-icons">delete</i></button>\n        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\n      </div>\n    </div>\n  </div>\n</div>'),t.appendChild(a.firstChild),document.getElementById("imagemodaldelete").addEventListener("click",(function(t){var r=t.target.closest("button");if(r&&r.hasAttribute("data-imageid")){var n=r.getAttribute("data-imageid");Ty(e,OL).fireEvent("deleteimage",{imageId:n}),$("#".concat("imagemodal")).modal("hide")}}))}function qL(){var e=this;$("#".concat("col1panel")).on("show.bs.collapse",(function(t){t.target.dataset.occurrenceid?(console.log({"left panel accordion show event (with occ id)":t}),e.fireEvent(yR.EVENT_SELECT_OCCURRENCE,{occurrenceId:t.target.dataset.occurrenceid})):t.target.dataset.sectionkey?(console.log({"left panel accordion show event (with section key)":t}),e.fireEvent(yR.EVENT_SELECT_SURVEY_SECTION,{sectionKey:t.target.dataset.sectionkey})):console.log({"left panel accordion show event (other)":t})})).on("hidden.bs.collapse",(function(t){if(console.log({"left panel accordion hide event":t}),t.target.dataset.occurrenceid){var r=e.controller.occurrences.get(t.target.dataset.occurrenceid);r.isNew&&!r.isPristine&&(r.isNew=!1,e.refreshOccurrenceValiditySummary(r)),e.controller.currentOccurrenceId===t.target.dataset.occurrenceid&&e.fireEvent(yR.EVENT_SELECT_OCCURRENCE,{occurrenceId:""})}else if(t.target.dataset.sectionkey)if("record"===t.target.dataset.sectionkey)"record"===e.controller.viewSubcontext&&e.fireEvent(yR.EVENT_SELECT_SURVEY_SECTION,{sectionKey:""});else if(Ty(e,_L)[t.target.dataset.sectionkey]){var n=Ty(e,_L)[t.target.dataset.sectionkey].validateForm();console.log({"survey section validity":n}),e.controller.surveySection===t.target.dataset.sectionkey&&e.fireEvent(yR.EVENT_SELECT_SURVEY_SECTION,{sectionKey:""})}}))}function WL(){var e=document.getElementById(this.leftPanelAccordionId),t=document.createElement("button");t.className="btn btn-primary",t.type="button",t.textContent="get started Â»",t.setAttribute("data-toggle","collapse"),t.setAttribute("data-target","#survey-0-about");var r=uR.nextId,n=document.createElement("div");n.innerHTML=this.welcomeContent,n.appendChild(t);var o=document.createElement("span");o.className="d-md-none pl-2",o.innerHTML='(<a href="/app/list/survey/welcome/help" data-navigo="list/survey/welcome/help">more info</a>)',n.appendChild(o),e.appendChild(this.card({cardId:r,cardHeadingId:uR.nextId,collapsed:"welcome"!==this.controller.surveySection,headingButtonId:uR.nextId,headingHTML:'<img src="/img/BSBIlong.png" alt="" style="float:right; max-width: 40%; max-height: 48px;"><div style="float: left;">Welcome</div>',buttonStyleString:"width: 100%",headingNonbuttonHTML:"",headingValidationWarningHTML:"",cardDescriptionId:"survey-welcome",parentContainerId:e.id,bodyContentElement:n,dataAttributes:{sectionkey:"welcome"}}))}function XL(e,t,r){var n=this,o=ux.sections[e],a=new ux(o);Ty(this,_L)[o.sectionNavigationKey]=a;var i=a.formElement,s=document.createElement("button");switch(s.className="btn btn-primary",s.type="button",s.textContent="next Â»",r){case UL.NEXT_RECORDS:s.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),n.fireEvent(yR.EVENT_NEXT_TO_RECORDS)}));break;case UL.NEXT_SURVEY_SECTION:var c=ux.sections[e+1];s.setAttribute("data-toggle","collapse"),s.setAttribute("data-target","#survey-".concat(e+1,"-").concat(c.sectionNavigationKey)),s.title=c.sectionTitle;break;case UL.NEXT_IS_FINAL:s.textContent="finish",s.className="btn btn-primary btn-md-lg mt-2 mb-3",s.type="button",s.addEventListener("click",(function(){n.controller.app.router.navigate("/list/"),$("#".concat("finishmodal")).modal()}));break;default:throw new Error("Unrecognized next section keyword '".concat(r,"'"))}i.appendChild(s);var l=uR.nextId;t.appendChild(this.card({cardId:l,cardHeadingId:uR.nextId,collapsed:this.controller.surveySection!==o.sectionNavigationKey,headingButtonId:uR.nextId,headingHTML:o.sectionTitle,headingNonbuttonHTML:'<small class="btn d-md-none" style="margin: 0; padding: 0;">(<a href="/app/list/survey/'.concat(o.sectionNavigationKey,'/help" data-help-link="/list/survey/').concat(o.sectionNavigationKey,'/help">help</a>)</small>'),headingValidationWarningHTML:"Please check the form for some missing responses.",cardDescriptionId:"survey-".concat(e,"-").concat(o.sectionNavigationKey),parentContainerId:t.id,bodyContentElement:i,dataAttributes:{sectionkey:o.sectionNavigationKey}})),this.controller.survey.registerForm(a),a.addListener(ux.EVENT_VALIDATION_STATE_CHANGE,(function(e){var t=document.getElementById(l);e.isValid?t.classList.remove("is-invalid"):t.classList.add("is-invalid")}))}function QL(){var e=document.getElementById(this.leftPanelAccordionId),t=document.createDocumentFragment();t.appendChild(document.createElement("p")).innerHTML="".concat(this.occurrenceSummaryText,'<small class="d-block d-md-none"><a href="/app/list/record/help">(help)</a></small>');var r=t.appendChild(document.createElement("button"));r.type="button",r.className="btn btn-primary btn-lg mb-2",r.innerText="Add a plant record.",r.addEventListener("click",this.newButtonClickHandler.bind(this)),t.appendChild(document.createElement("div")).id="occurrencelistcontainer",e.appendChild(this.card({cardId:uR.nextId,cardHeadingId:uR.nextId,collapsed:"record"!==this.controller.viewSubcontext,headingButtonId:uR.nextId,headingHTML:"Your plant records",cardDescriptionId:uR.nextId,parentContainerId:e.id,bodyContentElement:t,dataAttributes:{sectionkey:"record"}}))}function zL(){var e=document.getElementById("occurrencelistcontainer");if(!e)throw new pR("Failed to find list container.");EL(this,AL,JL).call(this);var t,r=[],n=SL(function(e){return function(e){if(Array.isArray(e))return NI(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||TI(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(this.controller.occurrences.entries()).sort((function(e,t){return t[1].createdStamp-e[1].createdStamp})));try{for(n.s();!(t=n.n()).done;){var o=t.value[1];if(console.log("displaying '".concat(o.id,"'")),!o.deleted){var a=o.isNew||o.evaluateCompletionStatus(mL.properties).requiredFieldsPresent;r.push('<div class="card'.concat(a?"":" is-invalid",'" id="card_').concat(o.id,'">\n    ').concat(EL(this,jL,$L).call(this,o),"\n</div>")),Ty(this,RL)[o.id]=o.addListener(hR.EVENT_MODIFIED,this.occurrenceChangeHandler.bind(this),{occurrenceId:o.id})}}}catch(e){n.e(e)}finally{n.f()}e.className="accordion",e.innerHTML=r.join(""),e.addEventListener("click",(function(e){var t=e.target.closest("button");t&&t.hasAttribute("data-toggle")&&"modal"===t.getAttribute("data-toggle")&&(document.getElementById("".concat("deleteoccurrencemodal","confirmed")).setAttribute("data-occurrenceid",t.getAttribute("data-occurrenceid")),$(t.getAttribute("data-target")).modal(),e.preventDefault(),e.stopPropagation())}))}function $L(e){return'<div class="card-header pointer pl-2 pr-2 pt-2 pb-2" id="heading_'.concat(e.id,'" data-toggle="collapse" data-target="#description_').concat(e.id,'">\n    <div class="float-right">\n        <button type="button" class="btn btn-outline-danger delete-occurrence-button" data-toggle="modal" data-target="#').concat("deleteoccurrencemodal",'" data-occurrenceid="').concat(e.id,'"><i class="material-icons">delete</i></button>\n    </div>\n    <h2 class="mb-0 pb-0 mt-0 pt-0 pl-0 ml-0">\n        <button class="btn btn-link').concat(this.controller.currentOccurrenceId===e.id?"":" collapsed",' pt-0 pb-0 pl-0" id="headingbutton_').concat(e.id,'" type="button" data-toggle="collapse" data-target="#description_').concat(e.id,'" aria-expanded="').concat(this.controller.currentOccurrenceId===e.id?"true":"false",'" aria-controls="description_').concat(e.id,'">\n          ').concat(this.occurrenceSummaryHeadingHTML(e),'\n        </button>\n    </h2>\n    <div class="card-invalid-feedback">\n        <small>Please check for errors or missing details.</small>\n    </div>\n</div>\n<div id="description_').concat(e.id,'" class="collapse').concat(this.controller.currentOccurrenceId===e.id?" show":"",'" aria-labelledby="heading_').concat(e.id,'" data-parent="#').concat("occurrencelistcontainer",'" data-occurrenceid="').concat(e.id,'">\n  <div class="card-body">\n    ').concat(this.occurrenceSummaryBodyHTML(e),"\n  </div>\n</div>")}ld(UL,"NEXT_RECORDS","records"),ld(UL,"NEXT_SURVEY_SECTION","survey"),ld(UL,"NEXT_IS_FINAL","last");var ZL=function(e){Zi(r,e);var t=os(r);function r(){var e;Xi(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return $i(rs(e=t.call.apply(t,[this].concat(o))),"projectId",2),e}return zi(r,[{key:"addSurvey",value:function(e){var t=this;if(e.projectId!==this.projectId)throw new Error("Survey project id '".concat(e.projectId," does not match with current project ('").concat(this.projectId,"')"));this.surveys.has(e.id)||(console.log("setting survey's modified/save handler"),e.addListener(dx.EVENT_MODIFIED,this,(function(e){return t.fireEvent(gx.EVENT_SURVEYS_CHANGED),e.save()}))),this.surveys.set(e.id,e),this.fireEvent(gx.EVENT_SURVEYS_CHANGED)}},{key:"haveExtantOccurrences",value:function(){var e,t=us(this.occurrences);try{for(t.s();!(e=t.n()).done;){if(!e.value.deleted)return!0}}catch(e){t.e(e)}finally{t.f()}return!1}},{key:"addOccurrence",value:function(e){var t=this;if(!e.surveyId)throw new pR("Survey id must set prior to registering occurrence.");0===this.occurrences.size&&(this.surveys.get(e.surveyId).createdStamp=e.createdStamp);this.occurrences.set(e.id,e),e.addListener(hR.EVENT_MODIFIED,this,(function(e){var r=t.surveys.get(e.surveyId);if(!r)throw new Error("Failed to look up survey id ".concat(e.surveyId));r.unsaved()&&r.save(),e.save(r.id)}))}},{key:"refreshFromServer",value:function(e){var t,n=this,o=new FormData,a=0,i=us(e);try{for(i.s();!(t=i.n()).done;){var s=t.value;o.append("surveyId[".concat(a++,"]"),s)}}catch(e){i.e(e)}finally{i.f()}return fetch(r.LOAD_SURVEYS_ENDPOINT,{method:"POST",body:o}).then((function(e){return e.ok?e.json():Promise.reject("Invalid response from server when refreshing survey ids")})).then((function(e){console.log({"refresh from server json response":e});var t=[];for(var r in e)if(e.hasOwnProperty(r)){var o,a=us(e[r]);try{for(a.s();!(o=a.n()).done;){var i=o.value;t.push(n._conditionallyReplaceObject(i))}}catch(e){a.e(e)}finally{a.f()}}return Promise.all(t)}))}},{key:"_conditionallyReplaceObject",value:function(e){var t=e.type,r=e.id,n="".concat(t,".").concat(r);return ad.getItem(n).then((function(t){return t&&!e.deleted&&t.modified>=e.modified?(console.log("Local copy of ".concat(n," is the same or newer than the server copy. (").concat(t.modified," >= ").concat(e.modified,") ")),Promise.resolve()):(console.log("Adding or replacing local copy of ".concat(n)),ad.setItem(n,e))}))}},{key:"seekKeys",value:function(e){return ad.keys().then((function(t){var r,n=us(t);try{for(n.s();!(r=n.n()).done;){var o,a,i=r.value,s=is(i.split(".",2),2);o=s[0],a=s[1],e.hasOwnProperty(o)?e[o].includes(a)||e[o].push(a):console.log("Unrecognised stored key type '".concat(o,"."))}}catch(e){n.e(e)}finally{n.f()}return e}))}},{key:"syncAll",value:function(){var e=this;return this.seekKeys({survey:[],occurrence:[],image:[]}).then((function(t){return e._syncLocalUnsaved(t)}),(function(e){console.log("Failed to sync all: ".concat(e))}))}},{key:"_syncLocalUnsaved",value:function(e){var t,r=[],n=us(e.survey);try{for(n.s();!(t=n.n()).done;){var o=t.value;r.push(dx.retrieveFromLocal(o,new dx).then((function(e){if(e.unsaved())return e.save()})))}}catch(e){n.e(e)}finally{n.f()}var a,i=us(e.occurrence);try{for(i.s();!(a=i.n()).done;){var s=a.value;r.push(hR.retrieveFromLocal(s,new hR).then((function(e){if(e.unsaved())return e.save()})))}}catch(e){i.e(e)}finally{i.f()}var c,l=us(e.image);try{for(l.s();!(c=l.n()).done;){var u=c.value;r.push(fx.retrieveFromLocal(u,new fx).then((function(e){if(e.unsaved())return e.save()})))}}catch(e){l.e(e)}finally{l.f()}return Promise.all(r).catch((function(e){console.log("Save failure: ".concat(e))}))}},{key:"restoreOccurrences",value:function(e){var t=this;if(this.surveys.has(e)){var r=this.surveys.get(e);if(r.isPristine)return this.currentSurvey=r,this.fireEvent(gx.EVENT_SURVEYS_CHANGED),Promise.resolve()}var n={survey:[],occurrence:[],image:[]};return e&&(n.survey[0]=e),this.seekKeys(n).then((function(e){return e.survey.length?t.refreshFromServer(e.survey).finally((function(){return t.seekKeys(e)})):null})).finally((function(){return n.survey.length?t._restoreSurveyFromLocal(n.survey[0],n).finally((function(){return t.currentSurvey=t.surveys.get(n.survey[0]),t.currentSurvey?(t.currentSurvey.deleted?t.setNewSurvey():t.fireEvent(gx.EVENT_SURVEYS_CHANGED),Promise.resolve()):(console.log("Failed to retrieve survey id '".concat(e,"'")),Promise.reject(new Error("Failed to retrieve survey id '".concat(e,"'"))))})):(t.setNewSurvey(),Promise.resolve())}))}},{key:"setNewSurvey",value:function(){this.currentSurvey=new dx,this.currentSurvey.projectId=this.projectId,this.currentSurvey.isPristine=!0,this.addSurvey(this.currentSurvey)}},{key:"addNewOccurrence",value:function(){var e=new hR;return e.surveyId=this.currentSurvey.id,e.projectId=this.projectId,e.isNew=!0,e.isPristine=!0,this.addOccurrence(e),this.fireEvent(r.EVENT_OCCURRENCE_ADDED,{occurrenceId:e.id,surveyId:e.surveyId}),e}},{key:"_restoreSurveyFromLocal",value:function(e,t){var r=this;return dx.retrieveFromLocal(e,new dx).then((function(n){r.clearCurrentSurvey(),r.addSurvey(n);var o,a=[],i=us(t.occurrence);try{for(i.s();!(o=i.n()).done;){var s=o.value;a.push(hR.retrieveFromLocal(s,new hR).then((function(t){t.surveyId===e&&r.addOccurrence(t)})))}}catch(e){i.e(e)}finally{i.f()}return Promise.all(a)})).finally((function(){var r,n=[],o=us(t.image);try{var a=function(){var t=r.value;n.push(fx.retrieveFromLocal(t,new fx).then((function(r){r.surveyId===e&&fx.imageCache.set(t,r)}),(function(e){console.log("Failed to retrieve an image: ".concat(e))})))};for(o.s();!(r=o.n()).done;)a()}catch(e){o.e(e)}finally{o.f()}return Promise.all(n)}))}},{key:"clearLocalForage",value:function(){return ad.clear()}}]),r}(gx);$i(ZL,"forageName","Nyph App"),$i(ZL,"LOAD_SURVEYS_ENDPOINT","/loadsurveys.php"),$i(ZL,"EVENT_OCCURRENCE_ADDED","occurrenceadded"),$i(ZL,"EVENT_SURVEYS_CHANGED","surveyschanged"),$i(ZL,"devMode",!1);var eM={exports:{}},tM={},rM=rr,nM=dr.f,oM={}.toString,aM="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];tM.f=function(e){return aM&&"[object Window]"==oM.call(e)?function(e){try{return nM(e)}catch(e){return aM.slice()}}(e):nM(rM(e))};var iM=!M((function(){return Object.isExtensible(Object.preventExtensions({}))})),sM=un,cM=rt,lM=re,uM=m,dM=ee.f,fM=dr,hM=tM,pM=iM,vM=!1,yM=b("meta"),mM=0,gM=Object.isExtensible||function(){return!0},SM=function(e){dM(e,yM,{value:{objectID:"O"+mM++,weakData:{}}})},bM=eM.exports={enable:function(){bM.enable=function(){},vM=!0;var e=fM.f,t=[].splice,r={};r[yM]=1,e(r).length&&(fM.f=function(r){for(var n=e(r),o=0,a=n.length;o<a;o++)if(n[o]===yM){t.call(n,o,1);break}return n},sM({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:hM.f}))},fastKey:function(e,t){if(!lM(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!uM(e,yM)){if(!gM(e))return"F";if(!t)return"E";SM(e)}return e[yM].objectID},getWeakData:function(e,t){if(!uM(e,yM)){if(!gM(e))return!0;if(!t)return!1;SM(e)}return e[yM].weakData},onFreeze:function(e){return pM&&vM&&gM(e)&&!uM(e,yM)&&SM(e),e}};cM[yM]=!0;var NM=N,TM=re,wM=gn,EM=function(e,t,r){var n,o;return wM&&NM(n=t.constructor)&&n!==r&&TM(o=n.prototype)&&o!==r.prototype&&wM(e,o),e},_M=un,OM=n,RM=tn,IM=z.exports,xM=eM.exports,CM=ro,AM=In,kM=N,LM=re,MM=M,PM=fo,HM=Tn,DM=EM,FM=function(e,t,r){var n=-1!==e.indexOf("Map"),o=-1!==e.indexOf("Weak"),a=n?"set":"add",i=OM[e],s=i&&i.prototype,c=i,l={},u=function(e){var t=s[e];IM(s,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(o&&!LM(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return o&&!LM(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(o&&!LM(e))&&t.call(this,0===e?0:e)}:function(e,r){return t.call(this,0===e?0:e,r),this})};if(RM(e,!kM(i)||!(o||s.forEach&&!MM((function(){(new i).entries().next()})))))c=r.getConstructor(t,e,n,a),xM.enable();else if(RM(e,!0)){var d=new c,f=d[a](o?{}:-0,1)!=d,h=MM((function(){d.has(1)})),p=PM((function(e){new i(e)})),v=!o&&MM((function(){for(var e=new i,t=5;t--;)e[a](t,t);return!e.has(-0)}));p||((c=t((function(t,r){AM(t,c,e);var o=DM(new i,t,c);return null!=r&&CM(r,o[a],{that:o,AS_ENTRIES:n}),o}))).prototype=s,s.constructor=c),(h||v)&&(u("delete"),u("has"),n&&u("get")),(v||f)&&u(a),o&&s.clear&&delete s.clear}return l[e]=c,_M({global:!0,forced:c!=i},l),HM(c,e),o||r.setStrong(c,e,n),c},jM=Pn,UM=Zt,BM=p,YM=wr,VM=xs,JM=[].push,GM=function(e){var t=1==e,r=2==e,n=3==e,o=4==e,a=6==e,i=7==e,s=5==e||a;return function(c,l,u,d){for(var f,h,p=BM(c),v=UM(p),y=jM(l,u,3),m=YM(v),g=0,S=d||VM,b=t?S(c,m):r||i?S(c,0):void 0;m>g;g++)if((s||g in v)&&(h=y(f=v[g],g,p),e))if(t)b[g]=h;else if(h)switch(e){case 3:return!0;case 5:return f;case 6:return g;case 2:JM.call(b,f)}else switch(e){case 4:return!1;case 7:JM.call(b,f)}return a?-1:n||o?o:b}},KM={forEach:GM(0),map:GM(1),filter:GM(2),some:GM(3),every:GM(4),find:GM(5),findIndex:GM(6),filterReject:GM(7)},qM=hn,WM=eM.exports.getWeakData,XM=ue,QM=re,zM=In,$M=ro,ZM=m,eP=yt.set,tP=yt.getterFor,rP=KM.find,nP=KM.findIndex,oP=0,aP=function(e){return e.frozen||(e.frozen=new iP)},iP=function(){this.entries=[]},sP=function(e,t){return rP(e.entries,(function(e){return e[0]===t}))};iP.prototype={get:function(e){var t=sP(this,e);if(t)return t[1]},has:function(e){return!!sP(this,e)},set:function(e,t){var r=sP(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=nP(this.entries,(function(t){return t[0]===e}));return~t&&this.entries.splice(t,1),!!~t}};var cP,lP={getConstructor:function(e,t,r,n){var o=e((function(e,a){zM(e,o,t),eP(e,{type:t,id:oP++,frozen:void 0}),null!=a&&$M(a,e[n],{that:e,AS_ENTRIES:r})})),a=tP(t),i=function(e,t,r){var n=a(e),o=WM(XM(t),!0);return!0===o?aP(n).set(t,r):o[n.id]=r,e};return qM(o.prototype,{delete:function(e){var t=a(this);if(!QM(e))return!1;var r=WM(e);return!0===r?aP(t).delete(e):r&&ZM(r,t.id)&&delete r[t.id]},has:function(e){var t=a(this);if(!QM(e))return!1;var r=WM(e);return!0===r?aP(t).has(e):r&&ZM(r,t.id)}}),qM(o.prototype,r?{get:function(e){var t=a(this);if(QM(e)){var r=WM(e);return!0===r?aP(t).get(e):r?r[t.id]:void 0}},set:function(e,t){return i(this,e,t)}}:{add:function(e){return i(this,e,!0)}}),o}},uP=n,dP=hn,fP=eM.exports,hP=FM,pP=lP,vP=re,yP=yt.enforce,mP=ze,gP=!uP.ActiveXObject&&"ActiveXObject"in uP,SP=Object.isExtensible,bP=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},NP=hP("WeakMap",bP,pP);if(mP&&gP){cP=pP.getConstructor(bP,"WeakMap",!0),fP.enable();var TP=NP.prototype,wP=TP.delete,EP=TP.has,_P=TP.get,OP=TP.set;dP(TP,{delete:function(e){if(vP(e)&&!SP(e)){var t=yP(this);return t.frozen||(t.frozen=new cP),wP.call(this,e)||t.frozen.delete(e)}return wP.call(this,e)},has:function(e){if(vP(e)&&!SP(e)){var t=yP(this);return t.frozen||(t.frozen=new cP),EP.call(this,e)||t.frozen.has(e)}return EP.call(this,e)},get:function(e){if(vP(e)&&!SP(e)){var t=yP(this);return t.frozen||(t.frozen=new cP),EP.call(this,e)?_P.call(this,e):t.frozen.get(e)}return _P.call(this,e)},set:function(e,t){if(vP(e)&&!SP(e)){var r=yP(this);r.frozen||(r.frozen=new cP),EP.call(this,e)?OP.call(this,e,t):r.frozen.set(e,t)}else OP.call(this,e,t);return this}})}var RP=new WeakMap,IP=function(e){Zi(r,e);var t=os(r);function r(e){var n;return Xi(this,r),$i(rs(n=t.call(this)),"route","/list/:action/:id"),$i(rs(n),"title","BSBI New Year Plant Hunt homepage"),$i(rs(n),"app",void 0),$i(rs(n),"view",void 0),ys(rs(n),RP,{writable:!0,value:""}),$i(rs(n),"needsFullRefresh",!0),$i(rs(n),"needRightPanelRefresh",!0),$i(rs(n),"viewSubcontext",""),$i(rs(n),"surveySection",void 0),$i(rs(n),"leftPanelBaseRoute",""),$i(rs(n),"viewContexts",{record:function(e){this.surveySection=null,e?ds(this,RP)!==e.id?(this.needRightPanelRefresh=!0,this.currentOccurrenceId=e.id?e.id:""):this.needRightPanelRefresh=!1:(this.currentOccurrenceId="",this.needRightPanelRefresh=!0),this.leftPanelBaseRoute="/list/record"},survey:function(e){console.log("in survey section ".concat(e.section)),this.currentOccurrenceId="",this.needRightPanelRefresh=!0,this.surveySection=e.section,this.leftPanelBaseRoute="/list/survey/".concat(e.section)}}),n.view=e,e.controller=rs(n),n.handle=fd.nextHandle,e.addListener(r.EVENT_SELECT_OCCURRENCE,rs(n),n.occurrenceSelectionHandler),e.addListener(r.EVENT_SELECT_SURVEY_SECTION,rs(n),n.surveyPartSelectionHandler),e.addListener(r.EVENT_NEW_RECORD,rs(n),n.newRecordHandler),e.addListener(r.EVENT_DELETE_OCCURRENCE,rs(n),n.deleteOccurrenceHandler),e.addListener(r.EVENT_BACK,rs(n),n.backHandler),e.addListener(r.EVENT_NEXT_TO_RECORDS,rs(n),n.nextTransitionToRecordsHandler),n}return zi(r,[{key:"occurrences",get:function(){return this.app.occurrences}},{key:"currentOccurrence",get:function(){if(ds(this,RP)){if(this.app.occurrences.has(ds(this,RP)))return this.app.occurrences.get(ds(this,RP));throw new xb("Record id '".concat(ds(this,RP),"' was not found."))}return null}},{key:"currentOccurrenceId",get:function(){return ds(this,RP)},set:function(e){fs(this,RP,e)}},{key:"survey",get:function(){return this.app.currentSurvey}},{key:"nextTransitionToRecordsHandler",value:function(){console.log("in nextTransitionToRecordsHandler()"),this.app.haveExtantOccurrences()?this.app.router.navigate("/list/record/"):this.newRecordHandler()}},{key:"deleteOccurrenceHandler",value:function(e,t,r){console.log({deleting:r});var n=this.app.occurrences.get(r);if(!n)throw new pR("Occurrence id '".concat(r,"' not found when trying to delete."));n.delete(),this.currentOccurrenceId===r&&this.app.router.navigate("/list/record/")}},{key:"surveyPartSelectionHandler",value:function(e,t,r){console.log("In surveyPartSelectionHandler"),console.log({context:e,eventName:t,params:r}),"record"===r.sectionKey?this.app.router.navigate("/list/record/"):r.sectionKey?this.app.router.navigate("/list/survey/".concat(r.sectionKey)):this.app.router.navigate("/list/")}},{key:"newRecordHandler",value:function(){var e=this.app.addNewOccurrence();this.app.router.navigate("/list/record/".concat(e.id))}},{key:"occurrenceSelectionHandler",value:function(e,t,r){console.log({"In occurrenceSelectionHandler":{context:e,eventName:t,params:r}}),this.currentOccurrenceId&&r.occurrenceId&&this.currentOccurrenceId===r.occurrenceId?console.log("ignoring spurious navigation event for '".concat(r.occurrenceId,"'")):this.app.router.navigate("/list/record/".concat(r.occurrenceId))}},{key:"registerRoute",value:function(e){e.on("/list",this.mainRouteHandler.bind(this,"list","",""),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null}),e.on("/list/help",this.mainRouteHandler.bind(this,"list","","help")),e.on("/list/record/",this.mainRouteHandler.bind(this,"list","record",""),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null}),e.on("/list/record/help",this.mainRouteHandler.bind(this,"list","record","help")),e.on("/list/record/:id",this.mainRouteHandler.bind(this,"list","record","form"),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null}),e.on("/list/survey/:section",this.mainRouteHandler.bind(this,"list","survey",""),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null}),e.on("/list/survey/:section/help",this.mainRouteHandler.bind(this,"list","survey","help"))}},{key:"mainRouteHandler",value:function(e,t,r,n){console.log("reached special route handler for MainController.js"),console.log({context:e,params:t,query:n}),this.app.saveRoute();try{this.viewSubcontext=t,t&&this.viewContexts[t].call(this,n),this.app.currentControllerHandle!==this.handle&&(this.needsFullRefresh=!0,this.needRightPanelRefresh=!0,this.app.currentControllerHandle=this.handle),this.view.panelKey=r,this.view.display(),this.needsFullRefresh=!1}catch(e){this.error=e,console.log({error:e});try{this.needsFullRefresh=!0,this.view.display()}catch(e){console.log({rethrownError:e}),document.body.innerHTML="<h2>Internal error</h2><p>Please report this problem:</p><p>".concat(e.message,"</p>")}}}},{key:"backHandler",value:function(){this.app.routeHistory.length>=2&&this.app.routeHistory[this.app.routeHistory.length-2].url===this.leftPanelBaseRoute?(this.app.routeHistory.length-=1,console.log("using standard back navigation"),window.history.back()):(console.log("navigating back using base address '".concat(this.leftPanelBaseRoute,"'")),this.app.router.navigate(this.leftPanelBaseRoute))}}]),r}(fd);$i(IP,"EVENT_SELECT_OCCURRENCE","selectoccurrence"),$i(IP,"EVENT_SELECT_SURVEY_SECTION","selectsurveysection"),$i(IP,"EVENT_NEW_RECORD","newrecord"),$i(IP,"EVENT_DELETE_OCCURRENCE","deleteoccurrence"),$i(IP,"EVENT_BACK","back"),$i(IP,"EVENT_NEXT_TO_RECORDS","nexttorecords"),FM("WeakSet",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),lP);var xP=M,CP=function(e,t){var r=[][e];return!!r&&xP((function(){r.call(null,t||function(){throw 1},1)}))},AP=un,kP=rr,LP=[].join,MP=Zt!=Object,PP=CP("join",",");AP({target:"Array",proto:!0,forced:MP||!PP},{join:function(e){return LP.call(kP(this),void 0===e?",":e)}});var HP=Math.floor,DP=function(e,t){var r=e.length,n=HP(r/2);return r<8?FP(e,t):jP(DP(e.slice(0,n),t),DP(e.slice(n),t),t)},FP=function(e,t){for(var r,n,o=e.length,a=1;a<o;){for(n=a,r=e[a];n&&t(e[n-1],r)>0;)e[n]=e[--n];n!==a++&&(e[n]=r)}return e},jP=function(e,t,r){for(var n=e.length,o=t.length,a=0,i=0,s=[];a<n||i<o;)a<n&&i<o?s.push(r(e[a],t[i])<=0?e[a++]:t[i++]):s.push(a<n?e[a++]:t[i++]);return s},UP=DP,BP=O.match(/firefox\/(\d+)/i),YP=!!BP&&+BP[1],VP=/MSIE|Trident/.test(O),JP=O.match(/AppleWebKit\/(\d+)\./),GP=!!JP&&+JP[1],KP=un,qP=me,WP=p,XP=wr,QP=yl,zP=M,$P=UP,ZP=CP,eH=YP,tH=VP,rH=L,nH=GP,oH=[],aH=oH.sort,iH=zP((function(){oH.sort(void 0)})),sH=zP((function(){oH.sort(null)})),cH=ZP("sort"),lH=!zP((function(){if(rH)return rH<70;if(!(eH&&eH>3)){if(tH)return!0;if(nH)return nH<603;var e,t,r,n,o="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)oH.push({k:t+n,v:r})}for(oH.sort((function(e,t){return t.v-e.v})),n=0;n<oH.length;n++)t=oH[n].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}}));KP({target:"Array",proto:!0,forced:iH||!sH||!cH||!lH},{sort:function(e){void 0!==e&&qP(e);var t=WP(this);if(lH)return void 0===e?aH.call(t):aH.call(t,e);var r,n,o=[],a=XP(t);for(n=0;n<a;n++)n in t&&o.push(t[n]);for(r=(o=$P(o,function(e){return function(t,r){return void 0===r?-1:void 0===t?1:void 0!==e?+e(t,r)||0:QP(t)>QP(r)?1:-1}}(e))).length,n=0;n<r;)t[n]=o[n++];for(;n<a;)delete t[n++];return t}});var uH="\x3c!-- begin: templates/formHelp/surveyAboutHelp.html --\x3e\r\n<h3>Background to the project</h3>\r\n<p>The majority of our ornamental plants are non-native. They contribute greatly to our enjoyment\r\nof gardens and represent a long history of plant discovery and garden design. However, some\r\nhave escaped the controlled environment of gardens, and a small minority of these are\r\nthreatening native biodiversity or are causing severe problems for infrastructure, agriculture or\r\n    forestry. Well known examples include Japanese Knotweed (<i>Reynoutria japonica</i>), <i>Rhododendron\r\n        ponticum</i> and Himalayan Balsam (<i>Impatiens glandulifera</i>).</p>\r\n<p>The period between introduction of a species and it first being noticed as a problem can be a\r\nlong one, making future control problematic. In Britain on average, this time span has been more\r\nthan one hundred years. Early detection of potentially problematic plants for further risk\r\n    assessment could greatly improve our ability to prevent plant species becoming invasive.</p>\r\n<p>This survey is based upon the assumption that it is gardeners who are most likely to notice first\r\nif a particular ornamental plant may have the potential to spread outside the garden. (Most\r\ngardeners will know which plants tend to overgrow others or tend to spread all over the\r\ngarden.) This knowledge could be invaluable in identifying potential invaders, triggering timely risk\r\n    assessment.</p>\r\n\x3c!-- end: templates/formHelp/surveyAboutHelp.html --\x3e\r\n",dH=new WeakMap,fH=function(e){Zi(r,e);var t=os(r);function r(e){var n;return Xi(this,r),ys(rs(n=t.call(this)),dH,{writable:!0,value:void 0}),$i(rs(n),"_formFieldsBuilt",!1),$i(rs(n),"section",void 0),n.section=e,n}return zi(r,[{key:"formElement",get:function(){var e=as(es(r.prototype),"formElement",this);return this._formFieldsBuilt||this.buildFormFields(),e}},{key:"updateModelFromContent",value:function(){for(var e in console.log("updating survey from NyphSurveyForm content"),this.fields)if(this.fields.hasOwnProperty(e)){var t=this.fields[e];ds(this,dH).attributes[e]=t.value}console.log({survey:ds(this,dH)})}},{key:"model",get:function(){return ds(this,dH)},set:function(e){fs(this,dH,e),this.populateFormContent()}},{key:"changeHandler",value:function(e){console.log("survey form change event"),console.log({event:e}),this.fireEvent(r.CHANGE_EVENT,{form:this})}},{key:"destructor",value:function(){as(es(r.prototype),"destructor",this).call(this),fs(this,dH,null)}},{key:"initialiseFormFields",value:function(){var e=this.section.properties;for(var t in this.fields={},e)e.hasOwnProperty(t)&&(this.fields[t]=new e[t].field(e[t].attributes))}},{key:"getFormSectionProperties",value:function(){return this.section.properties}}],[{key:"registerSection",value:function(e){r.sections[e.sectionSortOrder]=e,r.sectionsByKey[e.sectionNavigationKey]=e}}]),r}(uR);$i(fH,"sections",[]),$i(fH,"sectionsByKey",{}),fH.CHANGE_EVENT="change";var hH=function e(){Xi(this,e)};$i(hH,"sectionTitle",void 0),$i(hH,"sectionSortOrder",void 0),$i(hH,"sectionNavigationKey",void 0),$i(hH,"help",""),$i(hH,"properties",void 0);var pH=function(e){Zi(r,e);var t=os(r);function r(){return Xi(this,r),t.apply(this,arguments)}return r}(hH);$i(pH,"sectionNavigationKey","garden"),$i(pH,"sectionTitle","About your garden"),$i(pH,"sectionSortOrder",1),$i(pH,"help","\x3c!-- begin: templates/formHelp/surveyGardenHelp.html --\x3e\r\n<h2>About your garden</h2>\r\n<p>The questions in this section provide background information about the area where you live.</p>\r\n<p>Please try to answer everything, but don't worry if some details are impossible to assess.</p>\r\n<p>When you have completed this section, move on to the final part of the survey, where you can list the invasive plants in your garden.</p>\r\n\x3c!-- end: templates/formHelp/surveyGardenHelp.html --\x3e\r\n"),$i(pH,"properties",{durationAtAddress:{field:XA,attributes:{label:"Roughly how long have you lived at this address?",placeholder:"approximate years",type:"number"}},numberOfPlants:{field:gk,attributes:{label:"Could you please try to estimate how many different ornamental plants are growing in your garden?",placeholder:"please estimate",options:{"<20":{label:"fewer than 20"},"20-50":{label:"between 20 and 50"},"50-100":{label:"between 50 and 100"},">100":{label:"more than 100"},unknown:{label:"impossible to estimate"}},includeOtherFreeText:!1,completion:rR.COMPLETION_DESIRED}},introductions:{field:XA,attributes:{label:"In the last year, how many new ornamental plant species did you plant/introduce into your garden?",helpText:"please estimate",placeholder:"number of plants",autocomplete:"off",type:"number"}},acquisitions:{field:ik,attributes:{label:"In the last year, where did you get these new plants or seeds?",helpText:"<i>(tick all that apply)</i>",options:{nursery:{label:"bought from nursery"},gardencentre:{label:"bought at garden centre"},supermarket:{label:"bought at supermarket"},mailorder:{label:"mail-order"},internetorder:{label:"internet order"},friendsneighbours:{label:"from friends or neighbours"},swap:{label:"plant / seed swap"},other:{label:"other"}},includeOtherFreeText:!0}},gifts:{field:gk,attributes:{label:"In the last two years, did you give plants/seeds to friends/neighbours?",placeholder:"please select a response",options:{yes:{label:"yes"},no:{label:"no"}},includeOtherFreeText:!1}}});var vH=function(e){Zi(r,e);var t=os(r);function r(){return Xi(this,r),t.apply(this,arguments)}return r}(hH);$i(vH,"sectionNavigationKey","about"),$i(vH,"sectionTitle","About you and your survey"),$i(vH,"sectionSortOrder",0),$i(vH,"help",'\x3c!-- begin: templates/formHelp/surveyAboutHelp.html --\x3e\r\n<div class="card mt-3">\r\n    <div class="card-body">\r\n        <h5 class="card-title">Localising your records</h5>\r\n        <p class="card-text">To make sense of the national coverage of the records we receive, we need to know the approximate location\r\n        of your garden. Usually a postcode works well for this, but you can provide a grid-reference if you prefer (in Ireland please use a grid-reference as we don\'t yet have a way to convert postcodes).\r\n            We also need a place name, as a way to double check that the postcode or grid-reference makes sense.\r\n        </p>\r\n        <p><strong>Please don\'t provide your full address, as we would need to remove that from our data.</strong></p>\r\n    </div>\r\n</div>\r\n<div class="card mt-3">\r\n    <div class="card-body">\r\n        <h5 class="card-title">Your name and email</h5>\r\n        <p class="card-text">Both of these are optional, but providing an email address is important if you want to return\r\n            to your survey later or to revise your records. It is also really useful for our experts to be able to contact you\r\n            if we have questions about the records that you\'ve sent.\r\n        </p>\r\n        <p>We\'d like to be able to include your name with the records in our archive, but your email address won\'t be stored long-term\r\n            after your plant records have been checked.</p>\r\n    </div>\r\n</div>\r\n\x3c!-- end: templates/formHelp/surveyAboutHelp.html --\x3e\r\n'),$i(vH,"properties",{place:{field:XA,attributes:{label:"Where did you survey?",helpText:"e.g. town or village. Please don't give an address.",placeholder:"Nearest named place",autocomplete:"address-level2",completion:rR.COMPLETION_COMPULSORY}},georef:{field:XA,attributes:{label:"Postcode or grid-reference",helpText:"We need to be able to put your survey on our map. Detailed locations won't be made public.",placeholder:"Grid-reference or postcode",autocomplete:"postal-code",completion:rR.COMPLETION_COMPULSORY}},recorder:{field:XA,attributes:{label:"Your name",helpText:"(optional) This helps us follow-up if we have any queries about your records and allows us to properly acknowledge the origin of your observations.",placeholder:"full name",autocomplete:"name"}},namearchive:{field:gk,attributes:{label:"Can we include your name in our archive of plant records?",helpText:"",placeholder:"please choose an option",options:{yes:{label:"yes"},no:{label:"no, I'd prefer my records to be anonymous"}},includeOtherFreeText:!1,completion:rR.COMPLETION_DESIRED}},email:{field:XA,attributes:{label:"Your email address",helpText:"(optional) We'll never share your email with anyone else.",autocomplete:"email",type:"email"}}});var yH=p,mH=Math.floor,gH="".replace,SH=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,bH=/\$([$&'`]|\d{1,2})/g,NH=function(e,t,r,n,o,a){var i=r+e.length,s=n.length,c=bH;return void 0!==o&&(o=yH(o),c=SH),gH.call(a,c,(function(a,c){var l;switch(c.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(i);case"<":l=o[c.slice(1,-1)];break;default:var u=+c;if(0===u)return a;if(u>s){var d=mH(u/10);return 0===d?a:d<=s?void 0===n[d-1]?c.charAt(1):n[d-1]+c.charAt(1):a}l=n[u-1]}return void 0===l?"":l}))},TH=Pu,wH=M,EH=ue,_H=N,OH=pr,RH=Nr,IH=yl,xH=f,CH=Du,AH=Se,kH=NH,LH=Yu,MH=W("replace"),PH=Math.max,HH=Math.min,DH=function(e){return void 0===e?e:String(e)},FH="$0"==="a".replace(/./,"$0"),jH=!!/./[MH]&&""===/./[MH]("a","$0");TH("replace",(function(e,t,r){var n=jH?"$":"$0";return[function(e,r){var n=xH(this),o=null==e?void 0:AH(e,MH);return o?o.call(e,n,r):t.call(IH(n),e,r)},function(e,o){var a=EH(this),i=IH(e);if("string"==typeof o&&-1===o.indexOf(n)&&-1===o.indexOf("$<")){var s=r(t,a,i,o);if(s.done)return s.value}var c=_H(o);c||(o=IH(o));var l=a.global;if(l){var u=a.unicode;a.lastIndex=0}for(var d=[];;){var f=LH(a,i);if(null===f)break;if(d.push(f),!l)break;""===IH(f[0])&&(a.lastIndex=CH(i,RH(a.lastIndex),u))}for(var h="",p=0,v=0;v<d.length;v++){f=d[v];for(var y=IH(f[0]),m=PH(HH(OH(f.index),i.length),0),g=[],S=1;S<f.length;S++)g.push(DH(f[S]));var b=f.groups;if(c){var N=[y].concat(g,m,i);void 0!==b&&N.push(b);var T=IH(o.apply(void 0,N))}else T=kH(y,i,m,g,b,o);m>=p&&(h+=i.slice(p,m)+T,p=m+y.length)}return h+i.slice(p)}]}),!!wH((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!FH||jH);var UH=new WeakMap,BH=function(e){Zi(r,e);var t=os(r);function r(e){var n;return Xi(this,r),ys(rs(n=t.call(this)),UH,{writable:!0,value:void 0}),$i(rs(n),"_formFieldsBuilt",!1),$i(rs(n),"surveyId",""),e&&(n.model=e),n}return zi(r,[{key:"formElement",get:function(){var e=arguments,t=as(es(r.prototype),"formElement",this);return this._formFieldsBuilt||(this.buildFormFields(),t.addEventListener("change",(function(){console.log("occurrence form change event"),console.log(e)}),{capture:!1})),t}},{key:"buildContentContainer",value:function(e){var t=e.appendChild(document.createElement("div"));t.className="card mt-3 ml-0 mr-0 mb-3";var n=t.appendChild(document.createElement("div"));return n.className="card-header",n.textContent=r.sectionTitle,this._formContentContainer=t.appendChild(document.createElement("div")),this._formContentContainer.className="card-body",this._formContentContainer}},{key:"occurrenceId",get:function(){return ds(this,UH)?ds(this,UH).id:null}},{key:"projectId",get:function(){return ds(this,UH)?ds(this,UH).projectId:null}},{key:"initialiseFormFields",value:function(){var e=r.properties;for(var t in this.fields={},e)e.hasOwnProperty(t)&&(this.fields[t]=new e[t].field(e[t].attributes))}},{key:"updateModelFromContent",value:function(){for(var e in console.log("updating occurrence from NyphOccurrenceForm content"),this.fields)if(this.fields.hasOwnProperty(e)){var t=this.fields[e];ds(this,UH).attributes[e]=t.value}console.log({occurrence:ds(this,UH)})}},{key:"model",get:function(){return ds(this,UH)},set:function(e){fs(this,UH,e),this.populateFormContent()}},{key:"changeHandler",value:function(e){console.log("occurrence form change event"),console.log({event:e}),this.fireEvent(r.CHANGE_EVENT,{form:this})}},{key:"pingOccurrence",value:function(){ds(this,UH).unsaved()&&this.fireEvent(r.CHANGE_EVENT,{form:this})}},{key:"destructor",value:function(){fs(this,UH,null),as(es(r.prototype),"destructor",this).call(this)}},{key:"getFormSectionProperties",value:function(){return r.properties}}]),r}(uR);$i(BH,"sectionTitle","Details of invasive garden plant"),$i(BH,"help",'\x3c!-- begin: templates/formHelp/recordsHelp.html --\x3e\r\n<p>In this section, please list the ornamental plants that are spreading in your\r\ngarden and are difficult to control.</p>\r\n<p> Many plants in your garden will spread and this is a sign that they are growing well. We only want to know about those that are spreading to an extent that\r\n    you have to control them to prevent them overgrowing other plants or parts of your garden where you do not want them.</p>\r\n<p>Please note in this project we are dealing with ornamental plants only (no vegetables, no weeds -\r\n    unless they are ornamentals that you now regard as weeds).</p>\r\n<div class="card mt-3">\r\n    <div class="card-body">\r\n        <h5 class="card-title">Using the forms</h5>\r\n        <p class="card-text">You can enter as many plant records as you need. To add another record click the \'Add a plant\' button.</p>\r\n        <p class="card-text">If you are currently online then the entries will be saved as you go, automatically. Otherwise the records\r\n            will be remembered on your device, but you will need to click \'<a href="/app/survey/save" data-navigo="survey/save">save all</a>\' (on the Surveys menu) when you have a network connection again.\r\n        </p>\r\n        <p class="card-text">To delete a plant record, find it in the list and click the red \'bin\' icon.\r\n        </p>\r\n    </div>\r\n</div>\r\n<div class="card mt-3">\r\n    <div class="card-body">\r\n        <h5 class="card-title">Identifying your plants</h5>\r\n        </p>\r\n        <h6 class="card-subtitle mb-2 text-muted">Plant names</h6>\r\n        <p class="card-text">If possible, please enter the scientific or common name of the plant, but don\'t worry if you dont know the full details.\r\n            The list of suggested names includes a very wide range of both native and horticultural plants, but if the name you need\r\n            isn\'t on the list then you can still type it in.\r\n        </p>\r\n        <h6 class="card-subtitle mb-2 text-muted">Photos</h6>\r\n        <p class="card-text">Photos of the plant will help us confirm your record. Please provide a picture showing the whole plant, but it will\r\n            also help us if you can provide close-up views of the flowers and leaves.\r\n        </p>\r\n    </div>\r\n</div>\r\n\x3c!-- begin: templates/formHelp/recordsHelp.html --\x3e\r\n'),$i(BH,"properties",{taxon:{field:Yk,attributes:{label:"plant name",validationMessage:"Please specify a taxon name or provide some photos if you cannot identify the plant.",helpText:"Type the common or scientific name of the invasive plant and, if possible, pick a suggestion from the list. If you do not know the name of the plant then please leave this blank and include some photos."},validator:function(e,t,r){return!(!r.hasOwnProperty(e)||t.field.isEmpty(r[e]))||r.hasOwnProperty("images")&&!VA.isEmpty(r.images)}},idConfidence:{field:gk,attributes:{label:"How confident are you about your identification of this plant?",helpText:"",placeholder:"please choose an option",options:{1:{label:"very sure"},2:{label:"not really sure"},3:{label:"could be wrong"}},includeOtherFreeText:!1,completion:rR.COMPLETION_DESIRED}},images:{field:VA,attributes:{label:"Please provide some photos of the plant",placeholder:"photos",helpText:'If the plant is unusual or if you are unsure of its identity then photos will help us check your record.<br><strong>Submitted images remain your property, but you agree to allow us to use the photos under the terms of a <a href="#" title="Creative Commons Attribution" data-toggle="modal" data-target="#'.concat(VA.LICENSE_MODAL,'">CC BY</a> license.</strong>')}},spread:{field:ik,attributes:{label:"How does the plant spread in your garden?",helpText:"<i>(tick all that apply)</i>",options:{seeds:{label:"seeds"},roots:{label:"roots"},runners:{label:"runners"},bulbs:{label:"bulbs"},unknown:{label:"don't know"},other:{label:"other"}},includeOtherFreeText:!0,completion:rR.COMPLETION_DESIRED},summary:{summaryPrefix:"Spread by"}},control:{field:ik,attributes:{label:"How do you control this plant?",helpText:"<i>(tick all that apply)</i>",options:{digging:{label:"digging"},pulling:{label:"pulling"},chemical:{label:"chemical"},cutting:{label:"cutting"},mulching:{label:"mulching"},other:{label:"other"}},includeOtherFreeText:!0,completion:rR.COMPLETION_DESIRED},summary:{summaryPrefix:"Controlled by"}},disposal:{field:ik,attributes:{label:"Please tell us how you dispose of this plant?",helpText:"<i>(tick all that apply)</i>",options:{homecompost:{label:"home composting"},greenwaste:{label:"green waste"},"other waste":{label:"other waste collection"},other:{label:"other"}},includeOtherFreeText:!0,completion:rR.COMPLETION_DESIRED},summary:{summaryPrefix:"Disposal by"}},problemSeverity:{field:gk,attributes:{label:"Which of the following best describes your effort to control the plant?",placeholder:"please select a response",options:{1:{label:"I don't try to control it"},2:{label:"I try to keep it confined to certain areas."},3:{label:"I am trying everything to get rid of it."},4:{label:"I have given up trying to control it."},5:{label:"I have successfully eradicated the plant."}},includeOtherFreeText:!1,completion:rR.COMPLETION_DESIRED},summary:{summaryPrefix:"Severity:"}},source:{field:ik,attributes:{label:"Please tell us how this plant came into your garden?",helpText:"<i>(tick all that apply)</i>",options:{alreadypresent:{label:"Was already in the garden"},bought:{label:"Bought the plant"},seed:{label:"Grown from seed"},someoneelse:{label:"From someone else's garden"},saleswap:{label:"Non-commercial sale/swap"},spread:{label:"Spread into my garden"},other:{label:"other"}},includeOtherFreeText:!0,completion:rR.COMPLETION_DESIRED},summary:{summaryPrefix:"Source"}},local:{field:gk,attributes:{label:"Is the plant growing locally outside your garden?",placeholder:"please select a response",options:{yes:{label:"yes"},no:{label:"no"},notknown:{label:"I don't know"}},includeOtherFreeText:!1}},warning:{field:gk,attributes:{label:"In your opinion, should the plant be sold with a label warning buyers of potential control difficulties in their garden?",placeholder:"please select a response",options:{yes:{label:"Yes",summary:"Plants should carry a warning"},no:{label:"No",summary:"Plants need not carry a warning"},unsure:{label:"Don't know",summary:"Don't know if plants should carry a warning"}},includeOtherFreeText:!1,completion:rR.COMPLETION_DESIRED},summary:{summarise:!0,summaryPrefix:""}},comments:{field:qk,attributes:{label:"Any other comments about this plant?",helpText:"",autocomplete:"off"},summary:{summarise:!0}}}),BH.CHANGE_EVENT="change";fH.registerSection(vH),fH.registerSection(pH);var YH=new WeakMap,VH=new WeakMap,JH=new WeakMap,GH=new WeakSet,KH=new WeakSet,qH=new WeakSet,WH=new WeakSet,XH=new WeakSet,QH=new WeakSet,zH=new WeakSet,$H=new WeakSet,ZH=new WeakSet,eD=new WeakSet,tD=new WeakSet,rD=new WeakSet,nD=function(e){Zi(r,e);var t=os(r);function r(){var e;Xi(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return ms(rs(e=t.call.apply(t,[this].concat(o))),rD),ms(rs(e),tD),ms(rs(e),eD),ms(rs(e),ZH),ms(rs(e),$H),ms(rs(e),zH),ms(rs(e),QH),ms(rs(e),XH),ms(rs(e),WH),ms(rs(e),qH),ms(rs(e),KH),ms(rs(e),GH),$i(rs(e),"controller",void 0),ys(rs(e),YH,{writable:!0,value:{}}),ys(rs(e),VH,{writable:!0,value:void 0}),ys(rs(e),JH,{writable:!0,value:{}}),$i(rs(e),"panelKey",""),$i(rs(e),"OCCURRENCES_ARE_LAST_SECTION",!0),e}return zi(r,[{key:"initialise",value:function(){this.controller.app.addListener(ZL.EVENT_OCCURRENCE_ADDED,this,"occurrenceAddedHandler")}},{key:"setLayout",value:function(){var e=this;document.getElementById("body").innerHTML='\r\n<div class="container-fluid">\r\n    <div class="row" style="height: 90vh;">\r\n        <div class="col d-md-block pr-md-0 pt-3" id="col1panel" style="overflow-y: auto; max-height: calc(100vh - 5rem);">\r\n        </div>\r\n        <div class="col d-md-none pl-0 pr-0" id="ctrlpanel" style="background-color: aliceblue; width: 28px; max-width: 28px; overflow-y: hidden; ">\r\n            <button class="navbar-light navbar-toggler pl-0 pr-0" type="button" aria-label="Back" id="right-panel-back">\r\n                <i class="material-icons-round" style="color: gray;">view_list</i>\r\n            </button>\r\n        </div>\r\n        <div class="col d-md-block pr-md-0" id="col2panel" style="overflow-y: auto; height: 100%;">\r\n        </div>\r\n    </div>\r\n</div>\r\n',document.getElementById("right-panel-back").addEventListener("click",(function(t){t.stopPropagation(),t.preventDefault(),e.fireEvent(yR.EVENT_BACK)}))}},{key:"refreshLeftPanelAccordionState",value:function(){var e,t=document.querySelectorAll("div#".concat(this.leftPanelAccordionId,' div[data-parent="#').concat(this.leftPanelAccordionId,'"].collapse'));e=this.controller.viewSubcontext?"record"===this.controller.viewSubcontext?"record":this.controller.surveySection:"";var r,n=us(t);try{for(n.s();!(r=n.n()).done;){var o=r.value;o.getAttribute("data-sectionkey")===e?o.classList.add("show"):o.classList.remove("show")}}catch(e){n.e(e)}finally{n.f()}this._refreshOccurrenceAccordionState()}},{key:"_refreshOccurrenceAccordionState",value:function(){var e,t=document.querySelectorAll("div#".concat("occurrencelistcontainer",' div[data-parent="#').concat("occurrencelistcontainer",'"].collapse')),r=this.controller.currentOccurrenceId,n=us(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;o.getAttribute("data-occurrenceid")===r?o.classList.add("show"):o.classList.remove("show")}}catch(e){n.e(e)}finally{n.f()}}},{key:"display",value:function(){if(this.controller.needsFullRefresh?(console.log("Full refresh triggered."),this.setLayout(),ps(this,XH,cD).call(this)):this.refreshLeftPanelAccordionState(),this.controller.needRightPanelRefresh)switch(this.controller.viewSubcontext){case"record":ps(this,KH,aD).call(this);break;case"survey":ps(this,GH,oD).call(this);break;default:ps(this,qH,iD).call(this)}this.setResponsivePanel(""===this.panelKey?"left":"right")}},{key:"refreshOccurrenceFooterControls",value:function(e){var t=this,r=e.appendChild(document.createElement("div")),n=r.appendChild(document.createElement("button"));if(n.className="btn btn-secondary btn-md-lg mt-2 mb-3 mr-2",n.type="button",n.textContent="back to list",n.setAttribute("data-buttonaction","back"),this.occurrenceIsMostRecent(this.controller.currentOccurrence)){var o=r.appendChild(document.createElement("button"));o.className="btn btn-primary btn-md-lg mt-2 mb-3 mr-2",o.type="button",o.textContent="add another",o.setAttribute("data-buttonaction","new")}if(this.OCCURRENCES_ARE_LAST_SECTION){var a=r.appendChild(document.createElement("button"));a.className="btn btn-primary btn-md-lg mt-2 mb-3",a.type="button",a.textContent="finish",a.setAttribute("data-buttonaction","finish")}else{var i=fH.sections[1],s=r.appendChild(document.createElement("button"));s.className="btn btn-primary btn-md-lg mt-2 mb-3",s.type="button",s.textContent="next Â»",s.setAttribute("data-buttonaction","next"),s.title=i.sectionTitle}r.addEventListener("click",(function(e){var r=e.target.closest("button");if(r&&r.hasAttribute("data-buttonaction"))switch(r.getAttribute("data-buttonaction")){case"new":t.fireEvent(yR.EVENT_NEW_RECORD);break;case"back":t.controller.app.router.navigate("/list/record/");break;case"finish":t.controller.app.router.navigate("/list/record/"),$("#".concat("finishmodal")).modal();break;case"next":t.controller.app.router.navigate("/list/survey/".concat(nextSection.sectionNavigationKey));break;default:throw new Error("Unrecognised button action ".concat(r.getAttribute("data-buttonaction")))}}))}},{key:"occurrenceIsMostRecent",value:function(e){var t,r=us(this.controller.occurrences.entries());try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n[1].createdStamp>e.createdStamp&&!n[1].deleted)return!1}}catch(e){r.e(e)}finally{r.f()}return!0}},{key:"newButtonClickHandler",value:function(e){e.preventDefault(),e.stopPropagation(),this.fireEvent(yR.EVENT_NEW_RECORD)}},{key:"occurrenceAddedHandler",value:function(e,t,r){var n=document.getElementById("occurrencelistcontainer");if(n){var o=this.controller.occurrences.get(r.occurrenceId),a=document.createElement("div");a.className="card",a.id="card_".concat(o.id),a.innerHTML=ps(this,rD,vD).call(this,o),ds(this,JH)[o.id]=o.addListener(hR.EVENT_MODIFIED,this,this.occurrenceChangeHandler,{occurrenceId:o.id}),n.insertBefore(a,n.firstChild)}}},{key:"refreshOccurrenceValiditySummary",value:function(e){var t=document.getElementById("card_".concat(e.id));t&&(e.evaluateCompletionStatus(BH.properties).requiredFieldsPresent?t.classList.remove("is-invalid"):t.classList.add("is-invalid"))}},{key:"occurrenceChangeHandler",value:function(e,t,r){var n=this.controller.occurrences.get(r.occurrenceId),o=document.getElementById("card_".concat(r.occurrenceId));o&&(n.deleted?(o.parentElement.removeChild(o),ds(this,JH)[r.occurrenceId]&&(n.removeListener(hR.EVENT_MODIFIED,ds(this,JH)[r.occurrenceId]),ds(this,JH)[r.occurrenceId]=null)):(o.innerHTML=ps(this,rD,vD).call(this,n),this.refreshOccurrenceValiditySummary(n)))}},{key:"occurrenceSummaryBodyHTML",value:function(e){var t="";for(var r in e.attributes)if(e.attributes.hasOwnProperty(r)&&BH.properties.hasOwnProperty(r)&&!BH.properties[r].field.isEmpty(e.attributes[r])){var n=BH.properties[r].field.summarise(r,BH.properties[r],e.attributes);n&&(t+='<p class="ellipsed-line mb-0">'.concat(n,"</p>"))}return ZL.devMode&&(t+='<p class="mb-0">(<i>id '.concat(e.id,"</i>)</p>")),t}},{key:"occurrenceSummaryHeadingHTML",value:function(e){var t="";if(e.attributes.hasOwnProperty("images")&&e.attributes.images.length){var r=e.attributes.images[0];t+=fx.imageLink(r,48,48,{className:"mr-1"})}return e.attributes.taxon&&e.attributes.taxon.taxonId?t+=e.taxon.formattedHTML(e.attributes.taxon.vernacularMatch):e.attributes.taxon&&e.attributes.taxon.taxonName?t+=function(e){try{var t=document.createElement("textarea");return t.innerHTML=e,t.innerHTML.replace(/"/g,"&quot;")}catch(t){var r=document.createElement("pre");return r.appendChild(document.createTextNode(e)),r.innerHTML.replace(/"/g,"&quot;")}}(e.attributes.taxon.taxonName):t+="<span>(unnamed plant)</span>",t}},{key:"setResponsivePanel",value:function(e){var t=document.getElementById("col2panel"),r=document.getElementById("col1panel"),n=document.getElementById("ctrlpanel");switch(e){case"left":r.classList.remove("d-none"),r.classList.add("d-block"),t.classList.remove("d-block"),t.classList.add("d-none"),n.classList.remove("d-md-none"),n.classList.add("d-none");break;case"right":r.classList.remove("d-block"),r.classList.add("d-none"),t.classList.remove("d-none"),t.classList.add("d-block"),n.classList.remove("d-none"),n.classList.add("d-md-none");break;default:throw new Error("Unrecognised panel value '".concat(e))}}}]),r}(cx);function oD(){var e=document.getElementById("col2panel"),t=this.controller.surveySection,r=fH.sectionsByKey[t]?fH.sectionsByKey[t].help:"";e.innerHTML=r||("welcome"===t?uH:"<p>placeholder survey help content for '".concat(t,"'</p>"))}function aD(){try{var e=this.controller.currentOccurrence,t=document.getElementById("col2panel");if(e){ds(this,VH)&&ds(this,VH).occurrenceId===e.id||(ds(this,VH)&&ds(this,VH).destructor(),fs(this,VH,e.getForm()),ds(this,VH).surveyId=this.controller.app.currentSurvey.id,t.scrollTop=0),t.innerHTML="";var r=ds(this,VH).formElement;t.appendChild(r),ds(this,VH).populateFormContent(),this.refreshOccurrenceFooterControls(t),$("#description_".concat(e.id)).collapse("show")}else ps(this,qH,iD).call(this,BH.help)}catch(e){console.log({error:e});var n=document.getElementById("col2panel");n?n.innerHTML="<p>".concat(e.message,"</p>"):document.body.innerHTML="<h2>Internal error</h2><p>Please report this problem:</p><p>".concat(e.message,"</p>")}}function iD(e){document.getElementById("col2panel").innerHTML=e||uH}function sD(){for(var e in ds(this,JH)){var t=this.controller.occurrences.get[e];t&&t.removeListener(hR.EVENT_MODIFIED,ds(this,JH)[e])}fs(this,JH,{})}function cD(){var e=this,t=document.getElementById("col1panel").appendChild(document.createElement("div"));t.className="accordion",this.leftPanelAccordionId=t.id=uR.nextId,ps(this,$H,dD).call(this),ps(this,ZH,fD).call(this,0,t,nD.NEXT_RECORDS),ps(this,eD,hD).call(this),ps(this,tD,pD).call(this),t.addEventListener("click",(function(t){var r=t.target.closest("a");r&&r.hasAttribute("data-help-link")&&(t.preventDefault(),t.stopPropagation(),e.controller.app.router.navigate(r.getAttribute("data-help-link")))})),ps(this,zH,uD).call(this),ps(this,QH,lD).call(this)}function lD(){var e=this,t=document.body,r='<div class="modal fade" id="'.concat("deleteoccurrencemodal",'" tabindex="-1" role="dialog" aria-labelledby="').concat("deleteoccurrencemodal",'Title" aria-hidden="true">\n  <div class="modal-dialog modal-dialog-centered" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title" id="').concat("deleteoccurrencemodal",'Title">Delete record?</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body">\n        Please confirm that you wish to delete the record.\n      </div>\n      <div class="modal-footer">\n        <button type="button" class="btn btn-secondary" data-dismiss="modal">Back</button>\n        <button type="button" class="btn btn-danger" data-dismiss="modal" id="').concat("deleteoccurrencemodal",'confirmed">Delete record</button>\n      </div>\n    </div>\n  </div>\n</div>'),n=document.createElement("div");n.innerHTML=r,t.appendChild(n.firstChild),$("#".concat("deleteoccurrencemodal")).on("show.bs.modal",(function(e){var t=$(e.relatedTarget);if(t&&t.data("occurrenceid")){var r=t.data("occurrenceid");document.getElementById("".concat("deleteoccurrencemodal","confirmed")).setAttribute("data-occurrenceid",r)}})),document.getElementById("".concat("deleteoccurrencemodal","confirmed")).addEventListener("click",(function(t){var r=t.target.closest("button");if(r&&r.hasAttribute("data-occurrenceid")){var n=r.getAttribute("data-occurrenceid");console.log("Deleting occurrence ".concat(n,".")),e.fireEvent(yR.EVENT_DELETE_OCCURRENCE,n)}}));var o=document.createElement("div");o.innerHTML='<div class="modal fade" id="'.concat("finishmodal",'" tabindex="-1" role="dialog" aria-labelledby="').concat("finishmodal",'Title" aria-hidden="true">\n  <div class="modal-dialog modal-dialog-centered" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title" id="').concat("finishmodal",'Title">Thank you</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body">\n        <p>Thank you! Your form responses have been sent. If you wish, you can continue to make changes and edit or add further records.</p>\n        <p>If you provided an email address, then we will send you a message with a link to this form, so that you can return to it later if needed.</p>\n      </div>\n      <div class="modal-footer">\n        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\n      </div>\n    </div>\n  </div>\n</div>'),t.appendChild(o.firstChild),t.appendChild(VA.licenseModal());var a=document.createElement("div");a.innerHTML='<div class="modal fade" id="'.concat(HA,'" tabindex="-1" role="dialog" aria-labelledby="').concat(HA,'Title" aria-hidden="true">\n  <div class="modal-dialog modal-dialog-centered" role="document">\n    <div class="modal-content">\n      <div class="modal-header d-none d-md-flex">\n        <h5 class="modal-title" id="').concat(HA,'Title">Photo</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body" style="position: relative;">\n        <picture>\n        </picture>\n      </div>\n      <div class="modal-footer">\n        <button type="button" id="').concat(DA,'" class="btn btn-outline-danger delete-occurrence-button mr-3" data-toggle="modal" data-target="#').concat("deleteimagemodal",'" data-imageid=""><i class="material-icons">delete</i></button>\n        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\n      </div>\n    </div>\n  </div>\n</div>'),t.appendChild(a.firstChild),document.getElementById(DA).addEventListener("click",(function(t){var r=t.target.closest("button");if(r&&r.hasAttribute("data-imageid")){var n=r.getAttribute("data-imageid");ds(e,VH).fireEvent("deleteimage",n),$("#".concat(HA)).modal("hide")}}))}function uD(){var e=this;$("#".concat("col1panel")).on("show.bs.collapse",(function(t){t.target.dataset.occurrenceid?(console.log({"left panel accordion show event (with occ id)":t}),e.fireEvent(yR.EVENT_SELECT_OCCURRENCE,{occurrenceId:t.target.dataset.occurrenceid})):t.target.dataset.sectionkey?(console.log({"left panel accordion show event (with section key)":t}),e.fireEvent(yR.EVENT_SELECT_SURVEY_SECTION,{sectionKey:t.target.dataset.sectionkey})):console.log({"left panel accordion show event (other)":t})})).on("hidden.bs.collapse",(function(t){if(console.log({"left panel accordion hide event":t}),t.target.dataset.occurrenceid){var r=e.controller.occurrences.get(t.target.dataset.occurrenceid);r.isNew&&!r.isPristine&&(r.isNew=!1,e.refreshOccurrenceValiditySummary(r)),e.controller.currentOccurrenceId===t.target.dataset.occurrenceid&&e.fireEvent(yR.EVENT_SELECT_OCCURRENCE,{occurrenceId:""})}else if(t.target.dataset.sectionkey)if("record"===t.target.dataset.sectionkey)"record"===e.controller.viewSubcontext&&e.fireEvent(yR.EVENT_SELECT_SURVEY_SECTION,{sectionKey:""});else if(ds(e,YH)[t.target.dataset.sectionkey]){var n=ds(e,YH)[t.target.dataset.sectionkey].validateForm();console.log({"survey section validity":n}),e.controller.surveySection===t.target.dataset.sectionkey&&e.fireEvent(yR.EVENT_SELECT_SURVEY_SECTION,{sectionKey:""})}}))}function dD(){var e=document.getElementById(this.leftPanelAccordionId),t=document.createElement("button");t.className="btn btn-primary",t.type="button",t.textContent="get started Â»",t.setAttribute("data-toggle","collapse"),t.setAttribute("data-target","#survey-0-about");var r=uR.nextId,n=document.createElement("div");n.innerHTML='\x3c!-- begin: templates/welcome.html --\x3e\r\n<p>Using your experience as gardener, please help us identify\r\npotentially invasive plant species in gardens before they become a problem for\r\nbiodiversity and conservation in wild situations in Britain or Ireland.</p>\r\n<p>The survey is divided into three sections and usually takes between 15 and 20 minutes to complete. You can pause and come back\r\n    later at any point.</p>\r\n<p>The information that you provide will be used by the <a href="https://www.coventry.ac.uk/research/areas-of-research/agroecology-water-resilience/" target="_blank" title="CAWR">Centre for Agroecology, Water and Resilience</a> at Coventry University and by\r\n    <a href="https://bsbi.org/" target="_blank" title="Botanical Society of Britain and Ireland">BSBI</a> for a\r\n    study of invasive plants. We\'ll include your plant records in a permanent archive held by BSBI, to help us track\r\n    long term changes in plant distribution.</p>\r\n<p>To follow up any queries about the survey we request that you please provide your name and email address. You can choose whether or not\r\n    to include your name in our archive of plant records. Your email address (if provided) will be\r\nconfidential and won\'t be archived.</p>\r\n<p>A summary of records will appear on the project website, but the full survey details including the exact location of your garden will only be accessible to the research team.</p>\r\n\x3c!-- end: templates/welcome.html --\x3e\r\n',n.appendChild(t);var o=document.createElement("span");o.className="d-md-none pl-2",o.innerHTML='(<a href="/app/list/survey/welcome/help" data-navigo="list/survey/welcome/help">more info</a>)',n.appendChild(o),e.appendChild(this.card({cardId:r,cardHeadingId:uR.nextId,collapsed:"welcome"!==this.controller.surveySection,headingButtonId:uR.nextId,headingHTML:"Welcome",headingNonbuttonHTML:"",headingValidationWarningHTML:"",cardDescriptionId:"survey-welcome",parentContainerId:e.id,bodyContentElement:n,dataAttributes:{sectionkey:"welcome"}}))}function fD(e,t,r){var n=this,o=fH.sections[e],a=new fH(o);ds(this,YH)[o.sectionNavigationKey]=a;var i=a.formElement,s=document.createElement("button");switch(s.className="btn btn-primary",s.type="button",s.textContent="next Â»",r){case nD.NEXT_RECORDS:s.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),n.fireEvent(yR.EVENT_NEXT_TO_RECORDS)}));break;case nD.NEXT_SURVEY_SECTION:var c=fH.sections[e+1];s.setAttribute("data-toggle","collapse"),s.setAttribute("data-target","#survey-".concat(e+1,"-").concat(c.sectionNavigationKey)),s.title=c.sectionTitle;break;case nD.NEXT_IS_FINAL:s.textContent="finish",s.className="btn btn-primary btn-md-lg mt-2 mb-3",s.type="button",s.addEventListener("click",(function(){n.controller.app.router.navigate("/list/"),$("#".concat("finishmodal")).modal()}));break;default:throw new Error("Unrecognized next section keyword '".concat(r,"'"))}i.appendChild(s);var l=uR.nextId;t.appendChild(this.card({cardId:l,cardHeadingId:uR.nextId,collapsed:this.controller.surveySection!==o.sectionNavigationKey,headingButtonId:uR.nextId,headingHTML:o.sectionTitle,headingNonbuttonHTML:'<small class="btn d-md-none" style="margin: 0; padding: 0;">(<a href="/app/list/survey/'.concat(o.sectionNavigationKey,'/help" data-help-link="/list/survey/').concat(o.sectionNavigationKey,'/help">help</a>)</small>'),headingValidationWarningHTML:"Please check the form for some missing responses.",cardDescriptionId:"survey-".concat(e,"-").concat(o.sectionNavigationKey),parentContainerId:t.id,bodyContentElement:i,dataAttributes:{sectionkey:o.sectionNavigationKey}})),this.controller.survey.registerForm(a),a.addListener(fH.EVENT_VALIDATION_STATE_CHANGE,this,(function(e,t,r){var n=document.getElementById(l);r?n.classList.remove("is-invalid"):n.classList.add("is-invalid")}))}function hD(){var e=document.getElementById(this.leftPanelAccordionId),t=document.createDocumentFragment();t.appendChild(document.createElement("p")).innerHTML='Records of invasive plants in your garden.<small class="d-block d-md-none"><a href="/app/list/record/help">(help)</a></small>';var r=t.appendChild(document.createElement("button"));r.type="button",r.className="btn btn-primary btn-lg mb-2",r.innerText="Add a plant record.",r.addEventListener("click",this.newButtonClickHandler.bind(this)),t.appendChild(document.createElement("div")).id="occurrencelistcontainer",e.appendChild(this.card({cardId:uR.nextId,cardHeadingId:uR.nextId,collapsed:"record"!==this.controller.viewSubcontext,headingButtonId:uR.nextId,headingHTML:"Your plant records",cardDescriptionId:uR.nextId,parentContainerId:e.id,bodyContentElement:t,dataAttributes:{sectionkey:"record"}}))}function pD(){var e=document.getElementById("occurrencelistcontainer");if(!e)throw new pR("Failed to find list container.");ps(this,WH,sD).call(this);var t,r=[],n=us(ss(this.controller.occurrences.entries()).sort((function(e,t){return t[1].createdStamp-e[1].createdStamp})));try{for(n.s();!(t=n.n()).done;){var o=t.value[1];if(!o.deleted){var a=o.isNew||o.evaluateCompletionStatus(BH.properties).requiredFieldsPresent;r.push('<div class="card'.concat(a?"":" is-invalid",'" id="card_').concat(o.id,'">\n    ').concat(ps(this,rD,vD).call(this,o),"\n</div>")),ds(this,JH)[o.id]=o.addListener(hR.EVENT_MODIFIED,this,this.occurrenceChangeHandler,{occurrenceId:o.id})}}}catch(e){n.e(e)}finally{n.f()}e.className="accordion",e.innerHTML=r.join(""),e.addEventListener("click",(function(e){var t=e.target.closest("button");t&&t.hasAttribute("data-toggle")&&"modal"===t.getAttribute("data-toggle")&&(document.getElementById("".concat("deleteoccurrencemodal","confirmed")).setAttribute("data-occurrenceid",t.getAttribute("data-occurrenceid")),$(t.getAttribute("data-target")).modal(),e.preventDefault(),e.stopPropagation())}))}function vD(e){return'<div class="card-header pointer pl-2 pr-2 pt-2 pb-2" id="heading_'.concat(e.id,'" data-toggle="collapse" data-target="#description_').concat(e.id,'">\n    <div class="float-right">\n        <button type="button" class="btn btn-outline-danger delete-occurrence-button" data-toggle="modal" data-target="#').concat("deleteoccurrencemodal",'" data-occurrenceid="').concat(e.id,'"><i class="material-icons">delete</i></button>\n    </div>\n    <h2 class="mb-0 pb-0 mt-0 pt-0 pl-0 ml-0">\n        <button class="btn btn-link').concat(this.controller.currentOccurrenceId===e.id?"":" collapsed",' pt-0 pb-0 pl-0" id="headingbutton_').concat(e.id,'" type="button" data-toggle="collapse" data-target="#description_').concat(e.id,'" aria-expanded="').concat(this.controller.currentOccurrenceId===e.id?"true":"false",'" aria-controls="description_').concat(e.id,'">\n          ').concat(this.occurrenceSummaryHeadingHTML(e),'\n        </button>\n    </h2>\n    <div class="card-invalid-feedback">\n        <small>Please check for errors or missing details.</small>\n    </div>\n</div>\n<div id="description_').concat(e.id,'" class="collapse').concat(this.controller.currentOccurrenceId===e.id?" show":"",'" aria-labelledby="heading_').concat(e.id,'" data-parent="#').concat("occurrencelistcontainer",'" data-occurrenceid="').concat(e.id,'">\n  <div class="card-body">\n    ').concat(this.occurrenceSummaryBodyHTML(e),"\n  </div>\n</div>")}$i(nD,"NEXT_RECORDS","records"),$i(nD,"NEXT_SURVEY_SECTION","survey"),$i(nD,"NEXT_IS_FINAL","last");var yD=function(e){Zi(r,e);var t=os(r);function r(){return Xi(this,r),t.apply(this,arguments)}return zi(r,[{key:"body",value:function(){document.getElementById("body").innerHTML='\x3c!-- begin: templates/helpPage.html --\x3e\r\n<div class="accordion" id="helpaccordion">\r\n    <div class="card">\r\n        <div class="card-header" id="helphelpheadingOne">\r\n            <h5 class="mb-0">\r\n                <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">\r\n                    About the invasive plants survey\r\n                </button>\r\n            </h5>\r\n        </div>\r\n\r\n        <div id="collapseOne" class="collapse show" aria-labelledby="helpheadingOne" data-parent="#helpaccordion">\r\n            <div class="card-body">\r\n                <div style="float: right; padding-left: 12px; margin: 0;" class="d-none d-md-block"><a href="/Plant_Alert_Flyer.pdf" target="_blank" title="Plant Alert introductory leaflet (pdf)"><img src="/img/leaflet_thumb-or8.png" alt="" width="196"><p>download Plant Alert leaflet (pdf)</p></a></div>\r\n                <p>Invasive non-native plants are causing major problems\r\n                for native biodiversity, ecosystems, infrastructure, the\r\n                built environment and human health. Most of our\r\n                invasive plants were introduced as ornamental garden\r\n                    plants but then escaped into the wider environment.</p>\r\n                <p>While maintaining the benefits and contributions of nonnative plants to our gardens we need to know\r\n                    early which plants might endanger natural habitats in the future. Gardeners can play a crucial role\r\n                    as they may be the first to notice any ornamental plants that show signs of invasiveness.</p>\r\n                <p class="d-block d-md-none"><a href="/Plant_Alert_Flyer.pdf" target="_blank" title="Plant Alert introductory leaflet (pdf)">Download the Plant Alert Leaflet</a></p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="card">\r\n        <div class="card-header" id="helpheadingTwo">\r\n            <h5 class="mb-0">\r\n                <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">\r\n                    What happens to my records?\r\n                </button>\r\n            </h5>\r\n        </div>\r\n        <div id="collapseTwo" class="collapse" aria-labelledby="helpheadingTwo" data-parent="#helpaccordion">\r\n            <div class="card-body">\r\n                <p>A list of reported plants can be accessed on the website. At least once a year we will publish a summary of all records received on the webpage and in the <a href="https://bsbi.org/">BSBI\'s newsletter</a>.\r\n                Data collected will be used in risk assessments of species as well as to provide gardeners and nurseries with advice on which plants could also\r\n                    become difficult to manage in gardens.</p>\r\n                <p>The data will also be included in BSBI\'s permanent archive of plant occurrence records.</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="card">\r\n        <div class="card-header" id="helpheadingwhatreport">\r\n            <h5 class="mb-0">\r\n                <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseWhatReport" aria-expanded="false" aria-controls="collapseThree">\r\n                    Which plants should be reported?\r\n                </button>\r\n            </h5>\r\n        </div>\r\n        <div id="collapseWhatReport" class="collapse" aria-labelledby="helpheadingwhatreport" data-parent="#helpaccordion">\r\n            <div class="card-body">\r\n                <p>Many ornamental plants in your garden will spread\r\n                    and this is a sign that they are growing well. We only\r\n                    want to know about those that are spreading to an\r\n                    extent that you have to control them to prevent them\r\n                    overgrowing other plants or parts of your garden\r\n                    where you do not want them.</p>\r\n                    <p>If you do not know a plant you want to report or are\r\n                    not sure, you can submit photographs we will use to\r\n                    help with identification</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="card">\r\n        <div class="card-header" id="helpheadingThree">\r\n            <h5 class="mb-0">\r\n                <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">\r\n                    Help and support\r\n                </button>\r\n            </h5>\r\n        </div>\r\n        <div id="collapseThree" class="collapse" aria-labelledby="helpheadingThree" data-parent="#helpaccordion">\r\n            <div class="card-body">\r\n                <p>If you encounter problems, would like to provide feedback about the survey or for more information about Nyph, please contact\r\n                <a href="mailto:support@nyph.bsbi.org">support@nyph.bsbi.org</a>.</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="card">\r\n        <div class="card-header" id="helpheadingFour">\r\n            <h5 class="mb-0">\r\n                <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseThree">\r\n                    Links to further information\r\n                </button>\r\n            </h5>\r\n        </div>\r\n        <div id="collapseFour" class="collapse" aria-labelledby="helpheadingFour" data-parent="#helpaccordion">\r\n            <div class="card-body">\r\n                <p>Introductory article published in BSBI news.<br>\r\n                    Judith Conroy &amp; Katharina Dehnen-Schmutz. 2018. <a href="/GardenOrnamentals_BSBI_News_2018.pdf" target="_blank">Can gardeners help identify ornamental plants at risk\r\n                    of becoming invasive?</a> BSBI News. <strong>139</strong>: 51.</p>\r\n                <p>The findings of a pilot study for Nyph have been published:<br>\r\n                    Dehnen-Schmutz, K. &amp; Conroy, J. Biol Invasions (2018) <strong>20</strong>: 3069. <a href="https://doi.org/10.1007/s10530-018-1759-3" target="_blank">https://doi.org/10.1007/s10530-018-1759-3</a></p>\r\n                <p>Background information about invasive species can be found on the <a href="http://www.nonnativespecies.org/" target="_blank">GB Non-native Species Secretariat</a> website.</p>\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="card">\r\n        <div class="card-header" id="helpheadingFive">\r\n            <h5 class="mb-0">\r\n                <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseFive" aria-expanded="false" aria-controls="collapseThree">\r\n                    About us\r\n                </button>\r\n            </h5>\r\n        </div>\r\n        <div id="collapseFive" class="collapse" aria-labelledby="helpheadingFive" data-parent="#helpaccordion">\r\n            <div class="card-body">\r\n                Nyph is a collaboration between and the <a href="https://www.coventry.ac.uk/research/areas-of-research/agroecology-water-resilience/" title="CAWR" target="_blank">Centre for Agroecology, Water and Resilience</a> at Coventry University and the <a href="https://bsbi.org/" target="_blank" title="BSBI">Botanical Society of Britain and Ireland</a>.\r\n                <p>For more information, please contact <a href="mailto:support@nyph.bsbi.org">support@nyph.bsbi.org</a>.</p>\r\n                <p>Follow us on twitter <a href="https://twitter.com/Plant_Alert" target="_blank">@Plant_Alert</a></p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\x3c!-- end: templates/helpPage.html --\x3e\r\n<p>Version 1.0.1.1634554373</p>'}}]),r}(cx),mD=ue,gD=Nr,SD=yl,bD=f,ND=Se,TD=Du,wD=Yu;Pu("match",(function(e,t,r){return[function(t){var r=bD(this),n=null==t?void 0:ND(t,e);return n?n.call(t,r):new RegExp(t)[e](SD(r))},function(e){var n=mD(this),o=SD(e),a=r(t,n,o);if(a.done)return a.value;if(!n.global)return wD(n,o);var i=n.unicode;n.lastIndex=0;for(var s,c=[],l=0;null!==(s=wD(n,o));){var u=SD(s[0]);c[l]=u,""===u&&(n.lastIndex=TD(o,gD(n.lastIndex),i)),l++}return 0===l?null:c}]}));var ED=function(e){Zi(r,e);var t=os(r);function r(e){var n;return Xi(this,r),$i(rs(n=t.call(this)),"route","/survey/:action/:id"),$i(rs(n),"title","NYPH survey picker"),$i(rs(n),"app",void 0),$i(rs(n),"view",void 0),n.view=e,e.controller=rs(n),n.handle=fd.nextHandle,n}return zi(r,[{key:"survey",get:function(){return this.app.currentSurvey}},{key:"registerRoute",value:function(e){e.on("/survey",this.mainRouteHandler.bind(this,"survey","",""),{}),e.on("/survey/new",this.newSurveyHandler.bind(this,"survey","new",""),{before:this.beforeNewHandler.bind(this)}),e.on("/survey/reset",this.mainRouteHandler.bind(this,"survey","reset",""),{before:this.beforeResetHandler.bind(this)}),e.on("/survey/save",this.mainRouteHandler.bind(this,"survey","save",""),{before:this.beforeSaveAllHandler.bind(this)}),e.on("/survey/add/:surveyId",this.addSurveyHandler.bind(this,"survey","add","")),this.app.addListener(gx.EVENT_ADD_SURVEY_USER_REQUEST,this,this.addNewSurveyHandler),this.app.addListener(gx.EVENT_RESET_SURVEYS,this,this.resetSurveysHandler)}},{key:"beforeNewHandler",value:function(e){$("#".concat(bx.NEW_SURVEY_MODAL_ID)).modal(),this.app.router.pause(),window.history.back(),this.app.router.resume(),e(!1)}},{key:"beforeResetHandler",value:function(e){$("#".concat(bx.RESET_MODAL_ID)).modal(),this.app.router.pause(),window.history.back(),this.app.router.resume(),e(!1)}},{key:"beforeSaveAllHandler",value:function(e){this.app.syncAll().then((function(e){console.log("In save all handler, success result: ".concat(e)),$("#".concat(bx.SAVE_ALL_SUCCESS_MODAL_ID)).modal()}),(function(e){console.log("In save all handler, failure result: ".concat(e)),$("#".concat(bx.SAVE_ALL_FAILURE_MODAL_ID)).modal()})).finally((function(){})),this.app.router.pause(),window.history.back(),this.app.router.resume(),e(!1)}},{key:"newSurveyHandler",value:function(e,t,r,n){}},{key:"addNewSurveyHandler",value:function(){console.log("reached addNewSurveyHandler"),this.app.currentControllerHandle=this.handle,this.app.clearCurrentSurvey(),this.app.setNewSurvey(),this.app.router.pause(),this.app.router.navigate("/list/survey/welcome").resume(),this.app.router.resolve()}},{key:"resetSurveysHandler",value:function(){var e=this;this.app.clearLocalForage().then((function(){e.app.reset(),e.addNewSurveyHandler()}))}},{key:"addSurveyHandler",value:function(e,t,r,n){var o=this;console.log("reached addSurveyHandler"),console.log({context:e,params:t,query:n}),this.app.currentControllerHandle=this.handle;var a=n.surveyId;if(!a||!a.match(DO))throw new xb("Failed to match survey id '".concat(a,"', the id format appears to be incorrect"));a=a.toLowerCase(),this.app.restoreOccurrences(a).then((function(){o.app.markAllNotPristine(),o.app.router.pause(),o.app.router.navigate("/list").resume(),o.app.router.resolve()}),(function(e){console.log({"failed survey restoration":e})}))}},{key:"mainRouteHandler",value:function(e,t,r,n){console.log("reached special route handler for SurveyPickerController.js"),console.log({context:e,params:t,query:n})}}]),r}(fd);$i(ED,"EVENT_BACK","back");var _D=function(e){Zi(r,e);var t=os(r);function r(){var e;Xi(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return $i(rs(e=t.call.apply(t,[this].concat(o))),"surveysMenuId","surveysmenu"),e}return r}(bx),OD={},RD=W;OD.f=RD;var ID=n,xD=m,CD=OD,AD=ee.f,kD=function(e){var t=ID.Symbol||(ID.Symbol={});xD(t,e)||AD(t,e,{value:CD.f(e)})},LD=un,MD=n,PD=_,HD=Z,DD=D,FD=M,jD=m,UD=Ss,BD=N,YD=re,VD=he,JD=ue,GD=p,KD=rr,qD=Ae,WD=yl,XD=De,QD=hc,zD=zs,$D=dr,ZD=tM,eF=Dr,tF=Kt,rF=ee,nF=qt,oF=z.exports,aF=o.exports,iF=rt,sF=b,cF=W,lF=OD,uF=kD,dF=Tn,fF=yt,hF=KM.forEach,pF=tt("hidden"),vF=cF("toPrimitive"),yF=fF.set,mF=fF.getterFor("Symbol"),gF=Object.prototype,SF=MD.Symbol,bF=PD("JSON","stringify"),NF=tF.f,TF=rF.f,wF=ZD.f,EF=nF.f,_F=aF("symbols"),OF=aF("op-symbols"),RF=aF("string-to-symbol-registry"),IF=aF("symbol-to-string-registry"),xF=aF("wks"),CF=MD.QObject,AF=!CF||!CF.prototype||!CF.prototype.findChild,kF=HD&&FD((function(){return 7!=QD(TF({},"a",{get:function(){return TF(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=NF(gF,t);n&&delete gF[t],TF(e,t,r),n&&e!==gF&&TF(gF,t,n)}:TF,LF=function(e,t){var r=_F[e]=QD(SF.prototype);return yF(r,{type:"Symbol",tag:e,description:t}),HD||(r.description=t),r},MF=function(e,t,r){e===gF&&MF(OF,t,r),JD(e);var n=qD(t);return JD(r),jD(_F,n)?(r.enumerable?(jD(e,pF)&&e[pF][n]&&(e[pF][n]=!1),r=QD(r,{enumerable:XD(0,!1)})):(jD(e,pF)||TF(e,pF,XD(1,{})),e[pF][n]=!0),kF(e,n,r)):TF(e,n,r)},PF=function(e,t){JD(e);var r=KD(t),n=zD(r).concat(jF(r));return hF(n,(function(t){HD&&!HF.call(r,t)||MF(e,t,r[t])})),e},HF=function(e){var t=qD(e),r=EF.call(this,t);return!(this===gF&&jD(_F,t)&&!jD(OF,t))&&(!(r||!jD(this,t)||!jD(_F,t)||jD(this,pF)&&this[pF][t])||r)},DF=function(e,t){var r=KD(e),n=qD(t);if(r!==gF||!jD(_F,n)||jD(OF,n)){var o=NF(r,n);return!o||!jD(_F,n)||jD(r,pF)&&r[pF][n]||(o.enumerable=!0),o}},FF=function(e){var t=wF(KD(e)),r=[];return hF(t,(function(e){jD(_F,e)||jD(iF,e)||r.push(e)})),r},jF=function(e){var t=e===gF,r=wF(t?OF:KD(e)),n=[];return hF(r,(function(e){!jD(_F,e)||t&&!jD(gF,e)||n.push(_F[e])})),n};(DD||(oF((SF=function(){if(this instanceof SF)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?WD(arguments[0]):void 0,t=sF(e),r=function(e){this===gF&&r.call(OF,e),jD(this,pF)&&jD(this[pF],t)&&(this[pF][t]=!1),kF(this,t,XD(1,e))};return HD&&AF&&kF(gF,t,{configurable:!0,set:r}),LF(t,e)}).prototype,"toString",(function(){return mF(this).tag})),oF(SF,"withoutSetter",(function(e){return LF(sF(e),e)})),nF.f=HF,rF.f=MF,tF.f=DF,$D.f=ZD.f=FF,eF.f=jF,lF.f=function(e){return LF(cF(e),e)},HD&&(TF(SF.prototype,"description",{configurable:!0,get:function(){return mF(this).description}}),oF(gF,"propertyIsEnumerable",HF,{unsafe:!0}))),LD({global:!0,wrap:!0,forced:!DD,sham:!DD},{Symbol:SF}),hF(zD(xF),(function(e){uF(e)})),LD({target:"Symbol",stat:!0,forced:!DD},{for:function(e){var t=WD(e);if(jD(RF,t))return RF[t];var r=SF(t);return RF[t]=r,IF[r]=t,r},keyFor:function(e){if(!VD(e))throw TypeError(e+" is not a symbol");if(jD(IF,e))return IF[e]},useSetter:function(){AF=!0},useSimple:function(){AF=!1}}),LD({target:"Object",stat:!0,forced:!DD,sham:!HD},{create:function(e,t){return void 0===t?QD(e):PF(QD(e),t)},defineProperty:MF,defineProperties:PF,getOwnPropertyDescriptor:DF}),LD({target:"Object",stat:!0,forced:!DD},{getOwnPropertyNames:FF,getOwnPropertySymbols:jF}),LD({target:"Object",stat:!0,forced:FD((function(){eF.f(1)}))},{getOwnPropertySymbols:function(e){return eF.f(GD(e))}}),bF)&&LD({target:"JSON",stat:!0,forced:!DD||FD((function(){var e=SF();return"[null]"!=bF([e])||"{}"!=bF({a:e})||"{}"!=bF(Object(e))}))},{stringify:function(e,t,r){for(var n,o=[e],a=1;arguments.length>a;)o.push(arguments[a++]);if(n=t,(YD(t)||void 0!==e)&&!VD(e))return UD(t)||(t=function(e,t){if(BD(n)&&(t=n.call(this,e,t)),!VD(t))return t}),o[1]=t,bF.apply(null,o)}});if(!SF.prototype[vF]){var UF=SF.prototype.valueOf;oF(SF.prototype,vF,(function(){return UF.apply(this,arguments)}))}dF(SF,"Symbol"),iF[pF]=!0;var BF=un,YF=Z,VF=n,JF=m,GF=N,KF=re,qF=ee.f,WF=Kr,XF=VF.Symbol;if(YF&&GF(XF)&&(!("description"in XF.prototype)||void 0!==XF().description)){var QF={},zF=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof zF?new XF(e):void 0===e?XF():XF(e);return""===e&&(QF[t]=!0),t};WF(zF,XF);var $F=zF.prototype=XF.prototype;$F.constructor=zF;var ZF=$F.toString,ej="Symbol(test)"==String(XF("test")),tj=/^Symbol\((.*)\)[^)]+$/;qF($F,"description",{configurable:!0,get:function(){var e=KF(this)?this.valueOf():this,t=ZF.call(e);if(JF(QF,e))return"";var r=ej?t.slice(7,-1):t.replace(tj,"$1");return""===r?void 0:r}}),BF({global:!0,forced:!0},{Symbol:zF})}kD("asyncIterator"),kD("hasInstance"),kD("isConcatSpreadable"),kD("iterator"),kD("match"),kD("matchAll"),kD("replace"),kD("search"),kD("species"),kD("split"),kD("toPrimitive"),kD("toStringTag"),kD("unscopables");var rj=re,nj=Ue,oj=un,aj=xc,ij=gn,sj=Kr,cj=hc,lj=Ue,uj=De,dj=function(e,t){rj(t)&&"cause"in t&&nj(e,"cause",t.cause)},fj=ro,hj=yl,pj=function(e,t){var r=this,n=arguments.length>2?arguments[2]:void 0;if(!(r instanceof pj))return new pj(e,t,n);ij&&(r=ij(new Error(void 0),aj(r))),void 0!==t&&lj(r,"message",hj(t)),dj(r,n);var o=[];return fj(e,o.push,{that:o}),lj(r,"errors",o),r};ij?ij(pj,Error):sj(pj,Error),pj.prototype=cj(Error.prototype,{constructor:uj(1,pj),message:uj(1,""),name:uj(1,"AggregateError")}),oj({global:!0},{AggregateError:pj});var vj=p,yj=wr,mj=pr,gj=Nc;un({target:"Array",proto:!0},{at:function(e){var t=vj(this),r=yj(t),n=mj(e),o=n>=0?n:r+n;return o<0||o>=r?void 0:t[o]}}),gj("at");var Sj=p,bj=gr,Nj=wr,Tj=Math.min,wj=[].copyWithin||function(e,t){var r=Sj(this),n=Nj(r),o=bj(e,n),a=bj(t,n),i=arguments.length>2?arguments[2]:void 0,s=Tj((void 0===i?n:bj(i,n))-a,n-o),c=1;for(a<o&&o<a+s&&(c=-1,a+=s-1,o+=s-1);s-- >0;)a in r?r[o]=r[a]:delete r[o],o+=c,a+=c;return r},Ej=Nc;un({target:"Array",proto:!0},{copyWithin:wj}),Ej("copyWithin");var _j=KM.every;un({target:"Array",proto:!0,forced:!CP("every")},{every:function(e){return _j(this,e,arguments.length>1?arguments[1]:void 0)}});var Oj=p,Rj=gr,Ij=wr,xj=function(e){for(var t=Oj(this),r=Ij(t),n=arguments.length,o=Rj(n>1?arguments[1]:void 0,r),a=n>2?arguments[2]:void 0,i=void 0===a?r:Rj(a,r);i>o;)t[o++]=e;return t},Cj=Nc;un({target:"Array",proto:!0},{fill:xj}),Cj("fill");var Aj=KM.filter;un({target:"Array",proto:!0,forced:!Ls("filter")},{filter:function(e){return Aj(this,e,arguments.length>1?arguments[1]:void 0)}});var kj=un,Lj=KM.find,Mj=Nc,Pj=!0;"find"in[]&&Array(1).find((function(){Pj=!1})),kj({target:"Array",proto:!0,forced:Pj},{find:function(e){return Lj(this,e,arguments.length>1?arguments[1]:void 0)}}),Mj("find");var Hj=un,Dj=KM.findIndex,Fj=Nc,jj=!0;"findIndex"in[]&&Array(1).findIndex((function(){jj=!1})),Hj({target:"Array",proto:!0,forced:jj},{findIndex:function(e){return Dj(this,e,arguments.length>1?arguments[1]:void 0)}}),Fj("findIndex");var Uj=Ss,Bj=wr,Yj=Pn,Vj=function(e,t,r,n,o,a,i,s){for(var c,l,u=o,d=0,f=!!i&&Yj(i,s,3);d<n;){if(d in r){if(c=f?f(r[d],d,t):r[d],a>0&&Uj(c))l=Bj(c),u=Vj(e,t,c,l,u,a-1)-1;else{if(u>=9007199254740991)throw TypeError("Exceed the acceptable array length");e[u]=c}u++}d++}return u},Jj=Vj,Gj=Jj,Kj=p,qj=wr,Wj=pr,Xj=xs;un({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=Kj(this),r=qj(t),n=Xj(t,0);return n.length=Gj(n,t,t,r,0,void 0===e?1:Wj(e)),n}});var Qj=Jj,zj=me,$j=p,Zj=wr,eU=xs;un({target:"Array",proto:!0},{flatMap:function(e){var t,r=$j(this),n=Zj(r);return zj(e),(t=eU(r,0)).length=Qj(t,r,r,n,0,1,e,arguments.length>1?arguments[1]:void 0),t}});var tU=KM.forEach,rU=CP("forEach")?[].forEach:function(e){return tU(this,e,arguments.length>1?arguments[1]:void 0)};un({target:"Array",proto:!0,forced:[].forEach!=rU},{forEach:rU});var nU=ue,oU=qn,aU=Pn,iU=p,sU=function(e,t,r,n){try{return n?t(nU(r)[0],r[1]):t(r)}catch(t){oU(e,"throw",t)}},cU=Ln,lU=wo,uU=wr,dU=ws,fU=Jn,hU=Un,pU=function(e){var t=iU(e),r=lU(this),n=arguments.length,o=n>1?arguments[1]:void 0,a=void 0!==o;a&&(o=aU(o,n>2?arguments[2]:void 0,2));var i,s,c,l,u,d,f=hU(t),h=0;if(!f||this==Array&&cU(f))for(i=uU(t),s=r?new this(i):Array(i);i>h;h++)d=a?o(t[h],h):t[h],dU(s,h,d);else for(u=(l=fU(t,f)).next,s=r?new this:[];!(c=u.call(l)).done;h++)d=a?sU(l,o,[c.value,h],!0):c.value,dU(s,h,d);return s.length=h,s},vU=pU;un({target:"Array",stat:!0,forced:!fo((function(e){Array.from(e)}))},{from:vU});var yU=un,mU=Ir.indexOf,gU=CP,SU=[].indexOf,bU=!!SU&&1/[1].indexOf(1,-0)<0,NU=gU("indexOf");yU({target:"Array",proto:!0,forced:bU||!NU},{indexOf:function(e){return bU?SU.apply(this,arguments)||0:mU(this,e,arguments.length>1?arguments[1]:void 0)}}),un({target:"Array",stat:!0},{isArray:Ss});var TU=rr,wU=pr,EU=wr,_U=CP,OU=Math.min,RU=[].lastIndexOf,IU=!!RU&&1/[1].lastIndexOf(1,-0)<0,xU=_U("lastIndexOf"),CU=IU||!xU?function(e){if(IU)return RU.apply(this,arguments)||0;var t=TU(this),r=EU(t),n=r-1;for(arguments.length>1&&(n=OU(n,wU(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}:RU;un({target:"Array",proto:!0,forced:CU!==[].lastIndexOf},{lastIndexOf:CU});var AU=KM.map;un({target:"Array",proto:!0,forced:!Ls("map")},{map:function(e){return AU(this,e,arguments.length>1?arguments[1]:void 0)}});var kU=wo,LU=ws;un({target:"Array",stat:!0,forced:M((function(){function e(){}return!(Array.of.call(e)instanceof e)}))},{of:function(){for(var e=0,t=arguments.length,r=new(kU(this)?this:Array)(t);t>e;)LU(r,e,arguments[e++]);return r.length=t,r}});var MU=me,PU=p,HU=Zt,DU=wr,FU=function(e){return function(t,r,n,o){MU(r);var a=PU(t),i=HU(a),s=DU(a),c=e?s-1:0,l=e?-1:1;if(n<2)for(;;){if(c in i){o=i[c],c+=l;break}if(c+=l,e?c<0:s<=c)throw TypeError("Reduce of empty array with no initial value")}for(;e?c>=0:s>c;c+=l)c in i&&(o=r(o,i[c],c,a));return o}},jU={left:FU(!1),right:FU(!0)},UU=jU.left,BU=L,YU=Lo;un({target:"Array",proto:!0,forced:!CP("reduce")||!YU&&BU>79&&BU<83},{reduce:function(e){return UU(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var VU=jU.right,JU=L,GU=Lo;un({target:"Array",proto:!0,forced:!CP("reduceRight")||!GU&&JU>79&&JU<83},{reduceRight:function(e){return VU(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var KU=Ss,qU=[].reverse,WU=[1,2];un({target:"Array",proto:!0,forced:String(WU)===String(WU.reverse())},{reverse:function(){return KU(this)&&(this.length=this.length),qU.call(this)}});var XU=un,QU=Ss,zU=wo,$U=re,ZU=gr,eB=wr,tB=rr,rB=ws,nB=W,oB=Ls("slice"),aB=nB("species"),iB=[].slice,sB=Math.max;XU({target:"Array",proto:!0,forced:!oB},{slice:function(e,t){var r,n,o,a=tB(this),i=eB(a),s=ZU(e,i),c=ZU(void 0===t?i:t,i);if(QU(a)&&(r=a.constructor,(zU(r)&&(r===Array||QU(r.prototype))||$U(r)&&null===(r=r[aB]))&&(r=void 0),r===Array||void 0===r))return iB.call(a,s,c);for(n=new(void 0===r?Array:r)(sB(c-s,0)),o=0;s<c;s++,o++)s in a&&rB(n,o,a[s]);return n.length=o,n}});var cB=KM.some;un({target:"Array",proto:!0,forced:!CP("some")},{some:function(e){return cB(this,e,arguments.length>1?arguments[1]:void 0)}}),Rn("Array");var lB=un,uB=gr,dB=pr,fB=wr,hB=p,pB=xs,vB=ws,yB=Ls("splice"),mB=Math.max,gB=Math.min;lB({target:"Array",proto:!0,forced:!yB},{splice:function(e,t){var r,n,o,a,i,s,c=hB(this),l=fB(c),u=uB(e,l),d=arguments.length;if(0===d?r=n=0:1===d?(r=0,n=l-u):(r=d-2,n=gB(mB(dB(t),0),l-u)),l+r-n>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(o=pB(c,n),a=0;a<n;a++)(i=u+a)in c&&vB(o,a,c[i]);if(o.length=n,r<n){for(a=u;a<l-n;a++)s=a+r,(i=a+n)in c?c[s]=c[i]:delete c[s];for(a=l;a>l-n+r;a--)delete c[a-1]}else if(r>n)for(a=l-n;a>u;a--)s=a+r-1,(i=a+n-1)in c?c[s]=c[i]:delete c[s];for(a=0;a<r;a++)c[a+u]=arguments[a+2];return c.length=l-n+r,o}}),Nc("flat"),Nc("flatMap");var SB="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,bB=pr,NB=Nr,TB=function(e){if(void 0===e)return 0;var t=bB(e),r=NB(t);if(t!==r)throw RangeError("Wrong length or index");return r},wB=Math.abs,EB=Math.pow,_B=Math.floor,OB=Math.log,RB=Math.LN2,IB=n,xB=Z,CB=SB,AB=Tt,kB=Ue,LB=hn,MB=M,PB=In,HB=pr,DB=Nr,FB=TB,jB={pack:function(e,t,r){var n,o,a,i=new Array(r),s=8*r-t-1,c=(1<<s)-1,l=c>>1,u=23===t?EB(2,-24)-EB(2,-77):0,d=e<0||0===e&&1/e<0?1:0,f=0;for((e=wB(e))!=e||e===1/0?(o=e!=e?1:0,n=c):(n=_B(OB(e)/RB),e*(a=EB(2,-n))<1&&(n--,a*=2),(e+=n+l>=1?u/a:u*EB(2,1-l))*a>=2&&(n++,a/=2),n+l>=c?(o=0,n=c):n+l>=1?(o=(e*a-1)*EB(2,t),n+=l):(o=e*EB(2,l-1)*EB(2,t),n=0));t>=8;i[f++]=255&o,o/=256,t-=8);for(n=n<<t|o,s+=t;s>0;i[f++]=255&n,n/=256,s-=8);return i[--f]|=128*d,i},unpack:function(e,t){var r,n=e.length,o=8*n-t-1,a=(1<<o)-1,i=a>>1,s=o-7,c=n-1,l=e[c--],u=127&l;for(l>>=7;s>0;u=256*u+e[c],c--,s-=8);for(r=u&(1<<-s)-1,u>>=-s,s+=t;s>0;r=256*r+e[c],c--,s-=8);if(0===u)u=1-i;else{if(u===a)return r?NaN:l?-1/0:1/0;r+=EB(2,t),u-=i}return(l?-1:1)*r*EB(2,u-t)}},UB=xc,BB=gn,YB=dr.f,VB=ee.f,JB=xj,GB=Tn,KB=AB.PROPER,qB=AB.CONFIGURABLE,WB=yt.get,XB=yt.set,QB=IB.ArrayBuffer,zB=QB,$B=IB.DataView,ZB=$B&&$B.prototype,eY=Object.prototype,tY=IB.RangeError,rY=jB.pack,nY=jB.unpack,oY=function(e){return[255&e]},aY=function(e){return[255&e,e>>8&255]},iY=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},sY=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},cY=function(e){return rY(e,23,4)},lY=function(e){return rY(e,52,8)},uY=function(e,t){VB(e.prototype,t,{get:function(){return WB(this)[t]}})},dY=function(e,t,r,n){var o=FB(r),a=WB(e);if(o+t>a.byteLength)throw tY("Wrong index");var i=WB(a.buffer).bytes,s=o+a.byteOffset,c=i.slice(s,s+t);return n?c:c.reverse()},fY=function(e,t,r,n,o,a){var i=FB(r),s=WB(e);if(i+t>s.byteLength)throw tY("Wrong index");for(var c=WB(s.buffer).bytes,l=i+s.byteOffset,u=n(+o),d=0;d<t;d++)c[l+d]=u[a?d:t-d-1]};if(CB){var hY=KB&&"ArrayBuffer"!==QB.name;if(MB((function(){QB(1)}))&&MB((function(){new QB(-1)}))&&!MB((function(){return new QB,new QB(1.5),new QB(NaN),hY&&!qB})))hY&&qB&&kB(QB,"name","ArrayBuffer");else{for(var pY,vY=(zB=function(e){return PB(this,zB),new QB(FB(e))}).prototype=QB.prototype,yY=YB(QB),mY=0;yY.length>mY;)(pY=yY[mY++])in zB||kB(zB,pY,QB[pY]);vY.constructor=zB}BB&&UB(ZB)!==eY&&BB(ZB,eY);var gY=new $B(new zB(2)),SY=ZB.setInt8;gY.setInt8(0,2147483648),gY.setInt8(1,2147483649),!gY.getInt8(0)&&gY.getInt8(1)||LB(ZB,{setInt8:function(e,t){SY.call(this,e,t<<24>>24)},setUint8:function(e,t){SY.call(this,e,t<<24>>24)}},{unsafe:!0})}else zB=function(e){PB(this,zB,"ArrayBuffer");var t=FB(e);XB(this,{bytes:JB.call(new Array(t),0),byteLength:t}),xB||(this.byteLength=t)},$B=function(e,t,r){PB(this,$B,"DataView"),PB(e,zB,"DataView");var n=WB(e).byteLength,o=HB(t);if(o<0||o>n)throw tY("Wrong offset");if(o+(r=void 0===r?n-o:DB(r))>n)throw tY("Wrong length");XB(this,{buffer:e,byteLength:r,byteOffset:o}),xB||(this.buffer=e,this.byteLength=r,this.byteOffset=o)},xB&&(uY(zB,"byteLength"),uY($B,"buffer"),uY($B,"byteLength"),uY($B,"byteOffset")),LB($B.prototype,{getInt8:function(e){return dY(this,1,e)[0]<<24>>24},getUint8:function(e){return dY(this,1,e)[0]},getInt16:function(e){var t=dY(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=dY(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return sY(dY(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return sY(dY(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return nY(dY(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return nY(dY(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){fY(this,1,e,oY,t)},setUint8:function(e,t){fY(this,1,e,oY,t)},setInt16:function(e,t){fY(this,2,e,aY,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){fY(this,2,e,aY,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){fY(this,4,e,iY,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){fY(this,4,e,iY,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){fY(this,4,e,cY,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){fY(this,8,e,lY,t,arguments.length>2?arguments[2]:void 0)}});GB(zB,"ArrayBuffer"),GB($B,"DataView");var bY={ArrayBuffer:zB,DataView:$B},NY=Rn,TY=bY.ArrayBuffer;un({global:!0,forced:n.ArrayBuffer!==TY},{ArrayBuffer:TY}),NY("ArrayBuffer");var wY,EY,_Y,OY=SB,RY=Z,IY=n,xY=N,CY=re,AY=m,kY=Ut,LY=pe,MY=Ue,PY=z.exports,HY=ee.f,DY=xc,FY=gn,jY=W,UY=b,BY=IY.Int8Array,YY=BY&&BY.prototype,VY=IY.Uint8ClampedArray,JY=VY&&VY.prototype,GY=BY&&DY(BY),KY=YY&&DY(YY),qY=Object.prototype,WY=qY.isPrototypeOf,XY=jY("toStringTag"),QY=UY("TYPED_ARRAY_TAG"),zY=UY("TYPED_ARRAY_CONSTRUCTOR"),$Y=OY&&!!FY&&"Opera"!==kY(IY.opera),ZY=!1,eV={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},tV={BigInt64Array:8,BigUint64Array:8},rV=function(e){if(!CY(e))return!1;var t=kY(e);return AY(eV,t)||AY(tV,t)};for(wY in eV)(_Y=(EY=IY[wY])&&EY.prototype)?MY(_Y,zY,EY):$Y=!1;for(wY in tV)(_Y=(EY=IY[wY])&&EY.prototype)&&MY(_Y,zY,EY);if((!$Y||!xY(GY)||GY===Function.prototype)&&(GY=function(){throw TypeError("Incorrect invocation")},$Y))for(wY in eV)IY[wY]&&FY(IY[wY],GY);if((!$Y||!KY||KY===qY)&&(KY=GY.prototype,$Y))for(wY in eV)IY[wY]&&FY(IY[wY].prototype,KY);if($Y&&DY(JY)!==KY&&FY(JY,KY),RY&&!AY(KY,XY))for(wY in ZY=!0,HY(KY,XY,{get:function(){return CY(this)?this[QY]:void 0}}),eV)IY[wY]&&MY(IY[wY],QY,wY);var nV={NATIVE_ARRAY_BUFFER_VIEWS:$Y,TYPED_ARRAY_CONSTRUCTOR:zY,TYPED_ARRAY_TAG:ZY&&QY,aTypedArray:function(e){if(rV(e))return e;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(e){if(xY(e)&&(!FY||WY.call(GY,e)))return e;throw TypeError(LY(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,r){if(RY){if(r)for(var n in eV){var o=IY[n];if(o&&AY(o.prototype,e))try{delete o.prototype[e]}catch(e){}}KY[e]&&!r||PY(KY,e,r?t:$Y&&YY[e]||t)}},exportTypedArrayStaticMethod:function(e,t,r){var n,o;if(RY){if(FY){if(r)for(n in eV)if((o=IY[n])&&AY(o,e))try{delete o[e]}catch(e){}if(GY[e]&&!r)return;try{return PY(GY,e,r?t:$Y&&GY[e]||t)}catch(e){}}for(n in eV)!(o=IY[n])||o[e]&&!r||PY(o,e,t)}},isView:function(e){if(!CY(e))return!1;var t=kY(e);return"DataView"===t||AY(eV,t)||AY(tV,t)},isTypedArray:rV,TypedArray:GY,TypedArrayPrototype:KY};un({target:"ArrayBuffer",stat:!0,forced:!nV.NATIVE_ARRAY_BUFFER_VIEWS},{isView:nV.isView});var oV=un,aV=M,iV=ue,sV=gr,cV=Nr,lV=Co,uV=bY.ArrayBuffer,dV=bY.DataView,fV=uV.prototype.slice;oV({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:aV((function(){return!new uV(2).slice(1,void 0).byteLength}))},{slice:function(e,t){if(void 0!==fV&&void 0===t)return fV.call(iV(this),e);for(var r=iV(this).byteLength,n=sV(e,r),o=sV(void 0===t?r:t,r),a=new(lV(this,uV))(cV(o-n)),i=new dV(this),s=new dV(a),c=0;n<o;)s.setUint8(c++,i.getUint8(n++));return a}}),un({global:!0,forced:!SB},{DataView:bY.DataView});var hV=un,pV=M((function(){return 120!==new Date(16e11).getYear()})),vV=Date.prototype.getFullYear;hV({target:"Date",proto:!0,forced:pV},{getYear:function(){return vV.call(this)-1900}}),un({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}});var yV=un,mV=pr,gV=Date.prototype.getTime,SV=Date.prototype.setFullYear;yV({target:"Date",proto:!0},{setYear:function(e){gV.call(this);var t=mV(e),r=0<=t&&t<=99?t+1900:t;return SV.call(this,r)}}),un({target:"Date",proto:!0},{toGMTString:Date.prototype.toUTCString});var bV=pr,NV=yl,TV=f,wV=function(e){var t=NV(TV(this)),r="",n=bV(e);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(r+=t);return r},EV=Nr,_V=yl,OV=wV,RV=f,IV=Math.ceil,xV=function(e){return function(t,r,n){var o,a,i=_V(RV(t)),s=EV(r),c=i.length,l=void 0===n?" ":_V(n);return s<=c||""==l?i:(o=s-c,(a=OV.call(l,IV(o/l.length))).length>o&&(a=a.slice(0,o)),e?i+a:a+i)}},CV={start:xV(!1),end:xV(!0)},AV=M,kV=CV.start,LV=Math.abs,MV=Date.prototype,PV=MV.getTime,HV=MV.toISOString,DV=AV((function(){return"0385-07-25T07:06:39.999Z"!=HV.call(new Date(-50000000000001))}))||!AV((function(){HV.call(new Date(NaN))}))?function(){if(!isFinite(PV.call(this)))throw RangeError("Invalid time value");var e=this.getUTCFullYear(),t=this.getUTCMilliseconds(),r=e<0?"-":e>9999?"+":"";return r+kV(LV(e),r?6:4,0)+"-"+kV(this.getUTCMonth()+1,2,0)+"-"+kV(this.getUTCDate(),2,0)+"T"+kV(this.getUTCHours(),2,0)+":"+kV(this.getUTCMinutes(),2,0)+":"+kV(this.getUTCSeconds(),2,0)+"."+kV(t,3,0)+"Z"}:HV;un({target:"Date",proto:!0,forced:Date.prototype.toISOString!==DV},{toISOString:DV});var FV=p,jV=Ie;un({target:"Date",proto:!0,forced:M((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}))},{toJSON:function(e){var t=FV(this),r=jV(t,"number");return"number"!=typeof r||isFinite(r)?t.toISOString():null}});var UV=ue,BV=Te,YV=z.exports,VV=function(e){if(UV(this),"string"===e||"default"===e)e="string";else if("number"!==e)throw TypeError("Incorrect hint");return BV(this,e)},JV=W("toPrimitive"),GV=Date.prototype;JV in GV||YV(GV,JV,VV);var KV=z.exports,qV=Date.prototype,WV=qV.toString,XV=qV.getTime;"Invalid Date"!=String(new Date(NaN))&&KV(qV,"toString",(function(){var e=XV.call(this);return e==e?WV.call(this):"Invalid Date"}));var QV=yl,zV=/[\w*+\-./@]/,$V=function(e,t){for(var r=e.toString(16);r.length<t;)r="0"+r;return r};un({global:!0},{escape:function(e){for(var t,r,n=QV(e),o="",a=n.length,i=0;i<a;)t=n.charAt(i++),zV.test(t)?o+=t:o+=(r=t.charCodeAt(0))<256?"%"+$V(r,2):"%u"+$V(r,4).toUpperCase();return o}});var ZV=me,eJ=re,tJ=[].slice,rJ={},nJ=function(e,t,r){if(!(t in rJ)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";rJ[t]=Function("C,a","return new C("+n.join(",")+")")}return rJ[t](e,r)},oJ=Function.bind||function(e){var t=ZV(this),r=tJ.call(arguments,1),n=function(){var o=r.concat(tJ.call(arguments));return this instanceof n?nJ(t,o.length,o):t.apply(e,o)};return eJ(t.prototype)&&(n.prototype=t.prototype),n};un({target:"Function",proto:!0},{bind:oJ});var aJ=N,iJ=re,sJ=ee,cJ=xc,lJ=W("hasInstance"),uJ=Function.prototype;lJ in uJ||sJ.f(uJ,lJ,{value:function(e){if(!aJ(this)||!iJ(e))return!1;if(!iJ(this.prototype))return e instanceof this;for(;e=cJ(e);)if(this.prototype===e)return!0;return!1}});var dJ=Z,fJ=Tt.EXISTS,hJ=ee.f,pJ=Function.prototype,vJ=pJ.toString,yJ=/^\s*function ([^ (]*)/;dJ&&!fJ&&hJ(pJ,"name",{configurable:!0,get:function(){try{return vJ.call(this).match(yJ)[1]}catch(e){return""}}}),un({global:!0},{globalThis:n});var mJ=un,gJ=M,SJ=_("JSON","stringify"),bJ=/[\uD800-\uDFFF]/g,NJ=/^[\uD800-\uDBFF]$/,TJ=/^[\uDC00-\uDFFF]$/,wJ=function(e,t,r){var n=r.charAt(t-1),o=r.charAt(t+1);return NJ.test(e)&&!TJ.test(o)||TJ.test(e)&&!NJ.test(n)?"\\u"+e.charCodeAt(0).toString(16):e},EJ=gJ((function(){return'"\\udf06\\ud834"'!==SJ("\udf06\ud834")||'"\\udead"'!==SJ("\udead")}));SJ&&mJ({target:"JSON",stat:!0,forced:EJ},{stringify:function(e,t,r){var n=SJ.apply(null,arguments);return"string"==typeof n?n.replace(bJ,wJ):n}}),Tn(n.JSON,"JSON",!0);var _J=ee.f,OJ=hc,RJ=hn,IJ=Pn,xJ=In,CJ=ro,AJ=il,kJ=Rn,LJ=Z,MJ=eM.exports.fastKey,PJ=yt.set,HJ=yt.getterFor,DJ={getConstructor:function(e,t,r,n){var o=e((function(e,a){xJ(e,o,t),PJ(e,{type:t,index:OJ(null),first:void 0,last:void 0,size:0}),LJ||(e.size=0),null!=a&&CJ(a,e[n],{that:e,AS_ENTRIES:r})})),a=HJ(t),i=function(e,t,r){var n,o,i=a(e),c=s(e,t);return c?c.value=r:(i.last=c={index:o=MJ(t,!0),key:t,value:r,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=c),n&&(n.next=c),LJ?i.size++:e.size++,"F"!==o&&(i.index[o]=c)),e},s=function(e,t){var r,n=a(e),o=MJ(t);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key==t)return r};return RJ(o.prototype,{clear:function(){for(var e=a(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,LJ?e.size=0:this.size=0},delete:function(e){var t=a(this),r=s(this,e);if(r){var n=r.next,o=r.previous;delete t.index[r.index],r.removed=!0,o&&(o.next=n),n&&(n.previous=o),t.first==r&&(t.first=n),t.last==r&&(t.last=o),LJ?t.size--:this.size--}return!!r},forEach:function(e){for(var t,r=a(this),n=IJ(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!s(this,e)}}),RJ(o.prototype,r?{get:function(e){var t=s(this,e);return t&&t.value},set:function(e,t){return i(this,0===e?0:e,t)}}:{add:function(e){return i(this,e=0===e?0:e,e)}}),LJ&&_J(o.prototype,"size",{get:function(){return a(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=HJ(t),a=HJ(n);AJ(e,t,(function(e,t){PJ(this,{type:n,target:e,state:o(e),kind:t,last:void 0})}),(function(){for(var e=a(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),kJ(t)}};FM("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),DJ);var FJ=Math.log,jJ=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:FJ(1+e)},UJ=un,BJ=jJ,YJ=Math.acosh,VJ=Math.log,JJ=Math.sqrt,GJ=Math.LN2;UJ({target:"Math",stat:!0,forced:!YJ||710!=Math.floor(YJ(Number.MAX_VALUE))||YJ(1/0)!=1/0},{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?VJ(e)+GJ:BJ(e-1+JJ(e-1)*JJ(e+1))}});var KJ=un,qJ=Math.asinh,WJ=Math.log,XJ=Math.sqrt;KJ({target:"Math",stat:!0,forced:!(qJ&&1/qJ(0)>0)},{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):WJ(t+XJ(t*t+1)):t}});var QJ=un,zJ=Math.atanh,$J=Math.log;QJ({target:"Math",stat:!0,forced:!(zJ&&1/zJ(-0)<0)},{atanh:function(e){return 0==(e=+e)?e:$J((1+e)/(1-e))/2}});var ZJ=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1},eG=un,tG=ZJ,rG=Math.abs,nG=Math.pow;eG({target:"Math",stat:!0},{cbrt:function(e){return tG(e=+e)*nG(rG(e),1/3)}});var oG=un,aG=Math.floor,iG=Math.log,sG=Math.LOG2E;oG({target:"Math",stat:!0},{clz32:function(e){return(e>>>=0)?31-aG(iG(e+.5)*sG):32}});var cG=Math.expm1,lG=Math.exp,uG=!cG||cG(10)>22025.465794806718||cG(10)<22025.465794806718||-2e-17!=cG(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:lG(e)-1}:cG,dG=un,fG=uG,hG=Math.cosh,pG=Math.abs,vG=Math.E;dG({target:"Math",stat:!0,forced:!hG||hG(710)===1/0},{cosh:function(e){var t=fG(pG(e)-1)+1;return(t+1/(t*vG*vG))*(vG/2)}});var yG=uG;un({target:"Math",stat:!0,forced:yG!=Math.expm1},{expm1:yG});var mG=ZJ,gG=Math.abs,SG=Math.pow,bG=SG(2,-52),NG=SG(2,-23),TG=SG(2,127)*(2-NG),wG=SG(2,-126);un({target:"Math",stat:!0},{fround:Math.fround||function(e){var t,r,n=gG(e),o=mG(e);return n<wG?o*function(e){return e+1/bG-1/bG}(n/wG/NG)*wG*NG:(r=(t=(1+NG/bG)*n)-(t-n))>TG||r!=r?o*(1/0):o*r}});var EG=un,_G=Math.hypot,OG=Math.abs,RG=Math.sqrt;EG({target:"Math",stat:!0,forced:!!_G&&_G(1/0,NaN)!==1/0},{hypot:function(e,t){for(var r,n,o=0,a=0,i=arguments.length,s=0;a<i;)s<(r=OG(arguments[a++]))?(o=o*(n=s/r)*n+1,s=r):o+=r>0?(n=r/s)*n:r;return s===1/0?1/0:s*RG(o)}});var IG=un,xG=M,CG=Math.imul;IG({target:"Math",stat:!0,forced:xG((function(){return-5!=CG(4294967295,5)||2!=CG.length}))},{imul:function(e,t){var r=+e,n=+t,o=65535&r,a=65535&n;return 0|o*a+((65535&r>>>16)*a+o*(65535&n>>>16)<<16>>>0)}});var AG=un,kG=Math.log,LG=Math.LOG10E;AG({target:"Math",stat:!0},{log10:function(e){return kG(e)*LG}}),un({target:"Math",stat:!0},{log1p:jJ});var MG=un,PG=Math.log,HG=Math.LN2;MG({target:"Math",stat:!0},{log2:function(e){return PG(e)/HG}}),un({target:"Math",stat:!0},{sign:ZJ});var DG=un,FG=M,jG=uG,UG=Math.abs,BG=Math.exp,YG=Math.E;DG({target:"Math",stat:!0,forced:FG((function(){return-2e-17!=Math.sinh(-2e-17)}))},{sinh:function(e){return UG(e=+e)<1?(jG(e)-jG(-e))/2:(BG(e-1)-BG(-e-1))*(YG/2)}});var VG=un,JG=uG,GG=Math.exp;VG({target:"Math",stat:!0},{tanh:function(e){var t=JG(e=+e),r=JG(-e);return t==1/0?1:r==1/0?-1:(t-r)/(GG(e)+GG(-e))}}),Tn(Math,"Math",!0);var KG=un,qG=Math.ceil,WG=Math.floor;KG({target:"Math",stat:!0},{trunc:function(e){return(e>0?WG:qG)(e)}});var XG=1..valueOf,QG=function(e){return XG.call(e)},zG="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff",$G=f,ZG=yl,eK="[\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff]",tK=RegExp("^"+eK+eK+"*"),rK=RegExp(eK+eK+"*$"),nK=function(e){return function(t){var r=ZG($G(t));return 1&e&&(r=r.replace(tK,"")),2&e&&(r=r.replace(rK,"")),r}},oK={start:nK(1),end:nK(2),trim:nK(3)},aK=Z,iK=n,sK=tn,cK=z.exports,lK=m,uK=EM,dK=he,fK=Ie,hK=M,pK=dr.f,vK=Kt.f,yK=ee.f,mK=QG,gK=oK.trim,SK=iK.Number,bK=SK.prototype,NK=function(e){var t=fK(e,"number");return"bigint"==typeof t?t:TK(t)},TK=function(e){var t,r,n,o,a,i,s,c,l=fK(e,"number");if(dK(l))throw TypeError("Cannot convert a Symbol value to a number");if("string"==typeof l&&l.length>2)if(43===(t=(l=gK(l)).charCodeAt(0))||45===t){if(88===(r=l.charCodeAt(2))||120===r)return NaN}else if(48===t){switch(l.charCodeAt(1)){case 66:case 98:n=2,o=49;break;case 79:case 111:n=8,o=55;break;default:return+l}for(i=(a=l.slice(2)).length,s=0;s<i;s++)if((c=a.charCodeAt(s))<48||c>o)return NaN;return parseInt(a,n)}return+l};if(sK("Number",!SK(" 0o1")||!SK("0b1")||SK("+0x1"))){for(var wK,EK=function(e){var t=arguments.length<1?0:SK(NK(e)),r=this;return r instanceof EK&&hK((function(){mK(r)}))?uK(Object(t),r,EK):t},_K=aK?pK(SK):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),OK=0;_K.length>OK;OK++)lK(SK,wK=_K[OK])&&!lK(EK,wK)&&yK(EK,wK,vK(SK,wK));EK.prototype=bK,bK.constructor=EK,cK(iK,"Number",EK)}un({target:"Number",stat:!0},{EPSILON:Math.pow(2,-52)});var RK=n.isFinite;un({target:"Number",stat:!0},{isFinite:Number.isFinite||function(e){return"number"==typeof e&&RK(e)}});var IK=re,xK=Math.floor,CK=Number.isInteger||function(e){return!IK(e)&&isFinite(e)&&xK(e)===e};un({target:"Number",stat:!0},{isInteger:CK}),un({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});var AK=un,kK=CK,LK=Math.abs;AK({target:"Number",stat:!0},{isSafeInteger:function(e){return kK(e)&&LK(e)<=9007199254740991}}),un({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991}),un({target:"Number",stat:!0},{MIN_SAFE_INTEGER:-9007199254740991});var MK=n,PK=M,HK=yl,DK=oK.trim,FK=MK.parseFloat,jK=MK.Symbol,UK=jK&&jK.iterator,BK=1/FK("\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff-0")!=-1/0||UK&&!PK((function(){FK(Object(UK))}))?function(e){var t=DK(HK(e)),r=FK(t);return 0===r&&"-"==t.charAt(0)?-0:r}:FK,YK=BK;un({target:"Number",stat:!0,forced:Number.parseFloat!=YK},{parseFloat:YK});var VK=n,JK=M,GK=yl,KK=oK.trim,qK=VK.parseInt,WK=VK.Symbol,XK=WK&&WK.iterator,QK=/^[+-]?0x/i,zK=8!==qK("\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff08")||22!==qK("\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff0x16")||XK&&!JK((function(){qK(Object(XK))}))?function(e,t){var r=KK(GK(e));return qK(r,t>>>0||(QK.test(r)?16:10))}:qK,$K=zK;un({target:"Number",stat:!0,forced:Number.parseInt!=$K},{parseInt:$K});var ZK=un,eq=pr,tq=QG,rq=wV,nq=M,oq=1..toFixed,aq=Math.floor,iq=function(e,t,r){return 0===t?r:t%2==1?iq(e,t-1,r*e):iq(e*e,t/2,r)},sq=function(e,t,r){for(var n=-1,o=r;++n<6;)o+=t*e[n],e[n]=o%1e7,o=aq(o/1e7)},cq=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=aq(n/t),n=n%t*1e7},lq=function(e){for(var t=6,r="";--t>=0;)if(""!==r||0===t||0!==e[t]){var n=String(e[t]);r=""===r?n:r+rq.call("0",7-n.length)+n}return r};ZK({target:"Number",proto:!0,forced:oq&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!nq((function(){oq.call({})}))},{toFixed:function(e){var t,r,n,o,a=tq(this),i=eq(e),s=[0,0,0,0,0,0],c="",l="0";if(i<0||i>20)throw RangeError("Incorrect fraction digits");if(a!=a)return"NaN";if(a<=-1e21||a>=1e21)return String(a);if(a<0&&(c="-",a=-a),a>1e-21)if(r=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(a*iq(2,69,1))-69)<0?a*iq(2,-t,1):a/iq(2,t,1),r*=4503599627370496,(t=52-t)>0){for(sq(s,0,r),n=i;n>=7;)sq(s,1e7,0),n-=7;for(sq(s,iq(10,n,1),0),n=t-1;n>=23;)cq(s,1<<23),n-=23;cq(s,1<<n),sq(s,1,1),cq(s,2),l=lq(s)}else sq(s,0,r),sq(s,1<<-t,0),l=lq(s)+rq.call("0",i);return l=i>0?c+((o=l.length)<=i?"0."+rq.call("0",i-o)+l:l.slice(0,o-i)+"."+l.slice(o-i)):c+l}});var uq=M,dq=QG,fq=1..toPrecision;un({target:"Number",proto:!0,forced:uq((function(){return"1"!==fq.call(1,void 0)}))||!uq((function(){fq.call({})}))},{toPrecision:function(e){return void 0===e?fq.call(dq(this)):fq.call(dq(this),e)}});var hq=Z,pq=M,vq=zs,yq=Dr,mq=qt,gq=p,Sq=Zt,bq=Object.assign,Nq=Object.defineProperty,Tq=!bq||pq((function(){if(hq&&1!==bq({b:1},bq(Nq({},"a",{enumerable:!0,get:function(){Nq(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol();return e[r]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=bq({},e)[r]||"abcdefghijklmnopqrst"!=vq(bq({},t)).join("")}))?function(e,t){for(var r=gq(e),n=arguments.length,o=1,a=yq.f,i=mq.f;n>o;)for(var s,c=Sq(arguments[o++]),l=a?vq(c).concat(a(c)):vq(c),u=l.length,d=0;u>d;)s=l[d++],hq&&!i.call(c,s)||(r[s]=c[s]);return r}:bq,wq=Tq;un({target:"Object",stat:!0,forced:Object.assign!==wq},{assign:wq}),un({target:"Object",stat:!0,sham:!Z},{create:hc});var Eq=n,_q=GP,Oq=!M((function(){if(!(_q&&_q<535)){var e=Math.random();__defineSetter__.call(null,e,(function(){})),delete Eq[e]}})),Rq=me,Iq=p,xq=ee;Z&&un({target:"Object",proto:!0,forced:Oq},{__defineGetter__:function(e,t){xq.f(Iq(this),e,{get:Rq(t),enumerable:!0,configurable:!0})}});un({target:"Object",stat:!0,forced:!Z,sham:!Z},{defineProperties:tc});un({target:"Object",stat:!0,forced:!Z,sham:!Z},{defineProperty:ee.f});var Cq=me,Aq=p,kq=ee;Z&&un({target:"Object",proto:!0,forced:Oq},{__defineSetter__:function(e,t){kq.f(Aq(this),e,{set:Cq(t),enumerable:!0,configurable:!0})}});var Lq=Z,Mq=zs,Pq=rr,Hq=qt.f,Dq=function(e){return function(t){for(var r,n=Pq(t),o=Mq(n),a=o.length,i=0,s=[];a>i;)r=o[i++],Lq&&!Hq.call(n,r)||s.push(e?[r,n[r]]:n[r]);return s}},Fq={entries:Dq(!0),values:Dq(!1)},jq=Fq.entries;un({target:"Object",stat:!0},{entries:function(e){return jq(e)}});var Uq=un,Bq=iM,Yq=M,Vq=re,Jq=eM.exports.onFreeze,Gq=Object.freeze;Uq({target:"Object",stat:!0,forced:Yq((function(){Gq(1)})),sham:!Bq},{freeze:function(e){return Gq&&Vq(e)?Gq(Jq(e)):e}});var Kq=ro,qq=ws;un({target:"Object",stat:!0},{fromEntries:function(e){var t={};return Kq(e,(function(e,r){qq(t,e,r)}),{AS_ENTRIES:!0}),t}});var Wq=un,Xq=M,Qq=rr,zq=Kt.f,$q=Z,Zq=Xq((function(){zq(1)}));Wq({target:"Object",stat:!0,forced:!$q||Zq,sham:!$q},{getOwnPropertyDescriptor:function(e,t){return zq(Qq(e),t)}});var eW=Br,tW=rr,rW=Kt,nW=ws;un({target:"Object",stat:!0,sham:!Z},{getOwnPropertyDescriptors:function(e){for(var t,r,n=tW(e),o=rW.f,a=eW(n),i={},s=0;a.length>s;)void 0!==(r=o(n,t=a[s++]))&&nW(i,t,r);return i}});var oW=un,aW=M,iW=tM.f;oW({target:"Object",stat:!0,forced:aW((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:iW});var sW=p,cW=xc,lW=Tc;un({target:"Object",stat:!0,forced:M((function(){cW(1)})),sham:!lW},{getPrototypeOf:function(e){return cW(sW(e))}}),un({target:"Object",stat:!0},{hasOwn:m});var uW=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};un({target:"Object",stat:!0},{is:uW});var dW=un,fW=M,hW=re,pW=Object.isExtensible;dW({target:"Object",stat:!0,forced:fW((function(){pW(1)}))},{isExtensible:function(e){return!!hW(e)&&(!pW||pW(e))}});var vW=un,yW=M,mW=re,gW=Object.isFrozen;vW({target:"Object",stat:!0,forced:yW((function(){gW(1)}))},{isFrozen:function(e){return!mW(e)||!!gW&&gW(e)}});var SW=un,bW=M,NW=re,TW=Object.isSealed;SW({target:"Object",stat:!0,forced:bW((function(){TW(1)}))},{isSealed:function(e){return!NW(e)||!!TW&&TW(e)}});var wW=p,EW=zs;un({target:"Object",stat:!0,forced:M((function(){EW(1)}))},{keys:function(e){return EW(wW(e))}});var _W=un,OW=Z,RW=Oq,IW=p,xW=Ae,CW=xc,AW=Kt.f;OW&&_W({target:"Object",proto:!0,forced:RW},{__lookupGetter__:function(e){var t,r=IW(this),n=xW(e);do{if(t=AW(r,n))return t.get}while(r=CW(r))}});var kW=un,LW=Z,MW=Oq,PW=p,HW=Ae,DW=xc,FW=Kt.f;LW&&kW({target:"Object",proto:!0,forced:MW},{__lookupSetter__:function(e){var t,r=PW(this),n=HW(e);do{if(t=FW(r,n))return t.set}while(r=DW(r))}});var jW=un,UW=re,BW=eM.exports.onFreeze,YW=iM,VW=M,JW=Object.preventExtensions;jW({target:"Object",stat:!0,forced:VW((function(){JW(1)})),sham:!YW},{preventExtensions:function(e){return JW&&UW(e)?JW(BW(e)):e}});var GW=un,KW=re,qW=eM.exports.onFreeze,WW=iM,XW=M,QW=Object.seal;GW({target:"Object",stat:!0,forced:XW((function(){QW(1)})),sham:!WW},{seal:function(e){return QW&&KW(e)?QW(qW(e)):e}}),un({target:"Object",stat:!0},{setPrototypeOf:gn});var zW=Fq.values;un({target:"Object",stat:!0},{values:function(e){return zW(e)}});un({global:!0,forced:parseFloat!=BK},{parseFloat:BK});un({global:!0,forced:parseInt!=zK},{parseInt:zK});var $W=me,ZW=_a,eX=Da,tX=ro;un({target:"Promise",stat:!0},{allSettled:function(e){var t=this,r=ZW.f(t),n=r.resolve,o=r.reject,a=eX((function(){var r=$W(t.resolve),o=[],a=0,i=1;tX(e,(function(e){var s=a++,c=!1;o.push(void 0),i++,r.call(t,e).then((function(e){c||(c=!0,o[s]={status:"fulfilled",value:e},--i||n(o))}),(function(e){c||(c=!0,o[s]={status:"rejected",reason:e},--i||n(o))}))})),--i||n(o)}));return a.error&&o(a.value),r.promise}});var rX=me,nX=_,oX=_a,aX=Da,iX=ro;un({target:"Promise",stat:!0},{any:function(e){var t=this,r=oX.f(t),n=r.resolve,o=r.reject,a=aX((function(){var r=rX(t.resolve),a=[],i=0,s=1,c=!1;iX(e,(function(e){var l=i++,u=!1;a.push(void 0),s++,r.call(t,e).then((function(e){u||c||(c=!0,n(e))}),(function(e){u||c||(u=!0,a[l]=e,--s||o(new(nX("AggregateError"))(a,"No one promise resolved")))}))})),--s||o(new(nX("AggregateError"))(a,"No one promise resolved"))}));return a.error&&o(a.value),r.promise}});var sX=un,cX=me,lX=ue,uX=M,dX=_("Reflect","apply"),fX=Function.apply;sX({target:"Reflect",stat:!0,forced:!uX((function(){dX((function(){}))}))},{apply:function(e,t,r){return cX(e),lX(r),dX?dX(e,t,r):fX.call(e,t,r)}});var hX=un,pX=Oo,vX=ue,yX=re,mX=hc,gX=oJ,SX=M,bX=_("Reflect","construct"),NX=SX((function(){function e(){}return!(bX((function(){}),[],e)instanceof e)})),TX=!SX((function(){bX((function(){}))})),wX=NX||TX;hX({target:"Reflect",stat:!0,forced:wX,sham:wX},{construct:function(e,t){pX(e),vX(t);var r=arguments.length<3?e:pX(arguments[2]);if(TX&&!NX)return bX(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(gX.apply(e,n))}var o=r.prototype,a=mX(yX(o)?o:Object.prototype),i=Function.apply.call(e,a,t);return yX(i)?i:a}});var EX=Z,_X=ue,OX=Ae,RX=ee;un({target:"Reflect",stat:!0,forced:M((function(){Reflect.defineProperty(RX.f({},1,{value:1}),1,{value:2})})),sham:!EX},{defineProperty:function(e,t,r){_X(e);var n=OX(t);_X(r);try{return RX.f(e,n,r),!0}catch(e){return!1}}});var IX=un,xX=ue,CX=Kt.f;IX({target:"Reflect",stat:!0},{deleteProperty:function(e,t){var r=CX(xX(e),t);return!(r&&!r.configurable)&&delete e[t]}});var AX=m,kX=function(e){return void 0!==e&&(AX(e,"value")||AX(e,"writable"))},LX=re,MX=ue,PX=kX,HX=Kt,DX=xc;un({target:"Reflect",stat:!0},{get:function e(t,r){var n,o,a=arguments.length<3?t:arguments[2];return MX(t)===a?t[r]:(n=HX.f(t,r))?PX(n)?n.value:void 0===n.get?void 0:n.get.call(a):LX(o=DX(t))?e(o,r,a):void 0}});var FX=ue,jX=Kt;un({target:"Reflect",stat:!0,sham:!Z},{getOwnPropertyDescriptor:function(e,t){return jX.f(FX(e),t)}});var UX=ue,BX=xc;un({target:"Reflect",stat:!0,sham:!Tc},{getPrototypeOf:function(e){return BX(UX(e))}}),un({target:"Reflect",stat:!0},{has:function(e,t){return t in e}});var YX=un,VX=ue,JX=Object.isExtensible;YX({target:"Reflect",stat:!0},{isExtensible:function(e){return VX(e),!JX||JX(e)}}),un({target:"Reflect",stat:!0},{ownKeys:Br});var GX=_,KX=ue;un({target:"Reflect",stat:!0,sham:!iM},{preventExtensions:function(e){KX(e);try{var t=GX("Object","preventExtensions");return t&&t(e),!0}catch(e){return!1}}});var qX=ue,WX=re,XX=kX,QX=ee,zX=Kt,$X=xc,ZX=De;un({target:"Reflect",stat:!0,forced:M((function(){var e=function(){},t=QX.f(new e,"a",{configurable:!0});return!1!==Reflect.set(e.prototype,"a",1,t)}))},{set:function e(t,r,n){var o,a,i,s=arguments.length<4?t:arguments[3],c=zX.f(qX(t),r);if(!c){if(WX(a=$X(t)))return e(a,r,n,s);c=ZX(0)}if(XX(c)){if(!1===c.writable||!WX(s))return!1;if(o=zX.f(s,r)){if(o.get||o.set||!1===o.writable)return!1;o.value=n,QX.f(s,r,o)}else QX.f(s,r,ZX(0,n))}else{if(void 0===(i=c.set))return!1;i.call(s,n)}return!0}});var eQ=ue,tQ=vn,rQ=gn;rQ&&un({target:"Reflect",stat:!0},{setPrototypeOf:function(e,t){eQ(e),tQ(t);try{return rQ(e,t),!0}catch(e){return!1}}});var nQ=n,oQ=Tn;un({global:!0},{Reflect:{}}),oQ(nQ.Reflect,"Reflect",!0);var aQ=Z,iQ=n,sQ=tn,cQ=EM,lQ=Ue,uQ=ee.f,dQ=dr.f,fQ=Wl,hQ=yl,pQ=nu,vQ=ou,yQ=z.exports,mQ=M,gQ=m,SQ=yt.enforce,bQ=Rn,NQ=lu,TQ=fu,wQ=W("match"),EQ=iQ.RegExp,_Q=EQ.prototype,OQ=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,RQ=/a/g,IQ=/a/g,xQ=new EQ(RQ)!==RQ,CQ=vQ.UNSUPPORTED_Y,AQ=aQ&&(!xQ||CQ||NQ||TQ||mQ((function(){return IQ[wQ]=!1,EQ(RQ)!=RQ||EQ(IQ)==IQ||"/a/i"!=EQ(RQ,"i")})));if(sQ("RegExp",AQ)){for(var kQ=function(e,t){var r,n,o,a,i,s,c=this instanceof kQ,l=fQ(e),u=void 0===t,d=[],f=e;if(!c&&l&&u&&e.constructor===kQ)return e;if((l||e instanceof kQ)&&(e=e.source,u&&(t="flags"in f?f.flags:pQ.call(f))),e=void 0===e?"":hQ(e),t=void 0===t?"":hQ(t),f=e,NQ&&"dotAll"in RQ&&(n=!!t&&t.indexOf("s")>-1)&&(t=t.replace(/s/g,"")),r=t,CQ&&"sticky"in RQ&&(o=!!t&&t.indexOf("y")>-1)&&(t=t.replace(/y/g,"")),TQ&&(e=(a=function(e){for(var t,r=e.length,n=0,o="",a=[],i={},s=!1,c=!1,l=0,u="";n<=r;n++){if("\\"===(t=e.charAt(n)))t+=e.charAt(++n);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:OQ.test(e.slice(n+1))&&(n+=2,c=!0),o+=t,l++;continue;case">"===t&&c:if(""===u||gQ(i,u))throw new SyntaxError("Invalid capture group name");i[u]=!0,a.push([u,l]),c=!1,u="";continue}c?u+=t:o+=t}return[o,a]}(e))[0],d=a[1]),i=cQ(EQ(e,t),c?this:_Q,kQ),(n||o||d.length)&&(s=SQ(i),n&&(s.dotAll=!0,s.raw=kQ(function(e){for(var t,r=e.length,n=0,o="",a=!1;n<=r;n++)"\\"!==(t=e.charAt(n))?a||"."!==t?("["===t?a=!0:"]"===t&&(a=!1),o+=t):o+="[\\s\\S]":o+=t+e.charAt(++n);return o}(e),r)),o&&(s.sticky=!0),d.length&&(s.groups=d)),e!==f)try{lQ(i,"source",""===f?"(?:)":f)}catch(e){}return i},LQ=function(e){e in kQ||uQ(kQ,e,{configurable:!0,get:function(){return EQ[e]},set:function(t){EQ[e]=t}})},MQ=dQ(EQ),PQ=0;MQ.length>PQ;)LQ(MQ[PQ++]);_Q.constructor=kQ,kQ.prototype=_Q,yQ(iQ,"RegExp",kQ)}bQ("RegExp");var HQ=Z,DQ=lu,FQ=ee.f,jQ=yt.get,UQ=RegExp.prototype;HQ&&DQ&&FQ(UQ,"dotAll",{configurable:!0,get:function(){if(this!==UQ){if(this instanceof RegExp)return!!jQ(this).dotAll;throw TypeError("Incompatible receiver, RegExp required")}}});var BQ=ee,YQ=nu;Z&&M((function(){return"sy"!==Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get.call({dotAll:!0,sticky:!0})}))&&BQ.f(RegExp.prototype,"flags",{configurable:!0,get:YQ});var VQ=Z,JQ=ou.UNSUPPORTED_Y,GQ=ee.f,KQ=yt.get,qQ=RegExp.prototype;VQ&&JQ&&GQ(qQ,"sticky",{configurable:!0,get:function(){if(this!==qQ){if(this instanceof RegExp)return!!KQ(this).sticky;throw TypeError("Incompatible receiver, RegExp required")}}});var WQ=un,XQ=N,QQ=re,zQ=function(){var e=!1,t=/[ac]/;return t.exec=function(){return e=!0,/./.exec.apply(this,arguments)},!0===t.test("abc")&&e}(),$Q=/./.test;WQ({target:"RegExp",proto:!0,forced:!zQ},{test:function(e){var t=this.exec;if(!XQ(t))return $Q.call(this,e);var r=t.call(this,e);if(null!==r&&!QQ(r))throw new Error("RegExp exec method returned something other than an Object or null");return!!r}});var ZQ=Tt.PROPER,ez=z.exports,tz=ue,rz=yl,nz=M,oz=nu,az=RegExp.prototype,iz=az.toString,sz=nz((function(){return"/a/b"!=iz.call({source:"a",flags:"b"})})),cz=ZQ&&"toString"!=iz.name;(sz||cz)&&ez(RegExp.prototype,"toString",(function(){var e=tz(this),t=rz(e.source),r=e.flags;return"/"+t+"/"+rz(void 0===r&&e instanceof RegExp&&!("flags"in az)?oz.call(e):r)}),{unsafe:!0}),FM("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),DJ);var lz=f,uz=pr,dz=yl;un({target:"String",proto:!0,forced:M((function(){return"\ud842"!=="ð ®·".at(0)}))},{at:function(e){var t=dz(lz(this)),r=t.length,n=uz(e),o=n>=0?n:r+n;return o<0||o>=r?void 0:t.charAt(o)}});var fz=Nl.codeAt;un({target:"String",proto:!0},{codePointAt:function(e){return fz(this,e)}});var hz,pz=un,vz=Kt.f,yz=Nr,mz=yl,gz=Ql,Sz=f,bz=$l,Nz="".endsWith,Tz=Math.min,wz=bz("endsWith");pz({target:"String",proto:!0,forced:!!(wz||(hz=vz(String.prototype,"endsWith"),!hz||hz.writable))&&!wz},{endsWith:function(e){var t=mz(Sz(this));gz(e);var r=arguments.length>1?arguments[1]:void 0,n=t.length,o=void 0===r?n:Tz(yz(r),n),a=mz(e);return Nz?Nz.call(t,a,o):t.slice(o-a.length,o)===a}});var Ez=un,_z=gr,Oz=String.fromCharCode,Rz=String.fromCodePoint;Ez({target:"String",stat:!0,forced:!!Rz&&1!=Rz.length},{fromCodePoint:function(e){for(var t,r=[],n=arguments.length,o=0;n>o;){if(t=+arguments[o++],_z(t,1114111)!==t)throw RangeError(t+" is not a valid code point");r.push(t<65536?Oz(t):Oz(55296+((t-=65536)>>10),t%1024+56320))}return r.join("")}});var Iz=un,xz=Vc,Cz=f,Az=Nr,kz=yl,Lz=ue,Mz=Wl,Pz=nu,Hz=Se,Dz=z.exports,Fz=M,jz=Co,Uz=Du,Bz=Yu,Yz=yt,Vz=W("matchAll"),Jz=Yz.set,Gz=Yz.getterFor("RegExp String Iterator"),Kz=RegExp.prototype,qz="".matchAll,Wz=!!qz&&!Fz((function(){"a".matchAll(/./)})),Xz=xz((function(e,t,r,n){Jz(this,{type:"RegExp String Iterator",regexp:e,string:t,global:r,unicode:n,done:!1})}),"RegExp String",(function(){var e=Gz(this);if(e.done)return{value:void 0,done:!0};var t=e.regexp,r=e.string,n=Bz(t,r);return null===n?{value:void 0,done:e.done=!0}:e.global?(""===kz(n[0])&&(t.lastIndex=Uz(r,Az(t.lastIndex),e.unicode)),{value:n,done:!1}):(e.done=!0,{value:n,done:!1})})),Qz=function(e){var t,r,n,o,a,i,s=Lz(this),c=kz(e);return t=jz(s,RegExp),void 0===(r=s.flags)&&s instanceof RegExp&&!("flags"in Kz)&&(r=Pz.call(s)),n=void 0===r?"":kz(r),o=new t(t===RegExp?s.source:s,n),a=!!~n.indexOf("g"),i=!!~n.indexOf("u"),o.lastIndex=Az(s.lastIndex),new Xz(o,c,a,i)};Iz({target:"String",proto:!0,forced:Wz},{matchAll:function(e){var t,r,n=Cz(this);if(null!=e){if(Mz(e)&&!~kz(Cz("flags"in Kz?e.flags:Pz.call(e))).indexOf("g"))throw TypeError("`.matchAll` does not allow non-global regexes");if(Wz)return qz.apply(n,arguments);if(r=Hz(e,Vz))return r.call(e,n)}else if(Wz)return qz.apply(n,arguments);return t=kz(n),new RegExp(e,"g")[Vz](t)}}),Vz in Kz||Dz(Kz,Vz,Qz);var zz=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(O),$z=CV.end;un({target:"String",proto:!0,forced:zz},{padEnd:function(e){return $z(this,e,arguments.length>1?arguments[1]:void 0)}});var Zz=CV.start;un({target:"String",proto:!0,forced:zz},{padStart:function(e){return Zz(this,e,arguments.length>1?arguments[1]:void 0)}});var e$=un,t$=rr,r$=p,n$=yl,o$=wr,a$=Array.prototype,i$=a$.push,s$=a$.join;e$({target:"String",stat:!0},{raw:function(e){for(var t=t$(r$(e).raw),r=o$(t),n=arguments.length,o=[],a=0;r>a;){if(i$.call(o,n$(t[a++])),a===r)return s$.call(o,"");a<n&&i$.call(o,n$(arguments[a]))}}}),un({target:"String",proto:!0},{repeat:wV});var c$=un,l$=f,u$=N,d$=Wl,f$=yl,h$=Se,p$=nu,v$=NH,y$=W("replace"),m$=RegExp.prototype,g$=Math.max,S$=function(e,t,r){return r>e.length?-1:""===t?r:e.indexOf(t,r)};c$({target:"String",proto:!0},{replaceAll:function(e,t){var r,n,o,a,i,s,c,l=l$(this),u=0,d=0,f="";if(null!=e){if(d$(e)&&!~f$(l$("flags"in m$?e.flags:p$.call(e))).indexOf("g"))throw TypeError("`.replaceAll` does not allow non-global regexes");if(r=h$(e,y$))return r.call(e,l,t)}for(n=f$(l),o=f$(e),(a=u$(t))||(t=f$(t)),i=o.length,s=g$(1,i),u=S$(n,o,0);-1!==u;)c=a?f$(t(o,u,n)):v$(o,n,u,[],void 0,t),f+=n.slice(d,u)+c,d=u+i,u=S$(n,o,u+s);return d<n.length&&(f+=n.slice(d)),f}});var b$=ue,N$=f,T$=uW,w$=yl,E$=Se,_$=Yu;Pu("search",(function(e,t,r){return[function(t){var r=N$(this),n=null==t?void 0:E$(t,e);return n?n.call(t,r):new RegExp(t)[e](w$(r))},function(e){var n=b$(this),o=w$(e),a=r(t,n,o);if(a.done)return a.value;var i=n.lastIndex;T$(i,0)||(n.lastIndex=0);var s=_$(n,o);return T$(n.lastIndex,i)||(n.lastIndex=i),null===s?-1:s.index}]}));var O$=un,R$=Kt.f,I$=Nr,x$=yl,C$=Ql,A$=f,k$=$l,L$="".startsWith,M$=Math.min,P$=k$("startsWith");O$({target:"String",proto:!0,forced:!(!P$&&!!function(){var e=R$(String.prototype,"startsWith");return e&&!e.writable}())&&!P$},{startsWith:function(e){var t=x$(A$(this));C$(e);var r=I$(M$(arguments.length>1?arguments[1]:void 0,t.length)),n=x$(e);return L$?L$.call(t,n,r):t.slice(r,r+n.length)===n}});var H$=un,D$=f,F$=pr,j$=yl,U$="".slice,B$=Math.max,Y$=Math.min;H$({target:"String",proto:!0,forced:!"".substr||"b"!=="ab".substr(-1)},{substr:function(e,t){var r,n,o=j$(D$(this)),a=o.length,i=F$(e);return i===1/0&&(i=0),i<0&&(i=B$(a+i,0)),(r=void 0===t?a:F$(t))<=0||r===1/0||i>=(n=Y$(i+r,a))?"":U$.call(o,i,n)}});var V$=Tt.PROPER,J$=M,G$=zG,K$=function(e){return J$((function(){return!!G$[e]()||"âÂá "!=="âÂá "[e]()||V$&&G$[e].name!==e}))},q$=oK.trim;un({target:"String",proto:!0,forced:K$("trim")},{trim:function(){return q$(this)}});var W$=un,X$=oK.end,Q$=K$("trimEnd"),z$=Q$?function(){return X$(this)}:"".trimEnd;W$({target:"String",proto:!0,name:"trimEnd",forced:Q$},{trimEnd:z$,trimRight:z$});var $$=un,Z$=oK.start,eZ=K$("trimStart"),tZ=eZ?function(){return Z$(this)}:"".trimStart;$$({target:"String",proto:!0,name:"trimStart",forced:eZ},{trimStart:tZ,trimLeft:tZ});var rZ=f,nZ=yl,oZ=/"/g,aZ=function(e,t,r,n){var o=nZ(rZ(e)),a="<"+t;return""!==r&&(a+=" "+r+'="'+nZ(n).replace(oZ,"&quot;")+'"'),a+">"+o+"</"+t+">"},iZ=M,sZ=function(e){return iZ((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))},cZ=aZ;un({target:"String",proto:!0,forced:sZ("anchor")},{anchor:function(e){return cZ(this,"a","name",e)}});var lZ=aZ;un({target:"String",proto:!0,forced:sZ("big")},{big:function(){return lZ(this,"big","","")}});var uZ=aZ;un({target:"String",proto:!0,forced:sZ("blink")},{blink:function(){return uZ(this,"blink","","")}});var dZ=aZ;un({target:"String",proto:!0,forced:sZ("bold")},{bold:function(){return dZ(this,"b","","")}});var fZ=aZ;un({target:"String",proto:!0,forced:sZ("fixed")},{fixed:function(){return fZ(this,"tt","","")}});var hZ=aZ;un({target:"String",proto:!0,forced:sZ("fontcolor")},{fontcolor:function(e){return hZ(this,"font","color",e)}});var pZ=aZ;un({target:"String",proto:!0,forced:sZ("fontsize")},{fontsize:function(e){return pZ(this,"font","size",e)}});var vZ=aZ;un({target:"String",proto:!0,forced:sZ("italics")},{italics:function(){return vZ(this,"i","","")}});var yZ=aZ;un({target:"String",proto:!0,forced:sZ("link")},{link:function(e){return yZ(this,"a","href",e)}});var mZ=aZ;un({target:"String",proto:!0,forced:sZ("small")},{small:function(){return mZ(this,"small","","")}});var gZ=aZ;un({target:"String",proto:!0,forced:sZ("strike")},{strike:function(){return gZ(this,"strike","","")}});var SZ=aZ;un({target:"String",proto:!0,forced:sZ("sub")},{sub:function(){return SZ(this,"sub","","")}});var bZ=aZ;un({target:"String",proto:!0,forced:sZ("sup")},{sup:function(){return bZ(this,"sup","","")}});var NZ={exports:{}},TZ=n,wZ=M,EZ=fo,_Z=nV.NATIVE_ARRAY_BUFFER_VIEWS,OZ=TZ.ArrayBuffer,RZ=TZ.Int8Array,IZ=!_Z||!wZ((function(){RZ(1)}))||!wZ((function(){new RZ(-1)}))||!EZ((function(e){new RZ,new RZ(null),new RZ(1.5),new RZ(e)}),!0)||wZ((function(){return 1!==new RZ(new OZ(2),1,void 0).length})),xZ=pr,CZ=function(e){var t=xZ(e);if(t<0)throw RangeError("The argument can't be less than 0");return t},AZ=function(e,t){var r=CZ(e);if(r%t)throw RangeError("Wrong offset");return r},kZ=Oo,LZ=p,MZ=wr,PZ=Jn,HZ=Un,DZ=Ln,FZ=Pn,jZ=nV.aTypedArrayConstructor,UZ=function(e){var t,r,n,o,a,i,s=kZ(this),c=LZ(e),l=arguments.length,u=l>1?arguments[1]:void 0,d=void 0!==u,f=HZ(c);if(f&&!DZ(f))for(i=(a=PZ(c,f)).next,c=[];!(o=i.call(a)).done;)c.push(o.value);for(d&&l>2&&(u=FZ(u,arguments[2],2)),r=MZ(c),n=new(jZ(s))(r),t=0;r>t;t++)n[t]=d?u(c[t],t):c[t];return n},BZ=un,YZ=n,VZ=Z,JZ=IZ,GZ=nV,KZ=bY,qZ=In,WZ=De,XZ=Ue,QZ=CK,zZ=Nr,$Z=TB,ZZ=AZ,e0=Ae,t0=m,r0=Ut,n0=re,o0=he,a0=hc,i0=gn,s0=dr.f,c0=UZ,l0=KM.forEach,u0=Rn,d0=ee,f0=Kt,h0=EM,p0=yt.get,v0=yt.set,y0=d0.f,m0=f0.f,g0=Math.round,S0=YZ.RangeError,b0=KZ.ArrayBuffer,N0=KZ.DataView,T0=GZ.NATIVE_ARRAY_BUFFER_VIEWS,w0=GZ.TYPED_ARRAY_CONSTRUCTOR,E0=GZ.TYPED_ARRAY_TAG,_0=GZ.TypedArray,O0=GZ.TypedArrayPrototype,R0=GZ.aTypedArrayConstructor,I0=GZ.isTypedArray,x0=function(e,t){for(var r=0,n=t.length,o=new(R0(e))(n);n>r;)o[r]=t[r++];return o},C0=function(e,t){y0(e,t,{get:function(){return p0(this)[t]}})},A0=function(e){var t;return e instanceof b0||"ArrayBuffer"==(t=r0(e))||"SharedArrayBuffer"==t},k0=function(e,t){return I0(e)&&!o0(t)&&t in e&&QZ(+t)&&t>=0},L0=function(e,t){return t=e0(t),k0(e,t)?WZ(2,e[t]):m0(e,t)},M0=function(e,t,r){return t=e0(t),!(k0(e,t)&&n0(r)&&t0(r,"value"))||t0(r,"get")||t0(r,"set")||r.configurable||t0(r,"writable")&&!r.writable||t0(r,"enumerable")&&!r.enumerable?y0(e,t,r):(e[t]=r.value,e)};VZ?(T0||(f0.f=L0,d0.f=M0,C0(O0,"buffer"),C0(O0,"byteOffset"),C0(O0,"byteLength"),C0(O0,"length")),BZ({target:"Object",stat:!0,forced:!T0},{getOwnPropertyDescriptor:L0,defineProperty:M0}),NZ.exports=function(e,t,r){var n=e.match(/\d+$/)[0]/8,o=e+(r?"Clamped":"")+"Array",a="get"+e,i="set"+e,s=YZ[o],c=s,l=c&&c.prototype,u={},d=function(e,t){y0(e,t,{get:function(){return function(e,t){var r=p0(e);return r.view[a](t*n+r.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,o){var a=p0(e);r&&(o=(o=g0(o))<0?0:o>255?255:255&o),a.view[i](t*n+a.byteOffset,o,!0)}(this,t,e)},enumerable:!0})};T0?JZ&&(c=t((function(e,t,r,a){return qZ(e,c,o),h0(n0(t)?A0(t)?void 0!==a?new s(t,ZZ(r,n),a):void 0!==r?new s(t,ZZ(r,n)):new s(t):I0(t)?x0(c,t):c0.call(c,t):new s($Z(t)),e,c)})),i0&&i0(c,_0),l0(s0(s),(function(e){e in c||XZ(c,e,s[e])})),c.prototype=l):(c=t((function(e,t,r,a){qZ(e,c,o);var i,s,l,u=0,f=0;if(n0(t)){if(!A0(t))return I0(t)?x0(c,t):c0.call(c,t);i=t,f=ZZ(r,n);var h=t.byteLength;if(void 0===a){if(h%n)throw S0("Wrong length");if((s=h-f)<0)throw S0("Wrong length")}else if((s=zZ(a)*n)+f>h)throw S0("Wrong length");l=s/n}else l=$Z(t),i=new b0(s=l*n);for(v0(e,{buffer:i,byteOffset:f,byteLength:s,length:l,view:new N0(i)});u<l;)d(e,u++)})),i0&&i0(c,_0),l=c.prototype=a0(O0)),l.constructor!==c&&XZ(l,"constructor",c),XZ(l,w0,c),E0&&XZ(l,E0,o),u[o]=c,BZ({global:!0,forced:c!=s,sham:!T0},u),"BYTES_PER_ELEMENT"in c||XZ(c,"BYTES_PER_ELEMENT",n),"BYTES_PER_ELEMENT"in l||XZ(l,"BYTES_PER_ELEMENT",n),u0(o)}):NZ.exports=function(){},(0,NZ.exports)("Float32",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,NZ.exports)("Float64",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,NZ.exports)("Int8",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,NZ.exports)("Int16",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,NZ.exports)("Int32",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,NZ.exports)("Uint8",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,NZ.exports)("Uint8",(function(e){return function(t,r,n){return e(this,t,r,n)}}),!0),(0,NZ.exports)("Uint16",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,NZ.exports)("Uint32",(function(e){return function(t,r,n){return e(this,t,r,n)}}));var P0=wr,H0=pr,D0=nV.aTypedArray;(0,nV.exportTypedArrayMethod)("at",(function(e){var t=D0(this),r=P0(t),n=H0(e),o=n>=0?n:r+n;return o<0||o>=r?void 0:t[o]}));var F0=wj,j0=nV.aTypedArray;(0,nV.exportTypedArrayMethod)("copyWithin",(function(e,t){return F0.call(j0(this),e,t,arguments.length>2?arguments[2]:void 0)}));var U0=KM.every,B0=nV.aTypedArray;(0,nV.exportTypedArrayMethod)("every",(function(e){return U0(B0(this),e,arguments.length>1?arguments[1]:void 0)}));var Y0=xj,V0=nV.aTypedArray;(0,nV.exportTypedArrayMethod)("fill",(function(e){return Y0.apply(V0(this),arguments)}));var J0=Co,G0=nV.TYPED_ARRAY_CONSTRUCTOR,K0=nV.aTypedArrayConstructor,q0=function(e){return K0(J0(e,e[G0]))},W0=function(e,t){for(var r=0,n=t.length,o=new e(n);n>r;)o[r]=t[r++];return o},X0=q0,Q0=KM.filter,z0=function(e,t){return W0(X0(e),t)},$0=nV.aTypedArray;(0,nV.exportTypedArrayMethod)("filter",(function(e){var t=Q0($0(this),e,arguments.length>1?arguments[1]:void 0);return z0(this,t)}));var Z0=KM.find,e1=nV.aTypedArray;(0,nV.exportTypedArrayMethod)("find",(function(e){return Z0(e1(this),e,arguments.length>1?arguments[1]:void 0)}));var t1=KM.findIndex,r1=nV.aTypedArray;(0,nV.exportTypedArrayMethod)("findIndex",(function(e){return t1(r1(this),e,arguments.length>1?arguments[1]:void 0)}));var n1=KM.forEach,o1=nV.aTypedArray;(0,nV.exportTypedArrayMethod)("forEach",(function(e){n1(o1(this),e,arguments.length>1?arguments[1]:void 0)})),(0,nV.exportTypedArrayStaticMethod)("from",UZ,IZ);var a1=Ir.includes,i1=nV.aTypedArray;(0,nV.exportTypedArrayMethod)("includes",(function(e){return a1(i1(this),e,arguments.length>1?arguments[1]:void 0)}));var s1=Ir.indexOf,c1=nV.aTypedArray;(0,nV.exportTypedArrayMethod)("indexOf",(function(e){return s1(c1(this),e,arguments.length>1?arguments[1]:void 0)}));var l1=n,u1=Tt.PROPER,d1=nV,f1=pl,h1=W("iterator"),p1=l1.Uint8Array,v1=f1.values,y1=f1.keys,m1=f1.entries,g1=d1.aTypedArray,S1=d1.exportTypedArrayMethod,b1=p1&&p1.prototype[h1],N1=!!b1&&"values"===b1.name,T1=function(){return v1.call(g1(this))};S1("entries",(function(){return m1.call(g1(this))})),S1("keys",(function(){return y1.call(g1(this))})),S1("values",T1,u1&&!N1),S1(h1,T1,u1&&!N1);var w1=nV.aTypedArray,E1=[].join;(0,nV.exportTypedArrayMethod)("join",(function(e){return E1.apply(w1(this),arguments)}));var _1=CU,O1=nV.aTypedArray;(0,nV.exportTypedArrayMethod)("lastIndexOf",(function(e){return _1.apply(O1(this),arguments)}));var R1=KM.map,I1=q0,x1=nV.aTypedArray;(0,nV.exportTypedArrayMethod)("map",(function(e){return R1(x1(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(I1(e))(t)}))}));var C1=nV.aTypedArrayConstructor;(0,nV.exportTypedArrayStaticMethod)("of",(function(){for(var e=0,t=arguments.length,r=new(C1(this))(t);t>e;)r[e]=arguments[e++];return r}),IZ);var A1=jU.left,k1=nV.aTypedArray;(0,nV.exportTypedArrayMethod)("reduce",(function(e){return A1(k1(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}));var L1=jU.right,M1=nV.aTypedArray;(0,nV.exportTypedArrayMethod)("reduceRight",(function(e){return L1(M1(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}));var P1=nV.aTypedArray,H1=nV.exportTypedArrayMethod,D1=Math.floor;H1("reverse",(function(){for(var e,t=P1(this).length,r=D1(t/2),n=0;n<r;)e=this[n],this[n++]=this[--t],this[t]=e;return this}));var F1=wr,j1=AZ,U1=p,B1=nV.aTypedArray;(0,nV.exportTypedArrayMethod)("set",(function(e){B1(this);var t=j1(arguments.length>1?arguments[1]:void 0,1),r=this.length,n=U1(e),o=F1(n),a=0;if(o+t>r)throw RangeError("Wrong length");for(;a<o;)this[t+a]=n[a++]}),M((function(){new Int8Array(1).set({})})));var Y1=q0,V1=nV.aTypedArray,J1=[].slice;(0,nV.exportTypedArrayMethod)("slice",(function(e,t){for(var r=J1.call(V1(this),e,t),n=Y1(this),o=0,a=r.length,i=new n(a);a>o;)i[o]=r[o++];return i}),M((function(){new Int8Array(1).slice()})));var G1=KM.some,K1=nV.aTypedArray;(0,nV.exportTypedArrayMethod)("some",(function(e){return G1(K1(this),e,arguments.length>1?arguments[1]:void 0)}));var q1=M,W1=me,X1=wr,Q1=UP,z1=YP,$1=VP,Z1=L,e2=GP,t2=nV.aTypedArray,r2=nV.exportTypedArrayMethod,n2=n.Uint16Array,o2=n2&&n2.prototype.sort,a2=!!o2&&!q1((function(){var e=new n2(2);e.sort(null),e.sort({})})),i2=!!o2&&!q1((function(){if(Z1)return Z1<74;if(z1)return z1<67;if($1)return!0;if(e2)return e2<602;var e,t,r=new n2(516),n=Array(516);for(e=0;e<516;e++)t=e%4,r[e]=515-e,n[e]=e-2*t+3;for(r.sort((function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(r[e]!==n[e])return!0}));r2("sort",(function(e){if(void 0!==e&&W1(e),i2)return o2.call(this,e);t2(this);var t,r=X1(this),n=Array(r);for(t=0;t<r;t++)n[t]=this[t];for(n=Q1(this,function(e){return function(t,r){return void 0!==e?+e(t,r)||0:r!=r?-1:t!=t?1:0===t&&0===r?1/t>0&&1/r<0?1:-1:t>r}}(e)),t=0;t<r;t++)this[t]=n[t];return this}),!i2||a2);var s2=Nr,c2=gr,l2=q0,u2=nV.aTypedArray;(0,nV.exportTypedArrayMethod)("subarray",(function(e,t){var r=u2(this),n=r.length,o=c2(e,n);return new(l2(r))(r.buffer,r.byteOffset+o*r.BYTES_PER_ELEMENT,s2((void 0===t?n:c2(t,n))-o))}));var d2=nV,f2=M,h2=n.Int8Array,p2=d2.aTypedArray,v2=d2.exportTypedArrayMethod,y2=[].toLocaleString,m2=[].slice,g2=!!h2&&f2((function(){y2.call(new h2(1))}));v2("toLocaleString",(function(){return y2.apply(g2?m2.call(p2(this)):p2(this),arguments)}),f2((function(){return[1,2].toLocaleString()!=new h2([1,2]).toLocaleString()}))||!f2((function(){h2.prototype.toLocaleString.call([1,2])})));var S2=nV.exportTypedArrayMethod,b2=M,N2=n.Uint8Array,T2=N2&&N2.prototype||{},w2=[].toString,E2=[].join;b2((function(){w2.call({})}))&&(w2=function(){return E2.call(this)});var _2=T2.toString!=w2;S2("toString",w2,_2);var O2=un,R2=yl,I2=String.fromCharCode,x2=/^[\da-f]{2}$/i,C2=/^[\da-f]{4}$/i;O2({global:!0},{unescape:function(e){for(var t,r,n=R2(e),o="",a=n.length,i=0;i<a;){if("%"===(t=n.charAt(i++)))if("u"===n.charAt(i)){if(r=n.slice(i+1,i+5),C2.test(r)){o+=I2(parseInt(r,16)),i+=5;continue}}else if(r=n.slice(i,i+2),x2.test(r)){o+=I2(parseInt(r,16)),i+=2;continue}o+=t}return o}});var A2=n,k2=Il,L2=Al,M2=rU,P2=Ue,H2=function(e){if(e&&e.forEach!==M2)try{P2(e,"forEach",M2)}catch(t){e.forEach=M2}};for(var D2 in k2)k2[D2]&&H2(A2[D2]&&A2[D2].prototype);H2(L2);var F2=n,j2=sa;un({global:!0,bind:!0,enumerable:!0,forced:!F2.setImmediate||!F2.clearImmediate},{setImmediate:j2.set,clearImmediate:j2.clear});var U2=un,B2=Ea,Y2=Lo,V2=n.process;U2({global:!0,enumerable:!0,noTargetGet:!0},{queueMicrotask:function(e){var t=Y2&&V2.domain;B2(t?t.bind(e):e)}});var J2=n,G2=N,K2=[].slice,q2=function(e){return function(t,r){var n=arguments.length>2,o=n?K2.call(arguments,2):void 0;return e(n?function(){(G2(t)?t:Function(t)).apply(this,o)}:t,r)}};un({global:!0,bind:!0,forced:/MSIE .\./.test(O)},{setTimeout:q2(J2.setTimeout),setInterval:q2(J2.setInterval)});var W2=M,X2=W("iterator"),Q2=!W2((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach((function(e,n){t.delete("b"),r+=n+e})),!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[X2]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://ÑÐµÑÑ").host||"#%D0%B1"!==new URL("http://a#Ð±").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host})),z2=/[^\0-\u007E]/,$2=/[.\u3002\uFF0E\uFF61]/g,Z2="Overflow: input needs wider integers to process",e3=Math.floor,t3=String.fromCharCode,r3=function(e){return e+22+75*(e<26)},n3=function(e,t,r){var n=0;for(e=r?e3(e/700):e>>1,e+=e3(e/t);e>455;n+=36)e=e3(e/35);return e3(n+36*e/(e+38))},o3=function(e){var t,r,n=[],o=(e=function(e){for(var t=[],r=0,n=e.length;r<n;){var o=e.charCodeAt(r++);if(o>=55296&&o<=56319&&r<n){var a=e.charCodeAt(r++);56320==(64512&a)?t.push(((1023&o)<<10)+(1023&a)+65536):(t.push(o),r--)}else t.push(o)}return t}(e)).length,a=128,i=0,s=72;for(t=0;t<e.length;t++)(r=e[t])<128&&n.push(t3(r));var c=n.length,l=c;for(c&&n.push("-");l<o;){var u=2147483647;for(t=0;t<e.length;t++)(r=e[t])>=a&&r<u&&(u=r);var d=l+1;if(u-a>e3((2147483647-i)/d))throw RangeError(Z2);for(i+=(u-a)*d,a=u,t=0;t<e.length;t++){if((r=e[t])<a&&++i>2147483647)throw RangeError(Z2);if(r==a){for(var f=i,h=36;;h+=36){var p=h<=s?1:h>=s+26?26:h-s;if(f<p)break;var v=f-p,y=36-p;n.push(t3(r3(p+v%y))),f=e3(v/y)}n.push(t3(r3(f))),s=n3(i,d,l==c),i=0,++l}}++i,++a}return n.join("")},a3=un,i3=_,s3=Q2,c3=z.exports,l3=hn,u3=Tn,d3=Vc,f3=yt,h3=In,p3=N,v3=m,y3=Pn,m3=Ut,g3=ue,S3=re,b3=yl,N3=hc,T3=De,w3=Jn,E3=Un,_3=W,O3=i3("fetch"),R3=i3("Request"),I3=R3&&R3.prototype,x3=i3("Headers"),C3=_3("iterator"),A3=f3.set,k3=f3.getterFor("URLSearchParams"),L3=f3.getterFor("URLSearchParamsIterator"),M3=/\+/g,P3=Array(4),H3=function(e){return P3[e-1]||(P3[e-1]=RegExp("((?:%[\\da-f]{2}){"+e+"})","gi"))},D3=function(e){try{return decodeURIComponent(e)}catch(t){return e}},F3=function(e){var t=e.replace(M3," "),r=4;try{return decodeURIComponent(t)}catch(e){for(;r;)t=t.replace(H3(r--),D3);return t}},j3=/[!'()~]|%20/g,U3={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},B3=function(e){return U3[e]},Y3=function(e){return encodeURIComponent(e).replace(j3,B3)},V3=function(e,t){if(t)for(var r,n,o=t.split("&"),a=0;a<o.length;)(r=o[a++]).length&&(n=r.split("="),e.push({key:F3(n.shift()),value:F3(n.join("="))}))},J3=function(e){this.entries.length=0,V3(this.entries,e)},G3=function(e,t){if(e<t)throw TypeError("Not enough arguments")},K3=d3((function(e,t){A3(this,{type:"URLSearchParamsIterator",iterator:w3(k3(e).entries),kind:t})}),"Iterator",(function(){var e=L3(this),t=e.kind,r=e.iterator.next(),n=r.value;return r.done||(r.value="keys"===t?n.key:"values"===t?n.value:[n.key,n.value]),r})),q3=function(){h3(this,q3,"URLSearchParams");var e,t,r,n,o,a,i,s,c,l=arguments.length>0?arguments[0]:void 0,u=this,d=[];if(A3(u,{type:"URLSearchParams",entries:d,updateURL:function(){},updateSearchParams:J3}),void 0!==l)if(S3(l))if(e=E3(l))for(r=(t=w3(l,e)).next;!(n=r.call(t)).done;){if((i=(a=(o=w3(g3(n.value))).next).call(o)).done||(s=a.call(o)).done||!a.call(o).done)throw TypeError("Expected sequence with length 2");d.push({key:b3(i.value),value:b3(s.value)})}else for(c in l)v3(l,c)&&d.push({key:c,value:b3(l[c])});else V3(d,"string"==typeof l?"?"===l.charAt(0)?l.slice(1):l:b3(l))},W3=q3.prototype;if(l3(W3,{append:function(e,t){G3(arguments.length,2);var r=k3(this);r.entries.push({key:b3(e),value:b3(t)}),r.updateURL()},delete:function(e){G3(arguments.length,1);for(var t=k3(this),r=t.entries,n=b3(e),o=0;o<r.length;)r[o].key===n?r.splice(o,1):o++;t.updateURL()},get:function(e){G3(arguments.length,1);for(var t=k3(this).entries,r=b3(e),n=0;n<t.length;n++)if(t[n].key===r)return t[n].value;return null},getAll:function(e){G3(arguments.length,1);for(var t=k3(this).entries,r=b3(e),n=[],o=0;o<t.length;o++)t[o].key===r&&n.push(t[o].value);return n},has:function(e){G3(arguments.length,1);for(var t=k3(this).entries,r=b3(e),n=0;n<t.length;)if(t[n++].key===r)return!0;return!1},set:function(e,t){G3(arguments.length,1);for(var r,n=k3(this),o=n.entries,a=!1,i=b3(e),s=b3(t),c=0;c<o.length;c++)(r=o[c]).key===i&&(a?o.splice(c--,1):(a=!0,r.value=s));a||o.push({key:i,value:s}),n.updateURL()},sort:function(){var e,t,r,n=k3(this),o=n.entries,a=o.slice();for(o.length=0,r=0;r<a.length;r++){for(e=a[r],t=0;t<r;t++)if(o[t].key>e.key){o.splice(t,0,e);break}t===r&&o.push(e)}n.updateURL()},forEach:function(e){for(var t,r=k3(this).entries,n=y3(e,arguments.length>1?arguments[1]:void 0,3),o=0;o<r.length;)n((t=r[o++]).value,t.key,this)},keys:function(){return new K3(this,"keys")},values:function(){return new K3(this,"values")},entries:function(){return new K3(this,"entries")}},{enumerable:!0}),c3(W3,C3,W3.entries,{name:"entries"}),c3(W3,"toString",(function(){for(var e,t=k3(this).entries,r=[],n=0;n<t.length;)e=t[n++],r.push(Y3(e.key)+"="+Y3(e.value));return r.join("&")}),{enumerable:!0}),u3(q3,"URLSearchParams"),a3({global:!0,forced:!s3},{URLSearchParams:q3}),!s3&&p3(x3)){var X3=function(e){if(S3(e)){var t,r=e.body;if("URLSearchParams"===m3(r))return(t=e.headers?new x3(e.headers):new x3).has("content-type")||t.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),N3(e,{body:T3(0,String(r)),headers:T3(0,t)})}return e};if(p3(O3)&&a3({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return O3(e,arguments.length>1?X3(arguments[1]):{})}}),p3(R3)){var Q3=function(e){return h3(this,Q3,"Request"),new R3(e,arguments.length>1?X3(arguments[1]):{})};I3.constructor=Q3,Q3.prototype=I3,a3({global:!0,forced:!0},{Request:Q3})}}var z3,$3={URLSearchParams:q3,getState:k3},Z3=un,e5=Z,t5=Q2,r5=n,n5=tc,o5=z.exports,a5=In,i5=m,s5=Tq,c5=pU,l5=Nl.codeAt,u5=function(e){var t,r,n=[],o=e.toLowerCase().replace($2,".").split(".");for(t=0;t<o.length;t++)r=o[t],n.push(z2.test(r)?"xn--"+o3(r):r);return n.join(".")},d5=yl,f5=Tn,h5=$3,p5=yt,v5=r5.URL,y5=h5.URLSearchParams,m5=h5.getState,g5=p5.set,S5=p5.getterFor("URL"),b5=Math.floor,N5=Math.pow,T5=/[a-z]/i,w5=/[\d+-.a-z]/i,E5=/\d/,_5=/^0x/i,O5=/^[0-7]+$/,R5=/^\d+$/,I5=/^[\da-f]+$/i,x5=/[\0\t\n\r #%/:<>?@[\\\]^|]/,C5=/[\0\t\n\r #/:<>?@[\\\]^|]/,A5=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,k5=/[\t\n\r]/g,L5=function(e,t){var r,n,o;if("["==t.charAt(0)){if("]"!=t.charAt(t.length-1))return"Invalid host";if(!(r=P5(t.slice(1,-1))))return"Invalid host";e.host=r}else if(V5(e)){if(t=u5(t),x5.test(t))return"Invalid host";if(null===(r=M5(t)))return"Invalid host";e.host=r}else{if(C5.test(t))return"Invalid host";for(r="",n=c5(t),o=0;o<n.length;o++)r+=B5(n[o],D5);e.host=r}},M5=function(e){var t,r,n,o,a,i,s,c=e.split(".");if(c.length&&""==c[c.length-1]&&c.pop(),(t=c.length)>4)return e;for(r=[],n=0;n<t;n++){if(""==(o=c[n]))return e;if(a=10,o.length>1&&"0"==o.charAt(0)&&(a=_5.test(o)?16:8,o=o.slice(8==a?1:2)),""===o)i=0;else{if(!(10==a?R5:8==a?O5:I5).test(o))return e;i=parseInt(o,a)}r.push(i)}for(n=0;n<t;n++)if(i=r[n],n==t-1){if(i>=N5(256,5-t))return null}else if(i>255)return null;for(s=r.pop(),n=0;n<r.length;n++)s+=r[n]*N5(256,3-n);return s},P5=function(e){var t,r,n,o,a,i,s,c=[0,0,0,0,0,0,0,0],l=0,u=null,d=0,f=function(){return e.charAt(d)};if(":"==f()){if(":"!=e.charAt(1))return;d+=2,u=++l}for(;f();){if(8==l)return;if(":"!=f()){for(t=r=0;r<4&&I5.test(f());)t=16*t+parseInt(f(),16),d++,r++;if("."==f()){if(0==r)return;if(d-=r,l>6)return;for(n=0;f();){if(o=null,n>0){if(!("."==f()&&n<4))return;d++}if(!E5.test(f()))return;for(;E5.test(f());){if(a=parseInt(f(),10),null===o)o=a;else{if(0==o)return;o=10*o+a}if(o>255)return;d++}c[l]=256*c[l]+o,2!=++n&&4!=n||l++}if(4!=n)return;break}if(":"==f()){if(d++,!f())return}else if(f())return;c[l++]=t}else{if(null!==u)return;d++,u=++l}}if(null!==u)for(i=l-u,l=7;0!=l&&i>0;)s=c[l],c[l--]=c[u+i-1],c[u+--i]=s;else if(8!=l)return;return c},H5=function(e){var t,r,n,o;if("number"==typeof e){for(t=[],r=0;r<4;r++)t.unshift(e%256),e=b5(e/256);return t.join(".")}if("object"==typeof e){for(t="",n=function(e){for(var t=null,r=1,n=null,o=0,a=0;a<8;a++)0!==e[a]?(o>r&&(t=n,r=o),n=null,o=0):(null===n&&(n=a),++o);return o>r&&(t=n,r=o),t}(e),r=0;r<8;r++)o&&0===e[r]||(o&&(o=!1),n===r?(t+=r?":":"::",o=!0):(t+=e[r].toString(16),r<7&&(t+=":")));return"["+t+"]"}return e},D5={},F5=s5({},D5,{" ":1,'"':1,"<":1,">":1,"`":1}),j5=s5({},F5,{"#":1,"?":1,"{":1,"}":1}),U5=s5({},j5,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),B5=function(e,t){var r=l5(e,0);return r>32&&r<127&&!i5(t,e)?e:encodeURIComponent(e)},Y5={ftp:21,file:null,http:80,https:443,ws:80,wss:443},V5=function(e){return i5(Y5,e.scheme)},J5=function(e){return""!=e.username||""!=e.password},G5=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},K5=function(e,t){var r;return 2==e.length&&T5.test(e.charAt(0))&&(":"==(r=e.charAt(1))||!t&&"|"==r)},q5=function(e){var t;return e.length>1&&K5(e.slice(0,2))&&(2==e.length||"/"===(t=e.charAt(2))||"\\"===t||"?"===t||"#"===t)},W5=function(e){var t=e.path,r=t.length;!r||"file"==e.scheme&&1==r&&K5(t[0],!0)||t.pop()},X5=function(e){return"."===e||"%2e"===e.toLowerCase()},Q5={},z5={},$5={},Z5={},e4={},t4={},r4={},n4={},o4={},a4={},i4={},s4={},c4={},l4={},u4={},d4={},f4={},h4={},p4={},v4={},y4={},m4=function(e,t,r,n){var o,a,i,s,c,l=r||Q5,u=0,d="",f=!1,h=!1,p=!1;for(r||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=t.replace(A5,"")),t=t.replace(k5,""),o=c5(t);u<=o.length;){switch(a=o[u],l){case Q5:if(!a||!T5.test(a)){if(r)return"Invalid scheme";l=$5;continue}d+=a.toLowerCase(),l=z5;break;case z5:if(a&&(w5.test(a)||"+"==a||"-"==a||"."==a))d+=a.toLowerCase();else{if(":"!=a){if(r)return"Invalid scheme";d="",l=$5,u=0;continue}if(r&&(V5(e)!=i5(Y5,d)||"file"==d&&(J5(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=d,r)return void(V5(e)&&Y5[e.scheme]==e.port&&(e.port=null));d="","file"==e.scheme?l=l4:V5(e)&&n&&n.scheme==e.scheme?l=Z5:V5(e)?l=n4:"/"==o[u+1]?(l=e4,u++):(e.cannotBeABaseURL=!0,e.path.push(""),l=p4)}break;case $5:if(!n||n.cannotBeABaseURL&&"#"!=a)return"Invalid scheme";if(n.cannotBeABaseURL&&"#"==a){e.scheme=n.scheme,e.path=n.path.slice(),e.query=n.query,e.fragment="",e.cannotBeABaseURL=!0,l=y4;break}l="file"==n.scheme?l4:t4;continue;case Z5:if("/"!=a||"/"!=o[u+1]){l=t4;continue}l=o4,u++;break;case e4:if("/"==a){l=a4;break}l=h4;continue;case t4:if(e.scheme=n.scheme,a==z3)e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query=n.query;else if("/"==a||"\\"==a&&V5(e))l=r4;else if("?"==a)e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query="",l=v4;else{if("#"!=a){e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.path.pop(),l=h4;continue}e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query=n.query,e.fragment="",l=y4}break;case r4:if(!V5(e)||"/"!=a&&"\\"!=a){if("/"!=a){e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,l=h4;continue}l=a4}else l=o4;break;case n4:if(l=o4,"/"!=a||"/"!=d.charAt(u+1))continue;u++;break;case o4:if("/"!=a&&"\\"!=a){l=a4;continue}break;case a4:if("@"==a){f&&(d="%40"+d),f=!0,i=c5(d);for(var v=0;v<i.length;v++){var y=i[v];if(":"!=y||p){var m=B5(y,U5);p?e.password+=m:e.username+=m}else p=!0}d=""}else if(a==z3||"/"==a||"?"==a||"#"==a||"\\"==a&&V5(e)){if(f&&""==d)return"Invalid authority";u-=c5(d).length+1,d="",l=i4}else d+=a;break;case i4:case s4:if(r&&"file"==e.scheme){l=d4;continue}if(":"!=a||h){if(a==z3||"/"==a||"?"==a||"#"==a||"\\"==a&&V5(e)){if(V5(e)&&""==d)return"Invalid host";if(r&&""==d&&(J5(e)||null!==e.port))return;if(s=L5(e,d))return s;if(d="",l=f4,r)return;continue}"["==a?h=!0:"]"==a&&(h=!1),d+=a}else{if(""==d)return"Invalid host";if(s=L5(e,d))return s;if(d="",l=c4,r==s4)return}break;case c4:if(!E5.test(a)){if(a==z3||"/"==a||"?"==a||"#"==a||"\\"==a&&V5(e)||r){if(""!=d){var g=parseInt(d,10);if(g>65535)return"Invalid port";e.port=V5(e)&&g===Y5[e.scheme]?null:g,d=""}if(r)return;l=f4;continue}return"Invalid port"}d+=a;break;case l4:if(e.scheme="file","/"==a||"\\"==a)l=u4;else{if(!n||"file"!=n.scheme){l=h4;continue}if(a==z3)e.host=n.host,e.path=n.path.slice(),e.query=n.query;else if("?"==a)e.host=n.host,e.path=n.path.slice(),e.query="",l=v4;else{if("#"!=a){q5(o.slice(u).join(""))||(e.host=n.host,e.path=n.path.slice(),W5(e)),l=h4;continue}e.host=n.host,e.path=n.path.slice(),e.query=n.query,e.fragment="",l=y4}}break;case u4:if("/"==a||"\\"==a){l=d4;break}n&&"file"==n.scheme&&!q5(o.slice(u).join(""))&&(K5(n.path[0],!0)?e.path.push(n.path[0]):e.host=n.host),l=h4;continue;case d4:if(a==z3||"/"==a||"\\"==a||"?"==a||"#"==a){if(!r&&K5(d))l=h4;else if(""==d){if(e.host="",r)return;l=f4}else{if(s=L5(e,d))return s;if("localhost"==e.host&&(e.host=""),r)return;d="",l=f4}continue}d+=a;break;case f4:if(V5(e)){if(l=h4,"/"!=a&&"\\"!=a)continue}else if(r||"?"!=a)if(r||"#"!=a){if(a!=z3&&(l=h4,"/"!=a))continue}else e.fragment="",l=y4;else e.query="",l=v4;break;case h4:if(a==z3||"/"==a||"\\"==a&&V5(e)||!r&&("?"==a||"#"==a)){if(".."===(c=(c=d).toLowerCase())||"%2e."===c||".%2e"===c||"%2e%2e"===c?(W5(e),"/"==a||"\\"==a&&V5(e)||e.path.push("")):X5(d)?"/"==a||"\\"==a&&V5(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&K5(d)&&(e.host&&(e.host=""),d=d.charAt(0)+":"),e.path.push(d)),d="","file"==e.scheme&&(a==z3||"?"==a||"#"==a))for(;e.path.length>1&&""===e.path[0];)e.path.shift();"?"==a?(e.query="",l=v4):"#"==a&&(e.fragment="",l=y4)}else d+=B5(a,j5);break;case p4:"?"==a?(e.query="",l=v4):"#"==a?(e.fragment="",l=y4):a!=z3&&(e.path[0]+=B5(a,D5));break;case v4:r||"#"!=a?a!=z3&&("'"==a&&V5(e)?e.query+="%27":e.query+="#"==a?"%23":B5(a,D5)):(e.fragment="",l=y4);break;case y4:a!=z3&&(e.fragment+=B5(a,F5))}u++}},g4=function(e){var t,r,n=a5(this,g4,"URL"),o=arguments.length>1?arguments[1]:void 0,a=d5(e),i=g5(n,{type:"URL"});if(void 0!==o)if(o instanceof g4)t=S5(o);else if(r=m4(t={},d5(o)))throw TypeError(r);if(r=m4(i,a,null,t))throw TypeError(r);var s=i.searchParams=new y5,c=m5(s);c.updateSearchParams(i.query),c.updateURL=function(){i.query=String(s)||null},e5||(n.href=b4.call(n),n.origin=N4.call(n),n.protocol=T4.call(n),n.username=w4.call(n),n.password=E4.call(n),n.host=_4.call(n),n.hostname=O4.call(n),n.port=R4.call(n),n.pathname=I4.call(n),n.search=x4.call(n),n.searchParams=C4.call(n),n.hash=A4.call(n))},S4=g4.prototype,b4=function(){var e=S5(this),t=e.scheme,r=e.username,n=e.password,o=e.host,a=e.port,i=e.path,s=e.query,c=e.fragment,l=t+":";return null!==o?(l+="//",J5(e)&&(l+=r+(n?":"+n:"")+"@"),l+=H5(o),null!==a&&(l+=":"+a)):"file"==t&&(l+="//"),l+=e.cannotBeABaseURL?i[0]:i.length?"/"+i.join("/"):"",null!==s&&(l+="?"+s),null!==c&&(l+="#"+c),l},N4=function(){var e=S5(this),t=e.scheme,r=e.port;if("blob"==t)try{return new g4(t.path[0]).origin}catch(e){return"null"}return"file"!=t&&V5(e)?t+"://"+H5(e.host)+(null!==r?":"+r:""):"null"},T4=function(){return S5(this).scheme+":"},w4=function(){return S5(this).username},E4=function(){return S5(this).password},_4=function(){var e=S5(this),t=e.host,r=e.port;return null===t?"":null===r?H5(t):H5(t)+":"+r},O4=function(){var e=S5(this).host;return null===e?"":H5(e)},R4=function(){var e=S5(this).port;return null===e?"":String(e)},I4=function(){var e=S5(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+t.join("/"):""},x4=function(){var e=S5(this).query;return e?"?"+e:""},C4=function(){return S5(this).searchParams},A4=function(){var e=S5(this).fragment;return e?"#"+e:""},k4=function(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}};if(e5&&n5(S4,{href:k4(b4,(function(e){var t=S5(this),r=d5(e),n=m4(t,r);if(n)throw TypeError(n);m5(t.searchParams).updateSearchParams(t.query)})),origin:k4(N4),protocol:k4(T4,(function(e){var t=S5(this);m4(t,d5(e)+":",Q5)})),username:k4(w4,(function(e){var t=S5(this),r=c5(d5(e));if(!G5(t)){t.username="";for(var n=0;n<r.length;n++)t.username+=B5(r[n],U5)}})),password:k4(E4,(function(e){var t=S5(this),r=c5(d5(e));if(!G5(t)){t.password="";for(var n=0;n<r.length;n++)t.password+=B5(r[n],U5)}})),host:k4(_4,(function(e){var t=S5(this);t.cannotBeABaseURL||m4(t,d5(e),i4)})),hostname:k4(O4,(function(e){var t=S5(this);t.cannotBeABaseURL||m4(t,d5(e),s4)})),port:k4(R4,(function(e){var t=S5(this);G5(t)||(""==(e=d5(e))?t.port=null:m4(t,e,c4))})),pathname:k4(I4,(function(e){var t=S5(this);t.cannotBeABaseURL||(t.path=[],m4(t,d5(e),f4))})),search:k4(x4,(function(e){var t=S5(this);""==(e=d5(e))?t.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),t.query="",m4(t,e,v4)),m5(t.searchParams).updateSearchParams(t.query)})),searchParams:k4(C4),hash:k4(A4,(function(e){var t=S5(this);""!=(e=d5(e))?("#"==e.charAt(0)&&(e=e.slice(1)),t.fragment="",m4(t,e,y4)):t.fragment=null}))}),o5(S4,"toJSON",(function(){return b4.call(this)}),{enumerable:!0}),o5(S4,"toString",(function(){return b4.call(this)}),{enumerable:!0}),v5){var L4=v5.createObjectURL,M4=v5.revokeObjectURL;L4&&o5(g4,"createObjectURL",(function(e){return L4.apply(v5,arguments)})),M4&&o5(g4,"revokeObjectURL",(function(e){return M4.apply(v5,arguments)}))}f5(g4,"URL"),Z3({global:!0,forced:!t5,sham:!e5},{URL:g4}),un({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}}),"undefined"!=typeof Element&&(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}));var P4="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==P4&&P4,H4="URLSearchParams"in P4,D4="Symbol"in P4&&"iterator"in Symbol,F4="FileReader"in P4&&"Blob"in P4&&function(){try{return new Blob,!0}catch(e){return!1}}(),j4="FormData"in P4,U4="ArrayBuffer"in P4;if(U4)var B4=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],Y4=ArrayBuffer.isView||function(e){return e&&B4.indexOf(Object.prototype.toString.call(e))>-1};function V4(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function J4(e){return"string"!=typeof e&&(e=String(e)),e}function G4(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return D4&&(t[Symbol.iterator]=function(){return t}),t}function K4(e){this.map={},e instanceof K4?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function q4(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function W4(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function X4(e){var t=new FileReader,r=W4(t);return t.readAsArrayBuffer(e),r}function Q4(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function z4(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:F4&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:j4&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:H4&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():U4&&F4&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=Q4(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):U4&&(ArrayBuffer.prototype.isPrototypeOf(e)||Y4(e))?this._bodyArrayBuffer=Q4(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):H4&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},F4&&(this.blob=function(){var e=q4(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=q4(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(X4)}),this.text=function(){var e=q4(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,r=W4(t);return t.readAsText(e),r}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},j4&&(this.formData=function(){return this.text().then(e6)}),this.json=function(){return this.text().then(JSON.parse)},this}K4.prototype.append=function(e,t){e=V4(e),t=J4(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},K4.prototype.delete=function(e){delete this.map[V4(e)]},K4.prototype.get=function(e){return e=V4(e),this.has(e)?this.map[e]:null},K4.prototype.has=function(e){return this.map.hasOwnProperty(V4(e))},K4.prototype.set=function(e,t){this.map[V4(e)]=J4(t)},K4.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},K4.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),G4(e)},K4.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),G4(e)},K4.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),G4(e)},D4&&(K4.prototype[Symbol.iterator]=K4.prototype.entries);var $4=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Z4(e,t){if(!(this instanceof Z4))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var r=(t=t||{}).body;if(e instanceof Z4){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new K4(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new K4(t.headers)),this.method=function(e){var t=e.toUpperCase();return $4.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var n=/([?&])_=[^&]*/;if(n.test(this.url))this.url=this.url.replace(n,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function e6(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}})),t}function t6(e,t){if(!(this instanceof t6))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new K4(t.headers),this.url=t.url||"",this._initBody(e)}Z4.prototype.clone=function(){return new Z4(this,{body:this._bodyInit})},z4.call(Z4.prototype),z4.call(t6.prototype),t6.prototype.clone=function(){return new t6(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new K4(this.headers),url:this.url})},t6.error=function(){var e=new t6(null,{status:0,statusText:""});return e.type="error",e};var r6=[301,302,303,307,308];t6.redirect=function(e,t){if(-1===r6.indexOf(t))throw new RangeError("Invalid status code");return new t6(null,{status:t,headers:{location:e}})};var n6=P4.DOMException;try{new n6}catch(e){(n6=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack}).prototype=Object.create(Error.prototype),n6.prototype.constructor=n6}function o6(e,t){return new Promise((function(r,n){var o=new Z4(e,t);if(o.signal&&o.signal.aborted)return n(new n6("Aborted","AbortError"));var a=new XMLHttpRequest;function i(){a.abort()}a.onload=function(){var e,t,n={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new K4,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}})),t)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var o="response"in a?a.response:a.responseText;setTimeout((function(){r(new t6(o,n))}),0)},a.onerror=function(){setTimeout((function(){n(new TypeError("Network request failed"))}),0)},a.ontimeout=function(){setTimeout((function(){n(new TypeError("Network request failed"))}),0)},a.onabort=function(){setTimeout((function(){n(new n6("Aborted","AbortError"))}),0)},a.open(o.method,function(e){try{return""===e&&P4.location.href?P4.location.href:e}catch(t){return e}}(o.url),!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&(F4?a.responseType="blob":U4&&o.headers.get("Content-Type")&&-1!==o.headers.get("Content-Type").indexOf("application/octet-stream")&&(a.responseType="arraybuffer")),!t||"object"!=typeof t.headers||t.headers instanceof K4?o.headers.forEach((function(e,t){a.setRequestHeader(t,e)})):Object.getOwnPropertyNames(t.headers).forEach((function(e){a.setRequestHeader(e,J4(t.headers[e]))})),o.signal&&(o.signal.addEventListener("abort",i),a.onreadystatechange=function(){4===a.readyState&&o.signal.removeEventListener("abort",i)}),a.send(void 0===o._bodyInit?null:o._bodyInit)}))}o6.polyfill=!0,P4.fetch||(P4.fetch=o6,P4.Headers=K4,P4.Request=Z4,P4.Response=t6);var a6=function(e){Zi(r,e);var t=os(r);function r(){return Xi(this,r),t.apply(this,arguments)}return zi(r,[{key:"body",value:function(){document.getElementById("body").innerHTML="<p>Placeholder survey picker content.</p>"}}]),r}(cx);ad.config({name:ZL.forageName}),Promise.prototype.finally||(Promise.prototype.finally=function(e){return this.then(e).catch(e)}),console.log("if you have sourcemaps enabled in your devtools, click on main.js:5 --\x3e"),navigator.serviceWorker&&(navigator.serviceWorker.register("/app/serviceworker.js",{}),navigator.serviceWorker.addEventListener("controllerchange",(function(){window.location.reload(!0)})));var i6=new ZL;i6.router=new uC("https://nyphtest.bsbi.org/app/"),i6.containerId="appcontainer",i6.setLayout(new _D),i6.registerController(new mR(new yD,"/help")),i6.registerController(new IP(new nD)),i6.registerController(new ED(new a6)),i6.restoreOccurrences().then((function(e){console.log({"result from restoreOccurrences":e})}),(function(e){console.log({"failed result from restoreOccurrences":e})})).finally((function(){OA.onceTaxaLoaded().then((function(){i6.initialise(),i6.display()}))}))}();
//# sourceMappingURL=app.js.map
