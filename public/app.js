!function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var n=function(e){return e&&e.Math==Math&&e},r=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||function(){return this}()||Function("return this")(),o={exports:{}},a=r,i=function(e,t){try{Object.defineProperty(a,e,{value:t,configurable:!0,writable:!0})}catch(n){a[e]=t}return t},s=i,c=r["__core-js_shared__"]||s("__core-js_shared__",{}),l=c;(o.exports=function(e,t){return l[e]||(l[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.18.3",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"});var u,d,f=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},h=f,p=function(e){return Object(h(e))},v=p,y={}.hasOwnProperty,m=Object.hasOwn||function(e,t){return y.call(v(e),t)},g=0,S=Math.random(),b=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++g+S).toString(36)},N=function(e){return"function"==typeof e},T=r,E=N,w=function(e){return E(e)?e:void 0},_=function(e,t){return arguments.length<2?w(T[e]):T[e]&&T[e][t]},O=_("navigator","userAgent")||"",I=r,R=O,x=I.process,C=I.Deno,A=x&&x.versions||C&&C.version,k=A&&A.v8;k?d=(u=k.split("."))[0]<4?1:u[0]+u[1]:R&&(!(u=R.match(/Edge\/(\d+)/))||u[1]>=74)&&(u=R.match(/Chrome\/(\d+)/))&&(d=u[1]);var L=d&&+d,M=function(e){try{return!!e()}catch(e){return!0}},P=L,H=M,D=!!Object.getOwnPropertySymbols&&!H((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&P&&P<41})),F=D&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,j=r,U=o.exports,B=m,Y=b,V=D,J=F,G=U("wks"),q=j.Symbol,K=J?q:q&&q.withoutSetter||Y,W=function(e){return B(G,e)&&(V||"string"==typeof G[e])||(V&&B(q,e)?G[e]=q[e]:G[e]=K("Symbol."+e)),G[e]},X={};X[W("toStringTag")]="z";var Q="[object z]"===String(X),z={exports:{}},Z=!M((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),ee={},te=N,ne=function(e){return"object"==typeof e?null!==e:te(e)},re=ne,oe=r.document,ae=re(oe)&&re(oe.createElement),ie=function(e){return ae?oe.createElement(e):{}},se=ie,ce=!Z&&!M((function(){return 7!=Object.defineProperty(se("div"),"a",{get:function(){return 7}}).a})),le=ne,ue=function(e){if(le(e))return e;throw TypeError(String(e)+" is not an object")},de=N,fe=_,he=F?function(e){return"symbol"==typeof e}:function(e){var t=fe("Symbol");return de(t)&&Object(e)instanceof t},pe=function(e){try{return String(e)}catch(e){return"Object"}},ve=N,ye=pe,me=function(e){if(ve(e))return e;throw TypeError(ye(e)+" is not a function")},ge=me,Se=function(e,t){var n=e[t];return null==n?void 0:ge(n)},be=N,Ne=ne,Te=function(e,t){var n,r;if("string"===t&&be(n=e.toString)&&!Ne(r=n.call(e)))return r;if(be(n=e.valueOf)&&!Ne(r=n.call(e)))return r;if("string"!==t&&be(n=e.toString)&&!Ne(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},Ee=ne,we=he,_e=Se,Oe=Te,Ie=W("toPrimitive"),Re=function(e,t){if(!Ee(e)||we(e))return e;var n,r=_e(e,Ie);if(r){if(void 0===t&&(t="default"),n=r.call(e,t),!Ee(n)||we(n))return n;throw TypeError("Can't convert object to primitive value")}return void 0===t&&(t="number"),Oe(e,t)},xe=Re,Ce=he,Ae=function(e){var t=xe(e,"string");return Ce(t)?t:String(t)},ke=Z,Le=ce,Me=ue,Pe=Ae,He=Object.defineProperty;ee.f=ke?He:function(e,t,n){if(Me(e),t=Pe(t),Me(n),Le)try{return He(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var De=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},Fe=ee,je=De,Ue=Z?function(e,t,n){return Fe.f(e,t,je(1,n))}:function(e,t,n){return e[t]=n,e},Be=N,Ye=c,Ve=Function.toString;Be(Ye.inspectSource)||(Ye.inspectSource=function(e){return Ve.call(e)});var Je,Ge,qe,Ke=Ye.inspectSource,We=N,Xe=Ke,Qe=r.WeakMap,ze=We(Qe)&&/native code/.test(Xe(Qe)),$e=o.exports,Ze=b,et=$e("keys"),tt=function(e){return et[e]||(et[e]=Ze(e))},nt={},rt=ze,ot=ne,at=Ue,it=m,st=c,ct=tt,lt=nt,ut=r.WeakMap;if(rt||st.state){var dt=st.state||(st.state=new ut),ft=dt.get,ht=dt.has,pt=dt.set;Je=function(e,t){if(ht.call(dt,e))throw new TypeError("Object already initialized");return t.facade=e,pt.call(dt,e,t),t},Ge=function(e){return ft.call(dt,e)||{}},qe=function(e){return ht.call(dt,e)}}else{var vt=ct("state");lt[vt]=!0,Je=function(e,t){if(it(e,vt))throw new TypeError("Object already initialized");return t.facade=e,at(e,vt,t),t},Ge=function(e){return it(e,vt)?e[vt]:{}},qe=function(e){return it(e,vt)}}var yt={set:Je,get:Ge,has:qe,enforce:function(e){return qe(e)?Ge(e):Je(e,{})},getterFor:function(e){return function(t){var n;if(!ot(t)||(n=Ge(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},mt=Z,gt=m,St=Function.prototype,bt=mt&&Object.getOwnPropertyDescriptor,Nt=gt(St,"name"),Tt={EXISTS:Nt,PROPER:Nt&&"something"===function(){}.name,CONFIGURABLE:Nt&&(!mt||mt&&bt(St,"name").configurable)},Et=r,wt=N,_t=m,Ot=Ue,It=i,Rt=Ke,xt=Tt.CONFIGURABLE,Ct=yt.get,At=yt.enforce,kt=String(String).split("String");(z.exports=function(e,t,n,r){var o,a=!!r&&!!r.unsafe,i=!!r&&!!r.enumerable,s=!!r&&!!r.noTargetGet,c=r&&void 0!==r.name?r.name:t;wt(n)&&("Symbol("===String(c).slice(0,7)&&(c="["+String(c).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!_t(n,"name")||xt&&n.name!==c)&&Ot(n,"name",c),(o=At(n)).source||(o.source=kt.join("string"==typeof c?c:""))),e!==Et?(a?!s&&e[t]&&(i=!0):delete e[t],i?e[t]=n:Ot(e,t,n)):i?e[t]=n:It(t,n)})(Function.prototype,"toString",(function(){return wt(this)&&Ct(this).source||Rt(this)}));var Lt={}.toString,Mt=function(e){return Lt.call(e).slice(8,-1)},Pt=Q,Ht=N,Dt=Mt,Ft=W("toStringTag"),jt="Arguments"==Dt(function(){return arguments}()),Ut=Pt?Dt:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),Ft))?n:jt?Dt(t):"Object"==(r=Dt(t))&&Ht(t.callee)?"Arguments":r},Bt=Ut,Yt=Q?{}.toString:function(){return"[object "+Bt(this)+"]"},Vt=Q,Jt=z.exports,Gt=Yt;Vt||Jt(Object.prototype,"toString",Gt,{unsafe:!0});var qt={},Kt={},Wt={}.propertyIsEnumerable,Xt=Object.getOwnPropertyDescriptor,Qt=Xt&&!Wt.call({1:2},1);Kt.f=Qt?function(e){var t=Xt(this,e);return!!t&&t.enumerable}:Wt;var zt=Mt,$t="".split,Zt=M((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==zt(e)?$t.call(e,""):Object(e)}:Object,en=Zt,tn=f,nn=function(e){return en(tn(e))},rn=Z,on=Kt,an=De,sn=nn,cn=Ae,ln=m,un=ce,dn=Object.getOwnPropertyDescriptor;qt.f=rn?dn:function(e,t){if(e=sn(e),t=cn(t),un)try{return dn(e,t)}catch(e){}if(ln(e,t))return an(!on.f.call(e,t),e[t])};var fn={},hn=Math.ceil,pn=Math.floor,vn=function(e){var t=+e;return t!=t||0===t?0:(t>0?pn:hn)(t)},yn=vn,mn=Math.max,gn=Math.min,Sn=function(e,t){var n=yn(e);return n<0?mn(n+t,0):gn(n,t)},bn=vn,Nn=Math.min,Tn=function(e){return e>0?Nn(bn(e),9007199254740991):0},En=Tn,wn=function(e){return En(e.length)},_n=nn,On=Sn,In=wn,Rn=function(e){return function(t,n,r){var o,a=_n(t),i=In(a),s=On(r,i);if(e&&n!=n){for(;i>s;)if((o=a[s++])!=o)return!0}else for(;i>s;s++)if((e||s in a)&&a[s]===n)return e||s||0;return!e&&-1}},xn={includes:Rn(!0),indexOf:Rn(!1)},Cn=m,An=nn,kn=xn.indexOf,Ln=nt,Mn=function(e,t){var n,r=An(e),o=0,a=[];for(n in r)!Cn(Ln,n)&&Cn(r,n)&&a.push(n);for(;t.length>o;)Cn(r,n=t[o++])&&(~kn(a,n)||a.push(n));return a},Pn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Hn=Mn,Dn=Pn.concat("length","prototype");fn.f=Object.getOwnPropertyNames||function(e){return Hn(e,Dn)};var Fn={};Fn.f=Object.getOwnPropertySymbols;var jn=fn,Un=Fn,Bn=ue,Yn=_("Reflect","ownKeys")||function(e){var t=jn.f(Bn(e)),n=Un.f;return n?t.concat(n(e)):t},Vn=m,Jn=Yn,Gn=qt,qn=ee,Kn=function(e,t){for(var n=Jn(t),r=qn.f,o=Gn.f,a=0;a<n.length;a++){var i=n[a];Vn(e,i)||r(e,i,o(t,i))}},Wn=M,Xn=N,Qn=/#|\.prototype\./,zn=function(e,t){var n=Zn[$n(e)];return n==tr||n!=er&&(Xn(t)?Wn(t):!!t)},$n=zn.normalize=function(e){return String(e).replace(Qn,".").toLowerCase()},Zn=zn.data={},er=zn.NATIVE="N",tr=zn.POLYFILL="P",nr=zn,rr=r,or=qt.f,ar=Ue,ir=z.exports,sr=i,cr=Kn,lr=nr,ur=function(e,t){var n,r,o,a,i,s=e.target,c=e.global,l=e.stat;if(n=c?rr:l?rr[s]||sr(s,{}):(rr[s]||{}).prototype)for(r in t){if(a=t[r],o=e.noTargetGet?(i=or(n,r))&&i.value:n[r],!lr(c?r:s+(l?".":"#")+r,e.forced)&&void 0!==o){if(typeof a==typeof o)continue;cr(a,o)}(e.sham||o&&o.sham)&&ar(a,"sham",!0),ir(n,r,a,e)}},dr=r.Promise,fr=z.exports,hr=function(e,t,n){for(var r in t)fr(e,r,t[r],n);return e},pr=N,vr=function(e){if("object"==typeof e||pr(e))return e;throw TypeError("Can't set "+String(e)+" as a prototype")},yr=ue,mr=vr,gr=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return yr(n),mr(r),t?e.call(n,r):n.__proto__=r,n}}():void 0),Sr=ee.f,br=m,Nr=W("toStringTag"),Tr=function(e,t,n){e&&!br(e=n?e:e.prototype,Nr)&&Sr(e,Nr,{configurable:!0,value:t})},Er=_,wr=ee,_r=Z,Or=W("species"),Ir=function(e){var t=Er(e),n=wr.f;_r&&t&&!t[Or]&&n(t,Or,{configurable:!0,get:function(){return this}})},Rr=function(e,t,n){if(e instanceof t)return e;throw TypeError("Incorrect "+(n?n+" ":"")+"invocation")},xr={},Cr=xr,Ar=W("iterator"),kr=Array.prototype,Lr=function(e){return void 0!==e&&(Cr.Array===e||kr[Ar]===e)},Mr=me,Pr=function(e,t,n){if(Mr(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}},Hr=Ut,Dr=Se,Fr=xr,jr=W("iterator"),Ur=function(e){if(null!=e)return Dr(e,jr)||Dr(e,"@@iterator")||Fr[Hr(e)]},Br=me,Yr=ue,Vr=Ur,Jr=function(e,t){var n=arguments.length<2?Vr(e):t;if(Br(n))return Yr(n.call(e));throw TypeError(String(e)+" is not iterable")},Gr=ue,qr=Se,Kr=function(e,t,n){var r,o;Gr(e);try{if(!(r=qr(e,"return"))){if("throw"===t)throw n;return n}r=r.call(e)}catch(e){o=!0,r=e}if("throw"===t)throw n;if(o)throw r;return Gr(r),n},Wr=ue,Xr=Lr,Qr=wn,zr=Pr,$r=Jr,Zr=Ur,eo=Kr,to=function(e,t){this.stopped=e,this.result=t},no=function(e,t,n){var r,o,a,i,s,c,l,u=n&&n.that,d=!(!n||!n.AS_ENTRIES),f=!(!n||!n.IS_ITERATOR),h=!(!n||!n.INTERRUPTED),p=zr(t,u,1+d+h),v=function(e){return r&&eo(r,"normal",e),new to(!0,e)},y=function(e){return d?(Wr(e),h?p(e[0],e[1],v):p(e[0],e[1])):h?p(e,v):p(e)};if(f)r=e;else{if(!(o=Zr(e)))throw TypeError(String(e)+" is not iterable");if(Xr(o)){for(a=0,i=Qr(e);i>a;a++)if((s=y(e[a]))&&s instanceof to)return s;return new to(!1)}r=$r(e,o)}for(c=r.next;!(l=c.call(r)).done;){try{s=y(l.value)}catch(e){eo(r,"throw",e)}if("object"==typeof s&&s&&s instanceof to)return s}return new to(!1)},ro=W("iterator"),oo=!1;try{var ao=0,io={next:function(){return{done:!!ao++}},return:function(){oo=!0}};io[ro]=function(){return this},Array.from(io,(function(){throw 2}))}catch(e){}var so,co,lo,uo,fo=function(e,t){if(!t&&!oo)return!1;var n=!1;try{var r={};r[ro]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n},ho=M,po=N,vo=Ut,yo=Ke,mo=[],go=_("Reflect","construct"),So=/^\s*(?:class|function)\b/,bo=So.exec,No=!So.exec((function(){})),To=function(e){if(!po(e))return!1;try{return go(Object,mo,e),!0}catch(e){return!1}},Eo=!go||ho((function(){var e;return To(To.call)||!To(Object)||!To((function(){e=!0}))||e}))?function(e){if(!po(e))return!1;switch(vo(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}return No||!!bo.call(So,yo(e))}:To,wo=Eo,_o=pe,Oo=function(e){if(wo(e))return e;throw TypeError(_o(e)+" is not a constructor")},Io=ue,Ro=Oo,xo=W("species"),Co=function(e,t){var n,r=Io(e).constructor;return void 0===r||null==(n=Io(r)[xo])?t:Ro(n)},Ao=_("document","documentElement"),ko=/(?:ipad|iphone|ipod).*applewebkit/i.test(O),Lo="process"==Mt(r.process),Mo=r,Po=N,Ho=M,Do=Pr,Fo=Ao,jo=ie,Uo=ko,Bo=Lo,Yo=Mo.setImmediate,Vo=Mo.clearImmediate,Jo=Mo.process,Go=Mo.MessageChannel,qo=Mo.Dispatch,Ko=0,Wo={};try{so=Mo.location}catch(e){}var Xo=function(e){if(Wo.hasOwnProperty(e)){var t=Wo[e];delete Wo[e],t()}},Qo=function(e){return function(){Xo(e)}},zo=function(e){Xo(e.data)},$o=function(e){Mo.postMessage(String(e),so.protocol+"//"+so.host)};Yo&&Vo||(Yo=function(e){for(var t=[],n=arguments.length,r=1;n>r;)t.push(arguments[r++]);return Wo[++Ko]=function(){(Po(e)?e:Function(e)).apply(void 0,t)},co(Ko),Ko},Vo=function(e){delete Wo[e]},Bo?co=function(e){Jo.nextTick(Qo(e))}:qo&&qo.now?co=function(e){qo.now(Qo(e))}:Go&&!Uo?(uo=(lo=new Go).port2,lo.port1.onmessage=zo,co=Do(uo.postMessage,uo,1)):Mo.addEventListener&&Po(Mo.postMessage)&&!Mo.importScripts&&so&&"file:"!==so.protocol&&!Ho($o)?(co=$o,Mo.addEventListener("message",zo,!1)):co="onreadystatechange"in jo("script")?function(e){Fo.appendChild(jo("script")).onreadystatechange=function(){Fo.removeChild(this),Xo(e)}}:function(e){setTimeout(Qo(e),0)});var Zo,ea,ta,na,ra,oa,aa,ia,sa={set:Yo,clear:Vo},ca=r,la=/ipad|iphone|ipod/i.test(O)&&void 0!==ca.Pebble,ua=/web0s(?!.*chrome)/i.test(O),da=r,fa=qt.f,ha=sa.set,pa=ko,va=la,ya=ua,ma=Lo,ga=da.MutationObserver||da.WebKitMutationObserver,Sa=da.document,ba=da.process,Na=da.Promise,Ta=fa(da,"queueMicrotask"),Ea=Ta&&Ta.value;Ea||(Zo=function(){var e,t;for(ma&&(e=ba.domain)&&e.exit();ea;){t=ea.fn,ea=ea.next;try{t()}catch(e){throw ea?na():ta=void 0,e}}ta=void 0,e&&e.enter()},pa||ma||ya||!ga||!Sa?!va&&Na&&Na.resolve?((aa=Na.resolve(void 0)).constructor=Na,ia=aa.then,na=function(){ia.call(aa,Zo)}):na=ma?function(){ba.nextTick(Zo)}:function(){ha.call(da,Zo)}:(ra=!0,oa=Sa.createTextNode(""),new ga(Zo).observe(oa,{characterData:!0}),na=function(){oa.data=ra=!ra}));var wa=Ea||function(e){var t={fn:e,next:void 0};ta&&(ta.next=t),ea||(ea=t,na()),ta=t},_a={},Oa=me,Ia=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=Oa(t),this.reject=Oa(n)};_a.f=function(e){return new Ia(e)};var Ra,xa,Ca,Aa,ka=ue,La=ne,Ma=_a,Pa=function(e,t){if(ka(e),La(t)&&t.constructor===e)return t;var n=Ma.f(e);return(0,n.resolve)(t),n.promise},Ha=r,Da=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},Fa="object"==typeof window,ja=ur,Ua=r,Ba=_,Ya=dr,Va=z.exports,Ja=hr,Ga=gr,qa=Tr,Ka=Ir,Wa=me,Xa=N,Qa=ne,za=Rr,$a=Ke,Za=no,ei=fo,ti=Co,ni=sa.set,ri=wa,oi=Pa,ai=function(e,t){var n=Ha.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))},ii=_a,si=Da,ci=yt,li=nr,ui=Fa,di=Lo,fi=L,hi=W("species"),pi="Promise",vi=ci.get,yi=ci.set,mi=ci.getterFor(pi),gi=Ya&&Ya.prototype,Si=Ya,bi=gi,Ni=Ua.TypeError,Ti=Ua.document,Ei=Ua.process,wi=ii.f,_i=wi,Oi=!!(Ti&&Ti.createEvent&&Ua.dispatchEvent),Ii=Xa(Ua.PromiseRejectionEvent),Ri=!1,xi=li(pi,(function(){var e=$a(Si),t=e!==String(Si);if(!t&&66===fi)return!0;if(fi>=51&&/native code/.test(e))return!1;var n=new Si((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};return(n.constructor={})[hi]=r,!(Ri=n.then((function(){}))instanceof r)||!t&&ui&&!Ii})),Ci=xi||!ei((function(e){Si.all(e).catch((function(){}))})),Ai=function(e){var t;return!(!Qa(e)||!Xa(t=e.then))&&t},ki=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;ri((function(){for(var r=e.value,o=1==e.state,a=0;n.length>a;){var i,s,c,l=n[a++],u=o?l.ok:l.fail,d=l.resolve,f=l.reject,h=l.domain;try{u?(o||(2===e.rejection&&Hi(e),e.rejection=1),!0===u?i=r:(h&&h.enter(),i=u(r),h&&(h.exit(),c=!0)),i===l.promise?f(Ni("Promise-chain cycle")):(s=Ai(i))?s.call(i,d,f):d(i)):f(r)}catch(e){h&&!c&&h.exit(),f(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&Mi(e)}))}},Li=function(e,t,n){var r,o;Oi?((r=Ti.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),Ua.dispatchEvent(r)):r={promise:t,reason:n},!Ii&&(o=Ua["on"+e])?o(r):"unhandledrejection"===e&&ai("Unhandled promise rejection",n)},Mi=function(e){ni.call(Ua,(function(){var t,n=e.facade,r=e.value;if(Pi(e)&&(t=si((function(){di?Ei.emit("unhandledRejection",r,n):Li("unhandledrejection",n,r)})),e.rejection=di||Pi(e)?2:1,t.error))throw t.value}))},Pi=function(e){return 1!==e.rejection&&!e.parent},Hi=function(e){ni.call(Ua,(function(){var t=e.facade;di?Ei.emit("rejectionHandled",t):Li("rejectionhandled",t,e.value)}))},Di=function(e,t,n){return function(r){e(t,r,n)}},Fi=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,ki(e,!0))},ji=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw Ni("Promise can't be resolved itself");var r=Ai(t);r?ri((function(){var n={done:!1};try{r.call(t,Di(ji,n,e),Di(Fi,n,e))}catch(t){Fi(n,t,e)}})):(e.value=t,e.state=1,ki(e,!1))}catch(t){Fi({done:!1},t,e)}}};if(xi&&(bi=(Si=function(e){za(this,Si,pi),Wa(e),Ra.call(this);var t=vi(this);try{e(Di(ji,t),Di(Fi,t))}catch(e){Fi(t,e)}}).prototype,(Ra=function(e){yi(this,{type:pi,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=Ja(bi,{then:function(e,t){var n=mi(this),r=wi(ti(this,Si));return r.ok=!Xa(e)||e,r.fail=Xa(t)&&t,r.domain=di?Ei.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&ki(n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),xa=function(){var e=new Ra,t=vi(e);this.promise=e,this.resolve=Di(ji,t),this.reject=Di(Fi,t)},ii.f=wi=function(e){return e===Si||e===Ca?new xa(e):_i(e)},Xa(Ya)&&gi!==Object.prototype)){Aa=gi.then,Ri||(Va(gi,"then",(function(e,t){var n=this;return new Si((function(e,t){Aa.call(n,e,t)})).then(e,t)}),{unsafe:!0}),Va(gi,"catch",bi.catch,{unsafe:!0}));try{delete gi.constructor}catch(e){}Ga&&Ga(gi,bi)}ja({global:!0,wrap:!0,forced:xi},{Promise:Si}),qa(Si,pi,!1),Ka(pi),Ca=Ba(pi),ja({target:pi,stat:!0,forced:xi},{reject:function(e){var t=wi(this);return t.reject.call(void 0,e),t.promise}}),ja({target:pi,stat:!0,forced:xi},{resolve:function(e){return oi(this,e)}}),ja({target:pi,stat:!0,forced:Ci},{all:function(e){var t=this,n=wi(t),r=n.resolve,o=n.reject,a=si((function(){var n=Wa(t.resolve),a=[],i=0,s=1;Za(e,(function(e){var c=i++,l=!1;a.push(void 0),s++,n.call(t,e).then((function(e){l||(l=!0,a[c]=e,--s||r(a))}),o)})),--s||r(a)}));return a.error&&o(a.value),n.promise},race:function(e){var t=this,n=wi(t),r=n.reject,o=si((function(){var o=Wa(t.resolve);Za(e,(function(e){o.call(t,e).then(n.resolve,r)}))}));return o.error&&r(o.value),n.promise}});var Ui=ur,Bi=dr,Yi=M,Vi=_,Ji=N,Gi=Co,qi=Pa,Ki=z.exports;if(Ui({target:"Promise",proto:!0,real:!0,forced:!!Bi&&Yi((function(){Bi.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=Gi(this,Vi("Promise")),n=Ji(e);return this.then(n?function(n){return qi(t,e()).then((function(){return n}))}:e,n?function(n){return qi(t,e()).then((function(){throw n}))}:e)}}),Ji(Bi)){var Wi=Vi("Promise").prototype.finally;Bi.prototype.finally!==Wi&&Ki(Bi.prototype,"finally",Wi,{unsafe:!0})}function Xi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zi(e,t,n){return t&&Qi(e.prototype,t),n&&Qi(e,n),e}function $i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zi(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ts(e,t)}function es(e){return(es=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ts(e,t){return(ts=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ns(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rs(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ns(e)}function os(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=es(e);if(t){var o=es(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rs(this,n)}}function as(e,t,n){return(as="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=es(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function is(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return a}(e,t)||cs(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ss(e){return function(e){if(Array.isArray(e))return ls(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||cs(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cs(e,t){if(e){if("string"==typeof e)return ls(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ls(e,t):void 0}}function ls(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function us(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=cs(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function ds(e,t){return ps(e,hs(e,t,"get"))}function fs(e,t,n){return vs(e,hs(e,t,"set"),n),n}function hs(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function ps(e,t){return t.get?t.get.call(e):t.value}function vs(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}function ys(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}function ms(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}function gs(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function Ss(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bs(e,t,n){Ss(e,t),t.set(e,n)}function Ns(e,t){Ss(e,t),t.add(e)}var Ts=Mt,Es=Array.isArray||function(e){return"Array"==Ts(e)},ws=Ae,_s=ee,Os=De,Is=function(e,t,n){var r=ws(t);r in e?_s.f(e,r,Os(0,n)):e[r]=n},Rs=Es,xs=Eo,Cs=ne,As=W("species"),ks=function(e){var t;return Rs(e)&&(t=e.constructor,(xs(t)&&(t===Array||Rs(t.prototype))||Cs(t)&&null===(t=t[As]))&&(t=void 0)),void 0===t?Array:t},Ls=function(e,t){return new(ks(e))(0===t?0:t)},Ms=M,Ps=L,Hs=W("species"),Ds=function(e){return Ps>=51||!Ms((function(){var t=[];return(t.constructor={})[Hs]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Fs=ur,js=M,Us=Es,Bs=ne,Ys=p,Vs=wn,Js=Is,Gs=Ls,qs=Ds,Ks=L,Ws=W("isConcatSpreadable"),Xs=Ks>=51||!js((function(){var e=[];return e[Ws]=!1,e.concat()[0]!==e})),Qs=qs("concat"),zs=function(e){if(!Bs(e))return!1;var t=e[Ws];return void 0!==t?!!t:Us(e)};Fs({target:"Array",proto:!0,forced:!Xs||!Qs},{concat:function(e){var t,n,r,o,a,i=Ys(this),s=Gs(i,0),c=0;for(t=-1,r=arguments.length;t<r;t++)if(zs(a=-1===t?i:arguments[t])){if(c+(o=Vs(a))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<o;n++,c++)n in a&&Js(s,c,a[n])}else{if(c>=9007199254740991)throw TypeError("Maximum allowed index exceeded");Js(s,c++,a)}return s.length=c,s}});var $s,Zs=Mn,ec=Pn,tc=Object.keys||function(e){return Zs(e,ec)},nc=ee,rc=ue,oc=tc,ac=Z?Object.defineProperties:function(e,t){rc(e);for(var n,r=oc(t),o=r.length,a=0;o>a;)nc.f(e,n=r[a++],t[n]);return e},ic=ue,sc=ac,cc=Pn,lc=nt,uc=Ao,dc=ie,fc=tt("IE_PROTO"),hc=function(){},pc=function(e){return"<script>"+e+"<\/script>"},vc=function(e){e.write(pc("")),e.close();var t=e.parentWindow.Object;return e=null,t},yc=function(){try{$s=new ActiveXObject("htmlfile")}catch(e){}var e,t;yc="undefined"!=typeof document?document.domain&&$s?vc($s):((t=dc("iframe")).style.display="none",uc.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(pc("document.F=Object")),e.close(),e.F):vc($s);for(var n=cc.length;n--;)delete yc.prototype[cc[n]];return yc()};lc[fc]=!0;var mc=Object.create||function(e,t){var n;return null!==e?(hc.prototype=ic(e),n=new hc,hc.prototype=null,n[fc]=e):n=yc(),void 0===t?n:sc(n,t)},gc=mc,Sc=ee,bc=W("unscopables"),Nc=Array.prototype;null==Nc[bc]&&Sc.f(Nc,bc,{configurable:!0,value:gc(null)});var Tc,Ec,wc,_c=function(e){Nc[bc][e]=!0},Oc=!M((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Ic=m,Rc=N,xc=p,Cc=Oc,Ac=tt("IE_PROTO"),kc=Object.prototype,Lc=Cc?Object.getPrototypeOf:function(e){var t=xc(e);if(Ic(t,Ac))return t[Ac];var n=t.constructor;return Rc(n)&&t instanceof n?n.prototype:t instanceof Object?kc:null},Mc=M,Pc=N,Hc=Lc,Dc=z.exports,Fc=W("iterator"),jc=!1;[].keys&&("next"in(wc=[].keys())?(Ec=Hc(Hc(wc)))!==Object.prototype&&(Tc=Ec):jc=!0),(null==Tc||Mc((function(){var e={};return Tc[Fc].call(e)!==e})))&&(Tc={}),Pc(Tc[Fc])||Dc(Tc,Fc,(function(){return this}));var Uc={IteratorPrototype:Tc,BUGGY_SAFARI_ITERATORS:jc},Bc=Uc.IteratorPrototype,Yc=mc,Vc=De,Jc=Tr,Gc=xr,qc=function(){return this},Kc=function(e,t,n){var r=t+" Iterator";return e.prototype=Yc(Bc,{next:Vc(1,n)}),Jc(e,r,!1),Gc[r]=qc,e},Wc=ur,Xc=Tt,Qc=N,zc=Kc,$c=Lc,Zc=gr,el=Tr,tl=Ue,nl=z.exports,rl=xr,ol=Xc.PROPER,al=Xc.CONFIGURABLE,il=Uc.IteratorPrototype,sl=Uc.BUGGY_SAFARI_ITERATORS,cl=W("iterator"),ll=function(){return this},ul=function(e,t,n,r,o,a,i){zc(n,t,r);var s,c,l,u=function(e){if(e===o&&v)return v;if(!sl&&e in h)return h[e];switch(e){case"keys":case"values":case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}},d=t+" Iterator",f=!1,h=e.prototype,p=h[cl]||h["@@iterator"]||o&&h[o],v=!sl&&p||u(o),y="Array"==t&&h.entries||p;if(y&&(s=$c(y.call(new e)))!==Object.prototype&&s.next&&($c(s)!==il&&(Zc?Zc(s,il):Qc(s[cl])||nl(s,cl,ll)),el(s,d,!0)),ol&&"values"==o&&p&&"values"!==p.name&&(al?tl(h,"name","values"):(f=!0,v=function(){return p.call(this)})),o)if(c={values:u("values"),keys:a?v:u("keys"),entries:u("entries")},i)for(l in c)(sl||f||!(l in h))&&nl(h,l,c[l]);else Wc({target:t,proto:!0,forced:sl||f},c);return h[cl]!==v&&nl(h,cl,v,{name:o}),rl[t]=v,c},dl=nn,fl=_c,hl=xr,pl=yt,vl=ul,yl=pl.set,ml=pl.getterFor("Array Iterator"),gl=vl(Array,"Array",(function(e,t){yl(this,{type:"Array Iterator",target:dl(e),index:0,kind:t})}),(function(){var e=ml(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");hl.Arguments=hl.Array,fl("keys"),fl("values"),fl("entries");var Sl=Ut,bl=function(e){if("Symbol"===Sl(e))throw TypeError("Cannot convert a Symbol value to a string");return String(e)},Nl=vn,Tl=bl,El=f,wl=function(e){return function(t,n){var r,o,a=Tl(El(t)),i=Nl(n),s=a.length;return i<0||i>=s?e?"":void 0:(r=a.charCodeAt(i))<55296||r>56319||i+1===s||(o=a.charCodeAt(i+1))<56320||o>57343?e?a.charAt(i):r:e?a.slice(i,i+2):o-56320+(r-55296<<10)+65536}},_l={codeAt:wl(!1),charAt:wl(!0)},Ol=_l.charAt,Il=bl,Rl=yt,xl=ul,Cl=Rl.set,Al=Rl.getterFor("String Iterator");xl(String,"String",(function(e){Cl(this,{type:"String Iterator",string:Il(e),index:0})}),(function(){var e,t=Al(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=Ol(n,r),t.index+=e.length,{value:e,done:!1})}));var kl={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Ll=ie("span").classList,Ml=Ll&&Ll.constructor&&Ll.constructor.prototype,Pl=Ml===Object.prototype?void 0:Ml,Hl=r,Dl=kl,Fl=Pl,jl=gl,Ul=Ue,Bl=W,Yl=Bl("iterator"),Vl=Bl("toStringTag"),Jl=jl.values,Gl=function(e,t){if(e){if(e[Yl]!==Jl)try{Ul(e,Yl,Jl)}catch(t){e[Yl]=Jl}if(e[Vl]||Ul(e,Vl,t),Dl[t])for(var n in jl)if(e[n]!==jl[n])try{Ul(e,n,jl[n])}catch(t){e[n]=jl[n]}}};for(var ql in Dl)Gl(Hl[ql]&&Hl[ql].prototype,ql);Gl(Fl,"DOMTokenList");var Kl=xn.includes,Wl=_c;ur({target:"Array",proto:!0},{includes:function(e){return Kl(this,e,arguments.length>1?arguments[1]:void 0)}}),Wl("includes");var Xl=ne,Ql=Mt,zl=W("match"),$l=function(e){var t;return Xl(e)&&(void 0!==(t=e[zl])?!!t:"RegExp"==Ql(e))},Zl=$l,eu=function(e){if(Zl(e))throw TypeError("The method doesn't accept regular expressions");return e},tu=W("match"),nu=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[tu]=!1,"/./"[e](t)}catch(e){}}return!1},ru=eu,ou=f,au=bl;ur({target:"String",proto:!0,forced:!nu("includes")},{includes:function(e){return!!~au(ou(this)).indexOf(au(ru(e)),arguments.length>1?arguments[1]:void 0)}});var iu=ue,su=function(){var e=iu(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},cu={},lu=M,uu=r.RegExp;cu.UNSUPPORTED_Y=lu((function(){var e=uu("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),cu.BROKEN_CARET=lu((function(){var e=uu("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));var du=M,fu=r.RegExp,hu=du((function(){var e=fu(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),pu=M,vu=r.RegExp,yu=pu((function(){var e=vu("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),mu=bl,gu=su,Su=cu,bu=o.exports,Nu=mc,Tu=yt.get,Eu=hu,wu=yu,_u=RegExp.prototype.exec,Ou=bu("native-string-replace",String.prototype.replace),Iu=_u,Ru=function(){var e=/a/,t=/b*/g;return _u.call(e,"a"),_u.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),xu=Su.UNSUPPORTED_Y||Su.BROKEN_CARET,Cu=void 0!==/()??/.exec("")[1];(Ru||Cu||xu||Eu||wu)&&(Iu=function(e){var t,n,r,o,a,i,s,c=this,l=Tu(c),u=mu(e),d=l.raw;if(d)return d.lastIndex=c.lastIndex,t=Iu.call(d,u),c.lastIndex=d.lastIndex,t;var f=l.groups,h=xu&&c.sticky,p=gu.call(c),v=c.source,y=0,m=u;if(h&&(-1===(p=p.replace("y","")).indexOf("g")&&(p+="g"),m=u.slice(c.lastIndex),c.lastIndex>0&&(!c.multiline||c.multiline&&"\n"!==u.charAt(c.lastIndex-1))&&(v="(?: "+v+")",m=" "+m,y++),n=new RegExp("^(?:"+v+")",p)),Cu&&(n=new RegExp("^"+v+"$(?!\\s)",p)),Ru&&(r=c.lastIndex),o=_u.call(h?n:c,m),h?o?(o.input=o.input.slice(y),o[0]=o[0].slice(y),o.index=c.lastIndex,c.lastIndex+=o[0].length):c.lastIndex=0:Ru&&o&&(c.lastIndex=c.global?o.index+o[0].length:r),Cu&&o&&o.length>1&&Ou.call(o[0],n,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(o[a]=void 0)})),o&&f)for(o.groups=i=Nu(null),a=0;a<f.length;a++)i[(s=f[a])[0]]=o[s[1]];return o});var Au=Iu;ur({target:"RegExp",proto:!0,forced:/./.exec!==Au},{exec:Au});var ku=z.exports,Lu=Au,Mu=M,Pu=W,Hu=Ue,Du=Pu("species"),Fu=RegExp.prototype,ju=function(e,t,n,r){var o=Pu(e),a=!Mu((function(){var t={};return t[o]=function(){return 7},7!=""[e](t)})),i=a&&!Mu((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[Du]=function(){return n},n.flags="",n[o]=/./[o]),n.exec=function(){return t=!0,null},n[o](""),!t}));if(!a||!i||n){var s=/./[o],c=t(o,""[e],(function(e,t,n,r,o){var i=t.exec;return i===Lu||i===Fu.exec?a&&!o?{done:!0,value:s.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}));ku(String.prototype,e,c[0]),ku(Fu,o,c[1])}r&&Hu(Fu[o],"sham",!0)},Uu=_l.charAt,Bu=function(e,t,n){return t+(n?Uu(e,t).length:1)},Yu=ue,Vu=N,Ju=Mt,Gu=Au,qu=function(e,t){var n=e.exec;if(Vu(n)){var r=n.call(e,t);return null!==r&&Yu(r),r}if("RegExp"===Ju(e))return Gu.call(e,t);throw TypeError("RegExp#exec called on incompatible receiver")},Ku=ju,Wu=$l,Xu=ue,Qu=f,zu=Co,$u=Bu,Zu=Tn,ed=bl,td=Se,nd=qu,rd=Au,od=M,ad=cu.UNSUPPORTED_Y,id=[].push,sd=Math.min;Ku("split",(function(e,t,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var r=ed(Qu(this)),o=void 0===n?4294967295:n>>>0;if(0===o)return[];if(void 0===e)return[r];if(!Wu(e))return t.call(r,e,o);for(var a,i,s,c=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),u=0,d=new RegExp(e.source,l+"g");(a=rd.call(d,r))&&!((i=d.lastIndex)>u&&(c.push(r.slice(u,a.index)),a.length>1&&a.index<r.length&&id.apply(c,a.slice(1)),s=a[0].length,u=i,c.length>=o));)d.lastIndex===a.index&&d.lastIndex++;return u===r.length?!s&&d.test("")||c.push(""):c.push(r.slice(u)),c.length>o?c.slice(0,o):c}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,n){var o=Qu(this),a=null==t?void 0:td(t,e);return a?a.call(t,o,n):r.call(ed(o),t,n)},function(e,o){var a=Xu(this),i=ed(e),s=n(r,a,i,o,r!==t);if(s.done)return s.value;var c=zu(a,RegExp),l=a.unicode,u=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(ad?"g":"y"),d=new c(ad?"^(?:"+a.source+")":a,u),f=void 0===o?4294967295:o>>>0;if(0===f)return[];if(0===i.length)return null===nd(d,i)?[i]:[];for(var h=0,p=0,v=[];p<i.length;){d.lastIndex=ad?0:p;var y,m=nd(d,ad?i.slice(p):i);if(null===m||(y=sd(Zu(d.lastIndex+(ad?p:0)),i.length))===h)p=$u(i,p,l);else{if(v.push(i.slice(h,p)),v.length===f)return v;for(var g=1;g<=m.length-1;g++)if(v.push(m[g]),v.length===f)return v;p=h=y}}return v.push(i.slice(h)),v}]}),!!od((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),ad);var cd={exports:{}};
/*!
	    localForage -- Offline Storage, Improved
	    Version 1.10.0
	    https://localforage.github.io/localForage
	    (c) 2013-2017 Mozilla, Apache License 2.0
	*/cd.exports=function e(n,r,o){function a(s,c){if(!r[s]){if(!n[s]){if(!c&&t)return t(s);if(i)return i(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[s]={exports:{}};n[s][0].call(u.exports,(function(e){var t=n[s][1][e];return a(t||e)}),u,u.exports,e,n,r,o)}return r[s].exports}for(var i=t,s=0;s<o.length;s++)a(o[s]);return a}({1:[function(t,n,r){(function(e){var t,r,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var a=0,i=new o(u),s=e.document.createTextNode("");i.observe(s,{characterData:!0}),t=function(){s.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)t="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var c=new e.MessageChannel;c.port1.onmessage=u,t=function(){c.port2.postMessage(0)}}var l=[];function u(){var e,t;r=!0;for(var n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}r=!1}n.exports=function(e){1!==l.push(e)||r||t()}}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){var r=e(1);function o(){}var a={},i=["REJECTED"],s=["FULFILLED"],c=["PENDING"];function l(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==o&&h(this,e)}function u(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(e,t,n){r((function(){var r;try{r=t(n)}catch(t){return a.reject(e,t)}r===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,r)}))}function f(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var n=!1;function r(t){n||(n=!0,a.reject(e,t))}function o(t){n||(n=!0,a.resolve(e,t))}var i=p((function(){t(o,r)}));"error"===i.status&&r(i.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}t.exports=l,l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===i)return this;var n=new this.constructor(o);return this.state!==c?d(n,this.state===s?e:t,this.outcome):this.queue.push(new u(n,e,t)),n},u.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){a.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},a.resolve=function(e,t){var n=p(f,t);if("error"===n.status)return a.reject(e,n.value);var r=n.value;if(r)h(e,r);else{e.state=s,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},a.reject=function(e,t){e.state=i,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},l.resolve=function(e){return e instanceof this?e:a.resolve(new this(o),e)},l.reject=function(e){var t=new this(o);return a.reject(t,e)},l.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var i=new Array(n),s=0,c=-1,l=new this(o);++c<n;)u(e[c],c);return l;function u(e,o){t.resolve(e).then((function(e){i[o]=e,++s!==n||r||(r=!0,a.resolve(l,i))}),(function(e){r||(r=!0,a.reject(l,e))}))}},l.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var i,s=-1,c=new this(o);++s<n;)i=e[s],t.resolve(i).then((function(e){r||(r=!0,a.resolve(c,e))}),(function(e){r||(r=!0,a.reject(c,e))}));return c}},{1:1}],3:[function(t,n,r){(function(e){"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function a(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var i=Promise;function s(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function c(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function l(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function u(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var d=void 0,f={},h=Object.prototype.toString;function p(e){return"boolean"==typeof d?i.resolve(d):function(e){return new i((function(t){var n=e.transaction("local-forage-detect-blob-support","readwrite"),r=a([""]);n.objectStore("local-forage-detect-blob-support").put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}(e).then((function(e){return d=e}))}function v(e){var t=f[e.name],n={};n.promise=new i((function(e,t){n.resolve=e,n.reject=t})),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then((function(){return n.promise})):t.dbReady=n.promise}function y(e){var t=f[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function m(e,t){var n=f[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function g(e,t){return new i((function(n,r){if(f[e.name]=f[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return n(e.db);v(e),e.db.close()}var a=[e.name];t&&a.push(e.version);var i=o.open.apply(o,a);t&&(i.onupgradeneeded=function(t){var n=i.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore("local-forage-detect-blob-support")}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),i.onerror=function(e){e.preventDefault(),r(i.error)},i.onsuccess=function(){var t=i.result;t.onversionchange=function(e){e.target.close()},n(t),y(e)}}))}function S(e){return g(e,!1)}function b(e){return g(e,!0)}function N(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,o=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||n){if(n){var a=e.db.version+1;a>e.version&&(e.version=a)}return!0}return!1}function T(e){return a([function(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}(atob(e.data))],{type:e.type})}function E(e){return e&&e.__local_forage_encoded_blob}function w(e){var t=this,n=t._initReady().then((function(){var e=f[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return c(n,e,e),n}function _(e,t,n,r){void 0===r&&(r=1);try{var o=e.db.transaction(e.storeName,t);n(null,o)}catch(o){if(r>0&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return i.resolve().then((function(){if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),b(e)})).then((function(){return function(e){v(e);for(var t=f[e.name],n=t.forages,r=0;r<n.length;r++){var o=n[r];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return e.db=null,S(e).then((function(t){return e.db=t,N(e)?b(e):t})).then((function(r){e.db=t.db=r;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=r})).catch((function(t){throw m(e,t),t}))}(e).then((function(){_(e,t,n,r-1)}))})).catch(n);n(o)}}var O={_driver:"asyncStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var o=f[n.name];o||(o={forages:[],db:null,dbReady:null,deferredOperations:[]},f[n.name]=o),o.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=w);var a=[];function s(){return i.resolve()}for(var c=0;c<o.forages.length;c++){var l=o.forages[c];l!==t&&a.push(l._initReady().catch(s))}var u=o.forages.slice(0);return i.all(a).then((function(){return n.db=o.db,S(n)})).then((function(e){return n.db=e,N(n,t._defaultConfig.version)?b(n):e})).then((function(e){n.db=o.db=e,t._dbInfo=n;for(var r=0;r<u.length;r++){var a=u[r];a!==t&&(a._dbInfo.db=n.db,a._dbInfo.version=n.version)}}))},_support:function(){try{if(!o||!o.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var n=this,r=new i((function(t,r){n.ready().then((function(){_(n._dbInfo,"readonly",(function(o,a){if(o)return r(o);try{var i=a.objectStore(n._dbInfo.storeName).openCursor(),s=1;i.onsuccess=function(){var n=i.result;if(n){var r=n.value;E(r)&&(r=T(r));var o=e(r,n.key,s++);void 0!==o?t(o):n.continue()}else t()},i.onerror=function(){r(i.error)}}catch(e){r(e)}}))})).catch(r)}));return s(r,t),r},getItem:function(e,t){var n=this;e=l(e);var r=new i((function(t,r){n.ready().then((function(){_(n._dbInfo,"readonly",(function(o,a){if(o)return r(o);try{var i=a.objectStore(n._dbInfo.storeName).get(e);i.onsuccess=function(){var e=i.result;void 0===e&&(e=null),E(e)&&(e=T(e)),t(e)},i.onerror=function(){r(i.error)}}catch(e){r(e)}}))})).catch(r)}));return s(r,t),r},setItem:function(e,t,n){var r=this;e=l(e);var o=new i((function(n,o){var a;r.ready().then((function(){return a=r._dbInfo,"[object Blob]"===h.call(t)?p(a.db).then((function(e){return e?t:(n=t,new i((function(e,t){var r=new FileReader;r.onerror=t,r.onloadend=function(t){var r=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:r,type:n.type})},r.readAsBinaryString(n)})));var n})):t})).then((function(t){_(r._dbInfo,"readwrite",(function(a,i){if(a)return o(a);try{var s=i.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var c=s.put(t,e);i.oncomplete=function(){void 0===t&&(t=null),n(t)},i.onabort=i.onerror=function(){var e=c.error?c.error:c.transaction.error;o(e)}}catch(e){o(e)}}))})).catch(o)}));return s(o,n),o},removeItem:function(e,t){var n=this;e=l(e);var r=new i((function(t,r){n.ready().then((function(){_(n._dbInfo,"readwrite",(function(o,a){if(o)return r(o);try{var i=a.objectStore(n._dbInfo.storeName).delete(e);a.oncomplete=function(){t()},a.onerror=function(){r(i.error)},a.onabort=function(){var e=i.error?i.error:i.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return s(r,t),r},clear:function(e){var t=this,n=new i((function(e,n){t.ready().then((function(){_(t._dbInfo,"readwrite",(function(r,o){if(r)return n(r);try{var a=o.objectStore(t._dbInfo.storeName).clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=a.error?a.error:a.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return s(n,e),n},length:function(e){var t=this,n=new i((function(e,n){t.ready().then((function(){_(t._dbInfo,"readonly",(function(r,o){if(r)return n(r);try{var a=o.objectStore(t._dbInfo.storeName).count();a.onsuccess=function(){e(a.result)},a.onerror=function(){n(a.error)}}catch(e){n(e)}}))})).catch(n)}));return s(n,e),n},key:function(e,t){var n=this,r=new i((function(t,r){e<0?t(null):n.ready().then((function(){_(n._dbInfo,"readonly",(function(o,a){if(o)return r(o);try{var i=a.objectStore(n._dbInfo.storeName),s=!1,c=i.openKeyCursor();c.onsuccess=function(){var n=c.result;n?0===e||s?t(n.key):(s=!0,n.advance(e)):t(null)},c.onerror=function(){r(c.error)}}catch(e){r(e)}}))})).catch(r)}));return s(r,t),r},keys:function(e){var t=this,n=new i((function(e,n){t.ready().then((function(){_(t._dbInfo,"readonly",(function(r,o){if(r)return n(r);try{var a=o.objectStore(t._dbInfo.storeName).openKeyCursor(),i=[];a.onsuccess=function(){var t=a.result;t?(i.push(t.key),t.continue()):e(i)},a.onerror=function(){n(a.error)}}catch(e){n(e)}}))})).catch(n)}));return s(n,e),n},dropInstance:function(e,t){t=u.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,a=this;if(e.name){var c=e.name===n.name&&a._dbInfo.db,l=c?i.resolve(a._dbInfo.db):S(e).then((function(t){var n=f[e.name],r=n.forages;n.db=t;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=t;return t}));r=e.storeName?l.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;v(e);var r=f[e.name],a=r.forages;t.close();for(var s=0;s<a.length;s++){var c=a[s];c._dbInfo.db=null,c._dbInfo.version=n}return new i((function(t,r){var a=o.open(e.name,n);a.onerror=function(e){a.result.close(),r(e)},a.onupgradeneeded=function(){a.result.deleteObjectStore(e.storeName)},a.onsuccess=function(){var e=a.result;e.close(),t(e)}})).then((function(e){r.db=e;for(var t=0;t<a.length;t++){var n=a[t];n._dbInfo.db=e,y(n._dbInfo)}})).catch((function(t){throw(m(e,t)||i.resolve()).catch((function(){})),t}))}})):l.then((function(t){v(e);var n=f[e.name],r=n.forages;t.close();for(var a=0;a<r.length;a++)r[a]._dbInfo.db=null;return new i((function(t,n){var r=o.deleteDatabase(e.name);r.onerror=function(){var e=r.result;e&&e.close(),n(r.error)},r.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}})).then((function(e){n.db=e;for(var t=0;t<r.length;t++)y(r[t]._dbInfo)})).catch((function(t){throw(m(e,t)||i.resolve()).catch((function(){})),t}))}))}else r=i.reject("Invalid arguments");return s(r,t),r}},I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",R=/^~~local_forage_type~([^~]+)~/,x="__lfsc__:".length,C=x+"arbf".length,A=Object.prototype.toString;function k(e){var t,n,r,o,a,i=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);var l=new ArrayBuffer(i),u=new Uint8Array(l);for(t=0;t<s;t+=4)n=I.indexOf(e[t]),r=I.indexOf(e[t+1]),o=I.indexOf(e[t+2]),a=I.indexOf(e[t+3]),u[c++]=n<<2|r>>4,u[c++]=(15&r)<<4|o>>2,u[c++]=(3&o)<<6|63&a;return l}function L(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=I[n[t]>>2],r+=I[(3&n[t])<<4|n[t+1]>>4],r+=I[(15&n[t+1])<<2|n[t+2]>>6],r+=I[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var M={serialize:function(e,t){var n="";if(e&&(n=A.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===A.call(e.buffer))){var r,o="__lfsc__:";e instanceof ArrayBuffer?(r=e,o+="arbf"):(r=e.buffer,"[object Int8Array]"===n?o+="si08":"[object Uint8Array]"===n?o+="ui08":"[object Uint8ClampedArray]"===n?o+="uic8":"[object Int16Array]"===n?o+="si16":"[object Uint16Array]"===n?o+="ur16":"[object Int32Array]"===n?o+="si32":"[object Uint32Array]"===n?o+="ui32":"[object Float32Array]"===n?o+="fl32":"[object Float64Array]"===n?o+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(o+L(r))}else if("[object Blob]"===n){var a=new FileReader;a.onload=function(){var n="~~local_forage_type~"+e.type+"~"+L(this.result);t("__lfsc__:blob"+n)},a.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}},deserialize:function(e){if("__lfsc__:"!==e.substring(0,x))return JSON.parse(e);var t,n=e.substring(C),r=e.substring(x,C);if("blob"===r&&R.test(n)){var o=n.match(R);t=o[1],n=n.substring(o[0].length)}var i=k(n);switch(r){case"arbf":return i;case"blob":return a([i],{type:t});case"si08":return new Int8Array(i);case"ui08":return new Uint8Array(i);case"uic8":return new Uint8ClampedArray(i);case"si16":return new Int16Array(i);case"ur16":return new Uint16Array(i);case"si32":return new Int32Array(i);case"ui32":return new Uint32Array(i);case"fl32":return new Float32Array(i);case"fl64":return new Float64Array(i);default:throw new Error("Unkown type: "+r)}},stringToBuffer:k,bufferToString:L};function P(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function H(e,t,n,r,o,a){e.executeSql(n,r,o,(function(e,i){i.code===i.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,s){s.rows.length?a(e,i):P(e,t,(function(){e.executeSql(n,r,o,a)}),a)}),a):a(e,i)}),a)}function D(e,t,n,r){var o=this;e=l(e);var a=new i((function(a,i){o.ready().then((function(){void 0===t&&(t=null);var s=t,c=o._dbInfo;c.serializer.serialize(t,(function(t,l){l?i(l):c.db.transaction((function(n){H(n,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){a(s)}),(function(e,t){i(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void a(D.apply(o,[e,s,n,r-1]));i(t)}}))}))})).catch(i)}));return s(a,n),a}function F(e){return new i((function(t,n){e.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,r){for(var o=[],a=0;a<r.rows.length;a++)o.push(r.rows.item(a).name);t({db:e,storeNames:o})}),(function(e,t){n(t)}))}),(function(e){n(e)}))}))}var j={_driver:"webSQLStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var o=new i((function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction((function(o){P(o,n,(function(){t._dbInfo=n,e()}),(function(e,t){r(t)}))}),r)}));return n.serializer=M,o},_support:"function"==typeof openDatabase,iterate:function(e,t){var n=this,r=new i((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){H(n,o,"SELECT * FROM "+o.storeName,[],(function(n,r){for(var a=r.rows,i=a.length,s=0;s<i;s++){var c=a.item(s),l=c.value;if(l&&(l=o.serializer.deserialize(l)),void 0!==(l=e(l,c.key,s+1)))return void t(l)}t()}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,t),r},getItem:function(e,t){var n=this;e=l(e);var r=new i((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){H(n,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=o.serializer.deserialize(r)),t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,t),r},setItem:function(e,t,n){return D.apply(this,[e,t,n,1])},removeItem:function(e,t){var n=this;e=l(e);var r=new i((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){H(n,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,t),r},clear:function(e){var t=this,n=new i((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){H(t,r,"DELETE FROM "+r.storeName,[],(function(){e()}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,e),n},length:function(e){var t=this,n=new i((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){H(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(t,n){var r=n.rows.item(0).c;e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,e),n},key:function(e,t){var n=this,r=new i((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){H(n,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,t),r},keys:function(e){var t=this,n=new i((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){H(t,r,"SELECT key FROM "+r.storeName,[],(function(t,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).key);e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,e),n},dropInstance:function(e,t){t=u.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,o=this;return s(r=e.name?new i((function(t){var r;r=e.name===n.name?o._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:r,storeNames:[e.storeName]}):t(F(r))})).then((function(e){return new i((function(t,n){e.db.transaction((function(r){function o(e){return new i((function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){n(t)}))}))}for(var a=[],s=0,c=e.storeNames.length;s<c;s++)a.push(o(e.storeNames[s]));i.all(a).then((function(){t()})).catch((function(e){n(e)}))}),(function(e){n(e)}))}))})):i.reject("Invalid arguments"),t),r}};function U(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function B(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(e){return!0}}()||localStorage.length>0}var Y={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var n in e)t[n]=e[n];return t.keyPrefix=U(e,this._defaultConfig),B()?(this._dbInfo=t,t.serializer=M,i.resolve()):i.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var n=this,r=n.ready().then((function(){for(var t=n._dbInfo,r=t.keyPrefix,o=r.length,a=localStorage.length,i=1,s=0;s<a;s++){var c=localStorage.key(s);if(0===c.indexOf(r)){var l=localStorage.getItem(c);if(l&&(l=t.serializer.deserialize(l)),void 0!==(l=e(l,c.substring(o),i++)))return l}}}));return s(r,t),r},getItem:function(e,t){var n=this;e=l(e);var r=n.ready().then((function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r}));return s(r,t),r},setItem:function(e,t,n){var r=this;e=l(e);var o=r.ready().then((function(){void 0===t&&(t=null);var n=t;return new i((function(o,a){var i=r._dbInfo;i.serializer.serialize(t,(function(t,r){if(r)a(r);else try{localStorage.setItem(i.keyPrefix+e,t),o(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||a(e),a(e)}}))}))}));return s(o,n),o},removeItem:function(e,t){var n=this;e=l(e);var r=n.ready().then((function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return s(r,t),r},clear:function(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return s(n,e),n},length:function(e){var t=this.keys().then((function(e){return e.length}));return s(t,e),t},key:function(e,t){var n=this,r=n.ready().then((function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t}));return s(r,t),r},keys:function(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo,n=localStorage.length,r=[],o=0;o<n;o++){var a=localStorage.key(o);0===a.indexOf(e.keyPrefix)&&r.push(a.substring(e.keyPrefix.length))}return r}));return s(n,e),n},dropInstance:function(e,t){if(t=u.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,o=this;return s(r=e.name?new i((function(t){e.storeName?t(U(e,o._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}})):i.reject("Invalid arguments"),t),r}},V=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},J=function(e,t){for(var n=e.length,r=0;r<n;){if(V(e[r],t))return!0;r++}return!1},G=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},q={},K={},W={INDEXEDDB:O,WEBSQL:j,LOCALSTORAGE:Y},X=[W.INDEXEDDB._driver,W.WEBSQL._driver,W.LOCALSTORAGE._driver],Q=["dropInstance"],z=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Q),$={description:"",driver:X.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Z(e,t){e[t]=function(){var n=arguments;return e.ready().then((function(){return e[t].apply(e,n)}))}}function ee(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(G(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var te=new(function(){function e(t){for(var n in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),W)if(W.hasOwnProperty(n)){var r=W[n],o=r._driver;this[n]=o,q[o]||this.defineDriver(r)}this._defaultConfig=ee({},$),this._config=ee({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":r(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new i((function(t,n){try{var r=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(o);for(var a=z.concat("_initStorage"),c=0,l=a.length;c<l;c++){var u=a[c];if((!J(Q,u)||e[u])&&"function"!=typeof e[u])return void n(o)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=i.reject(t);return s(n,arguments[arguments.length-1]),n}},n=0,r=Q.length;n<r;n++){var o=Q[n];e[o]||(e[o]=t(o))}}();var d=function(n){q[r]&&console.info("Redefining LocalForage driver: "+r),q[r]=e,K[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(d,n):d(!!e._support):d(!0)}catch(e){n(e)}}));return c(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=q[e]?i.resolve(q[e]):i.reject(new Error("Driver not found."));return c(r,t,n),r},e.prototype.getSerializer=function(e){var t=i.resolve(M);return c(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return c(n,e,e),n},e.prototype.setDriver=function(e,t,n){var r=this;G(e)||(e=[e]);var o=this._getSupportedDrivers(e);function a(){r._config.driver=r.driver()}function s(e){return r._extend(e),a(),r._ready=r._initStorage(r._config),r._ready}var l=null!==this._driverSet?this._driverSet.catch((function(){return i.resolve()})):i.resolve();return this._driverSet=l.then((function(){var e=o[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then((function(e){r._driver=e._driver,a(),r._wrapLibraryMethodsWithReady(),r._initDriver=function(e){return function(){var t=0;return function n(){for(;t<e.length;){var o=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(o).then(s).catch(n)}a();var c=new Error("No available storage method found.");return r._driverSet=i.reject(c),r._driverSet}()}}(o)}))})).catch((function(){a();var e=new Error("No available storage method found.");return r._driverSet=i.reject(e),r._driverSet})),c(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!K[e]},e.prototype._extend=function(e){ee(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n];this.supports(o)&&t.push(o)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=z.length;e<t;e++)Z(this,z[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=te},{3:3}]},{},[4])(4);var ld=cd.exports;function ud(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fd(e,t,n){return t&&dd(e.prototype,t),n&&dd(e,n),e}function hd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pd(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}function vd(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}var yd=function(){function e(){ud(this,e),hd(this,"route",null),hd(this,"view",void 0),hd(this,"title","untitled"),hd(this,"handle",void 0),hd(this,"app",void 0)}return fd(e,[{key:"initialise",value:function(){this.view.initialise()}},{key:"registerRoute",value:function(e){if(null===this.route)throw new Error("No route set for '".concat(this.title,"' controller."));console.log({route:this.route}),e.on(this.route,this.routeHandler.bind(this),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null})}},{key:"routeHandler",value:function(e,t){}}],[{key:"nextHandle",get:function(){var t,n,r;return function(e,t,n,r){vd(e,t),pd(n,"set"),function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,n,r)}(e,e,md,(r=md,vd(n=e,e),pd(r,"get"),1+(t=+function(e,t){return t.get?t.get.call(e):t.value}(n,r)))),t}}]),e}(),md={writable:!0,value:0},gd="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Sd(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var bd=function(e){return e&&e.Math==Math&&e},Nd=bd("object"==typeof globalThis&&globalThis)||bd("object"==typeof window&&window)||bd("object"==typeof self&&self)||bd("object"==typeof gd&&gd)||function(){return this}()||Function("return this")(),Td={},Ed=function(e){try{return!!e()}catch(e){return!0}},wd=!Ed((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),_d={},Od={}.propertyIsEnumerable,Id=Object.getOwnPropertyDescriptor,Rd=Id&&!Od.call({1:2},1);_d.f=Rd?function(e){var t=Id(this,e);return!!t&&t.enumerable}:Od;var xd,Cd,Ad=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},kd={}.toString,Ld=function(e){return kd.call(e).slice(8,-1)},Md=Ld,Pd="".split,Hd=Ed((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==Md(e)?Pd.call(e,""):Object(e)}:Object,Dd=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},Fd=Hd,jd=Dd,Ud=function(e){return Fd(jd(e))},Bd=function(e){return"function"==typeof e},Yd=Bd,Vd=function(e){return"object"==typeof e?null!==e:Yd(e)},Jd=Nd,Gd=Bd,qd=function(e){return Gd(e)?e:void 0},Kd=function(e,t){return arguments.length<2?qd(Jd[e]):Jd[e]&&Jd[e][t]},Wd=Kd("navigator","userAgent")||"",Xd=Nd,Qd=Wd,zd=Xd.process,$d=Xd.Deno,Zd=zd&&zd.versions||$d&&$d.version,ef=Zd&&Zd.v8;ef?Cd=(xd=ef.split("."))[0]<4?1:xd[0]+xd[1]:Qd&&(!(xd=Qd.match(/Edge\/(\d+)/))||xd[1]>=74)&&(xd=Qd.match(/Chrome\/(\d+)/))&&(Cd=xd[1]);var tf=Cd&&+Cd,nf=tf,rf=Ed,of=!!Object.getOwnPropertySymbols&&!rf((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&nf&&nf<41})),af=of&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,sf=Bd,cf=Kd,lf=af?function(e){return"symbol"==typeof e}:function(e){var t=cf("Symbol");return sf(t)&&Object(e)instanceof t},uf=function(e){try{return String(e)}catch(e){return"Object"}},df=Bd,ff=uf,hf=function(e){if(df(e))return e;throw TypeError(ff(e)+" is not a function")},pf=hf,vf=function(e,t){var n=e[t];return null==n?void 0:pf(n)},yf=Bd,mf=Vd,gf={exports:{}},Sf=Nd,bf=function(e,t){try{Object.defineProperty(Sf,e,{value:t,configurable:!0,writable:!0})}catch(n){Sf[e]=t}return t},Nf=bf,Tf=Nd["__core-js_shared__"]||Nf("__core-js_shared__",{}),Ef=Tf;(gf.exports=function(e,t){return Ef[e]||(Ef[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.18.2",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"});var wf=Dd,_f=function(e){return Object(wf(e))},Of=_f,If={}.hasOwnProperty,Rf=Object.hasOwn||function(e,t){return If.call(Of(e),t)},xf=0,Cf=Math.random(),Af=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++xf+Cf).toString(36)},kf=Nd,Lf=gf.exports,Mf=Rf,Pf=Af,Hf=of,Df=af,Ff=Lf("wks"),jf=kf.Symbol,Uf=Df?jf:jf&&jf.withoutSetter||Pf,Bf=function(e){return Mf(Ff,e)&&(Hf||"string"==typeof Ff[e])||(Hf&&Mf(jf,e)?Ff[e]=jf[e]:Ff[e]=Uf("Symbol."+e)),Ff[e]},Yf=Vd,Vf=lf,Jf=vf,Gf=Bf("toPrimitive"),qf=function(e,t){if(!Yf(e)||Vf(e))return e;var n,r=Jf(e,Gf);if(r){if(void 0===t&&(t="default"),n=r.call(e,t),!Yf(n)||Vf(n))return n;throw TypeError("Can't convert object to primitive value")}return void 0===t&&(t="number"),function(e,t){var n,r;if("string"===t&&yf(n=e.toString)&&!mf(r=n.call(e)))return r;if(yf(n=e.valueOf)&&!mf(r=n.call(e)))return r;if("string"!==t&&yf(n=e.toString)&&!mf(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}(e,t)},Kf=lf,Wf=function(e){var t=qf(e,"string");return Kf(t)?t:String(t)},Xf=Vd,Qf=Nd.document,zf=Xf(Qf)&&Xf(Qf.createElement),$f=function(e){return zf?Qf.createElement(e):{}},Zf=$f,eh=!wd&&!Ed((function(){return 7!=Object.defineProperty(Zf("div"),"a",{get:function(){return 7}}).a})),th=wd,nh=_d,rh=Ad,oh=Ud,ah=Wf,ih=Rf,sh=eh,ch=Object.getOwnPropertyDescriptor;Td.f=th?ch:function(e,t){if(e=oh(e),t=ah(t),sh)try{return ch(e,t)}catch(e){}if(ih(e,t))return rh(!nh.f.call(e,t),e[t])};var lh={},uh=Vd,dh=function(e){if(uh(e))return e;throw TypeError(String(e)+" is not an object")},fh=wd,hh=eh,ph=dh,vh=Wf,yh=Object.defineProperty;lh.f=fh?yh:function(e,t,n){if(ph(e),t=vh(t),ph(n),hh)try{return yh(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var mh=lh,gh=Ad,Sh=wd?function(e,t,n){return mh.f(e,t,gh(1,n))}:function(e,t,n){return e[t]=n,e},bh={exports:{}},Nh=Bd,Th=Tf,Eh=Function.toString;Nh(Th.inspectSource)||(Th.inspectSource=function(e){return Eh.call(e)});var wh,_h,Oh,Ih=Th.inspectSource,Rh=Bd,xh=Ih,Ch=Nd.WeakMap,Ah=Rh(Ch)&&/native code/.test(xh(Ch)),kh=gf.exports,Lh=Af,Mh=kh("keys"),Ph=function(e){return Mh[e]||(Mh[e]=Lh(e))},Hh={},Dh=Ah,Fh=Vd,jh=Sh,Uh=Rf,Bh=Tf,Yh=Ph,Vh=Hh,Jh=Nd.WeakMap;if(Dh||Bh.state){var Gh=Bh.state||(Bh.state=new Jh),qh=Gh.get,Kh=Gh.has,Wh=Gh.set;wh=function(e,t){if(Kh.call(Gh,e))throw new TypeError("Object already initialized");return t.facade=e,Wh.call(Gh,e,t),t},_h=function(e){return qh.call(Gh,e)||{}},Oh=function(e){return Kh.call(Gh,e)}}else{var Xh=Yh("state");Vh[Xh]=!0,wh=function(e,t){if(Uh(e,Xh))throw new TypeError("Object already initialized");return t.facade=e,jh(e,Xh,t),t},_h=function(e){return Uh(e,Xh)?e[Xh]:{}},Oh=function(e){return Uh(e,Xh)}}var Qh={set:wh,get:_h,has:Oh,enforce:function(e){return Oh(e)?_h(e):wh(e,{})},getterFor:function(e){return function(t){var n;if(!Fh(t)||(n=_h(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},zh=wd,$h=Rf,Zh=Function.prototype,ep=zh&&Object.getOwnPropertyDescriptor,tp=$h(Zh,"name"),np={EXISTS:tp,PROPER:tp&&"something"===function(){}.name,CONFIGURABLE:tp&&(!zh||zh&&ep(Zh,"name").configurable)},rp=Nd,op=Bd,ap=Rf,ip=Sh,sp=bf,cp=Ih,lp=np.CONFIGURABLE,up=Qh.get,dp=Qh.enforce,fp=String(String).split("String");(bh.exports=function(e,t,n,r){var o,a=!!r&&!!r.unsafe,i=!!r&&!!r.enumerable,s=!!r&&!!r.noTargetGet,c=r&&void 0!==r.name?r.name:t;op(n)&&("Symbol("===String(c).slice(0,7)&&(c="["+String(c).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!ap(n,"name")||lp&&n.name!==c)&&ip(n,"name",c),(o=dp(n)).source||(o.source=fp.join("string"==typeof c?c:""))),e!==rp?(a?!s&&e[t]&&(i=!0):delete e[t],i?e[t]=n:ip(e,t,n)):i?e[t]=n:sp(t,n)})(Function.prototype,"toString",(function(){return op(this)&&up(this).source||cp(this)}));var hp={},pp=Math.ceil,vp=Math.floor,yp=function(e){var t=+e;return t!=t||0===t?0:(t>0?vp:pp)(t)},mp=yp,gp=Math.max,Sp=Math.min,bp=function(e,t){var n=mp(e);return n<0?gp(n+t,0):Sp(n,t)},Np=yp,Tp=Math.min,Ep=function(e){return e>0?Tp(Np(e),9007199254740991):0},wp=Ep,_p=function(e){return wp(e.length)},Op=Ud,Ip=bp,Rp=_p,xp=function(e){return function(t,n,r){var o,a=Op(t),i=Rp(a),s=Ip(r,i);if(e&&n!=n){for(;i>s;)if((o=a[s++])!=o)return!0}else for(;i>s;s++)if((e||s in a)&&a[s]===n)return e||s||0;return!e&&-1}},Cp={includes:xp(!0),indexOf:xp(!1)},Ap=Rf,kp=Ud,Lp=Cp.indexOf,Mp=Hh,Pp=function(e,t){var n,r=kp(e),o=0,a=[];for(n in r)!Ap(Mp,n)&&Ap(r,n)&&a.push(n);for(;t.length>o;)Ap(r,n=t[o++])&&(~Lp(a,n)||a.push(n));return a},Hp=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Dp=Pp,Fp=Hp.concat("length","prototype");hp.f=Object.getOwnPropertyNames||function(e){return Dp(e,Fp)};var jp={};jp.f=Object.getOwnPropertySymbols;var Up=hp,Bp=jp,Yp=dh,Vp=Kd("Reflect","ownKeys")||function(e){var t=Up.f(Yp(e)),n=Bp.f;return n?t.concat(n(e)):t},Jp=Rf,Gp=Vp,qp=Td,Kp=lh,Wp=function(e,t){for(var n=Gp(t),r=Kp.f,o=qp.f,a=0;a<n.length;a++){var i=n[a];Jp(e,i)||r(e,i,o(t,i))}},Xp=Ed,Qp=Bd,zp=/#|\.prototype\./,$p=function(e,t){var n=ev[Zp(e)];return n==nv||n!=tv&&(Qp(t)?Xp(t):!!t)},Zp=$p.normalize=function(e){return String(e).replace(zp,".").toLowerCase()},ev=$p.data={},tv=$p.NATIVE="N",nv=$p.POLYFILL="P",rv=$p,ov=Nd,av=Td.f,iv=Sh,sv=bh.exports,cv=bf,lv=Wp,uv=rv,dv=function(e,t){var n,r,o,a,i,s=e.target,c=e.global,l=e.stat;if(n=c?ov:l?ov[s]||cv(s,{}):(ov[s]||{}).prototype)for(r in t){if(a=t[r],o=e.noTargetGet?(i=av(n,r))&&i.value:n[r],!uv(c?r:s+(l?".":"#")+r,e.forced)&&void 0!==o){if(typeof a==typeof o)continue;lv(a,o)}(e.sham||o&&o.sham)&&iv(a,"sham",!0),sv(n,r,a,e)}},fv={};fv[Bf("toStringTag")]="z";var hv,pv="[object z]"===String(fv),vv=pv,yv=Bd,mv=Ld,gv=Bf("toStringTag"),Sv="Arguments"==mv(function(){return arguments}()),bv=vv?mv:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),gv))?n:Sv?mv(t):"Object"==(r=mv(t))&&yv(t.callee)?"Arguments":r},Nv=Ed,Tv=Bd,Ev=bv,wv=Ih,_v=[],Ov=Kd("Reflect","construct"),Iv=/^\s*(?:class|function)\b/,Rv=Iv.exec,xv=!Iv.exec((function(){})),Cv=function(e){if(!Tv(e))return!1;try{return Ov(Object,_v,e),!0}catch(e){return!1}},Av=!Ov||Nv((function(){var e;return Cv(Cv.call)||!Cv(Object)||!Cv((function(){e=!0}))||e}))?function(e){if(!Tv(e))return!1;switch(Ev(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}return xv||!!Rv.call(Iv,wv(e))}:Cv,kv=Av,Lv=uf,Mv=function(e){if(kv(e))return e;throw TypeError(Lv(e)+" is not a constructor")},Pv=Pp,Hv=Hp,Dv=Object.keys||function(e){return Pv(e,Hv)},Fv=lh,jv=dh,Uv=Dv,Bv=wd?Object.defineProperties:function(e,t){jv(e);for(var n,r=Uv(t),o=r.length,a=0;o>a;)Fv.f(e,n=r[a++],t[n]);return e},Yv=Kd("document","documentElement"),Vv=dh,Jv=Bv,Gv=Hp,qv=Hh,Kv=Yv,Wv=$f,Xv=Ph("IE_PROTO"),Qv=function(){},zv=function(e){return"<script>"+e+"<\/script>"},$v=function(e){e.write(zv("")),e.close();var t=e.parentWindow.Object;return e=null,t},Zv=function(){try{hv=new ActiveXObject("htmlfile")}catch(e){}var e,t;Zv="undefined"!=typeof document?document.domain&&hv?$v(hv):((t=Wv("iframe")).style.display="none",Kv.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(zv("document.F=Object")),e.close(),e.F):$v(hv);for(var n=Gv.length;n--;)delete Zv.prototype[Gv[n]];return Zv()};qv[Xv]=!0;var ey=Object.create||function(e,t){var n;return null!==e?(Qv.prototype=Vv(e),n=new Qv,Qv.prototype=null,n[Xv]=e):n=Zv(),void 0===t?n:Jv(n,t)},ty=hf,ny=Vd,ry=[].slice,oy={},ay=function(e,t,n){if(!(t in oy)){for(var r=[],o=0;o<t;o++)r[o]="a["+o+"]";oy[t]=Function("C,a","return new C("+r.join(",")+")")}return oy[t](e,n)},iy=Function.bind||function(e){var t=ty(this),n=ry.call(arguments,1),r=function(){var o=n.concat(ry.call(arguments));return this instanceof r?ay(t,o.length,o):t.apply(e,o)};return ny(t.prototype)&&(r.prototype=t.prototype),r},sy=dv,cy=Mv,ly=dh,uy=Vd,dy=ey,fy=iy,hy=Ed,py=Kd("Reflect","construct"),vy=hy((function(){function e(){}return!(py((function(){}),[],e)instanceof e)})),yy=!hy((function(){py((function(){}))})),my=vy||yy;function gy(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sy(e,t){return(Sy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function by(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sy(e,t)}function Ny(e){return(Ny="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ty(e,t){if(t&&("object"===Ny(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return gy(e)}function Ey(e){return(Ey=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wy(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function _y(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,wy(e,t,"set"),n),n}function Oy(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,wy(e,t,"get"))}sy({target:"Reflect",stat:!0,forced:my,sham:my},{construct:function(e,t){cy(e),ly(t);var n=arguments.length<3?e:cy(arguments[2]);if(yy&&!vy)return py(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(fy.apply(e,r))}var o=n.prototype,a=dy(uy(o)?o:Object.prototype),i=Function.apply.call(e,a,t);return uy(i)?i:a}});var Iy=ey,Ry=lh,xy=Bf("unscopables"),Cy=Array.prototype;null==Cy[xy]&&Ry.f(Cy,xy,{configurable:!0,value:Iy(null)});var Ay,ky,Ly,My=function(e){Cy[xy][e]=!0},Py={},Hy=!Ed((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Dy=Rf,Fy=Bd,jy=_f,Uy=Hy,By=Ph("IE_PROTO"),Yy=Object.prototype,Vy=Uy?Object.getPrototypeOf:function(e){var t=jy(e);if(Dy(t,By))return t[By];var n=t.constructor;return Fy(n)&&t instanceof n?n.prototype:t instanceof Object?Yy:null},Jy=Ed,Gy=Bd,qy=Vy,Ky=bh.exports,Wy=Bf("iterator"),Xy=!1;[].keys&&("next"in(Ly=[].keys())?(ky=qy(qy(Ly)))!==Object.prototype&&(Ay=ky):Xy=!0),(null==Ay||Jy((function(){var e={};return Ay[Wy].call(e)!==e})))&&(Ay={}),Gy(Ay[Wy])||Ky(Ay,Wy,(function(){return this}));var Qy={IteratorPrototype:Ay,BUGGY_SAFARI_ITERATORS:Xy},zy=lh.f,$y=Rf,Zy=Bf("toStringTag"),em=function(e,t,n){e&&!$y(e=n?e:e.prototype,Zy)&&zy(e,Zy,{configurable:!0,value:t})},tm=Qy.IteratorPrototype,nm=ey,rm=Ad,om=em,am=Py,im=function(){return this},sm=function(e,t,n){var r=t+" Iterator";return e.prototype=nm(tm,{next:rm(1,n)}),om(e,r,!1),am[r]=im,e},cm=Bd,lm=dh,um=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return lm(n),function(e){if("object"==typeof e||cm(e))return e;throw TypeError("Can't set "+String(e)+" as a prototype")}(r),t?e.call(n,r):n.__proto__=r,n}}():void 0),dm=dv,fm=np,hm=Bd,pm=sm,vm=Vy,ym=um,mm=em,gm=Sh,Sm=bh.exports,bm=Py,Nm=fm.PROPER,Tm=fm.CONFIGURABLE,Em=Qy.IteratorPrototype,wm=Qy.BUGGY_SAFARI_ITERATORS,_m=Bf("iterator"),Om=function(){return this},Im=function(e,t,n,r,o,a,i){pm(n,t,r);var s,c,l,u=function(e){if(e===o&&v)return v;if(!wm&&e in h)return h[e];switch(e){case"keys":case"values":case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}},d=t+" Iterator",f=!1,h=e.prototype,p=h[_m]||h["@@iterator"]||o&&h[o],v=!wm&&p||u(o),y="Array"==t&&h.entries||p;if(y&&(s=vm(y.call(new e)))!==Object.prototype&&s.next&&(vm(s)!==Em&&(ym?ym(s,Em):hm(s[_m])||Sm(s,_m,Om)),mm(s,d,!0)),Nm&&"values"==o&&p&&"values"!==p.name&&(Tm?gm(h,"name","values"):(f=!0,v=function(){return p.call(this)})),o)if(c={values:u("values"),keys:a?v:u("keys"),entries:u("entries")},i)for(l in c)(wm||f||!(l in h))&&Sm(h,l,c[l]);else dm({target:t,proto:!0,forced:wm||f},c);return h[_m]!==v&&Sm(h,_m,v,{name:o}),bm[t]=v,c},Rm=Ud,xm=My,Cm=Py,Am=Qh,km=Im,Lm=Am.set,Mm=Am.getterFor("Array Iterator"),Pm=km(Array,"Array",(function(e,t){Lm(this,{type:"Array Iterator",target:Rm(e),index:0,kind:t})}),(function(){var e=Mm(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");Cm.Arguments=Cm.Array,xm("keys"),xm("values"),xm("entries");var Hm=bv,Dm=pv?{}.toString:function(){return"[object "+Hm(this)+"]"},Fm=pv,jm=bh.exports,Um=Dm;Fm||jm(Object.prototype,"toString",Um,{unsafe:!0});var Bm=bv,Ym=function(e){if("Symbol"===Bm(e))throw TypeError("Cannot convert a Symbol value to a string");return String(e)},Vm=yp,Jm=Ym,Gm=Dd,qm=function(e){return function(t,n){var r,o,a=Jm(Gm(t)),i=Vm(n),s=a.length;return i<0||i>=s?e?"":void 0:(r=a.charCodeAt(i))<55296||r>56319||i+1===s||(o=a.charCodeAt(i+1))<56320||o>57343?e?a.charAt(i):r:e?a.slice(i,i+2):o-56320+(r-55296<<10)+65536}},Km={codeAt:qm(!1),charAt:qm(!0)},Wm=Km.charAt,Xm=Ym,Qm=Qh,zm=Im,$m=Qm.set,Zm=Qm.getterFor("String Iterator");zm(String,"String",(function(e){$m(this,{type:"String Iterator",string:Xm(e),index:0})}),(function(){var e,t=Zm(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=Wm(n,r),t.index+=e.length,{value:e,done:!1})}));var eg=bh.exports,tg=function(e,t,n){for(var r in t)eg(e,r,t[r],n);return e},ng={exports:{}},rg={},og=Ud,ag=hp.f,ig={}.toString,sg="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];rg.f=function(e){return sg&&"[object Window]"==ig.call(e)?function(e){try{return ag(e)}catch(e){return sg.slice()}}(e):ag(og(e))};var cg=!Ed((function(){return Object.isExtensible(Object.preventExtensions({}))})),lg=dv,ug=Hh,dg=Vd,fg=Rf,hg=lh.f,pg=hp,vg=rg,yg=cg,mg=!1,gg=Af("meta"),Sg=0,bg=Object.isExtensible||function(){return!0},Ng=function(e){hg(e,gg,{value:{objectID:"O"+Sg++,weakData:{}}})},Tg=ng.exports={enable:function(){Tg.enable=function(){},mg=!0;var e=pg.f,t=[].splice,n={};n[gg]=1,e(n).length&&(pg.f=function(n){for(var r=e(n),o=0,a=r.length;o<a;o++)if(r[o]===gg){t.call(r,o,1);break}return r},lg({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:vg.f}))},fastKey:function(e,t){if(!dg(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!fg(e,gg)){if(!bg(e))return"F";if(!t)return"E";Ng(e)}return e[gg].objectID},getWeakData:function(e,t){if(!fg(e,gg)){if(!bg(e))return!0;if(!t)return!1;Ng(e)}return e[gg].weakData},onFreeze:function(e){return yg&&mg&&bg(e)&&!fg(e,gg)&&Ng(e),e}};ug[gg]=!0;var Eg=Py,wg=Bf("iterator"),_g=Array.prototype,Og=function(e){return void 0!==e&&(Eg.Array===e||_g[wg]===e)},Ig=hf,Rg=function(e,t,n){if(Ig(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}},xg=bv,Cg=vf,Ag=Py,kg=Bf("iterator"),Lg=function(e){if(null!=e)return Cg(e,kg)||Cg(e,"@@iterator")||Ag[xg(e)]},Mg=hf,Pg=dh,Hg=Lg,Dg=function(e,t){var n=arguments.length<2?Hg(e):t;if(Mg(n))return Pg(n.call(e));throw TypeError(String(e)+" is not iterable")},Fg=dh,jg=vf,Ug=function(e,t,n){var r,o;Fg(e);try{if(!(r=jg(e,"return"))){if("throw"===t)throw n;return n}r=r.call(e)}catch(e){o=!0,r=e}if("throw"===t)throw n;if(o)throw r;return Fg(r),n},Bg=dh,Yg=Og,Vg=_p,Jg=Rg,Gg=Dg,qg=Lg,Kg=Ug,Wg=function(e,t){this.stopped=e,this.result=t},Xg=function(e,t,n){var r,o,a,i,s,c,l,u=n&&n.that,d=!(!n||!n.AS_ENTRIES),f=!(!n||!n.IS_ITERATOR),h=!(!n||!n.INTERRUPTED),p=Jg(t,u,1+d+h),v=function(e){return r&&Kg(r,"normal",e),new Wg(!0,e)},y=function(e){return d?(Bg(e),h?p(e[0],e[1],v):p(e[0],e[1])):h?p(e,v):p(e)};if(f)r=e;else{if(!(o=qg(e)))throw TypeError(String(e)+" is not iterable");if(Yg(o)){for(a=0,i=Vg(e);i>a;a++)if((s=y(e[a]))&&s instanceof Wg)return s;return new Wg(!1)}r=Gg(e,o)}for(c=r.next;!(l=c.call(r)).done;){try{s=y(l.value)}catch(e){Kg(r,"throw",e)}if("object"==typeof s&&s&&s instanceof Wg)return s}return new Wg(!1)},Qg=function(e,t,n){if(e instanceof t)return e;throw TypeError("Incorrect "+(n?n+" ":"")+"invocation")},zg=Bf("iterator"),$g=!1;try{var Zg=0,eS={next:function(){return{done:!!Zg++}},return:function(){$g=!0}};eS[zg]=function(){return this},Array.from(eS,(function(){throw 2}))}catch(ud){}var tS=function(e,t){if(!t&&!$g)return!1;var n=!1;try{var r={};r[zg]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n},nS=Bd,rS=Vd,oS=um,aS=function(e,t,n){var r,o;return oS&&nS(r=t.constructor)&&r!==n&&rS(o=r.prototype)&&o!==n.prototype&&oS(e,o),e},iS=dv,sS=Nd,cS=rv,lS=bh.exports,uS=ng.exports,dS=Xg,fS=Qg,hS=Bd,pS=Vd,vS=Ed,yS=tS,mS=em,gS=aS,SS=function(e,t,n){var r=-1!==e.indexOf("Map"),o=-1!==e.indexOf("Weak"),a=r?"set":"add",i=sS[e],s=i&&i.prototype,c=i,l={},u=function(e){var t=s[e];lS(s,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(o&&!pS(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return o&&!pS(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(o&&!pS(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})};if(cS(e,!hS(i)||!(o||s.forEach&&!vS((function(){(new i).entries().next()})))))c=n.getConstructor(t,e,r,a),uS.enable();else if(cS(e,!0)){var d=new c,f=d[a](o?{}:-0,1)!=d,h=vS((function(){d.has(1)})),p=yS((function(e){new i(e)})),v=!o&&vS((function(){for(var e=new i,t=5;t--;)e[a](t,t);return!e.has(-0)}));p||((c=t((function(t,n){fS(t,c,e);var o=gS(new i,t,c);return null!=n&&dS(n,o[a],{that:o,AS_ENTRIES:r}),o}))).prototype=s,s.constructor=c),(h||v)&&(u("delete"),u("has"),r&&u("get")),(v||f)&&u(a),o&&s.clear&&delete s.clear}return l[e]=c,iS({global:!0,forced:c!=i},l),mS(c,e),o||n.setStrong(c,e,r),c},bS=Ld,NS=Array.isArray||function(e){return"Array"==bS(e)},TS=NS,ES=Av,wS=Vd,_S=Bf("species"),OS=function(e,t){return new(function(e){var t;return TS(e)&&(t=e.constructor,(ES(t)&&(t===Array||TS(t.prototype))||wS(t)&&null===(t=t[_S]))&&(t=void 0)),void 0===t?Array:t}(e))(0===t?0:t)},IS=Rg,RS=Hd,xS=_f,CS=_p,AS=OS,kS=[].push,LS=function(e){var t=1==e,n=2==e,r=3==e,o=4==e,a=6==e,i=7==e,s=5==e||a;return function(c,l,u,d){for(var f,h,p=xS(c),v=RS(p),y=IS(l,u,3),m=CS(v),g=0,S=d||AS,b=t?S(c,m):n||i?S(c,0):void 0;m>g;g++)if((s||g in v)&&(h=y(f=v[g],g,p),e))if(t)b[g]=h;else if(h)switch(e){case 3:return!0;case 5:return f;case 6:return g;case 2:kS.call(b,f)}else switch(e){case 4:return!1;case 7:kS.call(b,f)}return a?-1:r||o?o:b}},MS={forEach:LS(0),map:LS(1),filter:LS(2),some:LS(3),every:LS(4),find:LS(5),findIndex:LS(6),filterReject:LS(7)},PS=tg,HS=ng.exports.getWeakData,DS=dh,FS=Vd,jS=Qg,US=Xg,BS=Rf,YS=Qh.set,VS=Qh.getterFor,JS=MS.find,GS=MS.findIndex,qS=0,KS=function(e){return e.frozen||(e.frozen=new WS)},WS=function(){this.entries=[]},XS=function(e,t){return JS(e.entries,(function(e){return e[0]===t}))};WS.prototype={get:function(e){var t=XS(this,e);if(t)return t[1]},has:function(e){return!!XS(this,e)},set:function(e,t){var n=XS(this,e);n?n[1]=t:this.entries.push([e,t])},delete:function(e){var t=GS(this.entries,(function(t){return t[0]===e}));return~t&&this.entries.splice(t,1),!!~t}};var QS,zS={getConstructor:function(e,t,n,r){var o=e((function(e,a){jS(e,o,t),YS(e,{type:t,id:qS++,frozen:void 0}),null!=a&&US(a,e[r],{that:e,AS_ENTRIES:n})})),a=VS(t),i=function(e,t,n){var r=a(e),o=HS(DS(t),!0);return!0===o?KS(r).set(t,n):o[r.id]=n,e};return PS(o.prototype,{delete:function(e){var t=a(this);if(!FS(e))return!1;var n=HS(e);return!0===n?KS(t).delete(e):n&&BS(n,t.id)&&delete n[t.id]},has:function(e){var t=a(this);if(!FS(e))return!1;var n=HS(e);return!0===n?KS(t).has(e):n&&BS(n,t.id)}}),PS(o.prototype,n?{get:function(e){var t=a(this);if(FS(e)){var n=HS(e);return!0===n?KS(t).get(e):n?n[t.id]:void 0}},set:function(e,t){return i(this,e,t)}}:{add:function(e){return i(this,e,!0)}}),o}},$S=Nd,ZS=tg,eb=ng.exports,tb=SS,nb=zS,rb=Vd,ob=Qh.enforce,ab=Ah,ib=!$S.ActiveXObject&&"ActiveXObject"in $S,sb=Object.isExtensible,cb=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},lb=tb("WeakMap",cb,nb);if(ab&&ib){QS=nb.getConstructor(cb,"WeakMap",!0),eb.enable();var ub=lb.prototype,db=ub.delete,fb=ub.has,hb=ub.get,pb=ub.set;ZS(ub,{delete:function(e){if(rb(e)&&!sb(e)){var t=ob(this);return t.frozen||(t.frozen=new QS),db.call(this,e)||t.frozen.delete(e)}return db.call(this,e)},has:function(e){if(rb(e)&&!sb(e)){var t=ob(this);return t.frozen||(t.frozen=new QS),fb.call(this,e)||t.frozen.has(e)}return fb.call(this,e)},get:function(e){if(rb(e)&&!sb(e)){var t=ob(this);return t.frozen||(t.frozen=new QS),fb.call(this,e)?hb.call(this,e):t.frozen.get(e)}return hb.call(this,e)},set:function(e,t){if(rb(e)&&!sb(e)){var n=ob(this);n.frozen||(n.frozen=new QS),fb.call(this,e)?pb.call(this,e,t):n.frozen.set(e,t)}else pb.call(this,e,t);return this}})}var vb={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},yb=$f("span").classList,mb=yb&&yb.constructor&&yb.constructor.prototype,gb=mb===Object.prototype?void 0:mb,Sb=Nd,bb=vb,Nb=gb,Tb=Pm,Eb=Sh,wb=Bf,_b=wb("iterator"),Ob=wb("toStringTag"),Ib=Tb.values,Rb=function(e,t){if(e){if(e[_b]!==Ib)try{Eb(e,_b,Ib)}catch(t){e[_b]=Ib}if(e[Ob]||Eb(e,Ob,t),bb[t])for(var n in Tb)if(e[n]!==Tb[n])try{Eb(e,n,Tb[n])}catch(t){e[n]=Tb[n]}}};for(var xb in bb)Rb(Sb[xb]&&Sb[xb].prototype,xb);function Cb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ab(e,t,n){return(Ab=Cb()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&Sy(o,n.prototype),o}).apply(null,arguments)}function kb(e){var t="function"==typeof Map?new Map:void 0;return(kb=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Ab(e,arguments,Ey(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Sy(r,e)})(e)}Rb(Nb,"DOMTokenList");var Lb=function(e){by(n,kb(Error));var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(e){return ud(this,n),t.call(this,e)}return n}();function Mb(e,t,n){return(Mb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ey(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}var Pb=Wf,Hb=lh,Db=Ad,Fb=function(e,t,n){var r=Pb(t);r in e?Hb.f(e,r,Db(0,n)):e[r]=n},jb=Ed,Ub=tf,Bb=Bf("species"),Yb=function(e){return Ub>=51||!jb((function(){var t=[];return(t.constructor={})[Bb]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Vb=dv,Jb=Ed,Gb=NS,qb=Vd,Kb=_f,Wb=_p,Xb=Fb,Qb=OS,zb=Yb,$b=tf,Zb=Bf("isConcatSpreadable"),eN=$b>=51||!Jb((function(){var e=[];return e[Zb]=!1,e.concat()[0]!==e})),tN=zb("concat"),nN=function(e){if(!qb(e))return!1;var t=e[Zb];return void 0!==t?!!t:Gb(e)};Vb({target:"Array",proto:!0,forced:!eN||!tN},{concat:function(e){var t,n,r,o,a,i=Kb(this),s=Qb(i,0),c=0;for(t=-1,r=arguments.length;t<r;t++)if(nN(a=-1===t?i:arguments[t])){if(c+(o=Wb(a))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<o;n++,c++)n in a&&Xb(s,c,a[n])}else{if(c>=9007199254740991)throw TypeError("Maximum allowed index exceeded");Xb(s,c++,a)}return s.length=c,s}});var rN=dh,oN=function(){var e=rN(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},aN=np.PROPER,iN=bh.exports,sN=dh,cN=Ym,lN=Ed,uN=oN,dN=RegExp.prototype,fN=dN.toString,hN=lN((function(){return"/a/b"!=fN.call({source:"a",flags:"b"})})),pN=aN&&"toString"!=fN.name;(hN||pN)&&iN(RegExp.prototype,"toString",(function(){var e=sN(this),t=cN(e.source),n=e.flags;return"/"+t+"/"+cN(void 0===n&&e instanceof RegExp&&!("flags"in dN)?uN.call(e):n)}),{unsafe:!0});var vN,yN,mN,gN,SN=Nd.Promise,bN=Kd,NN=lh,TN=wd,EN=Bf("species"),wN=function(e){var t=bN(e),n=NN.f;TN&&t&&!t[EN]&&n(t,EN,{configurable:!0,get:function(){return this}})},_N=dh,ON=Mv,IN=Bf("species"),RN=function(e,t){var n,r=_N(e).constructor;return void 0===r||null==(n=_N(r)[IN])?t:ON(n)},xN=/(?:ipad|iphone|ipod).*applewebkit/i.test(Wd),CN="process"==Ld(Nd.process),AN=Nd,kN=Bd,LN=Ed,MN=Rg,PN=Yv,HN=$f,DN=xN,FN=CN,jN=AN.setImmediate,UN=AN.clearImmediate,BN=AN.process,YN=AN.MessageChannel,VN=AN.Dispatch,JN=0,GN={};try{vN=AN.location}catch(ud){}var qN=function(e){if(GN.hasOwnProperty(e)){var t=GN[e];delete GN[e],t()}},KN=function(e){return function(){qN(e)}},WN=function(e){qN(e.data)},XN=function(e){AN.postMessage(String(e),vN.protocol+"//"+vN.host)};jN&&UN||(jN=function(e){for(var t=[],n=arguments.length,r=1;n>r;)t.push(arguments[r++]);return GN[++JN]=function(){(kN(e)?e:Function(e)).apply(void 0,t)},yN(JN),JN},UN=function(e){delete GN[e]},FN?yN=function(e){BN.nextTick(KN(e))}:VN&&VN.now?yN=function(e){VN.now(KN(e))}:YN&&!DN?(gN=(mN=new YN).port2,mN.port1.onmessage=WN,yN=MN(gN.postMessage,gN,1)):AN.addEventListener&&kN(AN.postMessage)&&!AN.importScripts&&vN&&"file:"!==vN.protocol&&!LN(XN)?(yN=XN,AN.addEventListener("message",WN,!1)):yN="onreadystatechange"in HN("script")?function(e){PN.appendChild(HN("script")).onreadystatechange=function(){PN.removeChild(this),qN(e)}}:function(e){setTimeout(KN(e),0)});var QN,zN,$N,ZN,eT,tT,nT,rT,oT={set:jN,clear:UN},aT=Nd,iT=/ipad|iphone|ipod/i.test(Wd)&&void 0!==aT.Pebble,sT=/web0s(?!.*chrome)/i.test(Wd),cT=Nd,lT=Td.f,uT=oT.set,dT=xN,fT=iT,hT=sT,pT=CN,vT=cT.MutationObserver||cT.WebKitMutationObserver,yT=cT.document,mT=cT.process,gT=cT.Promise,ST=lT(cT,"queueMicrotask"),bT=ST&&ST.value;bT||(QN=function(){var e,t;for(pT&&(e=mT.domain)&&e.exit();zN;){t=zN.fn,zN=zN.next;try{t()}catch(e){throw zN?ZN():$N=void 0,e}}$N=void 0,e&&e.enter()},dT||pT||hT||!vT||!yT?!fT&&gT&&gT.resolve?((nT=gT.resolve(void 0)).constructor=gT,rT=nT.then,ZN=function(){rT.call(nT,QN)}):ZN=pT?function(){mT.nextTick(QN)}:function(){uT.call(cT,QN)}:(eT=!0,tT=yT.createTextNode(""),new vT(QN).observe(tT,{characterData:!0}),ZN=function(){tT.data=eT=!eT}));var NT=bT||function(e){var t={fn:e,next:void 0};$N&&($N.next=t),zN||(zN=t,ZN()),$N=t},TT={},ET=hf,wT=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=ET(t),this.reject=ET(n)};TT.f=function(e){return new wT(e)};var _T,OT,IT,RT,xT=dh,CT=Vd,AT=TT,kT=function(e,t){if(xT(e),CT(t)&&t.constructor===e)return t;var n=AT.f(e);return(0,n.resolve)(t),n.promise},LT=Nd,MT="object"==typeof window,PT=dv,HT=Nd,DT=Kd,FT=SN,jT=bh.exports,UT=tg,BT=um,YT=em,VT=wN,JT=hf,GT=Bd,qT=Vd,KT=Qg,WT=Ih,XT=Xg,QT=tS,zT=RN,$T=oT.set,ZT=NT,eE=kT,tE=TT,nE=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},rE=Qh,oE=rv,aE=MT,iE=CN,sE=tf,cE=Bf("species"),lE="Promise",uE=rE.get,dE=rE.set,fE=rE.getterFor(lE),hE=FT&&FT.prototype,pE=FT,vE=hE,yE=HT.TypeError,mE=HT.document,gE=HT.process,SE=tE.f,bE=SE,NE=!!(mE&&mE.createEvent&&HT.dispatchEvent),TE=GT(HT.PromiseRejectionEvent),EE=!1,wE=oE(lE,(function(){var e=WT(pE),t=e!==String(pE);if(!t&&66===sE)return!0;if(sE>=51&&/native code/.test(e))return!1;var n=new pE((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};return(n.constructor={})[cE]=r,!(EE=n.then((function(){}))instanceof r)||!t&&aE&&!TE})),_E=wE||!QT((function(e){pE.all(e).catch((function(){}))})),OE=function(e){var t;return!(!qT(e)||!GT(t=e.then))&&t},IE=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;ZT((function(){for(var r=e.value,o=1==e.state,a=0;n.length>a;){var i,s,c,l=n[a++],u=o?l.ok:l.fail,d=l.resolve,f=l.reject,h=l.domain;try{u?(o||(2===e.rejection&&AE(e),e.rejection=1),!0===u?i=r:(h&&h.enter(),i=u(r),h&&(h.exit(),c=!0)),i===l.promise?f(yE("Promise-chain cycle")):(s=OE(i))?s.call(i,d,f):d(i)):f(r)}catch(e){h&&!c&&h.exit(),f(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&xE(e)}))}},RE=function(e,t,n){var r,o;NE?((r=mE.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),HT.dispatchEvent(r)):r={promise:t,reason:n},!TE&&(o=HT["on"+e])?o(r):"unhandledrejection"===e&&function(e,t){var n=LT.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},xE=function(e){$T.call(HT,(function(){var t,n=e.facade,r=e.value;if(CE(e)&&(t=nE((function(){iE?gE.emit("unhandledRejection",r,n):RE("unhandledrejection",n,r)})),e.rejection=iE||CE(e)?2:1,t.error))throw t.value}))},CE=function(e){return 1!==e.rejection&&!e.parent},AE=function(e){$T.call(HT,(function(){var t=e.facade;iE?gE.emit("rejectionHandled",t):RE("rejectionhandled",t,e.value)}))},kE=function(e,t,n){return function(r){e(t,r,n)}},LE=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,IE(e,!0))},ME=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw yE("Promise can't be resolved itself");var r=OE(t);r?ZT((function(){var n={done:!1};try{r.call(t,kE(ME,n,e),kE(LE,n,e))}catch(t){LE(n,t,e)}})):(e.value=t,e.state=1,IE(e,!1))}catch(t){LE({done:!1},t,e)}}};if(wE&&(vE=(pE=function(e){KT(this,pE,lE),JT(e),_T.call(this);var t=uE(this);try{e(kE(ME,t),kE(LE,t))}catch(e){LE(t,e)}}).prototype,(_T=function(e){dE(this,{type:lE,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=UT(vE,{then:function(e,t){var n=fE(this),r=SE(zT(this,pE));return r.ok=!GT(e)||e,r.fail=GT(t)&&t,r.domain=iE?gE.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&IE(n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),OT=function(){var e=new _T,t=uE(e);this.promise=e,this.resolve=kE(ME,t),this.reject=kE(LE,t)},tE.f=SE=function(e){return e===pE||e===IT?new OT(e):bE(e)},GT(FT)&&hE!==Object.prototype)){RT=hE.then,EE||(jT(hE,"then",(function(e,t){var n=this;return new pE((function(e,t){RT.call(n,e,t)})).then(e,t)}),{unsafe:!0}),jT(hE,"catch",vE.catch,{unsafe:!0}));try{delete hE.constructor}catch(ud){}BT&&BT(hE,vE)}PT({global:!0,wrap:!0,forced:wE},{Promise:pE}),YT(pE,lE,!1),VT(lE),IT=DT(lE),PT({target:lE,stat:!0,forced:wE},{reject:function(e){var t=SE(this);return t.reject.call(void 0,e),t.promise}}),PT({target:lE,stat:!0,forced:wE},{resolve:function(e){return eE(this,e)}}),PT({target:lE,stat:!0,forced:_E},{all:function(e){var t=this,n=SE(t),r=n.resolve,o=n.reject,a=nE((function(){var n=JT(t.resolve),a=[],i=0,s=1;XT(e,(function(e){var c=i++,l=!1;a.push(void 0),s++,n.call(t,e).then((function(e){l||(l=!0,a[c]=e,--s||r(a))}),o)})),--s||r(a)}));return a.error&&o(a.value),n.promise},race:function(e){var t=this,n=SE(t),r=n.reject,o=nE((function(){var o=JT(t.resolve);XT(e,(function(e){o.call(t,e).then(n.resolve,r)}))}));return o.error&&r(o.value),n.promise}});var PE={},HE=Ed,DE=Nd.RegExp;PE.UNSUPPORTED_Y=HE((function(){var e=DE("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),PE.BROKEN_CARET=HE((function(){var e=DE("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));var FE=Ed,jE=Nd.RegExp,UE=FE((function(){var e=jE(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),BE=Ed,YE=Nd.RegExp,VE=BE((function(){var e=YE("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),JE=Ym,GE=oN,qE=PE,KE=gf.exports,WE=ey,XE=Qh.get,QE=UE,zE=VE,$E=RegExp.prototype.exec,ZE=KE("native-string-replace",String.prototype.replace),ew=$E,tw=function(){var e=/a/,t=/b*/g;return $E.call(e,"a"),$E.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),nw=qE.UNSUPPORTED_Y||qE.BROKEN_CARET,rw=void 0!==/()??/.exec("")[1];(tw||rw||nw||QE||zE)&&(ew=function(e){var t,n,r,o,a,i,s,c=this,l=XE(c),u=JE(e),d=l.raw;if(d)return d.lastIndex=c.lastIndex,t=ew.call(d,u),c.lastIndex=d.lastIndex,t;var f=l.groups,h=nw&&c.sticky,p=GE.call(c),v=c.source,y=0,m=u;if(h&&(-1===(p=p.replace("y","")).indexOf("g")&&(p+="g"),m=u.slice(c.lastIndex),c.lastIndex>0&&(!c.multiline||c.multiline&&"\n"!==u.charAt(c.lastIndex-1))&&(v="(?: "+v+")",m=" "+m,y++),n=new RegExp("^(?:"+v+")",p)),rw&&(n=new RegExp("^"+v+"$(?!\\s)",p)),tw&&(r=c.lastIndex),o=$E.call(h?n:c,m),h?o?(o.input=o.input.slice(y),o[0]=o[0].slice(y),o.index=c.lastIndex,c.lastIndex+=o[0].length):c.lastIndex=0:tw&&o&&(c.lastIndex=c.global?o.index+o[0].length:r),rw&&o&&o.length>1&&ZE.call(o[0],n,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(o[a]=void 0)})),o&&f)for(o.groups=i=WE(null),a=0;a<f.length;a++)i[(s=f[a])[0]]=o[s[1]];return o});var ow=ew;dv({target:"RegExp",proto:!0,forced:/./.exec!==ow},{exec:ow});var aw=bh.exports,iw=ow,sw=Ed,cw=Bf,lw=Sh,uw=cw("species"),dw=RegExp.prototype,fw=function(e,t,n,r){var o=cw(e),a=!sw((function(){var t={};return t[o]=function(){return 7},7!=""[e](t)})),i=a&&!sw((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[uw]=function(){return n},n.flags="",n[o]=/./[o]),n.exec=function(){return t=!0,null},n[o](""),!t}));if(!a||!i||n){var s=/./[o],c=t(o,""[e],(function(e,t,n,r,o){var i=t.exec;return i===iw||i===dw.exec?a&&!o?{done:!0,value:s.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}));aw(String.prototype,e,c[0]),aw(dw,o,c[1])}r&&lw(dw[o],"sham",!0)},hw=Km.charAt,pw=function(e,t,n){return t+(n?hw(e,t).length:1)},vw=_f,yw=Math.floor,mw="".replace,gw=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Sw=/\$([$&'`]|\d{1,2})/g,bw=dh,Nw=Bd,Tw=Ld,Ew=ow,ww=function(e,t){var n=e.exec;if(Nw(n)){var r=n.call(e,t);return null!==r&&bw(r),r}if("RegExp"===Tw(e))return Ew.call(e,t);throw TypeError("RegExp#exec called on incompatible receiver")},_w=fw,Ow=Ed,Iw=dh,Rw=Bd,xw=yp,Cw=Ep,Aw=Ym,kw=Dd,Lw=pw,Mw=vf,Pw=function(e,t,n,r,o,a){var i=n+e.length,s=r.length,c=Sw;return void 0!==o&&(o=vw(o),c=gw),mw.call(a,c,(function(a,c){var l;switch(c.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(i);case"<":l=o[c.slice(1,-1)];break;default:var u=+c;if(0===u)return a;if(u>s){var d=yw(u/10);return 0===d?a:d<=s?void 0===r[d-1]?c.charAt(1):r[d-1]+c.charAt(1):a}l=r[u-1]}return void 0===l?"":l}))},Hw=ww,Dw=Bf("replace"),Fw=Math.max,jw=Math.min,Uw="$0"==="a".replace(/./,"$0"),Bw=!!/./[Dw]&&""===/./[Dw]("a","$0");_w("replace",(function(e,t,n){var r=Bw?"$":"$0";return[function(e,n){var r=kw(this),o=null==e?void 0:Mw(e,Dw);return o?o.call(e,r,n):t.call(Aw(r),e,n)},function(e,o){var a=Iw(this),i=Aw(e);if("string"==typeof o&&-1===o.indexOf(r)&&-1===o.indexOf("$<")){var s=n(t,a,i,o);if(s.done)return s.value}var c=Rw(o);c||(o=Aw(o));var l=a.global;if(l){var u=a.unicode;a.lastIndex=0}for(var d=[];;){var f=Hw(a,i);if(null===f)break;if(d.push(f),!l)break;""===Aw(f[0])&&(a.lastIndex=Lw(i,Cw(a.lastIndex),u))}for(var h,p="",v=0,y=0;y<d.length;y++){f=d[y];for(var m=Aw(f[0]),g=Fw(jw(xw(f.index),i.length),0),S=[],b=1;b<f.length;b++)S.push(void 0===(h=f[b])?h:String(h));var N=f.groups;if(c){var T=[m].concat(S,g,i);void 0!==N&&T.push(N);var E=Aw(o.apply(void 0,T))}else E=Pw(m,i,g,S,N,o);g>=v&&(p+=i.slice(v,g)+E,v=g+m.length)}return p+i.slice(v)}]}),!!Ow((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!Uw||Bw);var Yw=dv,Vw=SN,Jw=Ed,Gw=Kd,qw=Bd,Kw=RN,Ww=kT,Xw=bh.exports;if(Yw({target:"Promise",proto:!0,real:!0,forced:!!Vw&&Jw((function(){Vw.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=Kw(this,Gw("Promise")),n=qw(e);return this.then(n?function(n){return Ww(t,e()).then((function(){return n}))}:e,n?function(n){return Ww(t,e()).then((function(){throw n}))}:e)}}),qw(Vw)){var Qw=Gw("Promise").prototype.finally;Vw.prototype.finally!==Qw&&Xw(Vw.prototype,"finally",Qw,{unsafe:!0})}var zw=_f,$w=Dv;dv({target:"Object",stat:!0,forced:Ed((function(){$w(1)}))},{keys:function(e){return $w(zw(e))}});var Zw={},e_=Bf;Zw.f=e_;var t_=Nd,n_=Rf,r_=Zw,o_=lh.f,a_=function(e){var t=t_.Symbol||(t_.Symbol={});n_(t,e)||o_(t,e,{value:r_.f(e)})},i_=dv,s_=Nd,c_=Kd,l_=wd,u_=of,d_=Ed,f_=Rf,h_=NS,p_=Bd,v_=Vd,y_=lf,m_=dh,g_=_f,S_=Ud,b_=Wf,N_=Ym,T_=Ad,E_=ey,w_=Dv,__=hp,O_=rg,I_=jp,R_=Td,x_=lh,C_=_d,A_=bh.exports,k_=gf.exports,L_=Hh,M_=Af,P_=Bf,H_=Zw,D_=a_,F_=em,j_=Qh,U_=MS.forEach,B_=Ph("hidden"),Y_=P_("toPrimitive"),V_=j_.set,J_=j_.getterFor("Symbol"),G_=Object.prototype,q_=s_.Symbol,K_=c_("JSON","stringify"),W_=R_.f,X_=x_.f,Q_=O_.f,z_=C_.f,$_=k_("symbols"),Z_=k_("op-symbols"),eO=k_("string-to-symbol-registry"),tO=k_("symbol-to-string-registry"),nO=k_("wks"),rO=s_.QObject,oO=!rO||!rO.prototype||!rO.prototype.findChild,aO=l_&&d_((function(){return 7!=E_(X_({},"a",{get:function(){return X_(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=W_(G_,t);r&&delete G_[t],X_(e,t,n),r&&e!==G_&&X_(G_,t,r)}:X_,iO=function(e,t){var n=$_[e]=E_(q_.prototype);return V_(n,{type:"Symbol",tag:e,description:t}),l_||(n.description=t),n},sO=function(e,t,n){e===G_&&sO(Z_,t,n),m_(e);var r=b_(t);return m_(n),f_($_,r)?(n.enumerable?(f_(e,B_)&&e[B_][r]&&(e[B_][r]=!1),n=E_(n,{enumerable:T_(0,!1)})):(f_(e,B_)||X_(e,B_,T_(1,{})),e[B_][r]=!0),aO(e,r,n)):X_(e,r,n)},cO=function(e,t){m_(e);var n=S_(t),r=w_(n).concat(fO(n));return U_(r,(function(t){l_&&!lO.call(n,t)||sO(e,t,n[t])})),e},lO=function(e){var t=b_(e),n=z_.call(this,t);return!(this===G_&&f_($_,t)&&!f_(Z_,t))&&(!(n||!f_(this,t)||!f_($_,t)||f_(this,B_)&&this[B_][t])||n)},uO=function(e,t){var n=S_(e),r=b_(t);if(n!==G_||!f_($_,r)||f_(Z_,r)){var o=W_(n,r);return!o||!f_($_,r)||f_(n,B_)&&n[B_][r]||(o.enumerable=!0),o}},dO=function(e){var t=Q_(S_(e)),n=[];return U_(t,(function(e){f_($_,e)||f_(L_,e)||n.push(e)})),n},fO=function(e){var t=e===G_,n=Q_(t?Z_:S_(e)),r=[];return U_(n,(function(e){!f_($_,e)||t&&!f_(G_,e)||r.push($_[e])})),r};if(u_||(A_((q_=function(){if(this instanceof q_)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?N_(arguments[0]):void 0,t=M_(e),n=function(e){this===G_&&n.call(Z_,e),f_(this,B_)&&f_(this[B_],t)&&(this[B_][t]=!1),aO(this,t,T_(1,e))};return l_&&oO&&aO(G_,t,{configurable:!0,set:n}),iO(t,e)}).prototype,"toString",(function(){return J_(this).tag})),A_(q_,"withoutSetter",(function(e){return iO(M_(e),e)})),C_.f=lO,x_.f=sO,R_.f=uO,__.f=O_.f=dO,I_.f=fO,H_.f=function(e){return iO(P_(e),e)},l_&&(X_(q_.prototype,"description",{configurable:!0,get:function(){return J_(this).description}}),A_(G_,"propertyIsEnumerable",lO,{unsafe:!0}))),i_({global:!0,wrap:!0,forced:!u_,sham:!u_},{Symbol:q_}),U_(w_(nO),(function(e){D_(e)})),i_({target:"Symbol",stat:!0,forced:!u_},{for:function(e){var t=N_(e);if(f_(eO,t))return eO[t];var n=q_(t);return eO[t]=n,tO[n]=t,n},keyFor:function(e){if(!y_(e))throw TypeError(e+" is not a symbol");if(f_(tO,e))return tO[e]},useSetter:function(){oO=!0},useSimple:function(){oO=!1}}),i_({target:"Object",stat:!0,forced:!u_,sham:!l_},{create:function(e,t){return void 0===t?E_(e):cO(E_(e),t)},defineProperty:sO,defineProperties:cO,getOwnPropertyDescriptor:uO}),i_({target:"Object",stat:!0,forced:!u_},{getOwnPropertyNames:dO,getOwnPropertySymbols:fO}),i_({target:"Object",stat:!0,forced:d_((function(){I_.f(1)}))},{getOwnPropertySymbols:function(e){return I_.f(g_(e))}}),K_&&i_({target:"JSON",stat:!0,forced:!u_||d_((function(){var e=q_();return"[null]"!=K_([e])||"{}"!=K_({a:e})||"{}"!=K_(Object(e))}))},{stringify:function(e,t,n){for(var r,o=[e],a=1;arguments.length>a;)o.push(arguments[a++]);if(r=t,(v_(t)||void 0!==e)&&!y_(e))return h_(t)||(t=function(e,t){if(p_(r)&&(t=r.call(this,e,t)),!y_(t))return t}),o[1]=t,K_.apply(null,o)}}),!q_.prototype[Y_]){var hO=q_.prototype.valueOf;A_(q_.prototype,Y_,(function(){return hO.apply(this,arguments)}))}F_(q_,"Symbol"),L_[B_]=!0;var pO=MS.filter;dv({target:"Array",proto:!0,forced:!Yb("filter")},{filter:function(e){return pO(this,e,arguments.length>1?arguments[1]:void 0)}});var vO=dv,yO=Ed,mO=Ud,gO=Td.f,SO=wd,bO=yO((function(){gO(1)}));vO({target:"Object",stat:!0,forced:!SO||bO,sham:!SO},{getOwnPropertyDescriptor:function(e,t){return gO(mO(e),t)}});var NO=Ed,TO=function(e,t){var n=[][e];return!!n&&NO((function(){n.call(null,t||function(){throw 1},1)}))},EO=MS.forEach,wO=Nd,_O=vb,OO=gb,IO=TO("forEach")?[].forEach:function(e){return EO(this,e,arguments.length>1?arguments[1]:void 0)},RO=Sh,xO=function(e){if(e&&e.forEach!==IO)try{RO(e,"forEach",IO)}catch(t){e.forEach=IO}};for(var CO in _O)_O[CO]&&xO(wO[CO]&&wO[CO].prototype);xO(OO);var AO=Vp,kO=Ud,LO=Td,MO=Fb;function PO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function HO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?PO(Object(n),!0).forEach((function(t){hd(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PO(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}dv({target:"Object",stat:!0,sham:!wd},{getOwnPropertyDescriptors:function(e){for(var t,n,r=kO(e),o=LO.f,a=AO(r),i={},s=0;a.length>s;)void 0!==(n=o(r,t=a[s++]))&&MO(i,t,n);return i}});var DO=new WeakMap,FO=function(){function e(){ud(this,e),function(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}(this,DO,{writable:!0,value:[]})}return fd(e,[{key:"bindListener",value:function(e,t,n,r){_y(this,DO,Oy(this,DO)||[]);var o=function(e,o,a){return n.call(t,e,o,a,r)};return Oy(this,DO)[e]?Oy(this,DO)[e].push(o)-1:(Oy(this,DO)[e]=[o],0)}},{key:"addListener",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_y(this,DO,Oy(this,DO)||[]);var r=function(e,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t(HO(HO({context:e,eventName:r},o),n))};return Oy(this,DO)[e]?Oy(this,DO)[e].push(r)-1:(Oy(this,DO)[e]=[r],0)}},{key:"removeListener",value:function(e,t){Oy(this,DO)[e]&&Oy(this,DO)[e][t]?delete Oy(this,DO)[e][t]:console.log("trying to remove non-existent event handler, event = "+e+" handle = "+t)}},{key:"destructor",value:function(){_y(this,DO,null)}},{key:"fireEvent",value:function(t,n){if(Oy(this,DO))for(var r in Oy(this,DO)[t])if(Oy(this,DO)[t].hasOwnProperty(r)&&Oy(this,DO)[t][r](this,t,arguments[1])===e.STOP_PROPAGATION)break}}]),e}();hd(FO,"STOP_PROPAGATION","STOP_PROPAGATION");var jO=function e(t,n,r){function o(i,s){if(!n[i]){if(!t[i]){if(!s&&Sd)return Sd(i);if(a)return a(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[i]={exports:{}};t[i][0].call(l.exports,(function(e){return o(t[i][1][e]||e)}),l,l.exports,e,t,n,r)}return n[i].exports}for(var a=Sd,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(e,t,n){(function(e){var n,r,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var a=0,i=new o(u),s=e.document.createTextNode("");i.observe(s,{characterData:!0}),n=function(){s.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var c=new e.MessageChannel;c.port1.onmessage=u,n=function(){c.port2.postMessage(0)}}var l=[];function u(){var e,t;r=!0;for(var n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}r=!1}t.exports=function(e){1!==l.push(e)||r||n()}}).call(this,void 0!==gd?gd:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){var r=e(1);function o(){}var a={},i=["REJECTED"],s=["FULFILLED"],c=["PENDING"];function l(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==o&&h(this,e)}function u(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(e,t,n){r((function(){var r;try{r=t(n)}catch(t){return a.reject(e,t)}r===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,r)}))}function f(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var n=!1;function r(t){n||(n=!0,a.reject(e,t))}function o(t){n||(n=!0,a.resolve(e,t))}var i=p((function(){t(o,r)}));"error"===i.status&&r(i.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}t.exports=l,l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===i)return this;var n=new this.constructor(o);return this.state!==c?d(n,this.state===s?e:t,this.outcome):this.queue.push(new u(n,e,t)),n},u.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){a.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},a.resolve=function(e,t){var n=p(f,t);if("error"===n.status)return a.reject(e,n.value);var r=n.value;if(r)h(e,r);else{e.state=s,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},a.reject=function(e,t){e.state=i,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},l.resolve=function(e){return e instanceof this?e:a.resolve(new this(o),e)},l.reject=function(e){var t=new this(o);return a.reject(t,e)},l.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var i=new Array(n),s=0,c=-1,l=new this(o);++c<n;)u(e[c],c);return l;function u(e,o){t.resolve(e).then((function(e){i[o]=e,++s!==n||r||(r=!0,a.resolve(l,i))}),(function(e){r||(r=!0,a.reject(l,e))}))}},l.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return this.resolve([]);for(var r,i=-1,s=new this(o);++i<t;)r=e[i],this.resolve(r).then((function(e){n||(n=!0,a.resolve(s,e))}),(function(e){n||(n=!0,a.reject(s,e))}));return s}},{1:1}],3:[function(e,t,n){(function(t){"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==gd?gd:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function a(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var i=Promise;function s(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function c(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function l(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function u(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var d=void 0,f={},h=Object.prototype.toString;function p(e){return"boolean"==typeof d?i.resolve(d):function(e){return new i((function(t){var n=e.transaction("local-forage-detect-blob-support","readwrite"),r=a([""]);n.objectStore("local-forage-detect-blob-support").put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}(e).then((function(e){return d=e}))}function v(e){var t=f[e.name],n={};n.promise=new i((function(e,t){n.resolve=e,n.reject=t})),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then((function(){return n.promise})):t.dbReady=n.promise}function y(e){var t=f[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function m(e,t){var n=f[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function g(e,t){return new i((function(n,r){if(f[e.name]=f[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return n(e.db);v(e),e.db.close()}var a=[e.name];t&&a.push(e.version);var i=o.open.apply(o,a);t&&(i.onupgradeneeded=function(t){var n=i.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore("local-forage-detect-blob-support")}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),i.onerror=function(e){e.preventDefault(),r(i.error)},i.onsuccess=function(){var t=i.result;t.onversionchange=function(e){e.target.close()},n(t),y(e)}}))}function S(e){return g(e,!1)}function b(e){return g(e,!0)}function N(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,o=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||n){if(n){var a=e.db.version+1;a>e.version&&(e.version=a)}return!0}return!1}function T(e){return a([function(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}(atob(e.data))],{type:e.type})}function E(e){return e&&e.__local_forage_encoded_blob}function w(e){var t=this,n=t._initReady().then((function(){var e=f[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return c(n,e,e),n}function _(e,t,n,r){void 0===r&&(r=1);try{var o=e.db.transaction(e.storeName,t);n(null,o)}catch(o){if(r>0&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return i.resolve().then((function(){if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),b(e)})).then((function(){return function(e){v(e);for(var t=f[e.name],n=t.forages,r=0;r<n.length;r++){var o=n[r];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return e.db=null,S(e).then((function(t){return e.db=t,N(e)?b(e):t})).then((function(r){e.db=t.db=r;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=r})).catch((function(t){throw m(e,t),t}))}(e).then((function(){_(e,t,n,r-1)}))})).catch(n);n(o)}}var O={_driver:"asyncStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var o=f[n.name];o||(o={forages:[],db:null,dbReady:null,deferredOperations:[]},f[n.name]=o),o.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=w);var a=[];function s(){return i.resolve()}for(var c=0;c<o.forages.length;c++){var l=o.forages[c];l!==t&&a.push(l._initReady().catch(s))}var u=o.forages.slice(0);return i.all(a).then((function(){return n.db=o.db,S(n)})).then((function(e){return n.db=e,N(n,t._defaultConfig.version)?b(n):e})).then((function(e){n.db=o.db=e,t._dbInfo=n;for(var r=0;r<u.length;r++){var a=u[r];a!==t&&(a._dbInfo.db=n.db,a._dbInfo.version=n.version)}}))},_support:function(){try{if(!o||!o.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var n=this,r=new i((function(t,r){n.ready().then((function(){_(n._dbInfo,"readonly",(function(o,a){if(o)return r(o);try{var i=a.objectStore(n._dbInfo.storeName).openCursor(),s=1;i.onsuccess=function(){var n=i.result;if(n){var r=n.value;E(r)&&(r=T(r));var o=e(r,n.key,s++);void 0!==o?t(o):n.continue()}else t()},i.onerror=function(){r(i.error)}}catch(e){r(e)}}))})).catch(r)}));return s(r,t),r},getItem:function(e,t){var n=this;e=l(e);var r=new i((function(t,r){n.ready().then((function(){_(n._dbInfo,"readonly",(function(o,a){if(o)return r(o);try{var i=a.objectStore(n._dbInfo.storeName).get(e);i.onsuccess=function(){var e=i.result;void 0===e&&(e=null),E(e)&&(e=T(e)),t(e)},i.onerror=function(){r(i.error)}}catch(e){r(e)}}))})).catch(r)}));return s(r,t),r},setItem:function(e,t,n){var r=this;e=l(e);var o=new i((function(n,o){var a;r.ready().then((function(){return a=r._dbInfo,"[object Blob]"===h.call(t)?p(a.db).then((function(e){return e?t:(n=t,new i((function(e,t){var r=new FileReader;r.onerror=t,r.onloadend=function(t){var r=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:r,type:n.type})},r.readAsBinaryString(n)})));var n})):t})).then((function(t){_(r._dbInfo,"readwrite",(function(a,i){if(a)return o(a);try{var s=i.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var c=s.put(t,e);i.oncomplete=function(){void 0===t&&(t=null),n(t)},i.onabort=i.onerror=function(){var e=c.error?c.error:c.transaction.error;o(e)}}catch(e){o(e)}}))})).catch(o)}));return s(o,n),o},removeItem:function(e,t){var n=this;e=l(e);var r=new i((function(t,r){n.ready().then((function(){_(n._dbInfo,"readwrite",(function(o,a){if(o)return r(o);try{var i=a.objectStore(n._dbInfo.storeName).delete(e);a.oncomplete=function(){t()},a.onerror=function(){r(i.error)},a.onabort=function(){var e=i.error?i.error:i.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return s(r,t),r},clear:function(e){var t=this,n=new i((function(e,n){t.ready().then((function(){_(t._dbInfo,"readwrite",(function(r,o){if(r)return n(r);try{var a=o.objectStore(t._dbInfo.storeName).clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=a.error?a.error:a.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return s(n,e),n},length:function(e){var t=this,n=new i((function(e,n){t.ready().then((function(){_(t._dbInfo,"readonly",(function(r,o){if(r)return n(r);try{var a=o.objectStore(t._dbInfo.storeName).count();a.onsuccess=function(){e(a.result)},a.onerror=function(){n(a.error)}}catch(e){n(e)}}))})).catch(n)}));return s(n,e),n},key:function(e,t){var n=this,r=new i((function(t,r){e<0?t(null):n.ready().then((function(){_(n._dbInfo,"readonly",(function(o,a){if(o)return r(o);try{var i=a.objectStore(n._dbInfo.storeName),s=!1,c=i.openKeyCursor();c.onsuccess=function(){var n=c.result;n?0===e||s?t(n.key):(s=!0,n.advance(e)):t(null)},c.onerror=function(){r(c.error)}}catch(e){r(e)}}))})).catch(r)}));return s(r,t),r},keys:function(e){var t=this,n=new i((function(e,n){t.ready().then((function(){_(t._dbInfo,"readonly",(function(r,o){if(r)return n(r);try{var a=o.objectStore(t._dbInfo.storeName).openKeyCursor(),i=[];a.onsuccess=function(){var t=a.result;t?(i.push(t.key),t.continue()):e(i)},a.onerror=function(){n(a.error)}}catch(e){n(e)}}))})).catch(n)}));return s(n,e),n},dropInstance:function(e,t){t=u.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,a=this;if(e.name){var c=e.name===n.name&&a._dbInfo.db,l=c?i.resolve(a._dbInfo.db):S(e).then((function(t){var n=f[e.name],r=n.forages;n.db=t;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=t;return t}));r=e.storeName?l.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;v(e);var r=f[e.name],a=r.forages;t.close();for(var s=0;s<a.length;s++){var c=a[s];c._dbInfo.db=null,c._dbInfo.version=n}return new i((function(t,r){var a=o.open(e.name,n);a.onerror=function(e){a.result.close(),r(e)},a.onupgradeneeded=function(){a.result.deleteObjectStore(e.storeName)},a.onsuccess=function(){var e=a.result;e.close(),t(e)}})).then((function(e){r.db=e;for(var t=0;t<a.length;t++){var n=a[t];n._dbInfo.db=e,y(n._dbInfo)}})).catch((function(t){throw(m(e,t)||i.resolve()).catch((function(){})),t}))}})):l.then((function(t){v(e);var n=f[e.name],r=n.forages;t.close();for(var a=0;a<r.length;a++)r[a]._dbInfo.db=null;return new i((function(t,n){var r=o.deleteDatabase(e.name);r.onerror=function(){var e=r.result;e&&e.close(),n(r.error)},r.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}})).then((function(e){n.db=e;for(var t=0;t<r.length;t++)y(r[t]._dbInfo)})).catch((function(t){throw(m(e,t)||i.resolve()).catch((function(){})),t}))}))}else r=i.reject("Invalid arguments");return s(r,t),r}},I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",R=/^~~local_forage_type~([^~]+)~/,x="__lfsc__:".length,C=x+"arbf".length,A=Object.prototype.toString;function k(e){var t,n,r,o,a,i=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);var l=new ArrayBuffer(i),u=new Uint8Array(l);for(t=0;t<s;t+=4)n=I.indexOf(e[t]),r=I.indexOf(e[t+1]),o=I.indexOf(e[t+2]),a=I.indexOf(e[t+3]),u[c++]=n<<2|r>>4,u[c++]=(15&r)<<4|o>>2,u[c++]=(3&o)<<6|63&a;return l}function L(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=I[n[t]>>2],r+=I[(3&n[t])<<4|n[t+1]>>4],r+=I[(15&n[t+1])<<2|n[t+2]>>6],r+=I[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var M={serialize:function(e,t){var n="";if(e&&(n=A.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===A.call(e.buffer))){var r,o="__lfsc__:";e instanceof ArrayBuffer?(r=e,o+="arbf"):(r=e.buffer,"[object Int8Array]"===n?o+="si08":"[object Uint8Array]"===n?o+="ui08":"[object Uint8ClampedArray]"===n?o+="uic8":"[object Int16Array]"===n?o+="si16":"[object Uint16Array]"===n?o+="ur16":"[object Int32Array]"===n?o+="si32":"[object Uint32Array]"===n?o+="ui32":"[object Float32Array]"===n?o+="fl32":"[object Float64Array]"===n?o+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(o+L(r))}else if("[object Blob]"===n){var a=new FileReader;a.onload=function(){var n="~~local_forage_type~"+e.type+"~"+L(this.result);t("__lfsc__:blob"+n)},a.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}},deserialize:function(e){if("__lfsc__:"!==e.substring(0,x))return JSON.parse(e);var t,n=e.substring(C),r=e.substring(x,C);if("blob"===r&&R.test(n)){var o=n.match(R);t=o[1],n=n.substring(o[0].length)}var i=k(n);switch(r){case"arbf":return i;case"blob":return a([i],{type:t});case"si08":return new Int8Array(i);case"ui08":return new Uint8Array(i);case"uic8":return new Uint8ClampedArray(i);case"si16":return new Int16Array(i);case"ur16":return new Uint16Array(i);case"si32":return new Int32Array(i);case"ui32":return new Uint32Array(i);case"fl32":return new Float32Array(i);case"fl64":return new Float64Array(i);default:throw new Error("Unkown type: "+r)}},stringToBuffer:k,bufferToString:L};function P(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function H(e,t,n,r,o,a){e.executeSql(n,r,o,(function(e,i){i.code===i.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,s){s.rows.length?a(e,i):P(e,t,(function(){e.executeSql(n,r,o,a)}),a)}),a):a(e,i)}),a)}function D(e,t,n,r){var o=this;e=l(e);var a=new i((function(a,i){o.ready().then((function(){void 0===t&&(t=null);var s=t,c=o._dbInfo;c.serializer.serialize(t,(function(t,l){l?i(l):c.db.transaction((function(n){H(n,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){a(s)}),(function(e,t){i(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void a(D.apply(o,[e,s,n,r-1]));i(t)}}))}))})).catch(i)}));return s(a,n),a}function F(e){return new i((function(t,n){e.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,r){for(var o=[],a=0;a<r.rows.length;a++)o.push(r.rows.item(a).name);t({db:e,storeNames:o})}),(function(e,t){n(t)}))}),(function(e){n(e)}))}))}var j={_driver:"webSQLStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var o=new i((function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction((function(o){P(o,n,(function(){t._dbInfo=n,e()}),(function(e,t){r(t)}))}),r)}));return n.serializer=M,o},_support:"function"==typeof openDatabase,iterate:function(e,t){var n=this,r=new i((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){H(n,o,"SELECT * FROM "+o.storeName,[],(function(n,r){for(var a=r.rows,i=a.length,s=0;s<i;s++){var c=a.item(s),l=c.value;if(l&&(l=o.serializer.deserialize(l)),void 0!==(l=e(l,c.key,s+1)))return void t(l)}t()}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,t),r},getItem:function(e,t){var n=this;e=l(e);var r=new i((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){H(n,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=o.serializer.deserialize(r)),t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,t),r},setItem:function(e,t,n){return D.apply(this,[e,t,n,1])},removeItem:function(e,t){var n=this;e=l(e);var r=new i((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){H(n,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,t),r},clear:function(e){var t=this,n=new i((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){H(t,r,"DELETE FROM "+r.storeName,[],(function(){e()}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,e),n},length:function(e){var t=this,n=new i((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){H(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(t,n){var r=n.rows.item(0).c;e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,e),n},key:function(e,t){var n=this,r=new i((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){H(n,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,t),r},keys:function(e){var t=this,n=new i((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){H(t,r,"SELECT key FROM "+r.storeName,[],(function(t,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).key);e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,e),n},dropInstance:function(e,t){t=u.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,o=this;return s(r=e.name?new i((function(t){var r;r=e.name===n.name?o._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:r,storeNames:[e.storeName]}):t(F(r))})).then((function(e){return new i((function(t,n){e.db.transaction((function(r){function o(e){return new i((function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){n(t)}))}))}for(var a=[],s=0,c=e.storeNames.length;s<c;s++)a.push(o(e.storeNames[s]));i.all(a).then((function(){t()})).catch((function(e){n(e)}))}),(function(e){n(e)}))}))})):i.reject("Invalid arguments"),t),r}};function U(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}var B={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var n in e)t[n]=e[n];return t.keyPrefix=U(e,this._defaultConfig),!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(e){return!0}}()||localStorage.length>0?(this._dbInfo=t,t.serializer=M,i.resolve()):i.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var n=this,r=n.ready().then((function(){for(var t=n._dbInfo,r=t.keyPrefix,o=r.length,a=localStorage.length,i=1,s=0;s<a;s++){var c=localStorage.key(s);if(0===c.indexOf(r)){var l=localStorage.getItem(c);if(l&&(l=t.serializer.deserialize(l)),void 0!==(l=e(l,c.substring(o),i++)))return l}}}));return s(r,t),r},getItem:function(e,t){var n=this;e=l(e);var r=n.ready().then((function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r}));return s(r,t),r},setItem:function(e,t,n){var r=this;e=l(e);var o=r.ready().then((function(){void 0===t&&(t=null);var n=t;return new i((function(o,a){var i=r._dbInfo;i.serializer.serialize(t,(function(t,r){if(r)a(r);else try{localStorage.setItem(i.keyPrefix+e,t),o(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||a(e),a(e)}}))}))}));return s(o,n),o},removeItem:function(e,t){var n=this;e=l(e);var r=n.ready().then((function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return s(r,t),r},clear:function(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return s(n,e),n},length:function(e){var t=this.keys().then((function(e){return e.length}));return s(t,e),t},key:function(e,t){var n=this,r=n.ready().then((function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t}));return s(r,t),r},keys:function(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo,n=localStorage.length,r=[],o=0;o<n;o++){var a=localStorage.key(o);0===a.indexOf(e.keyPrefix)&&r.push(a.substring(e.keyPrefix.length))}return r}));return s(n,e),n},dropInstance:function(e,t){if(t=u.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,o=this;return s(r=e.name?new i((function(t){e.storeName?t(U(e,o._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}})):i.reject("Invalid arguments"),t),r}},Y=function(e,t){for(var n,r,o=e.length,a=0;a<o;){if((n=e[a])===(r=t)||"number"==typeof n&&"number"==typeof r&&isNaN(n)&&isNaN(r))return!0;a++}return!1},V=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},J={},G={},q={INDEXEDDB:O,WEBSQL:j,LOCALSTORAGE:B},K=[q.INDEXEDDB._driver,q.WEBSQL._driver,q.LOCALSTORAGE._driver],W=["dropInstance"],X=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(W),Q={description:"",driver:K.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function z(e,t){e[t]=function(){var n=arguments;return e.ready().then((function(){return e[t].apply(e,n)}))}}function $(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(V(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var Z=new(function(){function e(t){for(var n in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),q)if(q.hasOwnProperty(n)){var r=q[n],o=r._driver;this[n]=o,J[o]||this.defineDriver(r)}this._defaultConfig=$({},Q),this._config=$({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":r(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new i((function(t,n){try{var r=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(o);for(var a=X.concat("_initStorage"),c=0,l=a.length;c<l;c++){var u=a[c];if((!Y(W,u)||e[u])&&"function"!=typeof e[u])return void n(o)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=i.reject(t);return s(n,arguments[arguments.length-1]),n}},n=0,r=W.length;n<r;n++){var o=W[n];e[o]||(e[o]=t(o))}}();var d=function(n){J[r]&&console.info("Redefining LocalForage driver: "+r),J[r]=e,G[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(d,n):d(!!e._support):d(!0)}catch(e){n(e)}}));return c(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=J[e]?i.resolve(J[e]):i.reject(new Error("Driver not found."));return c(r,t,n),r},e.prototype.getSerializer=function(e){var t=i.resolve(M);return c(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return c(n,e,e),n},e.prototype.setDriver=function(e,t,n){var r=this;V(e)||(e=[e]);var o=this._getSupportedDrivers(e);function a(){r._config.driver=r.driver()}function s(e){return r._extend(e),a(),r._ready=r._initStorage(r._config),r._ready}var l=null!==this._driverSet?this._driverSet.catch((function(){return i.resolve()})):i.resolve();return this._driverSet=l.then((function(){var e=o[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then((function(e){r._driver=e._driver,a(),r._wrapLibraryMethodsWithReady(),r._initDriver=function(e){return function(){var t=0;return function n(){for(;t<e.length;){var o=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(o).then(s).catch(n)}a();var c=new Error("No available storage method found.");return r._driverSet=i.reject(c),r._driverSet}()}}(o)}))})).catch((function(){a();var e=new Error("No available storage method found.");return r._driverSet=i.reject(e),r._driverSet})),c(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!G[e]},e.prototype._extend=function(e){$(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n];this.supports(o)&&t.push(o)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=X.length;e<t;e++)z(this,X[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=Z},{3:3}]},{},[4])(4);
/*!
	    localForage -- Offline Storage, Improved
	    Version 1.10.0
	    https://localforage.github.io/localForage
	    (c) 2013-2017 Mozilla, Apache License 2.0
	*/function UO(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,UO)}var BO=/^[a-fA-F0-9]{8}-(?:[a-fA-F0-9]{4}-){3}[a-fA-F0-9]{12}$/,YO=function(e){by(n,FO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(){var e;return ud(this,n),hd(gy(e=t.call(this)),"_id",void 0),hd(gy(e),"_savedRemotely",!1),hd(gy(e),"_savedLocally",!1),hd(gy(e),"deleted",!1),hd(gy(e),"createdStamp",void 0),hd(gy(e),"modifiedStamp",void 0),hd(gy(e),"projectId",void 0),hd(gy(e),"isPristine",!1),e.createdStamp=Math.floor(Date.now()/1e3),e}return fd(n,[{key:"unsaved",value:function(){return!(this._savedLocally&&this._savedRemotely)}},{key:"id",get:function(){return this._id||(this._id=UO()),this._id},set:function(e){if(this._id&&e!==this._id)throw new Error("Occurrence id has already been set, when trying to set new id '".concat(e,"'."));this._id=e}},{key:"queuePost",value:function(e){var t=this;return new Promise((function(r,o){var a=function(){return console.log({"posting form data":e}),t.post(e).then(r,o)};n._tasks.push(a),n._tasks.length>1?console.log("Added post request to the queue."):(console.log("No pending tasks, starting post request immediately."),a().finally(n._next))}))}},{key:"post",value:function(e){var t=this;return fetch(this.SAVE_ENDPOINT,{method:"POST",body:e}).then((function(e){return e.ok?e.clone().json().then((function(n){switch(console.log({"returned to client after save":n}),n.saveState){case"SAVED_TO_SERVER":t._savedLocally=!0,t._savedRemotely=!0;break;case"SAVED_LOCALLY":t._savedLocally=!0,t._savedRemotely=!1;break;default:console.log("Unrecognised save state '".concat(n.saveState,"'"))}return t.createdStamp=parseInt(n.created,10),t.modifiedStamp=parseInt(n.modified,10),e.json()})):(console.log("Save failed, presumably service worker is missing and there is no network connection. Should write to IndexedDb here."),Promise.reject("IndexedDb storage not yet implemented"))}))}},{key:"_parseDescriptor",value:function(e){this._parseAttributes(e.attributes),this._parseSavedState(e.saveState),this.deleted=!0===e.deleted||"true"===e.deleted,this.createdStamp=parseInt(e.created,10),this.modifiedStamp=e.modified?parseInt(e.modified,10):0,this.projectId=parseInt(e.projectId,10)}},{key:"_parseAttributes",value:function(e){"string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)?(console.log("Attributes were spuriously represented as an array rather than as an empty object"),this.attributes={}):this.attributes=e}},{key:"_parseSavedState",value:function(e){switch(e){case"SAVED_LOCALLY":this._savedRemotely=!1,this._savedLocally=!0;break;case"SAVED_TO_SERVER":this._savedRemotely=!0,this._savedLocally=!0;break;default:throw new Error("Unrecognised saved state '".concat(e))}}},{key:"touch",value:function(){this.modifiedStamp=Math.floor(Date.now()/1e3),this.isPristine&&(this.isPristine=!1,this.createdStamp=this.modifiedStamp),this._savedLocally=!1,this._savedRemotely=!1}},{key:"evaluateCompletionStatus",value:function(e){var t={},n=!0;for(var r in e)if(e.hasOwnProperty(r)){var o=e[r];t[r]=o.validator?o.validator(r,o,this.attributes):o.field.isValid(r,o,this.attributes),null!==t[r]&&(n=n&&t[r])}return{requiredFieldsPresent:n,validity:t}}}],[{key:"_next",value:function(){if(n._tasks.shift(),n._tasks.length)return console.log("Running the next task."),n._tasks[0]().finally(n._next)}},{key:"retrieveFromLocal",value:function(e,t){return jO.getItem("".concat(t.TYPE,".").concat(e)).then((function(n){return n?(t.id=e,t._parseDescriptor(n),t):Promise.reject("Failed to retrieve ".concat(t.TYPE,".").concat(e," locally"))}))}}]),n}();hd(YO,"_tasks",[]);var VO=function(e){by(n,kb(Error));var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(){return ud(this,n),t.apply(this,arguments)}return n}();function JO(e){try{var t=document.createElement("textarea");return t.innerHTML=e,t.innerHTML.replace(/"/g,"&quot;")}catch(t){var n=document.createElement("pre");return n.appendChild(document.createTextNode(e)),n.innerHTML.replace(/"/g,"&quot;")}}var GO=function(){function e(){ud(this,e),hd(this,"id",void 0),hd(this,"nameString",""),hd(this,"canonical",""),hd(this,"hybridCanonical",""),hd(this,"acceptedEntityId",""),hd(this,"qualifier",""),hd(this,"authority",""),hd(this,"vernacular",""),hd(this,"vernacularRoot",""),hd(this,"used",void 0),hd(this,"sortOrder",void 0),hd(this,"parentIds",[])}return fd(e,[{key:"formattedHTML",value:function(t){var n;return this.id!==this.acceptedEntityId&&(n=e.fromId(this.acceptedEntityId)),e.showVernacular?t?n?"<q><b>".concat(JO(this.vernacular),'</b></q> <span class="italictaxon">').concat(this.nameString).concat(this.qualifier?" <b>".concat(this.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(JO(this.authority),"</span>")+' = <span class="italictaxon">'.concat(n.nameString).concat(n.qualifier?" <b>".concat(n.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(JO(n.authority),"</span>"):"<q><b>".concat(JO(this.vernacular),'</b></q> <span class="italictaxon">').concat(this.nameString).concat(this.qualifier?" <b>".concat(this.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(JO(this.authority),"</span>"):n?'<span class="italictaxon">'.concat(this.nameString).concat(this.qualifier?" <b>".concat(this.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(this.authority,"</span>").concat(this.vernacular?" <q><b>".concat(JO(this.vernacular),"</b></q>"):"",' = <span class="italictaxon">').concat(n.nameString).concat(n.qualifier?" <b>".concat(n.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(JO(n.authority),"</span>"):'<span class="italictaxon">'.concat(this.nameString).concat(this.qualifier?" <b>".concat(this.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(JO(this.authority),"</span>").concat(this.vernacular?" <q><b>".concat(JO(this.vernacular),"</b></q>"):""):n?'<span class="italictaxon">'.concat(this.nameString).concat(this.qualifier?" <b>".concat(this.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(this.authority,"</span>")+' = <span class="italictaxon">'.concat(n.nameString).concat(n.qualifier?" <b>".concat(n.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(JO(n.authority),"</span>"):'<span class="italictaxon">'.concat(this.nameString).concat(this.qualifier?" <b>".concat(this.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(JO(this.authority),"</span>")}}],[{key:"fromId",value:function(t){if(!e.rawTaxa){if(!BsbiDb.TaxonNames)throw new VO("Taxon.fromId() called before taxon list has loaded.");e.rawTaxa=BsbiDb.TaxonNames}if(!e.rawTaxa.hasOwnProperty(t))throw new VO("Taxon id '".concat(t,"' not found."));var n=e.rawTaxa[t],r=new e;return r.id=t,r.nameString=n[0],r.canonical=n[1]||n[0],r.hybridCanonical=n[2]||r.canonical,r.acceptedEntityId=n[3]||t,r.qualifier=n[4],r.authority=n[5],r.vernacular=n[6],r.vernacularRoot=n[7],r.used=n[8],r.sortOrder=n[9],r.parentIds=n[10],r}}]),e}();hd(GO,"rawTaxa",BsbiDb.TaxonNames),hd(GO,"showVernacular",!0);var qO=Dd,KO=Ym,WO="[\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff]",XO=RegExp("^"+WO+WO+"*"),QO=RegExp(WO+WO+"*$"),zO=function(e){return function(t){var n=KO(qO(t));return 1&e&&(n=n.replace(XO,"")),2&e&&(n=n.replace(QO,"")),n}},$O={start:zO(1),end:zO(2),trim:zO(3)},ZO=np.PROPER,eI=Ed,tI="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff",nI=function(e){return eI((function(){return!!tI[e]()||"âÂá "!=="âÂá "[e]()||ZO&&tI[e].name!==e}))},rI=$O.trim;function oI(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}function aI(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}dv({target:"String",proto:!0,forced:nI("trim")},{trim:function(){return rI(this)}});var iI=function(e){by(n,FO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(e){var r;return ud(this,n),hd(gy(r=t.call(this)),"_value",void 0),hd(gy(r),"_fieldEl",void 0),hd(gy(r),"label","field label"),hd(gy(r),"helpText",""),hd(gy(r),"validationMessage",""),hd(gy(r),"completion",n.COMPLETION_OPTIONAL),hd(gy(r),"parentForm",void 0),hd(gy(r),"attributeName",void 0),e&&(e.label&&(r.label=e.label),e.helpText&&(r.helpText=e.helpText),e.validationMessage&&(r.validationMessage=e.validationMessage),e.completion&&(r.completion=e.completion)),r}return fd(n,[{key:"value",get:function(){return this._value},set:function(e){}},{key:"fieldElement",get:function(){return this._fieldEl||this.buildField(),this._fieldEl}},{key:"addField",value:function(){this.parentForm.formElement.appendChild(this.fieldElement)}},{key:"markValidity",value:function(e){}}],[{key:"nextId",get:function(){var e,t,r;return"field".concat((function(e,t,n,r){aI(e,t),oI(n,"set"),function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,n,r)}(n,n,sI,(r=sI,aI(t=n,n),oI(r,"get"),1+(e=+function(e,t){return t.get?t.get.call(e):t.value}(t,r)))),e))}},{key:"cleanRawInput",value:function(e){return e.value.trim().replace(/\s\s+/g," ")}},{key:"cleanRawString",value:function(e){return e.trim().replace(/\s\s+/g," ")}},{key:"isEmpty",value:function(e){return""===e}},{key:"isValid",value:function(e,t,r){return!t.attributes.completion||t.attributes.completion!==n.COMPLETION_COMPULSORY&&t.attributes.completion!==n.COMPLETION_DESIRED?null:!(!r.hasOwnProperty(e)||t.field.isEmpty(r[e]))}},{key:"summarise",value:function(e,t,n){return!t.summary||t.summary.hasOwnProperty("summarise")&&!0!==t.summary.summarise?"":t.field.summariseImpl(e,t,n)}},{key:"summariseImpl",value:function(e,t,n){return""}}]),n}();hd(iI,"COMPLETION_COMPULSORY","compulsory"),hd(iI,"COMPLETION_DESIRED","desired"),hd(iI,"COMPLETION_OPTIONAL","optional");var sI={writable:!0,value:1};function cI(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function lI(e,t,n,r){return fI(e,t),dI(n,"set"),function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,n,r),r}function uI(e,t,n){return fI(e,t),dI(n,"get"),function(e,t){return t.get?t.get.call(e):t.value}(e,n)}function dI(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}function fI(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}hd(iI,"EVENT_CHANGE","fieldChange");var hI=new WeakMap,pI=function(e){by(n,FO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(){var e;ud(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return cI(gy(e=t.call.apply(t,[this].concat(o))),hI,{writable:!0,value:void 0}),hd(gy(e),"_formId",void 0),hd(gy(e),"_formContentContainer",void 0),hd(gy(e),"fields",void 0),hd(gy(e),"liveValidation",!1),hd(gy(e),"isValid",null),hd(gy(e),"_formFieldsBuilt",!1),e}return fd(n,[{key:"formElement",get:function(){var e,t=this;return Oy(this,hI)||(_y(this,hI,document.createElement("form")),Oy(this,hI).id=this._formId="form".concat((lI(n,n,vI,1+(e=+uI(n,n,vI))),e)),Oy(this,hI).noValidate=!0,this.liveValidation&&(Oy(this,hI).className="needs-validation"),this.buildContentContainer(Oy(this,hI)),Oy(this,hI).addEventListener("change",(function(e){t.changeHandler(e)}),{capture:!1})),Oy(this,hI)}},{key:"buildContentContainer",value:function(e){return this._formContentContainer=e,this._formContentContainer}},{key:"changeHandler",value:function(e){console.log({"form change event":e})}},{key:"destructor",value:function(){Mb(Ey(n.prototype),"destructor",this).call(this),_y(this,hI,null)}},{key:"buildFormFields",value:function(){for(var e in this.initialiseFormFields(),this.fields)if(this.fields.hasOwnProperty(e)){var t=this.fields[e];t.parentForm=this,t.attributeName=e,this._formContentContainer.appendChild(t.fieldElement),t.addListener(iI.EVENT_CHANGE,this.changeHandler.bind(this))}this._formFieldsBuilt=!0}},{key:"conditionallyValidateForm",value:function(){this.liveValidation&&this.validateForm()}},{key:"validateForm",value:function(){this.liveValidation=!0,this.formElement.classList.add("needs-validation");var e=this.model.evaluateCompletionStatus(this.getFormSectionProperties());for(var t in this.fields)this.fields.hasOwnProperty(t)&&this.fields[t].markValidity(e.validity[t]);return this.isValid!==e.requiredFieldsPresent&&(this.isValid=e.requiredFieldsPresent,this.fireEvent(n.EVENT_VALIDATION_STATE_CHANGE,{isValid:this.isValid})),e.requiredFieldsPresent}},{key:"populateFormContent",value:function(){if(this._formFieldsBuilt){var e=this.model;for(var t in this.fields)this.fields.hasOwnProperty(t)&&(this.fields[t].value=e.attributes[t]);this.conditionallyValidateForm()}}}],[{key:"nextId",get:function(){var e;return"id".concat((lI(n,n,yI,1+(e=+uI(n,n,yI))),e))}}]),n}();hd(pI,"CHANGE_EVENT","change");var vI={writable:!0,value:0};hd(pI,"EVENT_VALIDATION_STATE_CHANGE","validationstatechange");var yI={writable:!0,value:0};hd(pI,"COMPLETION_STATUS_UNSTARTED","unstarted"),hd(pI,"COMPLETION_STATUS_COMPLETE","complete"),hd(pI,"COMPLETION_STATUS_IN_PROGRESS","inProgress");var mI=function(e){by(n,YO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(){var e;ud(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return hd(gy(e=t.call.apply(t,[this].concat(o))),"attributes",{}),hd(gy(e),"_savedRemotely",!1),hd(gy(e),"_savedLocally",!1),hd(gy(e),"SAVE_ENDPOINT","/saveoccurrence.php"),hd(gy(e),"TYPE","occurrence"),hd(gy(e),"isNew",!1),e}return fd(n,[{key:"taxon",get:function(){return this.attributes.taxon&&this.attributes.taxon.taxonId?GO.fromId(this.attributes.taxon.taxonId):null}},{key:"setForm",value:function(e){return this.isNew||(e.liveValidation=!0),e.addListener(pI.CHANGE_EVENT,this.formChangedHandler.bind(this)),e}},{key:"formChangedHandler",value:function(e){console.log("Occurrence change handler invoked."),e.form.updateModelFromContent(),e.form.conditionallyValidateForm(),this.touch(),this.fireEvent(n.EVENT_MODIFIED,{occurrenceId:this.id})}},{key:"delete",value:function(){this.deleted||(this.touch(),this.deleted=!0,this.fireEvent(n.EVENT_MODIFIED,{occurrenceId:this.id}))}},{key:"save",value:function(e){if(this._savedRemotely)return Promise.reject("".concat(this.id," has already been saved."));var t=new FormData;return!e&&this.surveyId&&(e=this.surveyId),t.append("type",this.TYPE),t.append("surveyId",e),t.append("occurrenceId",this.id),t.append("id",this.id),t.append("projectId",this.projectId.toString()),t.append("attributes",JSON.stringify(this.attributes)),t.append("deleted",this.deleted.toString()),t.append("created",this.createdStamp.toString()),console.log("queueing occurrence post"),this.queuePost(t)}},{key:"_parseDescriptor",value:function(e){Mb(Ey(n.prototype),"_parseDescriptor",this).call(this,e),this.surveyId=e.surveyId}}]),n}();hd(mI,"EVENT_MODIFIED","modified");var gI=function(e){by(n,kb(Error));var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(){return ud(this,n),t.apply(this,arguments)}return n}();var SI=new WeakMap,bI=function(e){by(n,yd);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(e){var r;return ud(this,n),hd(gy(r=t.call(this)),"route","/list/:action/:id"),hd(gy(r),"title","App homepage"),hd(gy(r),"app",void 0),hd(gy(r),"view",void 0),function(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}(gy(r),SI,{writable:!0,value:""}),hd(gy(r),"needsFullRefresh",!0),hd(gy(r),"needRightPanelRefresh",!0),hd(gy(r),"viewSubcontext",""),hd(gy(r),"surveySection",void 0),hd(gy(r),"leftPanelBaseRoute",""),hd(gy(r),"viewContexts",{record:function(e){this.surveySection=null,e?Oy(this,SI)!==e.id?(this.needRightPanelRefresh=!0,this.currentOccurrenceId=e.id?e.id:""):this.needRightPanelRefresh=!1:(this.currentOccurrenceId="",this.needRightPanelRefresh=!0),this.leftPanelBaseRoute="/list/record"},survey:function(e){console.log("in survey section ".concat(e.section)),this.currentOccurrenceId="",this.needRightPanelRefresh=!0,this.surveySection=e.section,this.leftPanelBaseRoute="/list/survey/".concat(e.section)}}),r.view=e,e.controller=gy(r),r.handle=yd.nextHandle,e.addListener(n.EVENT_SELECT_OCCURRENCE,r.occurrenceSelectionHandler.bind(gy(r))),e.addListener(n.EVENT_SELECT_SURVEY_SECTION,r.surveyPartSelectionHandler.bind(gy(r))),e.addListener(n.EVENT_NEW_RECORD,r.newRecordHandler.bind(gy(r))),e.addListener(n.EVENT_DELETE_OCCURRENCE,r.deleteOccurrenceHandler.bind(gy(r))),e.addListener(n.EVENT_BACK,r.backHandler.bind(gy(r))),e.addListener(n.EVENT_NEXT_TO_RECORDS,r.nextTransitionToRecordsHandler.bind(gy(r))),r}return fd(n,[{key:"occurrences",get:function(){return this.app.occurrences}},{key:"currentOccurrence",get:function(){if(Oy(this,SI)){if(this.app.occurrences.has(Oy(this,SI)))return this.app.occurrences.get(Oy(this,SI));throw new Lb("Record id '".concat(Oy(this,SI),"' was not found."))}return null}},{key:"currentOccurrenceId",get:function(){return Oy(this,SI)},set:function(e){_y(this,SI,e)}},{key:"survey",get:function(){return this.app.currentSurvey}},{key:"nextTransitionToRecordsHandler",value:function(){console.log("in nextTransitionToRecordsHandler()"),this.app.haveExtantOccurrences()?this.app.router.navigate("/list/record/"):this.newRecordHandler()}},{key:"deleteOccurrenceHandler",value:function(e){console.log({deleting:e.occurrenceId});var t=this.app.occurrences.get(e.occurrenceId);if(!t)throw new gI("Occurrence id '".concat(e.occurrenceId,"' not found when trying to delete."));t.delete(),this.currentOccurrenceId===e.occurrenceId&&this.app.router.navigate("/list/record/")}},{key:"surveyPartSelectionHandler",value:function(e){console.log({"In surveyPartSelectionHandler":e}),"record"===e.sectionKey?this.app.router.navigate("/list/record/"):e.sectionKey?this.app.router.navigate("/list/survey/".concat(e.sectionKey)):this.app.router.navigate("/list/")}},{key:"newRecordHandler",value:function(){var e=this.app.addNewOccurrence();this.app.router.navigate("/list/record/".concat(e.id))}},{key:"occurrenceSelectionHandler",value:function(e){console.log({"In occurrenceSelectionHandler":e}),this.currentOccurrenceId&&e.occurrenceId&&this.currentOccurrenceId===e.occurrenceId?console.log("ignoring spurious navigation event for '".concat(e.occurrenceId,"'")):this.app.router.navigate("/list/record/".concat(e.occurrenceId))}},{key:"registerRoute",value:function(e){e.on("/list",this.mainRouteHandler.bind(this,"list","",""),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null}),e.on("/list/help",this.mainRouteHandler.bind(this,"list","","help")),e.on("/list/record/",this.mainRouteHandler.bind(this,"list","record",""),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null}),e.on("/list/record/help",this.mainRouteHandler.bind(this,"list","record","help")),e.on("/list/record/:id",this.mainRouteHandler.bind(this,"list","record","form"),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null}),e.on("/list/survey/:section",this.mainRouteHandler.bind(this,"list","survey",""),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null}),e.on("/list/survey/:section/help",this.mainRouteHandler.bind(this,"list","survey","help"))}},{key:"mainRouteHandler",value:function(e,t,n,r){console.log("reached special route handler for MainController.js"),console.log({context:e,params:t,query:r}),this.app.saveRoute();try{this.viewSubcontext=t,t&&this.viewContexts[t].call(this,r),this.app.currentControllerHandle!==this.handle&&(this.needsFullRefresh=!0,this.needRightPanelRefresh=!0,this.app.currentControllerHandle=this.handle),this.view.panelKey=n,this.view.display(),this.needsFullRefresh=!1}catch(e){this.error=e,console.log({error:e});try{this.needsFullRefresh=!0,this.view.display()}catch(e){console.log({rethrownError:e}),document.body.innerHTML="<h2>Internal error</h2><p>Please report this problem:</p><p>".concat(e.message,"</p>")}}}},{key:"backHandler",value:function(){this.app.routeHistory.length>=2&&this.app.routeHistory[this.app.routeHistory.length-2].url===this.leftPanelBaseRoute?(this.app.routeHistory.length-=1,console.log("using standard back navigation"),window.history.back()):(console.log("navigating back using base address '".concat(this.leftPanelBaseRoute,"'")),this.app.router.navigate(this.leftPanelBaseRoute))}}]),n}();hd(bI,"EVENT_SELECT_OCCURRENCE","selectoccurrence"),hd(bI,"EVENT_SELECT_SURVEY_SECTION","selectsurveysection"),hd(bI,"EVENT_NEW_RECORD","newrecord"),hd(bI,"EVENT_DELETE_OCCURRENCE","deleteoccurrence"),hd(bI,"EVENT_BACK","back"),hd(bI,"EVENT_NEXT_TO_RECORDS","nexttorecords");var NI=function(e){by(n,yd);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(e,r){var o;return ud(this,n),hd(gy(o=t.call(this)),"route",void 0),o.view=e,o.route=r,o.handle=yd.nextHandle,o}return fd(n,[{key:"routeHandler",value:function(e,t){this.app.currentControllerHandle=this.handle,this.view.display()}}]),n}(),TI=dh,EI=Ep,wI=Ym,_I=Dd,OI=vf,II=pw,RI=ww;fw("match",(function(e,t,n){return[function(t){var n=_I(this),r=null==t?void 0:OI(t,e);return r?r.call(t,n):new RegExp(t)[e](wI(n))},function(e){var r=TI(this),o=wI(e),a=n(t,r,o);if(a.done)return a.value;if(!r.global)return RI(r,o);var i=r.unicode;r.lastIndex=0;for(var s,c=[],l=0;null!==(s=RI(r,o));){var u=wI(s[0]);c[l]=u,""===u&&(r.lastIndex=II(o,EI(r.lastIndex),i)),l++}return 0===l?null:c}]}));var xI=dv,CI=NS,AI=Av,kI=Vd,LI=bp,MI=_p,PI=Ud,HI=Fb,DI=Bf,FI=Yb("slice"),jI=DI("species"),UI=[].slice,BI=Math.max;xI({target:"Array",proto:!0,forced:!FI},{slice:function(e,t){var n,r,o,a=PI(this),i=MI(a),s=LI(e,i),c=LI(void 0===t?i:t,i);if(CI(a)&&(n=a.constructor,(AI(n)&&(n===Array||CI(n.prototype))||kI(n)&&null===(n=n[jI]))&&(n=void 0),n===Array||void 0===n))return UI.call(a,s,c);for(r=new(void 0===n?Array:n)(BI(c-s,0)),o=0;s<c;s++,o++)s in a&&HI(r,o,a[s]);return r.length=o,r}});var YI=wd,VI=np.EXISTS,JI=lh.f,GI=Function.prototype,qI=GI.toString,KI=/^\s*function ([^ (]*)/;YI&&!VI&&JI(GI,"name",{configurable:!0,get:function(){try{return qI.call(this).match(KI)[1]}catch(e){return""}}});var WI=dh,XI=Ug,QI=Rg,zI=_f,$I=function(e,t,n,r){try{return r?t(WI(n)[0],n[1]):t(n)}catch(t){XI(e,"throw",t)}},ZI=Og,eR=Av,tR=_p,nR=Fb,rR=Dg,oR=Lg;dv({target:"Array",stat:!0,forced:!tS((function(e){Array.from(e)}))},{from:function(e){var t=zI(e),n=eR(this),r=arguments.length,o=r>1?arguments[1]:void 0,a=void 0!==o;a&&(o=QI(o,r>2?arguments[2]:void 0,2));var i,s,c,l,u,d,f=oR(t),h=0;if(!f||this==Array&&ZI(f))for(i=tR(t),s=n?new this(i):Array(i);i>h;h++)d=a?o(t[h],h):t[h],nR(s,h,d);else for(u=(l=rR(t,f)).next,s=n?new this:[];!(c=u.call(l)).done;h++)d=a?$I(l,o,[c.value,h],!0):c.value,nR(s,h,d);return s.length=h,s}});var aR=dv,iR=wd,sR=Nd,cR=Rf,lR=Bd,uR=Vd,dR=lh.f,fR=Wp,hR=sR.Symbol;if(iR&&lR(hR)&&(!("description"in hR.prototype)||void 0!==hR().description)){var pR={},vR=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof vR?new hR(e):void 0===e?hR():hR(e);return""===e&&(pR[t]=!0),t};fR(vR,hR);var yR=vR.prototype=hR.prototype;yR.constructor=vR;var mR=yR.toString,gR="Symbol(test)"==String(hR("test")),SR=/^Symbol\((.*)\)[^)]+$/;dR(yR,"description",{configurable:!0,get:function(){var e=uR(this)?this.valueOf():this,t=mR.call(e);if(cR(pR,e))return"";var n=gR?t.slice(7,-1):t.replace(SR,"$1");return""===n?void 0:n}}),aR({global:!0,forced:!0},{Symbol:vR})}a_("iterator");var bR=dv,NR=Ud,TR=[].join,ER=Hd!=Object,wR=TO("join",",");function _R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function OR(e,t){if(e){if("string"==typeof e)return _R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_R(e,t):void 0}}function IR(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return a}}(e,t)||OR(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}bR({target:"Array",proto:!0,forced:ER||!wR},{join:function(e){return TR.call(NR(this),void 0===e?",":e)}});var RR=lh.f,xR=ey,CR=tg,AR=Rg,kR=Qg,LR=Xg,MR=Im,PR=wN,HR=wd,DR=ng.exports.fastKey,FR=Qh.set,jR=Qh.getterFor;SS("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),{getConstructor:function(e,t,n,r){var o=e((function(e,a){kR(e,o,t),FR(e,{type:t,index:xR(null),first:void 0,last:void 0,size:0}),HR||(e.size=0),null!=a&&LR(a,e[r],{that:e,AS_ENTRIES:n})})),a=jR(t),i=function(e,t,n){var r,o,i=a(e),c=s(e,t);return c?c.value=n:(i.last=c={index:o=DR(t,!0),key:t,value:n,previous:r=i.last,next:void 0,removed:!1},i.first||(i.first=c),r&&(r.next=c),HR?i.size++:e.size++,"F"!==o&&(i.index[o]=c)),e},s=function(e,t){var n,r=a(e),o=DR(t);if("F"!==o)return r.index[o];for(n=r.first;n;n=n.next)if(n.key==t)return n};return CR(o.prototype,{clear:function(){for(var e=a(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,HR?e.size=0:this.size=0},delete:function(e){var t=a(this),n=s(this,e);if(n){var r=n.next,o=n.previous;delete t.index[n.index],n.removed=!0,o&&(o.next=r),r&&(r.previous=o),t.first==n&&(t.first=r),t.last==n&&(t.last=o),HR?t.size--:this.size--}return!!n},forEach:function(e){for(var t,n=a(this),r=AR(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!s(this,e)}}),CR(o.prototype,n?{get:function(e){var t=s(this,e);return t&&t.value},set:function(e,t){return i(this,0===e?0:e,t)}}:{add:function(e){return i(this,e=0===e?0:e,e)}}),HR&&RR(o.prototype,"size",{get:function(){return a(this).size}}),o},setStrong:function(e,t,n){var r=t+" Iterator",o=jR(t),a=jR(r);MR(e,t,(function(e,t){FR(this,{type:r,target:e,state:o(e),kind:t,last:void 0})}),(function(){for(var e=a(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),PR(t)}});var UR=Cp.includes,BR=My;dv({target:"Array",proto:!0},{includes:function(e){return UR(this,e,arguments.length>1?arguments[1]:void 0)}}),BR("includes");var YR=Vd,VR=Ld,JR=Bf("match"),GR=function(e){var t;return YR(e)&&(void 0!==(t=e[JR])?!!t:"RegExp"==VR(e))},qR=GR,KR=Bf("match"),WR=function(e){if(qR(e))throw TypeError("The method doesn't accept regular expressions");return e},XR=Dd,QR=Ym;dv({target:"String",proto:!0,forced:!function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[KR]=!1,"/./"[e](t)}catch(e){}}return!1}("includes")},{includes:function(e){return!!~QR(XR(this)).indexOf(QR(WR(e)),arguments.length>1?arguments[1]:void 0)}});var zR=fw,$R=GR,ZR=dh,ex=Dd,tx=RN,nx=pw,rx=Ep,ox=Ym,ax=vf,ix=ww,sx=ow,cx=Ed,lx=PE.UNSUPPORTED_Y,ux=[].push,dx=Math.min;zR("split",(function(e,t,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var r=ox(ex(this)),o=void 0===n?4294967295:n>>>0;if(0===o)return[];if(void 0===e)return[r];if(!$R(e))return t.call(r,e,o);for(var a,i,s,c=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),u=0,d=new RegExp(e.source,l+"g");(a=sx.call(d,r))&&!((i=d.lastIndex)>u&&(c.push(r.slice(u,a.index)),a.length>1&&a.index<r.length&&ux.apply(c,a.slice(1)),s=a[0].length,u=i,c.length>=o));)d.lastIndex===a.index&&d.lastIndex++;return u===r.length?!s&&d.test("")||c.push(""):c.push(r.slice(u)),c.length>o?c.slice(0,o):c}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,n){var o=ex(this),a=null==t?void 0:ax(t,e);return a?a.call(t,o,n):r.call(ox(o),t,n)},function(e,o){var a=ZR(this),i=ox(e),s=n(r,a,i,o,r!==t);if(s.done)return s.value;var c=tx(a,RegExp),l=a.unicode,u=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(lx?"g":"y"),d=new c(lx?"^(?:"+a.source+")":a,u),f=void 0===o?4294967295:o>>>0;if(0===f)return[];if(0===i.length)return null===ix(d,i)?[i]:[];for(var h=0,p=0,v=[];p<i.length;){d.lastIndex=lx?0:p;var y,m=ix(d,lx?i.slice(p):i);if(null===m||(y=dx(rx(d.lastIndex+(lx?p:0)),i.length))===h)p=nx(i,p,l);else{if(v.push(i.slice(h,p)),v.length===f)return v;for(var g=1;g<=m.length-1;g++)if(v.push(m[g]),v.length===f)return v;p=h=y}}return v.push(i.slice(h)),v}]}),!!cx((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),lx);var fx=function(e){by(n,FO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(){var e;ud(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return hd(gy(e=t.call.apply(t,[this].concat(o))),"controller",void 0),e}return fd(n,[{key:"initialise",value:function(){}},{key:"display",value:function(){console.log("got to view display"),this.refreshHeader(),this.body()}},{key:"refreshHeader",value:function(){}},{key:"body",value:function(){}},{key:"card",value:function(e){var t=document.createElement("div");t.id=e.cardId,t.className="card";var n=t.appendChild(document.createElement("div"));n.className="card-header pointer",e.cardHeadingId&&(n.id=e.cardHeadingId),n.setAttribute("data-toggle","collapse"),n.setAttribute("data-target","#".concat(e.cardDescriptionId));var r=n.appendChild(document.createElement("h2"));r.className="mb-0";var o=r.appendChild(document.createElement("button"));if(o.className="btn btn-link".concat(e.collapsed?" collapsed":""),e.headingButtonId&&(o.id=e.headingButtonId),o.type="button",o.setAttribute("data-toggle","collapse"),e.buttonStyleString&&(o.style.cssText=e.buttonStyleString),e.cardDescriptionId&&(o.setAttribute("data-target","#".concat(e.cardDescriptionId)),o.setAttribute("aria-controls",e.cardDescriptionId)),o.setAttribute("aria-expanded",e.collapsed?"false":"true"),o.innerHTML=e.headingHTML,e.headingNonbuttonHTML){var a=r.appendChild(document.createElement("span"));a.style.display="inline-block",a.innerHTML=e.headingNonbuttonHTML}if(e.headingValidationWarningHTML){var i=n.appendChild(document.createElement("div"));i.className="card-invalid-feedback",i.innerHTML="<small>".concat(e.headingValidationWarningHTML,"</small>")}var s=t.appendChild(document.createElement("div"));if(e.cardDescriptionId&&(s.id=e.cardDescriptionId),s.className="collapse".concat(e.collapsed?"":" show"),e.cardHeadingId&&s.setAttribute("aria-labelledby",e.cardHeadingId),s.setAttribute("data-parent","#".concat(e.parentContainerId)),e.dataAttributes)for(var c in e.dataAttributes)e.dataAttributes.hasOwnProperty(c)&&s.setAttribute("data-".concat(c),e.dataAttributes[c]);var l=s.appendChild(document.createElement("div"));return l.className="card-body pl-2 pr-2 pl-md-3 pr-md-3",l.appendChild(e.bodyContentElement),t}}]),n}();var hx=function(e){by(n,fx);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(){return ud(this,n),t.apply(this,arguments)}return fd(n,[{key:"body",value:function(){document.getElementById("body").innerHTML='<h2>Page not found</h2><p><a href="/app/list">Return to the homepage.</a>'}}]),n}();var px=function(e){by(n,pI);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(e){var r;return ud(this,n),hd(gy(r=t.call(this)),"_survey",void 0),hd(gy(r),"section",void 0),r.section=e,r}return fd(n,[{key:"formElement",get:function(){var e=Mb(Ey(n.prototype),"formElement",this);return this._formFieldsBuilt||this.buildFormFields(),e}},{key:"updateModelFromContent",value:function(){for(var e in console.log("updating survey from SurveyForm content"),this.fields)if(this.fields.hasOwnProperty(e)){var t=this.fields[e];this._survey.attributes[e]=t.value}console.log({survey:this._survey})}},{key:"model",get:function(){return this._survey},set:function(e){this._survey=e,this.populateFormContent()}},{key:"changeHandler",value:function(e){console.log("survey form change event"),console.log({event:e}),this.fireEvent(pI.CHANGE_EVENT,{form:this})}},{key:"destructor",value:function(){Mb(Ey(n.prototype),"destructor",this).call(this),this._survey=null}},{key:"initialiseFormFields",value:function(){var e=this.section.properties;for(var t in this.fields={},e)e.hasOwnProperty(t)&&(this.fields[t]=new e[t].field(e[t].attributes))}},{key:"getFormSectionProperties",value:function(){return this.section.properties}}],[{key:"registerSection",value:function(e){n.sections[e.sectionSortOrder]=e,n.sectionsByKey[e.sectionNavigationKey]=e}}]),n}();hd(px,"sections",[]),hd(px,"sectionsByKey",{});var vx=function(e){by(n,YO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(){var e;ud(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return hd(gy(e=t.call.apply(t,[this].concat(o))),"SAVE_ENDPOINT","/savesurvey.php"),hd(gy(e),"TYPE","survey"),hd(gy(e),"attributes",{}),e}return fd(n,[{key:"formChangedHandler",value:function(e){console.log("Survey change handler invoked."),e.form.updateModelFromContent(),e.form.conditionallyValidateForm(),this.touch(),this.fireEvent(n.EVENT_MODIFIED,{surveyId:this.id})}},{key:"registerForm",value:function(e){e.model=this,e.addListener(pI.CHANGE_EVENT,this.formChangedHandler.bind(this))}},{key:"save",value:function(){if(this._savedRemotely)return Promise.reject("".concat(this.id," has already been saved."));var e=new FormData;return e.append("type",this.TYPE),e.append("surveyId",this.id),e.append("id",this.id),e.append("projectId",this.projectId.toString()),e.append("attributes",JSON.stringify(this.attributes)),e.append("deleted",this.deleted.toString()),e.append("created",this.createdStamp.toString()),console.log("queueing survey post"),this.queuePost(e)}},{key:"generateSurveyName",value:function(){var e,t=(this.attributes.place||this.attributes.georef||"(unlocalised)").trim(),n=new Date(1e3*this.createdStamp);try{e=n.toLocaleString("default",{year:"numeric",month:"long",day:"numeric"})}catch(t){e=n.toLocaleString("en-GB",{year:"numeric",month:"long",day:"numeric"})}return"".concat(JO(t)," ").concat(e)}}]),n}();hd(vx,"EVENT_MODIFIED","modified");var yx=function(e){by(n,YO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(){var e;ud(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return hd(gy(e=t.call.apply(t,[this].concat(o))),"file",void 0),hd(gy(e),"TYPE","image"),hd(gy(e),"SAVE_ENDPOINT","/saveimage.php"),e}return fd(n,[{key:"getUrl",value:function(){}},{key:"save",value:function(e,t,n){if(this._savedRemotely)return Promise.reject("".concat(this.id," has already been saved."));var r=new FormData;return r.append("type",this.TYPE),r.append("surveyId",e||""),r.append("occurrenceId",t||this.occurrenceId),r.append("projectId",n?n.toString():""),r.append("imageId",this.id),r.append("id",this.id),r.append("image",this.file),r.append("deleted",this.deleted.toString()),console.log("queueing image post, image id ".concat(this.id)),this.queuePost(r)}},{key:"_parseDescriptor",value:function(e){Mb(Ey(n.prototype),"_parseDescriptor",this).call(this,e),this.surveyId=e.surveyId,this.occurrenceId=e.occurrenceId,this.file=e.image}}],[{key:"fromFile",value:function(e){var t=new n;return t.file=e,t}},{key:"placeholder",value:function(e){var t=new n;return t._id=e,n.imageCache.set(e,t),t}},{key:"imageLink",value:function(e,t,n,r){t=t||0,n=n||0;var o="";r.className&&(o+=' class="'.concat(r.className,'"'));var a=t>n?'width="'.concat(t,'"'):'height="'.concat(n,'"');return'<picture><source srcset="/image.php?imageid='.concat(e,'&amp;height=128&amp;format=webp" type="image/webp"><img').concat(o,' src="/image.php?imageid=').concat(e,"&amp;width=").concat(t,"&amp;height=").concat(n,'&amp;format=jpeg" ').concat(a,' alt="photo"></picture>')}}]),n}();function mx(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return gx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gx(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function gx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Sx(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}hd(yx,"imageCache",new Map),hd(yx,"EVENT_MODIFIED","modified");var bx=new WeakMap,Nx=new WeakMap,Tx=function(e){by(n,FO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(){var e;return ud(this,n),Sx(gy(e=t.call(this)),bx,{writable:!0,value:void 0}),Sx(gy(e),Nx,{writable:!0,value:void 0}),hd(gy(e),"controllers",[]),hd(gy(e),"currentControllerHandle",!1),hd(gy(e),"routeHistory",[]),hd(gy(e),"occurrences",void 0),hd(gy(e),"surveys",void 0),hd(gy(e),"currentSurvey",void 0),hd(gy(e),"layout",void 0),e.reset(),e}return fd(n,[{key:"reset",value:function(){this.surveys=new Map,this.clearCurrentSurvey()}},{key:"clearCurrentSurvey",value:function(){this.occurrences=new Map,this.currentSurvey=null}},{key:"router",get:function(){return Oy(this,bx)},set:function(e){_y(this,bx,e)}},{key:"containerId",set:function(e){var t=document.getElementById(e);if(!t)throw new Error("App container '".concat(e,"' not found."));_y(this,Nx,t)}},{key:"container",get:function(){return Oy(this,Nx)}},{key:"registerController",value:function(e){e.handle=this.controllers.length,this.controllers[this.controllers.length]=e,e.app=this,e.registerRoute(Oy(this,bx))}},{key:"initialise",value:function(){var e=this;this.layout.initialise(),Oy(this,bx).notFound((function(e){console.log("no route found for '".concat(e,"'")),(new hx).display()})),Oy(this,bx).on((function(){console.log("redirecting from '/' to '/list'"),Oy(e,bx).pause(),e.currentSurvey&&e.currentSurvey.isPristine?Oy(e,bx).navigate("/list/survey/welcome").resume():Oy(e,bx).navigate("/list").resume(),Oy(e,bx).resolve()}));var t,n=mx(this.controllers);try{for(n.s();!(t=n.n()).done;)t.value.initialise()}catch(e){n.e(e)}finally{n.f()}}},{key:"display",value:function(){console.log("App display"),Oy(this,bx).resolve()}},{key:"saveRoute",value:function(){var e=Oy(this,bx).lastRouteResolved();this.routeHistory.length?this.routeHistory[this.routeHistory.length-1]!==e&&(this.routeHistory[this.routeHistory.length]=e):this.routeHistory[0]=e}},{key:"markAllNotPristine",value:function(){var e,t=mx(this.occurrences);try{for(t.s();!(e=t.n()).done;)e.value[1].isPristine=!1}catch(e){t.e(e)}finally{t.f()}}},{key:"setLayout",value:function(e){this.layout=e,e.setApp(this)}},{key:"addSurvey",value:function(e){var t=this;if(e.projectId!==this.projectId)throw new Error("Survey project id '".concat(e.projectId," does not match with current project ('").concat(this.projectId,"')"));this.surveys.has(e.id)||(console.log("setting survey's modified/save handler"),e.addListener(vx.EVENT_MODIFIED,(function(){return t.fireEvent(n.EVENT_SURVEYS_CHANGED),e.save()}))),this.surveys.set(e.id,e),this.fireEvent(n.EVENT_SURVEYS_CHANGED)}},{key:"haveExtantOccurrences",value:function(){var e,t=mx(this.occurrences);try{for(t.s();!(e=t.n()).done;)if(!e.value.deleted)return!0}catch(e){t.e(e)}finally{t.f()}return!1}},{key:"addOccurrence",value:function(e){var t=this;if(!e.surveyId)throw new gI("Survey id must set prior to registering occurrence.");0===this.occurrences.size&&(this.surveys.get(e.surveyId).createdStamp=e.createdStamp),console.log("in addOccurrence setting id '".concat(e.id,"'")),this.occurrences.set(e.id,e),e.addListener(mI.EVENT_MODIFIED,(function(){var n=t.surveys.get(e.surveyId);if(!n)throw new Error("Failed to look up survey id ".concat(e.surveyId));n.isPristine=!1,n.unsaved()&&n.save(),e.save(n.id)}))}},{key:"refreshFromServer",value:function(e){var t,n=this,r=new FormData,o=0,a=mx(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;r.append("surveyId[".concat(o++,"]"),i)}}catch(e){a.e(e)}finally{a.f()}return fetch(ExampleApp.LOAD_SURVEYS_ENDPOINT,{method:"POST",body:r}).then((function(e){return e.ok?e.json():Promise.reject("Invalid response from server when refreshing survey ids")})).then((function(e){console.log({"refresh from server json response":e});var t=[];for(var r in e)if(e.hasOwnProperty(r)){var o,a=mx(e[r]);try{for(a.s();!(o=a.n()).done;){var i=o.value;t.push(n._conditionallyReplaceObject(i))}}catch(e){a.e(e)}finally{a.f()}}return Promise.all(t)}))}},{key:"_conditionallyReplaceObject",value:function(e){var t=e.type,n=e.id,r="".concat(t,".").concat(n);return jO.getItem(r).then((function(t){return t&&!e.deleted&&t.modified>=e.modified?(console.log("Local copy of ".concat(r," is the same or newer than the server copy. (").concat(t.modified," >= ").concat(e.modified,") ")),Promise.resolve()):(console.log("Adding or replacing local copy of ".concat(r)),jO.setItem(r,e))}))}},{key:"seekKeys",value:function(e){return jO.keys().then((function(t){var n,r=mx(t);try{for(r.s();!(n=r.n()).done;){var o,a,i=IR(n.value.split(".",2),2);o=i[0],a=i[1],e.hasOwnProperty(o)?e[o].includes(a)||e[o].push(a):console.log("Unrecognised stored key type '".concat(o,"."))}}catch(e){r.e(e)}finally{r.f()}return e}))}},{key:"syncAll",value:function(){var e=this;return this.seekKeys({survey:[],occurrence:[],image:[]}).then((function(t){return e._syncLocalUnsaved(t)}),(function(e){return console.log("Failed to sync all: ".concat(e)),!1}))}},{key:"_syncLocalUnsaved",value:function(e){var t,n=[],r=mx(e.survey);try{for(r.s();!(t=r.n()).done;){var o=t.value;n.push(vx.retrieveFromLocal(o,new vx).then((function(e){if(e.unsaved())return e.save()})))}}catch(e){r.e(e)}finally{r.f()}var a,i=mx(e.occurrence);try{for(i.s();!(a=i.n()).done;){var s=a.value;n.push(mI.retrieveFromLocal(s,new mI).then((function(e){if(e.unsaved())return e.save()})))}}catch(e){i.e(e)}finally{i.f()}var c,l=mx(e.image);try{for(l.s();!(c=l.n()).done;){var u=c.value;n.push(yx.retrieveFromLocal(u,new yx).then((function(e){if(e.unsaved())return e.save()})))}}catch(e){l.e(e)}finally{l.f()}return Promise.all(n).catch((function(e){console.log("Save failure: ".concat(e))}))}},{key:"restoreOccurrences",value:function(e){var t=this;if(this.surveys.has(e)){var r=this.surveys.get(e);if(r.isPristine)return this.clearCurrentSurvey(),this.currentSurvey=r,this.fireEvent(n.EVENT_SURVEYS_CHANGED),Promise.resolve()}var o={survey:[],occurrence:[],image:[]};return e&&(o.survey[0]=e),console.log("pre-seek keys"),console.log(o),this.seekKeys(o).then((function(e){return e.survey.length?t.refreshFromServer(e.survey).finally((function(){return t.seekKeys(e)})):null})).finally((function(){return o.survey.length?t._restoreSurveyFromLocal(o.survey[0],o).finally((function(){return t.currentSurvey=t.surveys.get(o.survey[0]),t.currentSurvey?(t.currentSurvey.deleted?t.setNewSurvey():t.fireEvent(n.EVENT_SURVEYS_CHANGED),Promise.resolve()):(console.log("Failed to retrieve survey id '".concat(e,"'")),Promise.reject(new Error("Failed to retrieve survey id '".concat(e,"'"))))})):(t.setNewSurvey(),Promise.resolve())}))}},{key:"setNewSurvey",value:function(){this.currentSurvey=new vx,this.currentSurvey.projectId=this.projectId,this.currentSurvey.isPristine=!0,this.addSurvey(this.currentSurvey)}},{key:"addNewOccurrence",value:function(){var e=new mI;return e.surveyId=this.currentSurvey.id,e.projectId=this.projectId,e.isNew=!0,e.isPristine=!0,this.addOccurrence(e),this.fireEvent(ExampleApp.EVENT_OCCURRENCE_ADDED,{occurrenceId:e.id,surveyId:e.surveyId}),e}},{key:"_restoreSurveyFromLocal",value:function(e,t){var n=this;return vx.retrieveFromLocal(e,new vx).then((function(r){n.clearCurrentSurvey(),n.addSurvey(r);var o,a=[],i=mx(t.occurrence);try{var s=function(){var t=o.value;a.push(mI.retrieveFromLocal(t,new mI).then((function(r){r.surveyId===e&&(console.log("adding occurrence ".concat(t)),n.addOccurrence(r))})))};for(i.s();!(o=i.n()).done;)s()}catch(e){i.e(e)}finally{i.f()}return Promise.all(a)})).finally((function(){var n,r=[],o=mx(t.image);try{var a=function(){var t=n.value;r.push(yx.retrieveFromLocal(t,new yx).then((function(n){console.log("restoring image id '".concat(t,"'")),n.surveyId===e&&yx.imageCache.set(t,n)}),(function(e){console.log("Failed to retrieve an image: ".concat(e))})))};for(o.s();!(n=o.n()).done;)a()}catch(e){o.e(e)}finally{o.f()}return Promise.all(r)}))}},{key:"clearLocalForage",value:function(){return jO.clear()}}]),n}();function Ex(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}hd(Tx,"EVENT_ADD_SURVEY_USER_REQUEST","useraddsurveyrequest"),hd(Tx,"EVENT_RESET_SURVEYS","userresetsurveys"),hd(Tx,"LOAD_SURVEYS_ENDPOINT","/loadsurveys.php"),hd(Tx,"EVENT_OCCURRENCE_ADDED","occurrenceadded"),hd(Tx,"EVENT_SURVEYS_CHANGED","surveyschanged"),hd(Tx,"devMode",!1);var wx=function(e){by(n,FO);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(){var e;ud(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return hd(gy(e=t.call.apply(t,[this].concat(o))),"app",void 0),hd(gy(e),"surveysMenuId",void 0),e}return fd(n,[{key:"setApp",value:function(e){var t=this;this.app=e,e.addListener(Tx.EVENT_SURVEYS_CHANGED,(function(){t.refreshSurveysMenu()}))}},{key:"initialise",value:function(){var e=this;this.refreshSurveysMenu();var t=document.createElement("div");t.innerHTML='\x3c!-- begin: templates/newSurveyModal.html --\x3e\r\n<div class="modal fade" id="newsurveymodal" tabindex="-1" role="dialog" aria-labelledby="newsurveymodalTitle" aria-hidden="true">\r\n    <div class="modal-dialog modal-dialog-centered" role="document">\r\n        <div class="modal-content">\r\n            <div class="modal-header">\r\n                <h5 class="modal-title" id="newsurveymodalTitle">Start a new survey?</h5>\r\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close">\r\n                    <span aria-hidden="true">&times;</span>\r\n                </button>\r\n            </div>\r\n            <div class="modal-body">\r\n                Please confirm that you wish to start a new survey. You only need to do this if you wish to send a set of records from a different locality, otherwise please add more records to your current report.\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-secondary" data-dismiss="modal">Back</button>\r\n                <button type="button" class="btn btn-danger" data-dismiss="modal" id="newsurveymodalconfirmed">New survey</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\x3c!-- end: templates/newSurveyModal.html --\x3e\r\n',document.body.appendChild(t.getElementsByTagName("div")[0]),(t=document.createElement("div")).innerHTML='\x3c!-- begin: templates/resetModal.html --\x3e\r\n<div class="modal fade" id="resetmodal" tabindex="-1" role="dialog" aria-labelledby="resetmodalTitle" aria-hidden="true">\r\n    <div class="modal-dialog modal-dialog-centered" role="document">\r\n        <div class="modal-content">\r\n            <div class="modal-header">\r\n                <h5 class="modal-title" id="resetmodalTitle">Reset?</h5>\r\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close">\r\n                    <span aria-hidden="true">&times;</span>\r\n                </button>\r\n            </div>\r\n            <div class="modal-body">\r\n                Please confirm that you wish to clear out your survey data.\r\n                <p>Warning: any unsaved changes will be lost.</p>\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-secondary" data-dismiss="modal">Back</button>\r\n                <button type="button" class="btn btn-danger" data-dismiss="modal" id="resetmodalconfirmed">Reset</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\x3c!-- end: templates/resetModal.html --\x3e\r\n',document.body.appendChild(t.getElementsByTagName("div")[0]),(t=document.createElement("div")).innerHTML='\x3c!-- begin: templates/syncSuccessModal.html --\x3e\r\n<div class="modal fade" id="saveallsuccess" tabindex="-1" role="dialog" aria-labelledby="saveallsuccessTitle" aria-hidden="true">\r\n    <div class="modal-dialog modal-dialog-centered" role="document">\r\n        <div class="modal-content">\r\n            <div class="modal-header">\r\n                <h5 class="modal-title" id="saveallsuccessTitle">All records sent</h5>\r\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close">\r\n                    <span aria-hidden="true">&times;</span>\r\n                </button>\r\n            </div>\r\n            <div class="modal-body">\r\n                Your data has been synchronised with the server.\r\n                <p>Thank you.</p>\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\x3c!-- end: templates/syncSuccessModal.html --\x3e\r\n',document.body.appendChild(t.getElementsByTagName("div")[0]),(t=document.createElement("div")).innerHTML='\x3c!-- begin: templates/syncFailureModal.html --\x3e\r\n<div class="modal fade" id="saveallfailure" tabindex="-1" role="dialog" aria-labelledby="saveallfailureTitle" aria-hidden="true">\r\n    <div class="modal-dialog modal-dialog-centered" role="document">\r\n        <div class="modal-content">\r\n            <div class="modal-header">\r\n                <h5 class="modal-title" id="saveallfailureTitle">One or more records could not be saved</h5>\r\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close">\r\n                    <span aria-hidden="true">&times;</span>\r\n                </button>\r\n            </div>\r\n            <div class="modal-body">\r\n                Please check your connection to the network and try again.\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\x3c!-- end: templates/syncFailureModal.html --\x3e\r\n',document.body.appendChild(t.getElementsByTagName("div")[0]),setTimeout((function(){document.getElementById("".concat(n.NEW_SURVEY_MODAL_ID,"confirmed")).addEventListener("click",(function(t){e.app.fireEvent(Tx.EVENT_ADD_SURVEY_USER_REQUEST)})),document.getElementById("".concat(n.RESET_MODAL_ID,"confirmed")).addEventListener("click",(function(t){e.app.fireEvent(Tx.EVENT_RESET_SURVEYS)}))}),100)}},{key:"refreshSurveysMenu",value:function(){var e,t=document.getElementById(this.surveysMenuId),n=[],r=this.app.currentSurvey?this.app.currentSurvey.id:null,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ex(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ex(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}(this.app.surveys);try{for(o.s();!(e=o.n()).done;){var a=e.value,i=a[1].generateSurveyName()+(a[0]===r?' <span style="color: green">â</span>':"");n[n.length]='<a class="dropdown-item" href="/app/survey/add/'.concat(a[0],'" data-navigo="survey/add/').concat(a[0],'">').concat(i,"</a>")}}catch(e){o.e(e)}finally{o.f()}t.innerHTML='<a class="dropdown-item" href="/app/survey/save" data-navigo="survey/save">save all</a>\n    <div class="dropdown-divider"></div>\n    '.concat(n.join(""),'\n    <div class="dropdown-divider"></div>\n    <a class="dropdown-item" href="/app/survey/new" data-navigo="survey/new">new survey</a>\n    <a class="dropdown-item" href="/app/survey/reset" data-navigo="survey/reset">reset</a>'),this.app.router.updatePageLinks()}}]),n}();hd(wx,"NEW_SURVEY_MODAL_ID","newsurveymodal"),hd(wx,"RESET_MODAL_ID","resetmodal"),hd(wx,"SAVE_ALL_SUCCESS_MODAL_ID","saveallsuccess"),hd(wx,"SAVE_ALL_FAILURE_MODAL_ID","saveallfailure");var _x=function(e){by(n,yd);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(e){var r;return ud(this,n),hd(gy(r=t.call(this)),"route","/survey/:action/:id"),hd(gy(r),"title","Survey picker"),hd(gy(r),"app",void 0),hd(gy(r),"view",void 0),r.view=e,e.controller=gy(r),r.handle=yd.nextHandle,r}return fd(n,[{key:"survey",get:function(){return this.app.currentSurvey}},{key:"registerRoute",value:function(e){e.on("/survey",this.mainRouteHandler.bind(this,"survey","",""),{}),e.on("/survey/new",this.newSurveyHandler.bind(this,"survey","new",""),{before:this.beforeNewHandler.bind(this)}),e.on("/survey/reset",this.mainRouteHandler.bind(this,"survey","reset",""),{before:this.beforeResetHandler.bind(this)}),e.on("/survey/save",this.mainRouteHandler.bind(this,"survey","save",""),{before:this.beforeSaveAllHandler.bind(this)}),e.on("/survey/add/:surveyId",this.addSurveyHandler.bind(this,"survey","add","")),this.app.addListener(Tx.EVENT_ADD_SURVEY_USER_REQUEST,this.addNewSurveyHandler.bind(this)),this.app.addListener(Tx.EVENT_RESET_SURVEYS,this.resetSurveysHandler.bind(this))}},{key:"beforeNewHandler",value:function(e){$("#".concat(wx.NEW_SURVEY_MODAL_ID)).modal(),this.app.router.pause(),window.history.back(),this.app.router.resume(),e(!1)}},{key:"beforeResetHandler",value:function(e){$("#".concat(wx.RESET_MODAL_ID)).modal(),this.app.router.pause(),window.history.back(),this.app.router.resume(),e(!1)}},{key:"beforeSaveAllHandler",value:function(e){this.app.syncAll().then((function(e){console.log("In save all handler, success result: ".concat(e)),Array.isArray(e)?$("#".concat(wx.SAVE_ALL_SUCCESS_MODAL_ID)).modal():$("#".concat(wx.SAVE_ALL_FAILURE_MODAL_ID)).modal()}),(function(e){console.log("In save all handler, failure result: ".concat(e)),$("#".concat(wx.SAVE_ALL_FAILURE_MODAL_ID)).modal()})).finally((function(){})),this.app.router.pause(),window.history.back(),this.app.router.resume(),e(!1)}},{key:"newSurveyHandler",value:function(e,t,n,r){}},{key:"addNewSurveyHandler",value:function(){console.log("reached addNewSurveyHandler"),this.app.currentControllerHandle=this.handle,this.app.clearCurrentSurvey(),this.app.setNewSurvey(),this.app.router.pause(),this.app.router.navigate("/list/survey/welcome").resume(),this.app.router.resolve()}},{key:"resetSurveysHandler",value:function(){var e=this;this.app.clearLocalForage().then((function(){e.app.reset(),e.addNewSurveyHandler()}))}},{key:"addSurveyHandler",value:function(e,t,n,r){var o=this;console.log("reached addSurveyHandler"),console.log({context:e,params:t,query:r}),this.app.currentControllerHandle=this.handle;var a=r.surveyId;if(!a||!a.match(BO))throw new Lb("Failed to match survey id '".concat(a,"', the id format appears to be incorrect"));a=a.toLowerCase(),this.app.restoreOccurrences(a).then((function(){o.app.markAllNotPristine(),o.app.router.pause(),o.app.router.navigate("/list").resume(),o.app.router.resolve()}),(function(e){console.log({"failed survey restoration":e})}))}},{key:"mainRouteHandler",value:function(e,t,n,r){console.log("reached special route handler for SurveyPickerController.js"),console.log({context:e,params:t,query:r})}}]),n}();hd(_x,"EVENT_BACK","back");var Ox=dv,Ix=sm,Rx=Dd,xx=Ep,Cx=Ym,Ax=dh,kx=GR,Lx=oN,Mx=vf,Px=bh.exports,Hx=Ed,Dx=RN,Fx=pw,jx=ww,Ux=Qh,Bx=Bf("matchAll"),Yx=Ux.set,Vx=Ux.getterFor("RegExp String Iterator"),Jx=RegExp.prototype,Gx="".matchAll,qx=!!Gx&&!Hx((function(){"a".matchAll(/./)})),Kx=Ix((function(e,t,n,r){Yx(this,{type:"RegExp String Iterator",regexp:e,string:t,global:n,unicode:r,done:!1})}),"RegExp String",(function(){var e=Vx(this);if(e.done)return{value:void 0,done:!0};var t=e.regexp,n=e.string,r=jx(t,n);return null===r?{value:void 0,done:e.done=!0}:e.global?(""===Cx(r[0])&&(t.lastIndex=Fx(n,xx(t.lastIndex),e.unicode)),{value:r,done:!1}):(e.done=!0,{value:r,done:!1})}));Ox({target:"String",proto:!0,forced:qx},{matchAll:function(e){var t,n,r=Rx(this);if(null!=e){if(kx(e)&&!~Cx(Rx("flags"in Jx?e.flags:Lx.call(e))).indexOf("g"))throw TypeError("`.matchAll` does not allow non-global regexes");if(qx)return Gx.apply(r,arguments);if(n=Mx(e,Bx))return n.call(e,r)}else if(qx)return Gx.apply(r,arguments);return t=Cx(r),new RegExp(e,"g")[Bx](t)}}),Bx in Jx||Px(Jx,Bx,(function(e){var t,n,r,o,a,i,s=Ax(this),c=Cx(e);return t=Dx(s,RegExp),void 0===(n=s.flags)&&s instanceof RegExp&&!("flags"in Jx)&&(n=Lx.call(s)),r=void 0===n?"":Cx(n),o=new t(t===RegExp?s.source:s,r),a=!!~r.indexOf("g"),i=!!~r.indexOf("u"),o.lastIndex=xx(s.lastIndex),new Kx(o,c,a,i)}));var Wx=MS.map;function Xx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}dv({target:"Array",proto:!0,forced:!Yb("map")},{map:function(e){return Wx(this,e,arguments.length>1?arguments[1]:void 0)}});var Qx=function(){function e(){ud(this,e)}return fd(e,null,[{key:"fromPostedData",value:function(t){var n,r={saveState:"SAVED_LOCALLY"},o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Xx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xx(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}(t.entries());try{for(o.s();!(n=o.n()).done;){var a=n.value;r[a[0]]=a[1]}}catch(t){o.e(t)}finally{o.f()}if(!r.type)throw new Error("Missing type in form data.");if(e.responses.hasOwnProperty(r.type))return new e.responses[r.type](r,{});throw new Error("Unrecognised post type '".concat(r.type,"'"))}},{key:"fromPostResponse",value:function(t){if(!t)throw new Error("Invalid empty post response.");if(!t.type)throw new Error("Missing type in returned response.");if(e.responses.hasOwnProperty(t.type))return console.log("in fromPostResponse returning a ".concat(t.type)),new e.responses[t.type]({},t);throw new Error("Unrecognised post type '".concat(t.type,"'"))}}]),e}();function zx(e){var t=new Headers;return t.set("Content-Type","application/json"),new Response(JSON.stringify(e),{status:e.error?500:200,headers:t})}hd(Qx,"responses",{});var $x=function(){function e(t,n){ud(this,e),hd(this,"toSaveLocally",void 0),hd(this,"returnedToClient",void 0),hd(this,"prebuiltResponse",void 0),hd(this,"failureErrorMessage","Failed to save a local copy on your device."),hd(this,"failureErrorHelp","Your internet connection may have failed (or there could be a problem with the server). It wasn't possible to save a temporary copy on your device. Perhaps there is insufficient space? Please try to re-establish a network connection and try again."),this.toSaveLocally=t,this.returnedToClient=n}return fd(e,[{key:"setPrebuiltResponse",value:function(e){return this.prebuiltResponse=e,this}},{key:"storeLocally",value:function(){var e=this;return jO.setItem(this.localKey(),this.toSaveLocally).then((function(){return console.log("Stored object ".concat(e.localKey()," locally")),e.prebuiltResponse?e.prebuiltResponse:zx(e.returnedToClient)}),(function(t){return console.log("Failed to store object ".concat(e.localKey()," locally")),console.log({reason:t}),e.returnedToClient.error=e.failureErrorMessage,e.returnedToClient.errorHelp=e.failureErrorHelp,zx(e.returnedToClient)}))}},{key:"localKey",value:function(){throw new Error("LocalKey must be implemented in a subclass for ".concat(this.toSaveLocally.type))}}]),e}();var Zx=function(e){by(n,$x);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(){var e;ud(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return hd(gy(e=t.call.apply(t,[this].concat(o))),"failureErrorMessage","Failed to store image."),hd(gy(e),"failureErrorHelp","Your internet connection may have failed (or there could be a problem with the server). It wasn't possible to save a temporary copy on your device. Perhaps there is insufficient space? Please try to re-establish a network connection and try again."),e}return fd(n,[{key:"populateClientResponse",value:function(){return this.returnedToClient.id=this.toSaveLocally.imageId?this.toSaveLocally.imageId:this.toSaveLocally.id,this.returnedToClient.imageId=this.toSaveLocally.imageId?this.toSaveLocally.imageId:this.toSaveLocally.id,this.returnedToClient.type="image",this.returnedToClient.surveyId=this.toSaveLocally.surveyId,this.returnedToClient.occurrenceId=this.toSaveLocally.occurrenceId,this.returnedToClient.created=parseInt(this.toSaveLocally.created,10),this.returnedToClient.modified=parseInt(this.toSaveLocally.modified,10),this.returnedToClient.saveState="SAVED_LOCALLY",this.returnedToClient.deleted=this.toSaveLocally.deleted,this.returnedToClient.projectId=parseInt(this.toSaveLocally.projectId,10),this}},{key:"populateLocalSave",value:function(){return this.toSaveLocally.surveyId=this.returnedToClient.surveyId,this.toSaveLocally.type="image",this.toSaveLocally.occurrenceId=this.returnedToClient.occurrenceId,this.toSaveLocally.imageId=this.returnedToClient.id?this.returnedToClient.id:this.returnedToClient.imageId,this.toSaveLocally.id=this.returnedToClient.id?this.returnedToClient.id:this.returnedToClient.imageId,this.toSaveLocally.created=parseInt(this.returnedToClient.created,10),this.toSaveLocally.modified=parseInt(this.returnedToClient.modified,10),this.toSaveLocally.saveState="SAVED_TO_SERVER",this.toSaveLocally.deleted=!0===this.returnedToClient.deleted||"true"===this.returnedToClient.deleted,this.toSaveLocally.projectId=parseInt(this.returnedToClient.projectId,10),this}},{key:"localKey",value:function(){return"image.".concat(this.toSaveLocally.imageId)}}],[{key:"register",value:function(){Qx.responses.image=n}}]),n}();var eC=function(e){by(n,$x);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(){var e;ud(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return hd(gy(e=t.call.apply(t,[this].concat(o))),"failureErrorMessage","Failed to store survey."),hd(gy(e),"failureErrorHelp","Your internet connection may have failed (or there could be a problem with the server). It wasn't possible to save a temporary copy on your device. Perhaps there is insufficient space? Please try to re-establish a network connection and try again."),e}return fd(n,[{key:"populateClientResponse",value:function(){return this.toSaveLocally.surveyId=this.returnedToClient.id?this.returnedToClient.id:this.returnedToClient.surveyId,this.toSaveLocally.id=this.returnedToClient.id?this.returnedToClient.id:this.returnedToClient.surveyId,this.returnedToClient.type="survey",this.returnedToClient.attributes=this.toSaveLocally.attributes,this.returnedToClient.created=this.toSaveLocally.created,this.returnedToClient.modified=this.toSaveLocally.modified,this.returnedToClient.saveState="SAVED_LOCALLY",this.returnedToClient.deleted=this.toSaveLocally.deleted,this.returnedToClient.projectId=this.toSaveLocally.projectId,this}},{key:"populateLocalSave",value:function(){return this.toSaveLocally.surveyId=this.returnedToClient.id?this.returnedToClient.id:this.returnedToClient.surveyId,this.toSaveLocally.id=this.returnedToClient.id?this.returnedToClient.id:this.returnedToClient.surveyId,this.toSaveLocally.type="survey",this.toSaveLocally.attributes=this.returnedToClient.attributes,this.toSaveLocally.created=parseInt(this.returnedToClient.created,10),this.toSaveLocally.modified=parseInt(this.returnedToClient.modified,10),this.toSaveLocally.saveState="SAVED_TO_SERVER",this.toSaveLocally.deleted=this.returnedToClient.deleted,this.toSaveLocally.projectId=parseInt(this.returnedToClient.projectId,10),this}},{key:"localKey",value:function(){return"survey.".concat(this.toSaveLocally.surveyId)}}],[{key:"register",value:function(){Qx.responses.survey=n}}]),n}();var tC=function(e){by(n,$x);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(){var e;ud(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return hd(gy(e=t.call.apply(t,[this].concat(o))),"failureErrorMessage","Failed to store occurrence."),hd(gy(e),"failureErrorHelp","Your internet connection may have failed (or there could be a problem with the server). It wasn't possible to save a temporary copy on your device. Perhaps there is insufficient space? Please try to re-establish a network connection and try again."),e}return fd(n,[{key:"populateClientResponse",value:function(){return this.returnedToClient.id=this.toSaveLocally.occurrenceId?this.toSaveLocally.occurrenceId:this.toSaveLocally.id,this.returnedToClient.occurrenceId=this.toSaveLocally.occurrenceId?this.toSaveLocally.occurrenceId:this.toSaveLocally.id,this.returnedToClient.type="occurrence",this.returnedToClient.surveyId=this.toSaveLocally.surveyId,this.returnedToClient.attributes=this.toSaveLocally.attributes,this.returnedToClient.created=parseInt(this.toSaveLocally.created,10),this.returnedToClient.modified=parseInt(this.toSaveLocally.modified,10),this.returnedToClient.saveState="SAVED_LOCALLY",this.returnedToClient.deleted=this.toSaveLocally.deleted,this.returnedToClient.projectId=parseInt(this.toSaveLocally.projectId,10),this}},{key:"populateLocalSave",value:function(){return this.toSaveLocally.occurrenceId=this.returnedToClient.id?this.returnedToClient.id:this.returnedToClient.occurrenceId,this.toSaveLocally.id=this.returnedToClient.id?this.returnedToClient.id:this.returnedToClient.occurrenceId,this.toSaveLocally.type="occurrence",this.toSaveLocally.surveyId=this.returnedToClient.surveyId,this.toSaveLocally.attributes=this.returnedToClient.attributes,this.toSaveLocally.created=parseInt(this.returnedToClient.created,10),this.toSaveLocally.modified=parseInt(this.returnedToClient.modified,10),this.toSaveLocally.saveState="SAVED_TO_SERVER",this.toSaveLocally.deleted=!0===this.returnedToClient.deleted||"true"===this.returnedToClient.deleted,this.toSaveLocally.projectId=parseInt(this.returnedToClient.projectId,10),this}},{key:"localKey",value:function(){return"occurrence.".concat(this.toSaveLocally.occurrenceId)}}],[{key:"register",value:function(){Qx.responses.occurrence=n}}]),n}();!function(){function e(){ud(this,e),hd(this,"URL_CACHE_SET",void 0)}fd(e,[{key:"initialise",value:function(e){var t=this;Promise.prototype.finally||(Promise.prototype.finally=function(e){return this.then(e).catch(e)}),Zx.register(),eC.register(),tC.register(),this.CACHE_VERSION="version-1.0.2.1634121489-".concat(e.version);var n=e.postPassThroughWhitelist,r=e.postImageUrlMatch,o=e.getImageUrlMatch,a=e.interceptUrlMatches,i=e.ignoreUrlMatches,s=e.indexUrl;this.URL_CACHE_SET=e.urlCacheSet,jO.config({name:e.forageName}),self.addEventListener("install",(function(e){console.log("BSBI app service worker is being installed."),self.skipWaiting(),e.waitUntil(t.precache().then((function(){return self.skipWaiting()})))})),self.addEventListener("activate",(function(e){e.waitUntil(self.clients.matchAll({includeUncontrolled:!0}).then((function(e){var t=e.map((function(e){return e.url}));console.log("[ServiceWorker] Matching clients:",t.join(", "))})).then((function(){return caches.keys()})).then((function(e){return Promise.all(e.map((function(e){if(e!==t.CACHE_VERSION)return console.log("[ServiceWorker] Deleting old cache:",e),caches.delete(e)})))})).then((function(){return console.log("[ServiceWorker] Claiming clients for version",t.CACHE_VERSION),self.clients.claim()})))})),self.addEventListener("fetch",(function(e){if(console.log("The service worker is serving: '".concat(e.request.url,"'")),e.preventDefault(),"POST"===e.request.method)console.log("Got a post request"),e.request.url.match(n)?(console.log("Passing through whitelisted post request for: ".concat(e.request.url)),e.respondWith(fetch(e.request))):e.request.url.match(r)?t.handle_image_post(e):t.handle_post(e);else if(a.test(e.request.url)&&!i.test(e.request.url)){console.log("redirecting to the root of the SPA");var c=new Request(s);e.respondWith(t.fromCache(c)),e.waitUntil(t.update(c))}else e.request.url.match(o)?(console.log("request is for an image '".concat(e.request.url,"'")),t.handleImageFetch(e)):(console.log("request is for non-image '".concat(e.request.url,"'")),e.respondWith(t.fromCache(e.request)),e.waitUntil(t.update(e.request)))}))}},{key:"handle_post",value:function(e){var t;try{t=e.request.clone()}catch(e){console.log("Failed to clone request."),console.log({"Cloning error":e})}e.respondWith(fetch(e.request).then((function(e){return e.ok?Promise.resolve(e).then((function(e){return e.clone().json()})).then((function(t){return console.log("Following successful remote post about to save locally."),Qx.fromPostResponse(t).setPrebuiltResponse(e).populateLocalSave().storeLocally()})).catch((function(t){return console.log({error:t}),Promise.resolve(e)})):(console.log("Failed to save, moving on to attempt IndexedDb"),Promise.reject("Failed to save to server."))})).catch((function(e){return console.log("post fetch failed (probably no network), (reason: ".concat(e,")")),t.formData().then((function(e){return console.log("got to form data handler"),Qx.fromPostedData(e).populateClientResponse().storeLocally()}),(function(e){return console.log("failed to read form data locally"),console.log({reason:e}),zx({error:"Failed to process posted response data. (internal error)",errorHelp:"Your internet connection may have failed (or there could be a problem with the server). It wasn't possible to save a temporary copy on your device. (an unexpected error occurred) Please try to re-establish a network connection and try again."})}))})))}},{key:"handle_image_post",value:function(e){var t;console.log("posting image");try{t=e.request.clone()}catch(e){console.log("Failed to clone request."),console.log({"Cloning error":e})}e.respondWith(t.formData().then((function(e){return console.log("got to form data handler"),Qx.fromPostedData(e).populateClientResponse().storeLocally()}),(function(e){return console.log("failed to read form data locally"),console.log({reason:e}),zx({error:"Failed to process posted response data. (internal error)",errorHelp:"Your internet connection may have failed (or there could be a problem with the server). It wasn't possible to save a temporary copy on your device. (an unexpected error occurred) Please try to re-establish a network connection and try again."})}))),e.waitUntil(fetch(e.request).then((function(e){return console.log("posted image to server in waitUntil part of fetch cycle"),e.ok?(console.log("posted image to server in waitUntil part of fetch cycle: got OK response"),Promise.resolve(e).then((function(e){return e.clone().json()})).then((function(t){return Qx.fromPostResponse(t).setPrebuiltResponse(e).populateLocalSave().storeLocally()})).catch((function(t){return console.log({error:t}),Promise.resolve(e)}))):zx({error:"Failed to save posted response data. (internal error)",errorHelp:"Your internet connection may have failed (or there could be a problem with the server). It wasn't possible to save a temporary copy on your device. (an unexpected error occurred) Please try to re-establish a network connection and try again."})})))}},{key:"precache",value:function(){var e=this;return caches.open(this.CACHE_VERSION).then((function(t){return t.addAll(e.URL_CACHE_SET)}))}},{key:"fromCache",value:function(e){var t=this;return console.log("attempting fromCache response"),caches.open(this.CACHE_VERSION).then((function(n){return console.log("cache is open"),n.match(e).then((function(n){return console.log(n?"cache matched ".concat(e.url):"no cache match for ".concat(e.url)),n||t.update(e)}))}))}},{key:"handleImageFetch",value:function(e){var t=this;e.respondWith(this.fromCache(e.request).then((function(n){if(console.log("In handleImageFetch promise"),n&&n.ok)return console.log("Responding with image from cache (or remotely if no cache)."),n;var r=e.request.url;console.log("Attempting image match for '".concat(r,"'"));var o=r.match(/imageid=([a-fA-F0-9]{8}-(?:[a-fA-F0-9]{4}-){3}[a-fA-F0-9]{12})/);if(o){var a=o[1];return console.log("Returning image match for '".concat(r,"' from local database")),t.imageFromLocalDatabase(a)}console.log("Failed to match image id in url '".concat(r,"'"))})).catch((function(n){var r=e.request.url;console.log(n),console.log("caught ".concat(n)),console.log("In catch following failed network fetch, attempting image match for '".concat(r,"'"));var o=r.match(/imageid=([a-fA-F0-9]{8}-(?:[a-fA-F0-9]{4}-){3}[a-fA-F0-9]{12})/);if(o){var a=o[1];return console.log("(via catch) Returning image match for '".concat(r,"' from local database")),t.imageFromLocalDatabase(a)}console.log("(via catch) Failed to match image id in url '".concat(r,"'"))})))}},{key:"imageFromLocalDatabase",value:function(e){var t=new yx;return console.log("attempting retrieval of image data from local database"),YO.retrieveFromLocal(e,t).then((function(t){if(console.log("Retrieved image '".concat(e,"' from indexeddb.")),t.file)return(new Headers).append("Content-Type",t.file.type),new Response(t.file,{status:200,statusText:"OK image response from IndexedDb"});console.log("No local file object associated with retrieved image '".concat(e,"' from indexeddb."))}))}},{key:"update",value:function(e){return e=new Request(e,{mode:"cors",credentials:"omit"}),console.log("Attempting fetch and cache update of ".concat(e.url)),caches.open(this.CACHE_VERSION).then((function(t){return fetch(e,{cache:"no-cache"}).then((function(n){return n.ok?(console.log("(re-)caching ".concat(e.url)),t.put(e,n).then((function(){return t.match(e)}))):(console.log("Request during cache update failed for ".concat(e.url)),console.log({"failed cache response":n}),Promise.reject("Request during cache update failed, not caching."))})).catch((function(t){console.log("Cache attempt failed for ".concat(e.url,": error was ").concat(t))}))}))}}])}();var nC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function rC(){return!("undefined"==typeof window||!window.history||!window.history.pushState)}function oC(e,t,n){this.root=null,this._routes=[],this._useHash=t,this._hash=void 0===n?"#":n,this._paused=!1,this._destroyed=!1,this._lastRouteResolved=null,this._notFoundHandler=null,this._defaultHandler=null,this._usePushState=!t&&rC(),this._onLocationChange=this._onLocationChange.bind(this),this._genericHooks=null,this._historyAPIUpdateMethod="pushState",e?this.root=t?e.replace(/\/$/,"/"+this._hash):e.replace(/\/$/,""):t&&(this.root=this._cLoc().split(this._hash)[0].replace(/\/$/,"/"+this._hash)),this._listen(),this.updatePageLinks()}function aC(e){return e instanceof RegExp?e:e.replace(/\/+$/,"").replace(/^\/+/,"^/")}function iC(e,t){return 0===t.length?null:e?e.slice(1,e.length).reduce((function(e,n,r){return null===e&&(e={}),e[t[r]]=decodeURIComponent(n),e}),null):null}function sC(e){var t=[];return{regexp:e instanceof RegExp?e:new RegExp(e.replace(oC.PARAMETER_REGEXP,(function(e,n,r){return t.push(r),oC.REPLACE_VARIABLE_REGEXP})).replace(oC.WILDCARD_REGEXP,oC.REPLACE_WILDCARD)+oC.FOLLOWED_BY_SLASH_REGEXP,oC.MATCH_REGEXP_FLAGS),paramNames:t}}function cC(e){return e.replace(/\/$/,"").split("/").length}function lC(e,t){return cC(t)-cC(e)}function uC(e,t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.map((function(t){var n=sC(aC(t.route)),r=n.regexp,o=n.paramNames,a=e.replace(/^\/+/,"/").match(r),i=iC(a,o);return!!a&&{match:a,route:t,params:i}})).filter((function(e){return e}))}(e,t)[0]||!1}function dC(e,t){var n=t.map((function(t){return""===t.route||"*"===t.route?e:e.split(new RegExp(t.route+"($|/)"))[0]})),r=aC(e);return n.length>1?n.reduce((function(e,t){return e.length>t.length&&(e=t),e}),n[0]):1===n.length?n[0]:r}function fC(e,t,n){var r,o=function(e){return e.split(/\?(.*)?$/)[0]};return void 0===n&&(n="#"),rC()&&!t?o(e).split(n)[0]:(r=e.split(n)).length>1?o(r[1]):o(r[0])}function hC(e,t,n){if(t&&"object"===(void 0===t?"undefined":nC(t))){if(t.before)return void t.before((function(){var r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];r&&(e(),t.after&&t.after(n))}),n);if(t.after)return e(),void(t.after&&t.after(n))}e()}oC.prototype={helpers:{match:uC,root:dC,clean:aC,getOnlyURL:fC},navigate:function(e,t){var n;return e=e||"",this._usePushState?(n=(n=(t?"":this._getRoot()+"/")+e.replace(/^\/+/,"/")).replace(/([^:])(\/{2,})/g,"$1/"),history[this._historyAPIUpdateMethod]({},"",n),this.resolve()):"undefined"!=typeof window&&(e=e.replace(new RegExp("^"+this._hash),""),window.location.href=window.location.href.replace(/#$/,"").replace(new RegExp(this._hash+".*$"),"")+this._hash+e),this},on:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];if("function"==typeof n[0])this._defaultHandler={handler:n[0],hooks:n[1]};else if(n.length>=2)if("/"===n[0]){var o=n[1];"object"===nC(n[1])&&(o=n[1].uses),this._defaultHandler={handler:o,hooks:n[2]}}else this._add(n[0],n[1],n[2]);else if("object"===nC(n[0])){var a=Object.keys(n[0]).sort(lC);a.forEach((function(t){e.on(t,n[0][t])}))}return this},off:function(e){return null!==this._defaultHandler&&e===this._defaultHandler.handler?this._defaultHandler=null:null!==this._notFoundHandler&&e===this._notFoundHandler.handler&&(this._notFoundHandler=null),this._routes=this._routes.reduce((function(t,n){return n.handler!==e&&t.push(n),t}),[]),this},notFound:function(e,t){return this._notFoundHandler={handler:e,hooks:t},this},resolve:function(e){var t,n,r=this,o=(e||this._cLoc()).replace(this._getRoot(),"");this._useHash&&(o=o.replace(new RegExp("^/"+this._hash),"/"));var a=function(e){return e.split(/\?(.*)?$/).slice(1).join("")}(e||this._cLoc()),i=fC(o,this._useHash,this._hash);return!this._paused&&(this._lastRouteResolved&&i===this._lastRouteResolved.url&&a===this._lastRouteResolved.query?(this._lastRouteResolved.hooks&&this._lastRouteResolved.hooks.already&&this._lastRouteResolved.hooks.already(this._lastRouteResolved.params),!1):(n=uC(i,this._routes))?(this._callLeave(),this._lastRouteResolved={url:i,query:a,hooks:n.route.hooks,params:n.params,name:n.route.name},t=n.route.handler,hC((function(){hC((function(){n.route.route instanceof RegExp?t.apply(void 0,n.match.slice(1,n.match.length)):t(n.params,a)}),n.route.hooks,n.params,r._genericHooks)}),this._genericHooks,n.params),n):this._defaultHandler&&(""===i||"/"===i||i===this._hash||function(e,t,n){if(rC()&&!t)return!1;if(!e.match(n))return!1;var r=e.split(n);return r.length<2||""===r[1]}(i,this._useHash,this._hash))?(hC((function(){hC((function(){r._callLeave(),r._lastRouteResolved={url:i,query:a,hooks:r._defaultHandler.hooks},r._defaultHandler.handler(a)}),r._defaultHandler.hooks)}),this._genericHooks),!0):(this._notFoundHandler&&hC((function(){hC((function(){r._callLeave(),r._lastRouteResolved={url:i,query:a,hooks:r._notFoundHandler.hooks},r._notFoundHandler.handler(a)}),r._notFoundHandler.hooks)}),this._genericHooks),!1))},destroy:function(){this._routes=[],this._destroyed=!0,this._lastRouteResolved=null,this._genericHooks=null,clearTimeout(this._listeningInterval),"undefined"!=typeof window&&(window.removeEventListener("popstate",this._onLocationChange),window.removeEventListener("hashchange",this._onLocationChange))},updatePageLinks:function(){var e=this;"undefined"!=typeof document&&this._findLinks().forEach((function(t){t.hasListenerAttached||(t.addEventListener("click",(function(n){if((n.ctrlKey||n.metaKey)&&"a"==n.target.tagName.toLowerCase())return!1;var r=e.getLinkPath(t);e._destroyed||(n.preventDefault(),e.navigate(r.replace(/\/+$/,"").replace(/^\/+/,"/")))})),t.hasListenerAttached=!0)}))},generate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this._routes.reduce((function(n,r){var o;if(r.name===e)for(o in n=r.route,t)n=n.toString().replace(":"+o,t[o]);return n}),"");return this._useHash?this._hash+n:n},link:function(e){return this._getRoot()+e},pause:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._paused=e,this._historyAPIUpdateMethod=e?"replaceState":"pushState"},resume:function(){this.pause(!1)},historyAPIUpdateMethod:function(e){return void 0===e?this._historyAPIUpdateMethod:(this._historyAPIUpdateMethod=e,e)},disableIfAPINotAvailable:function(){rC()||this.destroy()},lastRouteResolved:function(){return this._lastRouteResolved},getLinkPath:function(e){return e.getAttribute("href")},hooks:function(e){this._genericHooks=e},_add:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"string"==typeof e&&(e=encodeURI(e)),this._routes.push("object"===(void 0===t?"undefined":nC(t))?{route:e,handler:t.uses,name:t.as,hooks:n||t.hooks}:{route:e,handler:t,hooks:n}),this._add},_getRoot:function(){return null!==this.root||(this.root=dC(this._cLoc().split("?")[0],this._routes)),this.root},_listen:function(){var e=this;if(this._usePushState)window.addEventListener("popstate",this._onLocationChange);else if("undefined"!=typeof window&&"onhashchange"in window)window.addEventListener("hashchange",this._onLocationChange);else{var t=this._cLoc(),n=void 0,r=void 0;(r=function(){n=e._cLoc(),t!==n&&(t=n,e.resolve()),e._listeningInterval=setTimeout(r,200)})()}},_cLoc:function(){return"undefined"!=typeof window?void 0!==window.__NAVIGO_WINDOW_LOCATION_MOCK__?window.__NAVIGO_WINDOW_LOCATION_MOCK__:aC(window.location.href):""},_findLinks:function(){return[].slice.call(document.querySelectorAll("[data-navigo]"))},_onLocationChange:function(){this.resolve()},_callLeave:function(){var e=this._lastRouteResolved;e&&e.hooks&&e.hooks.leave&&e.hooks.leave(e.params)}},oC.PARAMETER_REGEXP=/([:*])(\w+)/g,oC.WILDCARD_REGEXP=/\*/g,oC.REPLACE_VARIABLE_REGEXP="([^/]+)",oC.REPLACE_WILDCARD="(?:.*)",oC.FOLLOWED_BY_SLASH_REGEXP="(?:/$|$)",oC.MATCH_REGEXP_FLAGS="";var pC=function(e){by(n,oC);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(){return ud(this,n),t.apply(this,arguments)}return fd(n,[{key:"updatePageLinks",value:function(){var e=this;if("undefined"!=typeof document){var t=document.createElement("a");t.href=this.root;var n=t.pathname;this._findLinks().forEach((function(t){t.hasListenerAttached||(t.addEventListener("click",(function(r){if((r.ctrlKey||r.metaKey)&&"a"==r.target.tagName.toLowerCase())return!1;if(!e._destroyed){var o=t.pathname.replace(n,"");r.preventDefault(),e.navigate(o)}})),t.hasListenerAttached=!0)}))}}}]),n}(),vC=wd,yC=Nd,mC=rv,gC=aS,SC=Sh,bC=lh.f,NC=hp.f,TC=GR,EC=Ym,wC=oN,_C=PE,OC=bh.exports,IC=Ed,RC=Rf,xC=Qh.enforce,CC=wN,AC=UE,kC=VE,LC=Bf("match"),MC=yC.RegExp,PC=MC.prototype,HC=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,DC=/a/g,FC=/a/g,jC=new MC(DC)!==DC,UC=_C.UNSUPPORTED_Y;if(mC("RegExp",vC&&(!jC||UC||AC||kC||IC((function(){return FC[LC]=!1,MC(DC)!=DC||MC(FC)==FC||"/a/i"!=MC(DC,"i")}))))){for(var BC=function(e,t){var n,r,o,a,i,s,c=this instanceof BC,l=TC(e),u=void 0===t,d=[],f=e;if(!c&&l&&u&&e.constructor===BC)return e;if((l||e instanceof BC)&&(e=e.source,u&&(t="flags"in f?f.flags:wC.call(f))),e=void 0===e?"":EC(e),t=void 0===t?"":EC(t),f=e,AC&&"dotAll"in DC&&(r=!!t&&t.indexOf("s")>-1)&&(t=t.replace(/s/g,"")),n=t,UC&&"sticky"in DC&&(o=!!t&&t.indexOf("y")>-1)&&(t=t.replace(/y/g,"")),kC&&(e=(a=function(e){for(var t,n=e.length,r=0,o="",a=[],i={},s=!1,c=!1,l=0,u="";r<=n;r++){if("\\"===(t=e.charAt(r)))t+=e.charAt(++r);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:HC.test(e.slice(r+1))&&(r+=2,c=!0),o+=t,l++;continue;case">"===t&&c:if(""===u||RC(i,u))throw new SyntaxError("Invalid capture group name");i[u]=!0,a.push([u,l]),c=!1,u="";continue}c?u+=t:o+=t}return[o,a]}(e))[0],d=a[1]),i=gC(MC(e,t),c?this:PC,BC),(r||o||d.length)&&(s=xC(i),r&&(s.dotAll=!0,s.raw=BC(function(e){for(var t,n=e.length,r=0,o="",a=!1;r<=n;r++)"\\"!==(t=e.charAt(r))?a||"."!==t?("["===t?a=!0:"]"===t&&(a=!1),o+=t):o+="[\\s\\S]":o+=t+e.charAt(++r);return o}(e),n)),o&&(s.sticky=!0),d.length&&(s.groups=d)),e!==f)try{SC(i,"source",""===f?"(?:)":f)}catch(e){}return i},YC=function(e){e in BC||bC(BC,e,{configurable:!0,get:function(){return MC[e]},set:function(t){MC[e]=t}})},VC=NC(MC),JC=0;VC.length>JC;)YC(VC[JC++]);PC.constructor=BC,BC.prototype=PC,OC(yC,"RegExp",BC)}CC("RegExp");var GC=Math.floor,qC=function(e,t){var n=e.length,r=GC(n/2);return n<8?KC(e,t):WC(qC(e.slice(0,r),t),qC(e.slice(r),t),t)},KC=function(e,t){for(var n,r,o=e.length,a=1;a<o;){for(r=a,n=e[a];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==a++&&(e[r]=n)}return e},WC=function(e,t,n){for(var r=e.length,o=t.length,a=0,i=0,s=[];a<r||i<o;)a<r&&i<o?s.push(n(e[a],t[i])<=0?e[a++]:t[i++]):s.push(a<r?e[a++]:t[i++]);return s},XC=qC,QC=Wd.match(/firefox\/(\d+)/i),zC=!!QC&&+QC[1],$C=/MSIE|Trident/.test(Wd),ZC=Wd.match(/AppleWebKit\/(\d+)\./),eA=!!ZC&&+ZC[1],tA=dv,nA=hf,rA=_f,oA=_p,aA=Ym,iA=Ed,sA=XC,cA=TO,lA=zC,uA=$C,dA=tf,fA=eA,hA=[],pA=hA.sort,vA=iA((function(){hA.sort(void 0)})),yA=iA((function(){hA.sort(null)})),mA=cA("sort"),gA=!iA((function(){if(dA)return dA<70;if(!(lA&&lA>3)){if(uA)return!0;if(fA)return fA<603;var e,t,n,r,o="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)hA.push({k:t+r,v:n})}for(hA.sort((function(e,t){return t.v-e.v})),r=0;r<hA.length;r++)t=hA[r].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}}));tA({target:"Array",proto:!0,forced:vA||!yA||!mA||!gA},{sort:function(e){void 0!==e&&nA(e);var t=rA(this);if(gA)return void 0===e?pA.call(t):pA.call(t,e);var n,r,o=[],a=oA(t);for(r=0;r<a;r++)r in t&&o.push(t[r]);for(n=(o=sA(o,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:aA(t)>aA(n)?1:-1}}(e))).length,r=0;r<n;)t[r]=o[r++];for(;r<a;)delete t[r++];return t}});var SA=dv,bA=bp,NA=yp,TA=_p,EA=_f,wA=OS,_A=Fb,OA=Yb("splice"),IA=Math.max,RA=Math.min;SA({target:"Array",proto:!0,forced:!OA},{splice:function(e,t){var n,r,o,a,i,s,c=EA(this),l=TA(c),u=bA(e,l),d=arguments.length;if(0===d?n=r=0:1===d?(n=0,r=l-u):(n=d-2,r=RA(IA(NA(t),0),l-u)),l+n-r>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(o=wA(c,r),a=0;a<r;a++)(i=u+a)in c&&_A(o,a,c[i]);if(o.length=r,n<r){for(a=u;a<l-r;a++)s=a+n,(i=a+r)in c?c[s]=c[i]:delete c[s];for(a=l;a>l-r+n;a--)delete c[a-1]}else if(n>r)for(a=l-r;a>u;a--)s=a+n-1,(i=a+r-1)in c?c[s]=c[i]:delete c[s];for(a=0;a<n;a++)c[a+u]=arguments[a+2];return c.length=l-r+n,o}});var xA=function(){function e(){if(ud(this,e),hd(this,"minimumRankSort",null),hd(this,"requireExtantDDbRecords",!1),hd(this,"skipJunk",!0),!GO.rawTaxa&&(GO.rawTaxa=BsbiDb.TaxonNames,!GO.rawTaxa))throw new Error("Taxon list has failed to load in TaxonSearch")}return fd(e,[{key:"lookup",value:function(t){var n,r,o,a,i={};if(r=e.normaliseTaxonName(decodeURIComponent(t).trim()).replace(/\s+x$/i,""),a=/ x\b/.test(r),""!==r){var s=r.match(e.abbreviatedGenusRegex);if(s){var c,l;for(var u in"X"===s[2]||"x"===s[2]?l=c=new RegExp("^(X\\s|X[a-z]+\\s+)(x )?\\b".concat(e.generate_hybrid_combinations_regex(s[3]),".*"),"i"):(c=new RegExp("^(X )?".concat(e.escapeRegExp(s[2]),"[a-z]+ (x )?.*\\b").concat(e.generate_hybrid_combinations_regex(s[3]),".*"),"i"),l=new RegExp("^(X )?".concat(e.escapeRegExp(s[2]),"[a-z]+ (x )?\\b").concat(e.generate_hybrid_combinations_regex(s[3]),".*"),"i")),GO.rawTaxa){var d=GO.rawTaxa[u];o=0===d[e.canonicalColumn]?d[e.nameStringColumn]:d[e.canonicalColumn],(c.test(o)||""!==d[e.hybridCanonicalColumn]&&c.test(d[e.hybridCanonicalColumn]))&&(i[u]={exact:d[e.nameStringColumn]===r,near:l.test(d[e.nameStringColumn])})}n=this.compile_results(i,a)}else{var f,h,p=e.escapeRegExp(r);-1!==r.indexOf(" ")?(f="".concat(e.escapeRegExp(r.substr(0,r.indexOf(" ")))," (x )?.*\\b").concat(e.generate_hybrid_combinations_regex(r.substr(r.indexOf(" ")+1)),".*"),h=new RegExp("^(?:Xs+)?".concat(e.escapeRegExp(r.substr(0,r.indexOf(" ")))," (x )?\\b").concat(e.generate_hybrid_combinations_regex(r.substr(r.indexOf(" ")+1)),".*"),"i")):(f="".concat(p,".*"),h=new RegExp("^".concat(p,".*")));var v="^".concat(p,".*"),y=new RegExp("^(?:Xs+)?".concat(f),"i");if(e.showVernacular){var m=new RegExp(v,"i");for(var g in GO.rawTaxa){var S=GO.rawTaxa[g];o=0===S[e.canonicalColumn]?S[e.nameStringColumn]:S[e.canonicalColumn],y.test(S[e.nameStringColumn])||o!==S[e.nameStringColumn]&&y.test(o)?i[g]={exact:S[e.nameStringColumn]===r,near:h.test(S[e.nameStringColumn])||h.test(o)}:(m.test(S[e.vernacularColumn])||m.test(S[e.vernacularRootColumn]))&&(i[g]={exact:S[e.vernacularColumn]===r,vernacular:!0})}if((n=this.compile_results(i,a)).length<5){var b=new RegExp("\\b".concat(p,".*"),"i");for(var N in GO.rawTaxa)if(!i.hasOwnProperty(N)){var T=GO.rawTaxa[N];b.test(T[e.nameStringColumn])?i[N]={exact:T[e.nameStringColumn]===r}:(0!==T[e.canonicalColumn]&&b.test(T[e.canonicalColumn])||b.test(T[e.vernacularColumn]))&&(i[N]={exact:T[e.nameStringColumn]===r,vernacular:!0})}n=this.compile_results(i,a)}}else{for(var E in GO.rawTaxa){var w=GO.rawTaxa[E];o=0===w[e.canonicalColumn]?w[e.nameStringColumn]:w[e.canonicalColumn],(y.test(w[e.nameStringColumn])||o!==w[e.nameStringColumn]&&y.test(o))&&(i[E]={exact:w[e.nameStringColumn]===r})}n=this.compile_results(i,a)}}}else n=[];return n}},{key:"compile_results",value:function(t,n){var r=[];for(var o in t)if(t.hasOwnProperty(o)){var a=GO.rawTaxa[o];if((!this.requireExtantDDbRecords||this.requireExtantDDbRecords&&1===a[e.usedColumn])&&(!this.minimumRankSort||this.minimumRankSort>0&&a[e.minRankColumn]>=this.minimumRankSort)){var i=a[e.nameStringColumn]+(a[e.qualifierColumn]?" ".concat(a[e.qualifierColumn]):""),s={entityId:o,vernacular:a[e.vernacularColumn],qname:i,name:i,qualifier:a[e.qualifierColumn],authority:a[e.authorityColumn],uname:a[e.nameStringColumn],vernacularMatched:t[o].hasOwnProperty("vernacular"),exact:t[o].hasOwnProperty("exact")&&t[o].exact,near:t[o].hasOwnProperty("near")&&t[o].near};if(s.formatted=e.formatter(s),a[e.acceptedEntityIdColumn]){var c=GO.rawTaxa[a[e.acceptedEntityIdColumn]];if(!c)throw GO.rawTaxa?new Error("Failed to find taxon for accepted entity id ".concat(a[e.acceptedEntityIdColumn])):new Error("Taxon.rawTaxa set is undefined, when trying to find taxon for accepted entity id ".concat(a[e.acceptedEntityIdColumn]));s.acceptedEntityId=a[e.acceptedEntityIdColumn],s.acceptedNameString=c[e.nameStringColumn],s.acceptedQualifier=c[e.qualifierColumn],s.acceptedAuthority=c[e.authorityColumn]}r.push(s)}}return r.length&&(r.sort((function(e,t){if(e.exact)return t.exact?e.acceptedEntityId?1:0:-1;if(t.exact)return 1;if(e.near){if(!t.near)return-1}else if(t.near)return 1;var r=null!==e.uname.match(/\bx\b/i),o=null!==t.uname.match(/\bx\b/i);if(r)return o?e.uname===t.uname?e.acceptedEntityId?1:0:e.qname<t.qname?-1:1:n?-1:1;if(o)return n?1:-1;if(e.uname===t.uname){if(!e.acceptedEntityId&&!t.acceptedEntityId||e.acceptedEntityId&&t.acceptedEntityId){var a=["s.s.","",null,"s.l.","agg."].indexOf(e.qualifier),i=["s.s.","",null,"s.l.","agg."].indexOf(t.qualifier);return a===i?0:a<i?1:-1}return e.acceptedEntityId?1:-1}return e.uname<t.uname?-1:1})),r.length>e.MAXIMUM_RESULTS&&(r.length=e.MAXIMUM_RESULTS)),r}}],[{key:"formatter",value:function(t){return e.showVernacular?t.vernacularMatched?t.acceptedEntityId?"<q><b>".concat(t.vernacular,'</b></q> <span class="italictaxon">').concat(t.uname).concat(t.qualifier?" <b>".concat(t.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.authority,"</span>")+' = <span class="italictaxon">'.concat(t.acceptedNameString).concat(t.acceptedQualifier?" <b>".concat(t.acceptedQualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.acceptedAuthority,"</span>"):"<q><b>".concat(t.vernacular,'</b></q> <span class="italictaxon">').concat(t.uname).concat(t.qualifier?" <b>".concat(t.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.authority,"</span>"):t.acceptedEntityId?'<span class="italictaxon">'.concat(t.uname).concat(t.qualifier?" <b>".concat(t.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.authority,"</span>").concat(t.vernacular?" <q><b>".concat(t.vernacular,"</b></q>"):"",' = <span class="italictaxon">').concat(t.acceptedNameString).concat(t.acceptedQualifier?" <b>".concat(t.acceptedQualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.acceptedAuthority,"</span>"):'<span class="italictaxon">'.concat(t.uname).concat(t.qualifier?" <b>".concat(t.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.authority,"</span>").concat(t.vernacular?" <q><b>".concat(t.vernacular,"</b></q>"):""):t.acceptedEntityId?'<span class="italictaxon">'.concat(t.uname).concat(t.qualifier?" <b>".concat(t.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.authority,"</span>")+' = <span class="italictaxon">'.concat(t.acceptedNameString).concat(t.acceptedQualifier?" <b>".concat(t.acceptedQualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.acceptedAuthority,"</span>"):'<span class="italictaxon">'.concat(t.uname).concat(t.qualifier?" <b>".concat(t.qualifier,"</b>"):"",'</span> <span class="taxauthority">').concat(t.authority,"</span>")}},{key:"normaliseTaxonName",value:function(t){for(var n=0,r=e.taxonRankNameSearchRegex.length;n<r;n++)t=t.replace(e.taxonRankNameSearchRegex[n],e.taxonRankNameReplacement[n]);for(var o=0,a=e.taxonQualifierSearchRegex.length;o<a;o++)t=t.replace(e.taxonQualifierSearchRegex[o],e.taxonQualifierReplacement[o]);return t}},{key:"escapeRegExp",value:function(t){return t.replace(e.cleanRegex,"\\$&")}},{key:"generate_hybrid_combinations_regex",value:function(t){var n=e.escapeRegExp(t).split(/\s+x\s+/i);if(n.length<2)return n[0];var r=[];return function e(t,n){if(0===t.length)r[r.length]=n.join("[a-zA-Z]* x ");else for(var o=t.length-1;o>=0;--o){var a=t.slice(0),i=n.slice(0);i.unshift(a.splice(o,1)[0]),e(a,i)}}(n,[]),"(?:".concat(r.join("|"),")")}}]),e}();hd(xA,"showVernacular",!0),hd(xA,"MIN_SEARCH_LENGTH",2),hd(xA,"MAXIMUM_RESULTS",25),hd(xA,"abbreviatedGenusRegex",/^(X\s+)?([a-z])[.\s]+(.*?)$/i),hd(xA,"nameStringColumn",0),hd(xA,"canonicalColumn",1),hd(xA,"hybridCanonicalColumn",2),hd(xA,"acceptedEntityIdColumn",3),hd(xA,"qualifierColumn",4),hd(xA,"authorityColumn",5),hd(xA,"vernacularColumn",6),hd(xA,"vernacularRootColumn",7),hd(xA,"usedColumn",8),hd(xA,"minRankColumn",9),hd(xA,"taxonRankNameSearchRegex",[/\s+sub-?g(?:en(?:us)?)?[.\s]+/i,/\s+sect(?:ion)?[.\s]+/i,/\s+subsect(?:ion)?[.\s]+/i,/\s+ser(?:ies)?[.\s]+/i,/\s+gp[.\s]+/i,/\s+s(?:ub)?-?sp(?:ecies)?[.\s]+/i,/\s+morphotype\s+/i,/\s+var[.\s]+/i,/\s+cv[.\s]+/i,/\s+n(?:otho)?v(?:ar)?[.\s]+/i,/\s+f[.\s]+|\s+forma?\s+/i,/\s+n(?:otho)?ssp[.\s]+/i]),hd(xA,"taxonRankNameReplacement",[" subg. "," sect. "," subsect. "," ser. "," group "," subsp. "," morph. "," var. "," cv. "," nothovar. "," f. "," nothosubsp. "]),hd(xA,"cleanRankNamesRegex",/\s(subfam\.|subg\.|sect\.|subsect\.|ser\.|subser\.|subsp\.|nothosubsp\.|microsp\.|praesp\.|agsp\.|race|convar\.|nm\.|microgene|f\.|subvar\.|var\.|nothovar\.|cv\.|sublusus|taxon|morph\.|group|sp\.)\s/),hd(xA,"taxonQualifierSearchRegex",[/\s*\(?\bf\s*x\s*m or m\s*x\s*f\)?\s*$/i,/\s*\(?\bm\s*x\s*f or f\s*x\s*m\)?\s*$/i,/\s*\(?\bf\s*x\s*m\)?\s*$/i,/\s*\(?\bm\s*x\s*f\)?\s*$/i,/\s*\(?\bfemale\s*x\s*male\)?\s*$/i,/\s*\(?\bmale\s*x\s*female\)?\s*$/i,/\s*'male'\s*$/i,/\s*'female'\s*$/i,/\b\s*sens\.?\s*lat[.\s]+/i,/\b\s*s\.\s*lat\.?\s*\b/i,/\b\s*s\.?\s*l\.?\s+\b/i,/\b\s*sensu\s*lato\s+\b|\(\s*sensu\s*lato\s*\)/i,/\b\s*sensu\s*stricto\s+\b|\(\s*sensu\s*stricto\s*\)/i,/\b\s*sens\.?\s*strict[.\s]+/i,/\b\s*sens\.?\s*str\.?\s*(?=\))|\b\s*sens\.?\s*str[.\s]+/i,/\b\s*s\.\s*str[.\s]+/i,/\b\s*s\.?\s*s\.?\s+\b/i,/\b\s*sens\.?\s*lat\.?\s*$/i,/\b\s*s\.\s*lat\.?\s*$/i,/\b\s*s\.?\s*l\.?\s*$/i,/\b\s*sensu\s*lato\s*$/i,/\b\s*sensu\s*stricto\s*$/i,/\b\s*sens\.?\s*strict\.?\s*$/i,/\b\s*sens\.?\s*str\.?\s*$/i,/\b\s*s\.\s*str\.?\s*$/i,/\b\s*s\.?\s*s\.?\s*$/i,/\b\s*agg\.?\s*$/i,/\b\s*aggregate\s*$/i,/\b\s*sp\.?\s*cultivar\s*$/i,/\b\s*sp\.?\s*cv\.?\s*$/i,/\b\s*cultivars?\s*$/i,/\b\s*cv\s+$/i,/\b\s*cv$/i,/\b\s*cf\s*$/i,/\b\s*aff\s*$/i,/\b\s*s\.?n\.?\s*$/i,/\b\s*sp\.?\s*nov\.?\s*$/i,/\b\s*auct[.\s]*$/i,/\b\s*ined[.\s]*$/i,/\b\s*nom\.?\snud[.\s]*$/i,/\b\s*p\.p[.\s?]*$/i,/\b\s*spp?\.?[\s?]*$/i,/\b\s*species\s*$/i,/\b\s*spp?\.?\s*\(/i,/\b\s*species\s*\(/i]),hd(xA,"taxonQualifierReplacement",[" "," "," (f x m)"," (m x f)"," (f x m)"," (m x f)"," male"," female"," s.l. "," s.l. "," s.l. "," s.l. "," s.s. "," s.s. "," s.s. "," s.s. "," s.s. "," s.l."," s.l."," s.l."," s.l."," s.s."," s.s."," s.s."," s.s."," s.s."," agg."," agg."," cv. "," cv. "," cv. "," cv. "," cv. "," cf."," aff."," sp.nov."," sp.nov."," auct."," ined."," nom. nud."," pro parte","",""," ("," ("]),hd(xA,"cleanRegex",/[.*+?^${}()|[\]\\]/g);var CA=function(){function e(){ud(this,e)}return fd(e,null,[{key:"taxaLoadedEntryPoint",value:function(){for(GO.rawTaxa=BsbiDb.TaxonNames;e.callbackStack.length;){var t=e.callbackStack.shift();try{t()}catch(t){console.log({"Exception after taxon load":t})}}}},{key:"onceTaxaLoaded",value:function(){return BsbiDb.hasOwnProperty("TaxonNames")?Promise.resolve():(BsbiDb.taxonNamesLoadedEntryPoint||(BsbiDb.taxonNamesLoadedEntryPoint=e.taxaLoadedEntryPoint),new Promise((function(t){e.callbackStack.push(t)})))}}]),e}();function AA(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}hd(CA,"callbackStack",[]),dv({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}});var kA=new WeakMap,LA=new WeakMap;function MA(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return PA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?PA(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function PA(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function HA(e,t){FA(e,t),t.add(e)}function DA(e,t,n){FA(e,t),t.set(e,n)}function FA(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jA(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}!function(e){by(n,iI);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(e){var r;return ud(this,n),AA(gy(r=t.call(this,e)),kA,{writable:!0,value:void 0}),AA(gy(r),LA,{writable:!0,value:void 0}),hd(gy(r),"_value",""),hd(gy(r),"_inputType","date"),hd(gy(r),"_autocomplete",""),r._value=(new Date).toJSON().slice(0,10),e&&(e.placeholder&&(r.placeholder=e.placeholder),e.autocomplete&&(r._autocomplete=e.autocomplete)),r}fd(n,[{key:"value",get:function(){return this._value},set:function(e){this._value=void 0===e||null==e?(new Date).toJSON().slice(0,10):e.trim(),this.updateView()}},{key:"updateView",value:function(){this._fieldEl&&(document.getElementById(Oy(this,kA)).value=iI.cleanRawString(this._value))}},{key:"buildField",value:function(){var e=document.createElement("div");e.className="form-group",_y(this,LA,e.id=iI.nextId),_y(this,kA,iI.nextId);var t=e.appendChild(document.createElement("label"));t.htmlFor=Oy(this,kA),t.textContent=this.label;var n=e.appendChild(document.createElement("input"));n.className="form-control",n.id=Oy(this,kA);try{n.type=this._inputType}catch(e){console.log("Failed to set type '".concat(this._inputType,"'"))}if(this.placeholder&&(n.placeholder=this.placeholder),this._autocomplete&&(n.autocomplete=this._autocomplete,"off"===this._autocomplete&&(n.name=UO())),this.completion===iI.COMPLETION_COMPULSORY&&(n.required=!0),this.validationMessage){var r=e.appendChild(document.createElement("div"));r.className="invalid-feedback",r.innerHTML=this.validationMessage}this.helpText&&(e.appendChild(document.createElement("small")).innerHTML=this.helpText),n.addEventListener("change",this.inputChangeHandler.bind(this)),this._fieldEl=e}},{key:"markValidity",value:function(e){var t=document.getElementById(Oy(this,kA));null===e?t.classList.remove("is-invalid","is-valid"):(t.classList.remove(e?"is-invalid":"is-valid"),t.classList.add(e?"is-valid":"is-invalid"))}},{key:"inputChangeHandler",value:function(e){e.stopPropagation(),console.log("got date field change event"),this.value=iI.cleanRawString(document.getElementById(Oy(this,kA)).value),this.fireEvent(iI.EVENT_CHANGE)}}],[{key:"summariseImpl",value:function(e,t,n){return""!==n[e]&&null!==n[e]&&void 0!==n[e]?JO(n[e].trim()):""}}])}(),SS("WeakSet",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),zS);var UA=new WeakMap,BA=new WeakMap,YA=new WeakMap,VA=new WeakSet,JA=new WeakSet,GA=function(e){by(n,iI);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(e){var r;return ud(this,n),HA(gy(r=t.call(this,e)),JA),HA(gy(r),VA),DA(gy(r),UA,{writable:!0,value:void 0}),DA(gy(r),BA,{writable:!0,value:void 0}),DA(gy(r),YA,{writable:!0,value:void 0}),hd(gy(r),"parentForm",void 0),hd(gy(r),"_value",{images:[]}),hd(gy(r),"includeCamera",!0),hd(gy(r),"placeholder",""),e&&(e.hasOwnProperty("includeCamera")&&(r.includeCamera=e.includeCamera),e.placeholder&&(r.placeholder=e.placeholder)),r}return fd(n,[{key:"value",get:function(){var e=[];if(this._value&&this._value.images){var t,n=MA(this._value.images);try{for(n.s();!(t=n.n()).done;){var r=t.value;e[e.length]=r.id}}catch(e){n.e(e)}finally{n.f()}}return e},set:function(e){if(this._value={images:[]},e){var t,n=MA(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;yx.imageCache.has(r)?this._value.images.push(yx.imageCache.get(r)):(console.log("Creating placeholder image object '".concat(r,"'")),this._value.images.push(yx.placeholder(r)))}}catch(e){n.e(e)}finally{n.f()}}this.updateView()}},{key:"updateView",value:function(){if(this._fieldEl){var e,t=[],n=MA(this._value.images);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push('<picture style="cursor: pointer;" data-imageid="'.concat(r.id,'"><source srcset="/image.php?imageid=').concat(r.id,'&amp;height=128&amp;format=webp" type="image/webp"><img data-imageid="').concat(r.id,'" src="/image.php?imageid=').concat(r.id,'&amp;height=128&amp;format=jpeg" height="128" alt="photo"></picture>'))}}catch(e){n.e(e)}finally{n.f()}document.getElementById(Oy(this,YA)).innerHTML=t.join("\n")}}},{key:"buildField",value:function(){var e=document.createElement("div");e.className="form-group",_y(this,BA,e.id=iI.nextId),_y(this,UA,iI.nextId);var t=e.appendChild(document.createElement("label"));t.htmlFor=Oy(this,UA),t.textContent=this.label;var n=e.appendChild(document.createElement("div"));n.className="input-group";var r=document.createElement("div");r.className="custom-file",n.appendChild(r);var o=r.appendChild(document.createElement("input"));if(o.type="file",o.className="custom-file-input",o.id=Oy(this,UA),o.accept=".jpeg, .jpg, image/png, image/jpeg",o.multiple=!0,this.placeholder){var a=r.appendChild(document.createElement("label"));a.className="custom-file-label",a.htmlFor=Oy(this,UA),a.textContent=this.placeholder}if(this.includeCamera){var i=document.createElement("div");i.className="input-group-append";var s=i.appendChild(document.createElement("span"));s.className="input-group-text";var c=s.appendChild(document.createElement("label"));c.className="pl-0 pr-0 ml-0 mr-0 mt-0 mb-0 pt-0 pb-0 material-icons";var l=c.appendChild(document.createElement("i"));l.className="material-icons pl-0 pr-0 ml-0 mr-0 mt-0 mb-0 pt-0 pb-0",l.textContent="add_a_photo";var u=c.appendChild(document.createElement("input"));u.type="file",u.capture="environment",u.accept="image/*",u.style.display="none",u.id=iI.nextId,n.appendChild(i),u.addEventListener("change",this.inputChangeHandler.bind(this,u.id))}this.helpText&&(e.appendChild(document.createElement("small")).innerHTML=this.helpText);var d=e.appendChild(document.createElement("p"));if(_y(this,YA,d.id=iI.nextId),d.addEventListener("click",this.imageClickHandler.bind(this)),this.validationMessage){var f=e.appendChild(document.createElement("div"));f.className="invalid-feedback",f.innerHTML=this.validationMessage}o.addEventListener("change",this.inputChangeHandler.bind(this,o.id)),this._fieldEl=e,this.parentForm.addListener("deleteimage",this.deleteImageHandler.bind(this))}},{key:"deleteImageHandler",value:function(e){var t;for(var n in console.log("delete image ".concat(e.imageId)),this._value.images)if(this._value.images.hasOwnProperty(n)&&this._value.images[n].id===e.imageId){t=this._value.images.splice(n,1)[0];break}t?(this.updateView(),this.fireEvent(iI.EVENT_CHANGE)):console.log("Failed to find image id ".concat(e.imageId))}},{key:"imageClickHandler",value:function(e){var t=e.target.closest("picture");t||(t=e.target.closest("img")),console.log({"clicked image":t});var n=t.getAttribute("data-imageid");n&&(document.getElementById("imagemodal").getElementsByTagName("picture")[0].innerHTML='<source srcset="/image.php?imageid='.concat(n,"&amp;width=").concat(window.innerWidth,'&amp;format=webp" type="image/webp">\n                <img src="/image.php?imageid=').concat(n,"&amp;width=").concat(window.innerWidth,'&amp;format=jpeg" width="auto" style="max-height: 48vh; max-width: 100%;" alt="photo">'),document.getElementById("imagemodaldelete").setAttribute("data-imageid",n),$("#".concat("imagemodal")).modal({}))}},{key:"inputChangeHandler",value:function(e,t){var n=this;t.stopPropagation(),console.log("got image field input change event");var r=document.getElementById(e);r.files.length?jA(this,VA,qA).call(this,r.files).then((function(){n.fireEvent(iI.EVENT_CHANGE)})):this.fireEvent(iI.EVENT_CHANGE)}}],[{key:"isEmpty",value:function(e){return!e||0===e.length}},{key:"licenseModal",value:function(){var e=document.createElement("div");return e.innerHTML='<div class="modal fade" id="'.concat(n.LICENSE_MODAL,'" tabindex="-1" role="dialog" aria-labelledby="').concat(n.LICENSE_MODAL,'Title" aria-hidden="true">\n  <div class="modal-dialog modal-dialog-centered" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title" id="').concat(n.LICENSE_MODAL,'Title">Image licensing</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body">\n        <p>By choosing to submit images with your Garden Wildflower Hunt records you agree to license the image under the terms of the Creative Common Attribution 4.0 International license (CC BY 4.0).</p>\n        <p>The following is a summary of (and not a substitute for) the <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">license</a>.</p>\n        <p>Licensees are free to:</p>\n        <ul class="license-properties">\n<li>\n<strong>Share</strong> â copy and redistribute the material in any medium or format\n</li>\n<li>\n<strong>Adapt</strong> â remix, transform, and build upon the material for any purpose, even commercially.\n</li>\n</ul>\n<p>Licensees are most follow these term:</p>\n<ul>\n<li>\n<p>\n<strong>Attribution</strong> â licensees must give appropriate credit, provide a link to the license, and indicate if changes were made.\n</p>\n</li>\n</ul>\n<p>Full details of the license are here: <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0 license</a></p>\n\n      </div>\n      <div class="modal-footer">\n        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\n      </div>\n    </div>\n  </div>\n</div>'),e.firstChild}}]),n}();function qA(e){this.parentForm.pingOccurrence();var t,n=[],r=MA(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;n.push(yx.fromFile(o))}}catch(e){r.e(e)}finally{r.f()}return jA(this,JA,KA).call(this,n)}function KA(e){var t=this;if(e.length){var n=e.shift();return n.save(this.parentForm.surveyId,this.parentForm.occurrenceId,this.parentForm.projectId).then((function(e){console.log("Added image '".concat(n.id,"'")),console.log({jsonDescription:e}),t._value.images.push(n),t.updateView()}),(function(e){console.log("Failed to add image ".concat(n.id)),console.log({"Failure reason":e})})).finally((function(){return jA(t,JA,KA).call(t,e)}))}return Promise.resolve()}function WA(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}hd(GA,"LICENSE_MODAL","imagelicensemodal");var XA=new WeakMap,QA=new WeakMap,zA=function(e){by(n,iI);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(e){var r;return ud(this,n),WA(gy(r=t.call(this,e)),XA,{writable:!0,value:void 0}),WA(gy(r),QA,{writable:!0,value:void 0}),hd(gy(r),"_value",""),hd(gy(r),"_inputType","text"),hd(gy(r),"_autocomplete",""),e&&(e.type&&(r._inputType=e.type),e.placeholder&&(r.placeholder=e.placeholder),e.autocomplete&&(r._autocomplete=e.autocomplete)),r}return fd(n,[{key:"value",get:function(){return this._value},set:function(e){this._value=void 0===e||null==e?"":e.trim(),this.updateView()}},{key:"updateView",value:function(){this._fieldEl&&(document.getElementById(Oy(this,XA)).value=iI.cleanRawString(this._value))}},{key:"buildField",value:function(){var e=document.createElement("div");e.className="form-group",_y(this,QA,e.id=iI.nextId),_y(this,XA,iI.nextId);var t=e.appendChild(document.createElement("label"));t.htmlFor=Oy(this,XA),t.textContent=this.label;var n=e.appendChild(document.createElement("input"));n.className="form-control",n.id=Oy(this,XA);try{n.type=this._inputType}catch(e){console.log("Failed to set type '".concat(this._inputType,"'"))}if(this.placeholder&&(n.placeholder=this.placeholder),this._autocomplete&&(n.autocomplete=this._autocomplete,"off"===this._autocomplete&&(n.name=UO())),this.completion===iI.COMPLETION_COMPULSORY&&(n.required=!0),this.validationMessage){var r=e.appendChild(document.createElement("div"));r.className="invalid-feedback",r.innerHTML=this.validationMessage}this.helpText&&(e.appendChild(document.createElement("small")).innerHTML=this.helpText),n.addEventListener("change",this.inputChangeHandler.bind(this)),this._fieldEl=e}},{key:"markValidity",value:function(e){var t=document.getElementById(Oy(this,XA));null===e?t.classList.remove("is-invalid","is-valid"):(t.classList.remove(e?"is-invalid":"is-valid"),t.classList.add(e?"is-valid":"is-invalid"))}},{key:"inputChangeHandler",value:function(e){e.stopPropagation(),console.log("got input field change event"),this.value=iI.cleanRawString(document.getElementById(Oy(this,XA)).value),this.fireEvent(iI.EVENT_CHANGE)}}],[{key:"summariseImpl",value:function(e,t,n){return""!==n[e]&&null!==n[e]&&void 0!==n[e]?JO(n[e].trim()):""}}]),n}();function $A(e,t,n){if(n.length>2){var r=n.pop();return"".concat(n.join(e+" ")," ").concat(t," ").concat(r)}return n.join(" ".concat(t," "))}function ZA(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ek(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ek(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function ek(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tk(e,t,n){nk(e,t),t.set(e,n)}function nk(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rk(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function ok(e,t,n){return function(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}(e,t),function(e,t){if(void 0===e)throw new TypeError("attempted to get private static field before its declaration")}(n),function(e,t){return t.get?t.get.call(e):t.value}(e,n)}var ak=new WeakMap,ik=new WeakMap,sk=new WeakSet,ck=function(e){by(n,iI);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(e){var r,o,a;return ud(this,n),nk(o=gy(r=t.call(this,e)),a=sk),a.add(o),tk(gy(r),ak,{writable:!0,value:void 0}),tk(gy(r),ik,{writable:!0,value:void 0}),hd(gy(r),"options",{}),hd(gy(r),"includeOtherFreeText",!0),hd(gy(r),"_value",{selection:[],other:null}),e&&(e.options&&(r.options=e.options),e.hasOwnProperty("includeOtherFreeText")&&(r.includeOtherFreeText=e.includeOtherFreeText)),r}return fd(n,[{key:"value",get:function(){return this._value},set:function(e){this._value=e||{selection:[],other:null},this.updateView()}},{key:"updateView",value:function(){if(this._fieldEl){var e,t=ZA(document.querySelectorAll("".concat(ok(n,n,uk),"#").concat(Oy(this,ak),' input[type="checkbox"]')));try{for(t.s();!(e=t.n()).done;){var r=e.value,o=r.checked=this._value.selection.includes(r.name);if(r.name===n.KEY_OTHER&&Oy(this,ik)){var a=document.getElementById(Oy(this,ik));a.style.display=o?"block":"none",a.value=null===this._value.other?"":this._value.other.trim()}}}catch(e){t.e(e)}finally{t.f()}}}},{key:"buildField",value:function(){if(!this.options)throw new Error("Options have not been set before call to buildField()");var e=document.createElement(ok(n,n,uk));e.className="form-group",_y(this,ak,e.id=iI.nextId);var t=e.appendChild(document.createElement("label"));for(var r in t.style.display="block",t.textContent=this.label,this.helpText&&(e.appendChild(document.createElement("small")).innerHTML=this.helpText),this.options)this.options.hasOwnProperty(r)&&rk(this,sk,lk).call(this,e,r,this.options[r]);if(this.validationMessage){var o=e.appendChild(document.createElement("div"));o.className="invalid-feedback",o.innerHTML=this.validationMessage}e.addEventListener("change",this.inputChangeHandler.bind(this)),this._fieldEl=e}},{key:"inputChangeHandler",value:function(e){e.stopPropagation();var t,r={selection:[],other:null};Oy(this,ik)&&(t=document.getElementById(Oy(this,ik)));var o,a=ZA(document.querySelectorAll("".concat(ok(n,n,uk),"#").concat(Oy(this,ak),' input[type="checkbox"]:checked')));try{for(a.s();!(o=a.n()).done;){var i=o.value;r.selection[r.selection.length]=i.name,i.name===n.KEY_OTHER&&Oy(this,ik)&&(r.other=iI.cleanRawInput(t))}}catch(e){a.e(e)}finally{a.f()}this.value=r,this.fireEvent(iI.EVENT_CHANGE)}}],[{key:"summariseImpl",value:function(e,t,n){var r=t.summary,o=[];if(n[e].selection.length){var a,i=ZA(n[e].selection);try{for(i.s();!(a=i.n()).done;){var s=a.value;"other"===s&&n[e].other?o[o.length]="".concat(t.attributes.options[s].summary||t.attributes.options[s].label," (").concat(n[e].other,")"):o[o.length]=t.attributes.options[s].summary||t.attributes.options[s].label}}catch(e){i.e(e)}finally{i.f()}return JO("".concat(r.summaryPrefix," ").concat($A(",","or",o)))}return""}}]),n}();function lk(e,t,n){var r=e.appendChild(document.createElement("div"));r.className="form-check";var o=r.appendChild(document.createElement("input"));o.type="checkbox",o.className="form-check-input",o.id=iI.nextId,o.name=t;var a=r.appendChild(document.createElement("label"));if(a.htmlFor=o.id,a.className="form-check-label",a.textContent=n.label,ck.KEY_OTHER===t&&this.includeOtherFreeText){var i=r.appendChild(document.createElement("input"));i.id=_y(this,ik,iI.nextId),i.className="form-control",i.style.display="none"}}hd(ck,"KEY_OTHER","other");var uk={writable:!0,value:"fieldset"};function dk(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return fk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fk(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function fk(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hk(e,t,n){pk(e,t),t.set(e,n)}function pk(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vk(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var yk=new WeakMap,mk=new WeakMap,gk=new WeakMap,Sk=new WeakSet,bk=function(e){by(n,iI);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(e){var r,o,a;return ud(this,n),pk(o=gy(r=t.call(this,e)),a=Sk),a.add(o),hk(gy(r),yk,{writable:!0,value:void 0}),hk(gy(r),mk,{writable:!0,value:void 0}),hk(gy(r),gk,{writable:!0,value:void 0}),hd(gy(r),"options",{}),hd(gy(r),"placeholder",""),hd(gy(r),"includeOtherFreeText",!0),hd(gy(r),"_value",{selection:[],other:null}),e&&(e.options&&(r.options=e.options),e.hasOwnProperty("includeOtherFreeText")&&(r.includeOtherFreeText=e.includeOtherFreeText),e.placeholder&&(r.placeholder=e.placeholder)),r}return fd(n,[{key:"value",get:function(){return this._value},set:function(e){this._value=e||{selection:[],other:null},this.updateView()}},{key:"markValidity",value:function(e){var t=document.getElementById(Oy(this,mk));null===e?t.classList.remove("is-invalid","is-valid"):(t.classList.remove(e?"is-invalid":"is-valid"),t.classList.add(e?"is-valid":"is-invalid"))}},{key:"updateView",value:function(){if(this._fieldEl){var e,t=dk(document.querySelectorAll("select#".concat(Oy(this,mk)," option")));try{for(t.s();!(e=t.n()).done;){var n=e.value;if(""!==n.value){var r=n.selected=this._value.selection.includes(n.value);if(n.value===ck.KEY_OTHER&&Oy(this,gk)){var o=document.getElementById(Oy(this,gk));o.style.display=r?"block":"none",o.value=null===this._value.other?"":this._value.other.trim()}}else n.selected=0===this._value.selection.length}}catch(e){t.e(e)}finally{t.f()}}}},{key:"buildField",value:function(){if(!this.options)throw new Error("Options have not been set before call to buildField()");var e=document.createElement(function(e,t,n){return function(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}(e,t),function(e,t){if(void 0===e)throw new TypeError("attempted to get private static field before its declaration")}(n),function(e,t){return t.get?t.get.call(e):t.value}(e,n)}(n,n,Tk));e.className="form-group",_y(this,yk,e.id=iI.nextId),_y(this,mk,iI.nextId);var t=e.appendChild(document.createElement("label"));t.htmlFor=Oy(this,mk),t.style.display="block",t.innerHTML=this.label;var r=document.createElement("select");for(var o in r.id=Oy(this,mk),r.className="custom-select",this.helpText&&(e.appendChild(document.createElement("small")).innerHTML=this.helpText),this.placeholder&&vk(this,Sk,Nk).call(this,e,r,"",{label:this.placeholder}),this.options)this.options.hasOwnProperty(o)&&vk(this,Sk,Nk).call(this,e,r,o,this.options[o]);if(e.appendChild(r),this.validationMessage){var a=e.appendChild(document.createElement("div"));a.className="invalid-feedback",a.innerHTML=this.validationMessage}e.addEventListener("change",this.inputChangeHandler.bind(this)),this._fieldEl=e}},{key:"inputChangeHandler",value:function(e){e.stopPropagation();var t,n={selection:[],other:null};Oy(this,gk)&&(t=document.getElementById(Oy(this,gk)));var r,o=dk(document.querySelectorAll("select#".concat(Oy(this,mk)," option:checked")));try{for(o.s();!(r=o.n()).done;){var a=r.value;""!==a.value&&(n.selection[n.selection.length]=a.value,a.name===ck.KEY_OTHER&&Oy(this,gk)&&(n.other=iI.cleanRawInput(t)))}}catch(e){o.e(e)}finally{o.f()}this.value=n,this.fireEvent(iI.EVENT_CHANGE)}}],[{key:"isEmpty",value:function(e){return 0===e.selection.length||""===e.selection[0]}},{key:"summariseImpl",value:function(e,t,n){var r=t.summary,o=[];if(n[e].selection.length){var a,i=dk(n[e].selection);try{for(i.s();!(a=i.n()).done;){var s=a.value;"other"===s&&n[e].other?o[o.length]="".concat(t.attributes.options[s].summary||t.attributes.options[s].label," (").concat(n[e].other,")"):o[o.length]=t.attributes.options[s].summary||t.attributes.options[s].label}}catch(e){i.e(e)}finally{i.f()}return JO("".concat(r.summaryPrefix," ").concat($A(",","or",o)))}return""}}]),n}();function Nk(e,t,n,r){var o=t.appendChild(document.createElement("option"));if(o.value=n,o.innerText=r.label,ck.KEY_OTHER===n&&this.includeOtherFreeText){var a=e.appendChild(document.createElement("input"));a.id=_y(this,gk,iI.nextId),a.className="form-control"}}var Tk={writable:!0,value:"fieldset"},Ek=dv,wk=$O.start,_k=nI("trimStart"),Ok=_k?function(){return wk(this)}:"".trimStart;Ek({target:"String",proto:!0,name:"trimStart",forced:_k},{trimStart:Ok,trimLeft:Ok});var Ik=dv,Rk=MS.find,xk=My,Ck=!0;function Ak(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function kk(e,t,n){Lk(e,t),t.set(e,n)}function Lk(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mk(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}"find"in[]&&Array(1).find((function(){Ck=!1})),Ik({target:"Array",proto:!0,forced:Ck},{find:function(e){return Rk(this,e,arguments.length>1?arguments[1]:void 0)}}),xk("find");var Pk=new WeakMap,Hk=new WeakMap,Dk=new WeakMap,Fk=new WeakMap,jk=new WeakMap,Uk=new WeakMap,Bk=new WeakMap,Yk=new WeakMap,Vk=new WeakSet,Jk=function(e){by(n,iI);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(e){var r,o,a;return ud(this,n),Lk(o=gy(r=t.call(this,e)),a=Vk),a.add(o),hd(gy(r),"taxonSearch",void 0),kk(gy(r),Pk,{writable:!0,value:void 0}),kk(gy(r),Hk,{writable:!0,value:void 0}),kk(gy(r),Dk,{writable:!0,value:void 0}),kk(gy(r),Fk,{writable:!0,value:void 0}),kk(gy(r),jk,{writable:!0,value:null}),kk(gy(r),Uk,{writable:!0,value:null}),kk(gy(r),Bk,{writable:!0,value:null}),hd(gy(r),"_lastInputValue",""),kk(gy(r),Yk,{writable:!0,value:[]}),hd(gy(r),"_value",{taxonId:"",taxonName:"",vernacularMatch:!1}),r.taxonSearch=new xA,r}return fd(n,[{key:"value",get:function(){return this._value},set:function(e){var t;e&&e.taxonId?(t=GO.fromId(e.taxonId),this._value={taxonId:t.id,taxonName:e.vernacularMatch?t.vernacular:t.nameString,vernacularMatch:e.vernacularMatch}):this._value={taxonId:"",taxonName:e&&e.taxonName?e.taxonName:"",vernacularMatch:null},this.updateView()}},{key:"updateView",value:function(){this._fieldEl&&(document.getElementById(Oy(this,Pk)).value=this._value.taxonName,this._lastInputValue=this._value.taxonName)}},{key:"markValidity",value:function(e){var t=document.getElementById(Oy(this,Pk));null===e?t.classList.remove("is-invalid","is-valid"):(t.classList.remove(e?"is-invalid":"is-valid"),t.classList.add(e?"is-valid":"is-invalid"))}},{key:"buildField",value:function(){var e=document.createElement("div");e.className="form-group",_y(this,Fk,e.id=iI.nextId),_y(this,Pk,iI.nextId);var t=e.appendChild(document.createElement("label"));t.htmlFor=Oy(this,Pk),t.textContent=this.label;var n=e.appendChild(document.createElement("div"));n.className="dropdown-wrapper";var r=n.appendChild(document.createElement("input"));if(r.className="form-control dropdown-input",r.id=Oy(this,Pk),r.autocomplete="off",r.spellcheck=!1,this.validationMessage){var o=n.appendChild(document.createElement("div"));o.className="invalid-feedback",o.innerHTML=this.validationMessage}var a=n.appendChild(document.createElement("div"));a.className="dropdown-list",_y(this,Hk,a.id=iI.nextId),_y(this,Dk,iI.nextId),this.helpText&&(e.appendChild(document.createElement("small")).innerHTML=this.helpText),r.addEventListener("keydown",this.keydownHandler.bind(this)),r.addEventListener("input",this.inputHandler.bind(this)),r.addEventListener("change",this.inputChangeHandler.bind(this)),e.addEventListener("focusin",this.focusHandler.bind(this)),e.addEventListener("focusout",this.blurHandler.bind(this)),a.addEventListener("click",this.dropboxClickHandler.bind(this)),this._fieldEl=e}},{key:"keydownHandler",value:function(e){switch(this._lastInputValue=e.target.value.trimLeft(),e.key){case"Enter":case"ArrowUp":case"ArrowDown":e.preventDefault()}}},{key:"inputHandler",value:function(e){e.target.value.trimLeft()!==this._lastInputValue&&Mk(this,Vk,Gk).call(this,e.target)}},{key:"keyupHandler",value:function(e){!e.key||1!==e.key.length&&"Backspace"!==e.key&&"Delete"!==e.key||Mk(this,Vk,Gk).call(this,e.target)}},{key:"focusHandler",value:function(e){console.log("focused");var t=document.getElementById(Oy(this,Hk));if(!t.classList.contains("dropdown-focused")){var n=document.getElementById(Oy(this,Pk));Mk(this,Vk,Gk).call(this,n),t.classList.add("dropdown-focused")}}},{key:"blurHandler",value:function(e){var t=this;Oy(this,jk)&&(clearTimeout(Oy(this,jk)),_y(this,jk,null)),setTimeout((function(){document.getElementById(Oy(t,Hk)).classList.remove("dropdown-focused")}),500)}},{key:"refreshSearchResultsList",value:function(){var e=document.getElementById(Oy(this,Hk));if(Oy(this,Yk).length){var t,n=[],r=0,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ak(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ak(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}(Oy(this,Yk));try{for(o.s();!(t=o.n()).done;){var a=t.value;n[n.length]='<a class="list-group-item list-group-item-action" href="#" data-occurrenceId="'.concat(a.entityId,'" data-resultnumber="').concat(r,'">').concat(xA.formatter(a),"</a>"),++r}}catch(e){o.e(e)}finally{o.f()}e.innerHTML='<div class="list-group" id="'.concat(Oy(this,Dk),'">').concat(n.join(""),"</div>")}else e.innerHTML="";_y(this,Bk,null)}},{key:"dropboxClickHandler",value:function(e){console.log("click handler"),console.log(e);var t=e.target.closest("a");if(console.log(t),Oy(this,Uk)&&(clearTimeout(Oy(this,Uk)),_y(this,Uk,null),console.log("cleared a pending change event")),t&&t.dataset.occurrenceid){e.preventDefault(),console.log("got target ".concat(t.dataset.occurrenceid));var n=Oy(this,Yk)[t.dataset.resultnumber];this.value={taxonId:n.entityId,taxonName:n.vernacularMatched?n.vernacular:n.qname,vernacularMatch:n.vernacularMatched},this.fireEvent(iI.EVENT_CHANGE)}}},{key:"inputChangeHandler",value:function(e){var t=this;e.stopPropagation(),console.log("got taxon field input change event"),Oy(this,Uk)&&clearTimeout(Oy(this,Uk)),_y(this,Uk,setTimeout((function(){console.log("processing taxon field input change event");var e=Oy(t,Yk).find((function(e){return e.exact}));e?(console.log("exact match"),t.value={taxonId:e.entityId,taxonName:e.vernacularMatched?e.vernacular:e.qname,vernacularMatch:e.vernacularMatched}):(console.log("no match"),t.value={taxonId:"",taxonName:document.getElementById(Oy(t,Pk)).value.trim(),vernacularMatch:null}),console.log(t._value),t.fireEvent(iI.EVENT_CHANGE)}),500))}}],[{key:"isEmpty",value:function(e){return!e||e&&!e.taxonName}},{key:"cleanRawInput",value:function(e){return e.value.trim().replace(/\s\s+/g," ")}}]),n}();function Gk(e){var t=this,n=iI.cleanRawInput(e);Oy(this,jk)&&clearTimeout(Oy(this,jk)),n.length>=xA.MIN_SEARCH_LENGTH?_y(this,jk,setTimeout((function(){_y(t,Yk,t.taxonSearch.lookup(iI.cleanRawInput(document.getElementById(Oy(t,Pk))))),console.log(Oy(t,Yk)),t.refreshSearchResultsList(),_y(t,jk,null)}),Jk.timeoutDelay)):(_y(this,Yk,[]),this.refreshSearchResultsList())}function qk(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}hd(Jk,"timeoutDelay",50);var Kk=new WeakMap,Wk=new WeakMap,Xk=function(e){by(n,iI);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(e){var r;return ud(this,n),qk(gy(r=t.call(this,e)),Kk,{writable:!0,value:void 0}),qk(gy(r),Wk,{writable:!0,value:void 0}),hd(gy(r),"_value",""),hd(gy(r),"_autocomplete",""),e&&(e.options&&(r.options=e.options),e.placeholder&&(r.placeholder=e.placeholder),e.autocomplete&&(r._autocomplete=e.autocomplete)),r}return fd(n,[{key:"value",get:function(){return this._value},set:function(e){this._value=void 0===e||null==e?"":e.trim(),this.updateView()}},{key:"updateView",value:function(){this._fieldEl&&(document.getElementById(Oy(this,Kk)).value=iI.cleanRawString(this._value))}},{key:"buildField",value:function(){var e=document.createElement("div");e.className="form-group",_y(this,Wk,e.id=iI.nextId),_y(this,Kk,iI.nextId);var t=e.appendChild(document.createElement("label"));t.htmlFor=Oy(this,Kk),t.textContent=this.label;var n=e.appendChild(document.createElement("textarea"));if(n.className="form-control",n.id=Oy(this,Kk),this.helpText&&(e.appendChild(document.createElement("small")).innerHTML=this.helpText),this._autocomplete&&(n.autocomplete=this._autocomplete,"off"===this._autocomplete&&(n.name=UO())),this.validationMessage){var r=e.appendChild(document.createElement("div"));r.className="invalid-feedback",r.innerHTML=this.validationMessage}n.addEventListener("change",this.inputChangeHandler.bind(this)),this._fieldEl=e}},{key:"inputChangeHandler",value:function(e){e.stopPropagation(),console.log("got text area field input change event"),this.value=iI.cleanRawString(document.getElementById(Oy(this,Kk)).value),this.fireEvent(iI.EVENT_CHANGE)}}],[{key:"summariseImpl",value:function(e,t,n){return""!==n[e]&&null!==n[e]&&void 0!==n[e]?JO(n[e].trim()):""}}]),n}(),Qk=function(){var e=function(){};return e.tetradOffsets={E:[0,8e3],J:[2e3,8e3],P:[4e3,8e3],U:[6e3,8e3],Z:[8e3,8e3],D:[0,6e3],I:[2e3,6e3],N:[4e3,6e3],T:[6e3,6e3],Y:[8e3,6e3],C:[0,4e3],H:[2e3,4e3],M:[4e3,4e3],S:[6e3,4e3],X:[8e3,4e3],B:[0,2e3],G:[2e3,2e3],L:[4e3,2e3],R:[6e3,2e3],W:[8e3,2e3],A:[0,0],F:[2e3,0],K:[4e3,0],Q:[6e3,0],V:[8e3,0]},e.quadrantOffsets={NW:[0,5e3],NE:[5e3,5e3],SW:[0,0],SE:[5e3,0]},e.letterMapping={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,J:8,K:9,L:10,M:11,N:12,O:13,P:14,Q:15,R:16,S:17,T:18,U:19,V:20,W:21,X:22,Y:23,Z:24},e.tetradLetters="ABCDEFGHIJKLMNPQRSTUVWXYZ",e.prototype.preciseGridRef="",e.prototype.length=0,e.prototype.hectad="",e.prototype.tetrad="",e.prototype.tetradLetter="",e.prototype.quadrant="",e.prototype.quadrantCode="",e.prototype.set_tetrad=function(){if(this.tetradLetter=e.tetradLetters.substr(5*(Math.floor(this.gridCoords.x%1e4/1e3)>>1)+(Math.floor(this.gridCoords.y%1e4/1e3)>>1),1),!this.tetradLetter)throw new Error("Failed to get tetrad letter when processing '"+this.preciseGridRef+"', easting="+this.gridCoords.x+" northing="+this.gridCoords.y);this.tetrad=this.hectad+this.tetradLetter},e.get_normalized_precision=function(e,t){return e>2e3?1e4:e>1e3?2e3:e>100?1e3:e>10?100:e>1?10:t||1},e}(),zk=function(e,t){this.lat=e,this.lng=t},$k=Math.PI/180,Zk=180/Math.PI,eL=function(e,t){this.lat=e,this.lng=t};eL.prototype.to_WGS84=function(){var e=6377563.396,t=.00667054007,n=this.lat*$k,r=Math.sin(n),o=this.lng*$k,a=e/Math.sqrt(1-t*(r*r)),i=a*Math.cos(n)*Math.cos(o),s=a*Math.cos(n)*Math.sin(o),c=(1-t)*a*r,l=-204894e-10,u=7.28190110241429e-7,d=119748977294801e-20,f=446.448+i*(1+l)+-u*s+d*c,h=408261589226812e-20*i-124.157+s*(1+l)+-u*c,p=542.06+-d*i+u*s+c*(1+l);e=6378137,t=.00669438003;for(var v=Math.sqrt(f*f+h*h),y=Math.atan(p/(v*(1-t))),m=1;m<10;++m){var g=Math.sin(y);y=Math.atan((p+t*(e/Math.sqrt(1-t*(g*g)))*g)/v)}return new zk(Zk*y,Zk*Math.atan(h/f))},eL.from_wgs84=function(e){var t=e.lat*$k,n=e.lng*$k,r=.00669438037928458,o=.0066705397616,a=20.4894*1e-6,i=6378137/Math.sqrt(1-r*Math.sin(t)*Math.sin(t)),s=(i+0)*Math.cos(t)*Math.cos(n),c=(i+0)*Math.cos(t)*Math.sin(n),l=((1-r)*i+0)*Math.sin(t),u=-.1502/3600*$k,d=-.247/3600*$k,f=-.8421/3600*$k,h=s+s*a-c*f+l*d-446.448,p=s*f+c+c*a-l*u+125.157,v=-1*s*d+c*u+l+l*a+-542.06,y=Math.atan(p/h),m=Math.sqrt(h*h+p*p),g=Math.atan(v/(m*(1-o)));i=6377563.396/Math.sqrt(1-o*(Math.sin(g)*Math.sin(g)));for(var S=1,b=0;S>.001;)b=Math.atan((v+o*i*Math.sin(g))/m),S=Math.abs(b-g),g=b;return new eL(g*Zk,y*Zk)};var tL=function(){var e=function(e,t){this.lat=e,this.lng=t};return e._transform=function(t,n,r,o,a,i,s,c,l,u,d,f,h,p){var v=1e-6*p,y=r/Math.sqrt(1-o*(Math.sin(t)*Math.sin(t))),m=(y+a)*Math.cos(t)*Math.cos(n),g=(y+a)*Math.cos(t)*Math.sin(n),S=((1-o)*y+a)*Math.sin(t),b=d/3600*$k,N=f/3600*$k,T=h/3600*$k,E=m+m*v-g*T+S*N+c,w=m*T+g+g*v-S*b+l,_=-1*m*N+g*b+S+S*v+u;n=Math.atan(w/E);var O=Math.sqrt(E*E+w*w);t=Math.atan(_/(O*(1-s))),y=i/Math.sqrt(1-s*(Math.sin(t)*Math.sin(t)));for(var I=1,R=0;I>.001;)R=Math.atan((_+s*y*Math.sin(t))/O),I=Math.abs(R-t),t=R;return new e(t,n)},e._Marc=function(e,t,n,r){return e*((1+t+5/4*(t*t)+5/4*(t*t*t))*(r-n)-(3*t+t*t*3+21/8*(t*t*t))*Math.sin(r-n)*Math.cos(r+n)+(15/8*(t*t)+15/8*(t*t*t))*Math.sin(2*(r-n))*Math.cos(2*(r+n))-35/24*(t*t*t)*Math.sin(3*(r-n))*Math.cos(3*(r+n)))},e}(),nL=function(){var e=function(e,t){this.lat=e,this.lng=t};return e.from_wgs84=function(t){var n=t.lat*$k,r=t.lng*$k,o=tL._transform(n,r,6378137,.00669438037928458,0,6378388,.0067226700223333,83.901,98.127,118.635,0,0,0,0);return new e(o.lat*Zk,o.lng*Zk)},e}(),rL=function(e,t){this.lat=e,this.lng=t};rL.prototype.to_WGS84=function(){var e=tL._transform(this.lat*$k,this.lng*$k,6377340.189,.00667054015,0,6378137,.00669438037928458,482.53,-130.596,564.557,-1.042,-.214,-.631,-8.15);return new zk(e.lat*Zk,e.lng*Zk)},rL.from_wgs84=function(e){var t=e.lat*$k,n=e.lng*$k,r=tL._transform(t,n,6378137,.00669438037928458,0,6377340.189,.00667054015,-482.53,130.596,-564.557,1.042,.214,.631,8.15);return new rL(r.lat*Zk,r.lng*Zk)};var oL=function(){};oL.tetradLetters="ABCDEFGHIJKLMNPQRSTUVWXYZ",oL.tetradLettersRowFirst="AFKQVBGLRWCHMSXDINTYEJPUZ",oL.from_latlng=function(e,t){if(t>=-8.74&&e>49.88){var n=new eL.from_wgs84(new zk(e,t)).to_os_coords();if(n.x>=0&&n.is_gb_hectad())return n}if(t<-5.3&&e>51.34&&t>-11&&e<55.73){var r=new rL.from_wgs84(new zk(e,t)).to_os_coords();return r.x<0||r.y<0?null:r}var o=new nL.from_wgs84(new zk(e,t)).to_os_coords();return o.x>=5e5&&o.x<6e5&&o.y>=54e5&&o.y<56e5?o:null},oL.calculate_tetrad=function(e,t){return e>=0&&t>=0?oL.tetradLetters.charAt(5*Math.floor(e%1e4/2e3)+Math.floor(t%1e4/2e3)):""},oL.prototype.toString=function(){return this.x+","+this.y};var aL=function(e,t,n,r){var o="00000"+Math.floor(t),a="00000"+Math.floor(n);if(2e3===r)return e+o.charAt(o.length-5)+a.charAt(a.length-5)+oL.calculate_tetrad(t,n);if(1e5===r)return e;5e3===r&&(r=1e4);var i=Math.round(Math.log10(r));return e+(i?o.slice(-5,-i)+a.slice(-5,-i):o.slice(-5)+a.slice(-5))},iL=function(e,t){this.x=e,this.y=t};(iL.prototype=new oL).constructor=iL,iL.prototype.country="CI",iL.prototype.to_latLng=function(){var e=.0067226700223333,t=6375836.6448,n=this.x-5e5,r=sL(this.y,0,t,0,.0016863406508729017,6354369.181221601),o=t/Math.sqrt(1-e*(Math.sin(r)*Math.sin(r))),a=o*(1-e)/(1-e*Math.sin(r)*Math.sin(r)),i=o/a-1,s=Math.tan(r)*Math.tan(r),c=Math.pow(Math.tan(r),4),l=Math.pow(Math.tan(r),6),u=Math.pow(Math.cos(r),-1),d=Math.tan(r)/(2*a*o),f=Math.tan(r)/(24*a*(o*o*o))*(5+3*s+i-9*i*s),h=Math.tan(r)/(720*a*Math.pow(o,5))*(61+90*s+45*c),p=r-n*n*d+Math.pow(n,4)*f-Math.pow(n,6)*h,v=Math.pow(Math.cos(r),-1)/o,y=u/(o*o*o*6)*(o/a+2*s),m=u/(120*Math.pow(o,5))*(5+28*s+24*c),g=u/(5040*Math.pow(o,7))*(61+662*s+1320*c+720*l),S=n*v-.0523598775598-n*n*n*y+Math.pow(n,5)*m-Math.pow(n,7)*g,b=iL.convert_to_wgs(p,S);return new zk(b.lat*Zk,b.lng*Zk)};var sL=function(e,t,n,r,o,a){for(var i=(e-t)/n+r,s=iL.marc(a,o,r,i),c=(e-t-s)/n+i,l=0;Math.abs(e-t-s)>1e-5&&l<20;)l+=1,c=(e-t-s)/n+i,s=tL._Marc(a,o,r,c),i=c;return c};iL.prototype.to_gridref=function(e){return this.y>=55e5?aL("WA",this.x-5e5,this.y-55e5,e||1):this.y<55e5?aL("WV",this.x-5e5,this.y-54e5,e||1):null},iL.prototype.to_hectad=function(){return this.y>55e5?"WA"+this.x.toString().substring(1,2)+this.y.toString().substring(2,3):this.y<55e5?"WV"+this.x.toString().substring(1,2)+this.y.toString().substring(2,3):null};var cL=function(){var e=function(){};return(e.prototype=new Qk).constructor=e,e.prototype.country="CI",e.prototype.GridCoords=iL,e.prototype.from_string=function(t){var n,r=t.replace(/[\[\]\s\t\.\/-]+/g,"").toUpperCase(),o="";/[ABCDEFGHIJKLMNPQRSTUVWXYZ]$/.test(r)&&(Qk.quadrantOffsets.hasOwnProperty(r.substr(r.length-2))?(this.quadrantCode=r.substr(r.length-2),r=r.substr(0,r.length-2)):(o=r.substr(r.length-1),r=r.substr(0,r.length-1))),/^(W[AV](?:\d\d){1,5})$/.test(r)?(n=e.gridref_string_to_e_n_l(r))?(this.length=n.length,this.gridCoords=new iL(n.e,n.n),this.hectad=this.gridCoords.to_gridref(1e4),1e4===this.length&&(o||this.quadrantCode)?o?(this.preciseGridRef=r+o,this.tetrad=this.hectad+o,this.tetradLetter=o,this.length=2e3,this.gridCoords.x+=Qk.tetradOffsets[o][0],this.gridCoords.y+=Qk.tetradOffsets[o][1]):(this.preciseGridRef=r+this.quadrantCode,this.tetradLetter="",this.tetrad="",this.quadrant=this.preciseGridRef,this.length=5e3,this.gridCoords.x+=Qk.quadrantOffsets[this.quadrantCode][0],this.gridCoords.y+=Qk.quadrantOffsets[this.quadrantCode][1]):(this.preciseGridRef=r,this.length<=1e3&&this.set_tetrad())):(this.error=!0,this.errorMessage="Grid reference format not understood (odd length)."):(this.error=!0,this.errorMessage="Channel Island grid reference format not understood. ('"+t+"')")},e.prototype.parse_well_formed=e.prototype.from_string,e.gridref_string_to_e_n_l=function(e){var t,n,r,o,a=e.substr(0,2);if("WA"===a)t=55e5;else{if("WV"!==a)return Logger("Bad Channel Island grid letters: '"+a+"'"),!1;t=54e5}var i=e.substr(2);switch(i.length){case 2:n=1e4*i.charAt(0),r=1e4*i.charAt(1),o=1e4;break;case 4:n=1e3*i.substr(0,2),r=1e3*i.substr(2),o=1e3;break;case 6:n=100*i.substr(0,3),r=100*i.substr(3),o=100;break;case 8:n=10*i.substr(0,4),r=10*i.substr(4),o=10;break;case 10:n=parseInt(i.substr(0,5),10),r=parseInt(i.substr(5),10),o=1;break;default:return Logger("Bad length for Channel Island grid ref '"+e+"'"),!1}return{e:n+5e5,n:r+t,length:o}},e}(),lL=function(e,t){this.x=e,this.y=t};(lL.prototype=new oL).constructor=lL,lL.prototype.country="GB",lL.gbHectads="SV80SV81SV90SV91SW32SW33SW42SW43SW44SW52SW53SW54SW61SW62SW63SW64SW65SW71SW72SW73SW74SW75SW76SW81SW82SW83SW84SW85SW86SW87SW95SW96SW97SS10SS11SS20SS21SS30SW83SW84SW85SW93SW94SW95SW96SW97SW98SX03SX04SX05SX06SX07SX08SX09SX14SX15SX16SX17SX18SX19SX25SX26SX27SX28SX29SX35SX36SX37SX38SX39SX44SX45SX46SX47SS70SS80SS81SS90SS91ST00ST01ST10ST11ST20ST21ST30SX37SX44SX45SX46SX47SX48SX54SX55SX56SX57SX58SX63SX64SX65SX66SX67SX68SX69SX73SX74SX75SX76SX77SX78SX79SX83SX84SX85SX86SX87SX88SX89SX94SX95SX96SX97SX98SX99SY07SY08SY09SY18SY19SY28SY29SY38SY39SS14SS20SS21SS22SS30SS31SS32SS40SS41SS42SS43SS44SS50SS51SS52SS53SS54SS60SS61SS62SS63SS64SS70SS71SS72SS73SS74SS75SS80SS81SS82SS83SS91SS92ST01ST02SX28SX29SX37SX38SX39SX48SX49SX58SX59SX68SX69SX79SS73SS74SS82SS83SS84SS92SS93SS94ST01ST02ST03ST04ST11ST12ST13ST14ST20ST21ST22ST23ST24ST25ST30ST31ST32ST33ST34ST40ST41ST42ST50ST51ST52ST61ST62ST71ST72ST24ST25ST26ST32ST33ST34ST35ST36ST37ST42ST43ST44ST45ST46ST47ST52ST53ST54ST55ST56ST57ST62ST63ST64ST65ST66ST67ST72ST73ST74ST75ST76ST77ST83ST84ST85ST86SP00SP10ST76ST77ST85ST86ST87ST88ST89ST96ST97ST98ST99SU06SU07SU08SU09SU16SU17SU18SU19SU26SU27SU28SU29SU36SU37ST73ST74ST75ST76ST82ST83ST84ST85ST86ST91ST92ST93ST94ST95ST96SU01SU02SU03SU04SU05SU06SU11SU12SU13SU14SU15SU16SU21SU22SU23SU24SU25SU26SU31SU32SU34SU35SU36ST20ST30ST40ST50ST51ST60ST61ST70ST71ST72ST73ST80ST81ST82ST83ST90ST91ST92SU00SU01SU02SU10SU11SY39SY48SY49SY58SY59SY66SY67SY68SY69SY77SY78SY79SY87SY88SY89SY97SY98SY99SZ07SZ08SZ09SZ28SZ38SZ39SZ47SZ48SZ49SZ57SZ58SZ59SZ68SZ69SU00SU01SU02SU10SU11SU12SU20SU21SU22SU23SU30SU31SU32SU33SU40SU41SU42SU43SU50SU51SU52SU60SU61SU62SU70SU71SU72SZ08SZ09SZ19SZ29SZ38SZ39SZ49SZ59SZ69SZ79SU23SU24SU25SU33SU34SU35SU36SU42SU43SU44SU45SU46SU52SU53SU54SU55SU56SU62SU63SU64SU65SU66SU72SU73SU74SU75SU76SU82SU83SU84SU85SU86SU70SU71SU72SU80SU81SU82SU83SU90SU91SU92SU93SZ79SZ89SZ99TQ00TQ01TQ02TQ03TQ10TQ11TQ12TQ13TQ20TQ21TQ22TQ23TQ30TQ31TQ32TQ20TQ21TQ22TQ23TQ30TQ31TQ32TQ33TQ40TQ41TQ42TQ43TQ44TQ50TQ51TQ52TQ53TQ54TQ60TQ61TQ62TQ63TQ70TQ71TQ72TQ80TQ81TQ82TQ91TQ92TV49TV59TV69TQ65TQ72TQ73TQ74TQ75TQ76TQ77TQ82TQ83TQ84TQ85TQ86TQ87TQ91TQ92TQ93TQ94TQ95TQ96TQ97TR01TR02TR03TR04TR05TR06TR07TR12TR13TR14TR15TR16TR23TR24TR25TR26TR27TR33TR34TR35TR36TR37TR46TR47TQ35TQ36TQ37TQ38TQ43TQ44TQ45TQ46TQ47TQ48TQ53TQ54TQ55TQ56TQ57TQ58TQ63TQ64TQ65TQ66TQ67TQ72TQ73TQ74TQ75TQ76TQ77TQ78TQ87TQ88TQ97SU83SU84SU85SU86SU93SU94SU95SU96SU97TQ03TQ04TQ05TQ06TQ07TQ13TQ14TQ15TQ16TQ17TQ23TQ24TQ25TQ26TQ27TQ33TQ34TQ35TQ36TQ37TQ38TQ43TQ44TQ45TL30TL40TL50TL60TL70TL80TL90TM00TQ38TQ39TQ47TQ48TQ49TQ57TQ58TQ59TQ67TQ68TQ69TQ77TQ78TQ79TQ88TQ89TQ98TQ99TR08TR09TR19TL30TL31TL34TL40TL41TL42TL43TL44TL50TL51TL52TL53TL54TL60TL61TL62TL63TL64TL70TL71TL72TL73TL74TL80TL81TL82TL83TL84TL90TL91TL92TL93TM01TM02TM03TM11TM12TM13TM21TM22TM23TQ49SP81SP90SP91TL00TL01TL02TL10TL11TL12TL13TL20TL21TL22TL23TL24TL30TL31TL32TL33TL34TL41TL42TL43TL44TL51TL52TQ09TQ19TQ29TQ39TL20TL30TQ06TQ07TQ08TQ09TQ16TQ17TQ18TQ19TQ27TQ28TQ29TQ37TQ38TQ39SP20SP30SP40SP41SP50SU19SU26SU27SU28SU29SU36SU37SU38SU39SU46SU47SU48SU49SU56SU57SU58SU59SU66SU67SU68SU69SU76SU77SU78SU86SU87SU88SU96SU97SU98SP10SP20SP21SP22SP23SP30SP31SP32SP33SP34SP40SP41SP42SP43SP44SP45SP50SP51SP52SP53SP54SP60SP61SP62SP63SP70SU29SU39SU49SU57SU58SU59SU67SU68SU69SU77SU78SU79SP51SP53SP60SP61SP62SP63SP64SP70SP71SP72SP73SP74SP80SP81SP82SP83SP84SP85SP90SP91SP92SP93SP94SP95SU78SU79SU88SU89SU97SU98SU99TL00TL01TQ07TQ08TQ09TG40TG50TM03TM04TM05TM06TM07TM13TM14TM15TM16TM17TM23TM24TM25TM26TM27TM28TM33TM34TM35TM36TM37TM38TM39TM44TM45TM46TM47TM48TM49TM57TM58TM59TL64TL65TL66TL67TL68TL74TL75TL76TL77TL78TL83TL84TL85TL86TL87TL88TL93TL94TL95TL96TL97TL98TM03TM04TM05TM06TM07TM08TG00TG01TG02TG03TG04TG10TG11TG12TG13TG14TG20TG21TG22TG23TG24TG30TG31TG32TG33TG40TG41TG42TG50TG51TM07TM08TM09TM17TM18TM19TM27TM28TM29TM38TM39TM49TM59TF40TF41TF42TF50TF51TF52TF53TF60TF61TF62TF63TF64TF70TF71TF72TF73TF74TF80TF81TF82TF83TF84TF90TF91TF92TF93TF94TG00TG01TG02TG03TG04TL49TL59TL68TL69TL78TL79TL87TL88TL89TL98TL99TM07TM08TM09TF20TF30TF31TF40TF41TF50TL15TL19TL23TL24TL25TL26TL28TL29TL33TL34TL35TL36TL37TL38TL39TL44TL45TL46TL47TL48TL49TL54TL55TL56TL57TL58TL59TL63TL64TL65TL66TL67TL68TL69TL75TL76SP91SP92SP93SP94SP95SP96TL01TL02TL03TL04TL05TL06TL07TL11TL12TL13TL14TL15TL16TL23TL24TL25TL06TL07TL08TL09TL15TL16TL17TL18TL19TL25TL26TL27TL28TL29TL36TL37TL38TL39SK90SP43SP44SP45SP46SP53SP54SP55SP56SP57SP58SP63SP64SP65SP66SP67SP68SP73SP74SP75SP76SP77SP78SP79SP84SP85SP86SP87SP88SP89SP95SP96SP97SP98SP99TF00TF10TF20TL06TL07TL08TL09TL18TL19TL29SO70SO71SO80SO81SO82SO83SO90SO91SO92SO93SO94SP00SP01SP02SP03SP04SP10SP11SP12SP13SP14SP15SP20SP21SP22SP23SP24SP25ST99SU09SU19SU29SO50SO51SO60SO61SO62SO63SO70SO71SO72SO73SO80SO81SO82SO83SO90ST57ST58ST59ST66ST67ST68ST69ST76ST77ST78ST79ST87ST88ST89ST98ST99SO10SO11SO20SO21SO22SO23SO30SO31SO32SO40SO41SO42SO50SO51ST18ST19ST27ST28ST29ST37ST38ST39ST47ST48ST49ST58ST59SO22SO23SO24SO25SO26SO32SO33SO34SO35SO36SO37SO41SO42SO43SO44SO45SO46SO47SO51SO52SO53SO54SO55SO56SO57SO61SO62SO63SO64SO65SO66SO73SO74SO75SO76SO56SO64SO65SO66SO67SO72SO73SO74SO75SO76SO77SO78SO82SO83SO84SO85SO86SO87SO88SO93SO94SO95SO96SO97SO98SO99SP03SP04SP05SP06SP07SP08SP13SP14SP16SP17SP18SK10SK20SK30SP04SP05SP06SP07SP08SP09SP14SP15SP16SP17SP18SP19SP22SP23SP24SP25SP26SP27SP28SP29SP33SP34SP35SP36SP37SP38SP39SP44SP45SP46SP47SP48SP49SP55SP56SP57SP58SJ63SJ70SJ71SJ72SJ73SJ74SJ75SJ80SJ81SJ82SJ83SJ84SJ85SJ86SJ90SJ91SJ92SJ93SJ94SJ95SJ96SK00SK01SK02SK03SK04SK05SK06SK10SK11SK12SK13SK14SK15SK16SK20SK21SK22SO77SO78SO79SO88SO89SO98SO99SP08SP09SP19SP29SJ20SJ21SJ22SJ23SJ30SJ31SJ32SJ33SJ34SJ40SJ41SJ42SJ43SJ50SJ51SJ52SJ53SJ54SJ60SJ61SJ62SJ63SJ64SJ70SJ71SJ72SJ73SJ74SJ80SO17SO18SO27SO28SO29SO37SO38SO39SO46SO47SO48SO49SO56SO57SO58SO59SO66SO67SO68SO69SO77SO78SO79SO88SO89SN50SN60SN61SN70SN71SN80SN81SN90SO00SO01SO10SO11SS38SS39SS48SS49SS58SS59SS68SS69SS77SS78SS79SS87SS88SS89SS96SS97SS98SS99ST06ST07ST08ST09ST16ST17ST18ST19ST26ST27ST28SN70SN71SN74SN80SN81SN82SN83SN84SN85SN86SN90SN91SN92SN93SN94SN95SN96SO00SO01SO02SO03SO04SO05SO06SO10SO11SO12SO13SO14SO21SO22SO23SO24SN86SN87SN96SN97SO04SO05SO06SO07SO08SO13SO14SO15SO16SO17SO18SO24SO25SO26SO27SO36SO37SN01SN02SN10SN11SN12SN20SN21SN22SN23SN24SN30SN31SN32SN33SN34SN40SN41SN42SN43SN44SN50SN51SN52SN53SN54SN60SN61SN62SN63SN64SN65SN71SN72SN73SN74SN75SN81SN82SN83SN84SS39SS49SS59SM50SM62SM70SM71SM72SM73SM80SM81SM82SM83SM84SM90SM91SM92SM93SM94SN00SN01SN02SN03SN04SN10SN11SN12SN13SN14SN22SN23SN24SR89SR99SS09SS19SN14SN15SN24SN25SN33SN34SN35SN36SN44SN45SN46SN54SN55SN56SN57SN58SN64SN65SN66SN67SN68SN69SN74SN75SN76SN77SN78SN79SN84SN85SN86SN87SN88SN89SH70SH71SH80SH81SH90SH91SH92SJ00SJ01SJ02SJ03SJ10SJ11SJ12SJ20SJ21SJ22SJ31SN69SN78SN79SN87SN88SN89SN97SN98SN99SO07SO08SO09SO18SO19SO28SO29SO39SH50SH51SH52SH53SH54SH60SH61SH62SH63SH64SH70SH71SH72SH73SH74SH80SH81SH82SH83SH84SH91SH92SH93SH94SH95SJ03SJ04SJ05SJ13SJ14SN59SN69SN79SH12SH13SH22SH23SH24SH32SH33SH34SH43SH44SH45SH46SH53SH54SH55SH56SH57SH64SH65SH66SH67SH74SH75SH76SH77SH78SH84SH85SH86SH87SH88SH74SH75SH76SH77SH84SH85SH86SH87SH88SH94SH95SH96SH97SH98SJ02SJ03SJ04SJ05SJ06SJ07SJ08SJ12SJ13SJ14SJ15SJ16SJ17SJ22SJ23SJ24SJ25SJ26SJ33SJ34SJ35SJ43SJ44SJ45SJ53SJ54SH97SH98SJ06SJ07SJ08SJ15SJ16SJ17SJ18SJ25SJ26SJ27SJ35SJ36SJ37SH27SH28SH29SH36SH37SH38SH39SH46SH47SH48SH49SH56SH57SH58SH59SH67SH68SK81SK82SK83SK84SK85SK86SK87SK90SK91SK92SK93SK94SK95SK96SK97TF00TF01TF02TF03TF04TF05TF06TF07TF10TF11TF12TF13TF14TF15TF16TF17TF20TF21TF22TF23TF24TF25TF30TF31TF32TF33TF34TF41TF42TF43TF44TF52SE60SE70SE71SE80SE81SE82SE90SE91SE92SK78SK79SK87SK88SK89SK97SK98SK99TA00TA01TA02TA10TA11TA12TA20TA21TA30TA31TA40TF07TF08TF09TF15TF16TF17TF18TF19TF24TF25TF26TF27TF28TF29TF33TF34TF35TF36TF37TF38TF39TF43TF44TF45TF46TF47TF48TF49TF54TF55TF56TF57TF58SK20SK21SK30SK31SK32SK40SK41SK42SK43SK50SK51SK52SK60SK61SK62SK70SK71SK72SK73SK74SK80SK81SK82SK83SK84SK90SK91SP39SP48SP49SP57SP58SP59SP68SP69SP78SP79SP89SP99TF00TF01SE60SE70SK42SK43SK44SK45SK46SK52SK53SK54SK55SK56SK57SK58SK59SK62SK63SK64SK65SK66SK67SK68SK69SK72SK73SK74SK75SK76SK77SK78SK79SK84SK85SK86SK87SK88SK89SK97SJ98SJ99SK03SK06SK07SK08SK09SK11SK12SK13SK14SK15SK16SK17SK18SK19SK21SK22SK23SK24SK25SK26SK27SK28SK31SK32SK33SK34SK35SK36SK37SK38SK42SK43SK44SK45SK46SK47SK48SK53SK56SK57SD90SE00SE10SJ18SJ19SJ27SJ28SJ29SJ35SJ36SJ37SJ38SJ39SJ44SJ45SJ46SJ47SJ48SJ54SJ55SJ56SJ57SJ58SJ63SJ64SJ65SJ66SJ67SJ68SJ69SJ74SJ75SJ76SJ77SJ78SJ79SJ85SJ86SJ87SJ88SJ89SJ96SJ97SJ98SJ99SK06SK07SK08SK09SK19SD20SD21SD22SD30SD31SD32SD40SD41SD42SD50SD51SD52SD53SD60SD61SD62SD63SD70SD71SD72SD73SD74SD80SD81SD82SD83SD84SD90SD91SD92SD93SD94SJ29SJ38SJ39SJ48SJ49SJ58SJ59SJ68SJ69SJ79SJ88SJ89SJ99SD22SD23SD32SD33SD34SD35SD36SD42SD43SD44SD45SD46SD47SD52SD53SD54SD55SD56SD57SD63SD64SD65SD66SD67SD68SD73SD78SE53SE54SE62SE63SE64SE65SE72SE73SE74SE75SE76SE82SE83SE84SE85SE86SE87SE92SE93SE94SE95SE96SE97SE98TA02TA03TA04TA05TA06TA07TA08TA12TA13TA14TA15TA16TA17TA18TA21TA22TA23TA24TA26TA27TA31TA32TA33TA41TA42NZ30NZ31NZ40NZ41NZ42NZ50NZ51NZ52NZ60NZ61NZ62NZ70NZ71NZ72NZ80NZ81NZ90NZ91SE37SE38SE39SE46SE47SE48SE49SE55SE56SE57SE58SE59SE64SE65SE66SE67SE68SE69SE75SE76SE77SE78SE79SE86SE87SE88SE89SE97SE98SE99TA08TA09TA18SD84SD90SD91SD92SD93SD94SD95SE00SE01SE02SE03SE04SE10SE11SE12SE13SE14SE20SE21SE22SE23SE30SE31SE32SE33SE40SE41SE42SE50SE51SE52SE60SE61SE62SE70SE71SE72SE81SE82SK18SK19SK28SK29SK38SK39SK47SK48SK49SK57SK58SK59SK69SD54SD55SD64SD65SD66SD67SD68SD73SD74SD75SD76SD77SD78SD84SD85SD86SD87SD88SD94SD95SD96SD97SD98SE04SE05SE06SE07SE13SE14SE15SE16SE17SE23SE24SE25SE26SE27SE32SE33SE34SE35SE36SE37SE42SE43SE44SE45SE46SE52SE53SE54SE55SE56SE62SE63SE64SE65SE72NY72NY80NY81NY82NY90NY91NY92NZ00NZ01NZ02NZ10NZ11NZ20NZ21NZ30NZ31SD68SD69SD78SD79SD88SD89SD97SD98SD99SE07SE08SE09SE17SE18SE19SE27SE28SE29SE36SE37SE38SE39SE46SE47NY73NY74NY82NY83NY84NY92NY93NY94NY95NZ01NZ02NZ03NZ04NZ05NZ11NZ12NZ13NZ14NZ15NZ16NZ20NZ21NZ22NZ23NZ24NZ25NZ26NZ30NZ31NZ32NZ33NZ34NZ35NZ36NZ41NZ42NZ43NZ44NZ45NZ46NZ52NZ53NT60NT70NT80NT90NU00NU10NU20NY58NY59NY64NY65NY66NY67NY68NY69NY74NY75NY76NY77NY78NY79NY84NY85NY86NY87NY88NY89NY94NY95NY96NY97NY98NY99NZ04NZ05NZ06NZ07NZ08NZ09NZ15NZ16NZ17NZ18NZ19NZ26NZ27NZ28NZ29NZ36NZ37NZ38NZ39NT70NT71NT73NT80NT81NT82NT83NT84NT90NT91NT92NT93NT94NT95NU00NU01NU02NU03NU04NU05NU10NU11NU12NU13NU14NU20NU21NU22NU23NZ09NZ19NY20NY21NY30NY31NY40NY41NY42NY50NY51NY52NY53NY60NY61NY62NY63NY70NY71NY72NY73NY80NY81NY82NY83SD16SD17SD18SD19SD26SD27SD28SD29SD36SD37SD38SD39SD46SD47SD48SD49SD57SD58SD59SD67SD68SD69SD78SD79SD89NX90NX91NX92NX93NY00NY01NY02NY03NY04NY05NY10NY11NY12NY13NY14NY15NY16NY20NY21NY22NY23NY24NY25NY26NY31NY32NY33NY34NY35NY36NY37NY41NY42NY43NY44NY45NY46NY47NY48NY52NY53NY54NY55NY56NY57NY58NY62NY63NY64NY65NY66NY67NY68NY73NY74NY75NY84SD08SD09SD17SD18SD19SD28SD29NX30NX40SC16SC17SC26SC27SC28SC36SC37SC38SC39SC47SC48SC49NS60NS61NS70NS71NS72NS80NS81NS90NT00NT01NT10NT11NT20NT21NT30NX69NX78NX79NX88NX89NX96NX97NX98NX99NY05NY06NY07NY08NY09NY16NY17NY18NY19NY26NY27NY28NY29NY36NY37NY38NY39NY47NY48NY49NS50NS60NX36NX37NX38NX45NX46NX47NX48NX49NX54NX55NX56NX57NX58NX59NX64NX65NX66NX67NX68NX69NX74NX75NX76NX77NX78NX79NX84NX85NX86NX87NX88NX95NX96NX97NX98NY05NY06NW95NW96NW97NX03NX04NX05NX06NX07NX13NX14NX15NX16NX17NX24NX25NX26NX27NX33NX34NX35NX36NX37NX43NX44NX45NX46NS00NS10NS14NS15NS16NS20NS21NS23NS24NS25NS26NS30NS31NS32NS33NS34NS35NS36NS40NS41NS42NS43NS44NS45NS50NS51NS52NS53NS54NS55NS60NS61NS62NS63NS64NS71NS72NS73NX07NX08NX09NX17NX18NX19NX27NX28NX29NX37NX38NX39NX48NX49NX59NS16NS17NS26NS27NS35NS36NS37NS44NS45NS46NS47NS54NS55NS56NS64NS65NS66NS53NS54NS55NS56NS57NS63NS64NS65NS66NS67NS71NS72NS73NS74NS75NS76NS77NS80NS81NS82NS83NS84NS85NS86NS87NS90NS91NS92NS93NS94NS95NS96NT00NT01NT02NT03NT04NT05NT14NT01NT02NT03NT04NT05NT11NT12NT13NT14NT15NT21NT22NT23NT24NT25NT32NT33NT34NT10NT11NT20NT21NT22NT23NT30NT31NT32NT33NT34NT41NT42NT43NT44NT53NT20NT30NT31NT40NT41NT42NT43NT44NT50NT51NT52NT53NT54NT60NT61NT62NT63NT64NT70NT71NT72NT73NT74NT81NT82NT83NY39NY47NY48NY49NY58NY59NY69NT44NT45NT46NT53NT54NT55NT56NT63NT64NT65NT66NT73NT74NT75NT76NT77NT83NT84NT85NT86NT87NT94NT95NT96NT36NT37NT45NT46NT47NT48NT55NT56NT57NT58NT65NT66NT67NT68NT76NT77NS95NS96NT05NT06NT15NT16NT17NT24NT25NT26NT27NT34NT35NT36NT37NT43NT44NT45NT46NS86NS87NS95NS96NS97NS98NT06NT07NT08NT16NT17NO00NO01NO10NO11NO20NO21NO22NO30NO31NO32NO40NO41NO42NO50NO51NO52NO60NO61NS99NT08NT09NT18NT19NT28NT29NT39NT49NT59NT69NN30NN31NN40NN41NS38NS39NS47NS48NS49NS57NS58NS59NS67NS68NS69NS77NS78NS79NS86NS87NS88NS89NS97NS98NN21NN22NN30NN31NN32NN40NN41NN42NN50NN51NN52NN60NN61NN70NN71NN80NN81NN90NN91NO00NS49NS59NS69NS79NS88NS89NS98NS99NT08NT09NN22NN23NN32NN33NN34NN35NN42NN43NN44NN45NN46NN47NN51NN52NN53NN54NN55NN56NN57NN61NN62NN63NN64NN65NN66NN67NN71NN72NN73NN74NN75NN76NN77NN81NN82NN83NN84NN85NN86NN90NN91NN92NN93NN94NN95NN96NO00NO01NO02NO03NO04NO11NO12NO13NO21NN56NN57NN66NN67NN68NN76NN77NN78NN86NN87NN88NN94NN95NN96NN97NN98NO02NO03NO04NO05NO06NO07NO08NO11NO12NO13NO14NO15NO16NO17NO21NO22NO23NO24NO25NO32NO33NO34NO15NO16NO17NO23NO24NO25NO26NO27NO28NO32NO33NO34NO35NO36NO37NO38NO42NO43NO44NO45NO46NO47NO48NO53NO54NO55NO56NO57NO58NO63NO64NO65NO66NO67NO74NO75NO76NJ60NJ70NJ80NJ90NO57NO58NO66NO67NO68NO69NO76NO77NO78NO79NO86NO87NO88NO89NO99NH90NJ00NJ10NJ11NJ20NJ21NJ30NJ31NJ32NJ40NJ41NJ42NJ50NJ51NJ52NJ60NJ61NJ62NJ70NJ71NJ72NJ80NJ81NJ82NJ90NJ91NJ92NK02NN98NN99NO07NO08NO09NO17NO18NO19NO27NO28NO29NO37NO38NO39NO48NO49NO58NO59NO68NO69NO79NO89NJ31NJ32NJ33NJ34NJ42NJ43NJ44NJ52NJ53NJ54NJ55NJ62NJ63NJ64NJ65NJ72NJ73NJ74NJ75NJ76NJ82NJ83NJ84NJ85NJ86NJ92NJ93NJ94NJ95NJ96NK02NK03NK04NK05NK06NK13NK14NK15NH90NJ00NJ01NJ10NJ11NJ12NJ13NJ14NJ21NJ22NJ23NJ24NJ25NJ32NJ33NJ34NJ35NJ36NJ42NJ43NJ44NJ45NJ46NJ54NJ55NJ56NJ64NJ65NJ66NJ74NJ75NJ76NJ86NN99NH72NH81NH82NH91NH92NH93NH94NH95NH96NJ00NJ01NJ02NJ03NJ04NJ05NJ06NJ11NJ12NJ13NJ14NJ15NJ16NJ17NJ23NJ24NJ25NJ26NJ27NJ34NJ35NJ36NJ45NH01NH02NH10NH11NH12NH13NH14NH20NH21NH22NH23NH24NH30NH31NH32NH33NH34NH40NH41NH42NH43NH44NH50NH51NH52NH53NH54NH60NH61NH62NH63NH64NH70NH71NH72NH73NH74NH75NH80NH81NH82NH83NH84NH85NH90NH91NH92NH93NH94NH95NH96NJ00NJ01NN39NN46NN47NN48NN49NN56NN57NN58NN59NN67NN68NN69NN77NN78NN79NN88NN89NN98NN99NG60NG70NG71NG72NG80NG81NG82NG90NG91NH00NH01NH10NH20NH30NM46NM47NM54NM55NM56NM57NM64NM65NM66NM67NM68NM69NM74NM75NM76NM77NM78NM79NM84NM85NM86NM87NM88NM89NM95NM96NM97NM98NM99NN05NN06NN07NN08NN09NN16NN17NN18NN19NN26NN27NN28NN29NN35NN36NN37NN38NN39NN46NN47NN48NN49NN57NN58NN59NM70NM71NM72NM73NM80NM81NM82NM83NM84NM90NM91NM92NM93NM94NM95NN00NN01NN02NN03NN04NN05NN10NN11NN12NN13NN14NN15NN16NN20NN21NN22NN23NN24NN25NN26NN30NN33NN34NN35NN36NN44NN45NN46NR79NR88NR89NR96NR97NR98NR99NS06NS07NS08NS09NS16NS17NS18NS19NS28NS29NN20NN21NN30NN31NS28NS29NS37NS38NS39NS46NS47NS48NS56NS57NR82NR83NR84NR92NR93NR94NR95NR96NR97NS01NS02NS03NS04NS05NS06NS07NS15NS16NR50NR51NR60NR61NR62NR63NR64NR65NR67NR68NR70NR71NR72NR73NR74NR75NR76NR77NR78NR79NR83NR84NR85NR86NR87NR88NR89NR95NR96NM40NM60NM61NM70NM71NR15NR16NR24NR25NR26NR27NR34NR35NR36NR37NR38NR39NR44NR45NR46NR47NR48NR49NR56NR57NR58NR59NR67NR68NR69NR79NL93NL94NM04NM05NM15NM16NM21NM22NM23NM24NM25NM26NM31NM32NM33NM34NM35NM41NM42NM43NM44NM45NM51NM52NM53NM54NM55NM61NM62NM63NM64NM72NM73NG13NG14NG15NG20NG23NG24NG25NG26NG30NG31NG32NG33NG34NG35NG36NG37NG38NG40NG41NG42NG43NG44NG45NG46NG47NG50NG51NG52NG53NG54NG55NG56NG60NG61NG62NG63NG64NG65NG66NG71NG72NG82NM19NM29NM37NM38NM39NM47NM48NM49NM59NB90NB91NC00NC01NC10NC11NC20NC21NG63NG64NG65NG72NG73NG74NG75NG76NG77NG78NG79NG82NG83NG84NG85NG86NG87NG88NG89NG91NG92NG93NG94NG95NG96NG97NG98NG99NH00NH01NH02NH03NH04NH05NH06NH07NH08NH09NH10NH11NH15NH16NH17NH18NH19NH27NH28NH29NC10NC20NC21NC30NC31NC40NH02NH03NH04NH05NH06NH07NH12NH13NH14NH15NH16NH17NH19NH23NH24NH25NH26NH27NH28NH29NH34NH35NH36NH37NH38NH39NH44NH45NH46NH47NH48NH49NH54NH55NH56NH57NH58NH59NH64NH65NH66NH67NH68NH69NH75NH76NH77NH78NH86NH87NH88NH97NH98NC22NC30NC31NC32NC33NC40NC41NC42NC43NC50NC51NC52NC60NC61NC62NC63NC70NC71NC72NC73NC74NC80NC81NC82NC83NC84NC90NC91NC92NC93ND01ND02NH49NH59NH68NH69NH78NH79NH88NH89NC01NC02NC03NC10NC11NC12NC13NC14NC15NC16NC20NC21NC22NC23NC24NC25NC26NC27NC31NC32NC33NC34NC35NC36NC37NC42NC43NC44NC45NC46NC52NC53NC54NC55NC56NC62NC63NC64NC65NC66NC73NC74NC75NC76NC83NC84NC85NC86NC93NC94NC95NC96NC92NC93NC94NC95NC96ND01ND02ND03ND04ND05ND06ND07ND12ND13ND14ND15ND16ND17ND23ND24ND25ND26ND27ND33ND34ND35ND36ND37ND47HW63HW83HX62NA00NA10NA64NA74NA81NA90NA91NA92NA93NB00NB01NB02NB03NB10NB11NB12NB13NB14NB20NB21NB22NB23NB24NB30NB31NB32NB33NB34NB35NB40NB41NB42NB43NB44NB45NB46NB52NB53NB54NB55NB56NF09NF19NF56NF58NF60NF61NF66NF67NF68NF70NF71NF72NF73NF74NF75NF76NF77NF80NF81NF82NF83NF84NF85NF86NF87NF88NF89NF95NF96NF97NF98NF99NG07NG08NG09NG18NG19NG29NG49NL57NL58NL68NL69NL79HY10HY20HY21HY22HY23HY30HY31HY32HY33HY34HY35HY40HY41HY42HY43HY44HY45HY50HY51HY52HY53HY54HY55HY60HY61HY62HY63HY64HY73HY74HY75ND19ND28ND29ND38ND39ND47ND48ND49ND59HP40HP50HP51HP60HP61HT93HT94HU14HU15HU16HU24HU25HU26HU27HU28HU30HU31HU32HU33HU34HU35HU36HU37HU38HU39HU40HU41HU42HU43HU44HU45HU46HU47HU48HU49HU53HU54HU55HU56HU57HU58HU59HU66HU67HU68HU69HZ16HZ17HZ26HZ27",lL.prototype.to_gridref=function(e){var t,n=this.x/1e5|0,r=this.y/1e5|0;t=r<5?n<5?"S":"T":r<10?n<5?"N":"O":n<5?"H":"J";var o=65+5*(4-r%5)+n%5;o>=73&&o++;var a=String.fromCharCode(o);return aL(t+a,this.x-1e5*n,this.y-1e5*r,e||1)},lL.prototype.to_hectad=function(){var e=this.x/1e5|0,t=this.y/1e5|0,n=65+5*(4-t%5)+e%5;return n>=73&&n++,(t<5?e<5?"S":"T":t<10?e<5?"N":"O":e<5?"H":"J")+String.fromCharCode(n)+((this.x-1e5*e)/1e4|0)+((this.y-1e5*t)/1e4|0)},lL.prototype.is_gb_hectad=function(){return-1!==lL.gbHectads.indexOf(this.to_hectad())},lL.prototype.to_latLng=function(){var e,t=4e5,n=.85521133347722,r=6377563.396,o=this.x,a=this.y,i=.0016732203289875,s=(a+1e5)/(.9996012717*r)+n;do{s+=(e=a+1e5-6353722.489*(1.0016767257674*(s-n)-.00502807228247412*Math.sin(s-n)*Math.cos(s+n)+5258157614724887e-21*Math.sin(2*(s-n))*Math.cos(2*(s+n))-35/24*i*i*i*Math.sin(3*(s-n))*Math.cos(3*(s+n))))/6375020.48098897}while(e>=.001);var c=Math.sin(s)*Math.sin(s),l=Math.tan(s)*Math.tan(s),u=1/Math.cos(s),d=.9996012717*r*Math.pow(1-.00667054007*c,-.5),f=6332495.651423464*Math.pow(1-.00667054007*c,-1.5),h=d/f-1,p=Math.tan(s)/(2*f*d),v=Math.tan(s)/(24*f*Math.pow(d,3))*(5+3*l+h-9*l*h),y=Math.tan(s)/(720*f*Math.pow(d,5))*(61+90*l+45*l*l),m=u/d,g=u/(6*d*d*d)*(d/f+2*l),S=u/(120*Math.pow(d,5))*(5+28*l+24*l*l),b=u/(5040*Math.pow(d,7))*(61+662*l+1320*l*l+720*l*l*l),N=s-p*Math.pow(o-t,2)+v*Math.pow(o-t,4)-y*Math.pow(o-t,6),T=m*(o-t)-.034906585039887-g*Math.pow(o-t,3)+S*Math.pow(o-t,5)-b*Math.pow(o-t,7);return new eL(Zk*N,Zk*T).to_WGS84()};var uL=function(){var e=function(){};return(e.prototype=new Qk).constructor=e,e.prototype.country="GB",e.prototype.GridCoords=lL,e.prototype.parse_well_formed=function(e){e.length>=5&&/^[A-Z]/.test(e.charAt(4))&&(Qk.quadrantOffsets.hasOwnProperty(e.substr(e.length-2))?this.quadrantCode=e.substr(e.length-2):this.tetradLetter=e.charAt(4),e=e.substr(0,4)),this.parse_wellformed_gb_gr_string_no_tetrads(e),this.tetradLetter||this.quadrantCode?this.tetradLetter?(this.preciseGridRef=this.tetrad=this.hectad+this.tetradLetter,this.length=2e3,this.gridCoords.x+=Qk.tetradOffsets[this.tetradLetter][0],this.gridCoords.y+=Qk.tetradOffsets[this.tetradLetter][1]):(this.preciseGridRef=this.quadrant=e+this.quadrantCode,this.length=5e3,this.gridCoords.x+=Qk.quadrantOffsets[this.quadrantCode][0],this.gridCoords.y+=Qk.quadrantOffsets[this.quadrantCode][1]):(this.preciseGridRef=e,this.length<=1e3&&this.set_tetrad())},e.prototype.from_string=function(e){var t,n=e.replace(/[\[\]\s\t\.-]+/g,"").toUpperCase(),r="";if(/[ABCDEFGHIJKLMNPQRSTUVWXYZ]$/.test(n)&&(Qk.quadrantOffsets.hasOwnProperty(n.substr(n.length-2))?(this.quadrantCode=n.substr(n.length-2),n=n.substr(0,n.length-2)):(r=n.substr(n.length-1),n=n.substr(0,n.length-1))),n===parseInt(n,10).toString()?n=n.substr(0,2)+"/"+n.substr(2):n.length>3&&"/"===n.charAt(2)&&/^[A-Z]{2}$/.test(n.substr(0,2))&&(n=n.replace("/","")),"VC"===n.substr(0,2))this.error=!0,this.errorMessage="Misplaced vice-county code in grid-reference field. ('"+n+"')",this.gridCoords=null,this.length=0;else if(null!==(t=n.match(/^([A-Z]{2}(?:\d\d){1,5})$/)))n=t[0],this.parse_wellformed_gb_gr_string_no_tetrads(n),this.length>0?1e4===this.length&&(r||this.quadrantCode)?r?(this.preciseGridRef=n+r,this.tetradLetter=r,this.tetrad=this.hectad+r,this.length=2e3,this.gridCoords.x+=Qk.tetradOffsets[r][0],this.gridCoords.y+=Qk.tetradOffsets[r][1]):(this.preciseGridRef=n+this.quadrantCode,this.tetradLetter="",this.tetrad="",this.quadrant=this.preciseGridRef,this.length=5e3,this.gridCoords.x+=Qk.quadrantOffsets[this.quadrantCode][0],this.gridCoords.y+=Qk.quadrantOffsets[this.quadrantCode][1]):(this.preciseGridRef=n,this.length<=1e3&&this.set_tetrad()):(this.error=!0,this.errorMessage="GB grid reference format not understood (strange length).");else if(/^([\d]{2})\/((?:\d\d){1,5})$/.test(n)){switch(this.parse_gr_string_without_tetrads(n),this.length){case 1e4:n=this.gridCoords.to_gridref(1e4),this.hectad=n,r?(n+=r,this.tetradLetter=r,this.tetrad=this.hectad+r,this.length=2e3,this.gridCoords.x+=Qk.tetradOffsets[r][0],this.gridCoords.y+=Qk.tetradOffsets[r][1]):this.quadrantCode&&(n+=this.quadrantCode,this.quadrant=n,this.length=5e3,this.gridCoords.x+=Qk.quadrantOffsets[this.quadrantCode][0],this.gridCoords.y+=Qk.quadrantOffsets[this.quadrantCode][1]);break;case 1e3:case 100:case 10:case 1:n=this.gridCoords.to_gridref(this.length),this.hectad=this.gridCoords.to_gridref(1e4),this.set_tetrad();break;default:this.error=!0,this.errorMessage="Bad grid square dimension ("+this.length+" m).",this.gridCoords=null,this.length=0}this.preciseGridRef=n}else this.gridCoords=null,this.length=0,this.error=!0,this.errorMessage="Grid reference format not understood. ('"+e+"')"},e.prototype.parse_gr_string_without_tetrads=function(e){var t,n,r,o;if(null!==(t=e.match(/^(\d{2})\/((?:\d\d){1,5})$/))){switch(t[1]){case"57":n=3e5,r=1e6;break;case"67":n=4e5,r=1e6;break;case"58":n=3e5,r=11e5;break;case"68":n=4e5,r=11e5;break;case"69":n=4e5,r=12e5;break;default:n=1e5*e.charAt(0),r=1e5*e.charAt(1)}o=t[2]}else{if(!Qk.letterMapping.hasOwnProperty(e.charAt(0))||!Qk.letterMapping.hasOwnProperty(e.charAt(1)))return this.length=0,void(this.gridCoords=null);var a=Qk.letterMapping[e.charAt(0)],i=Qk.letterMapping[e.charAt(1)];o=e.substr(2),n=a%5*5e5+i%5*1e5-1e6,r=5e5*-Math.floor(a/5)-1e5*Math.floor(i/5)+19e5}switch(o.length){case 2:this.gridCoords=new lL(n+1e4*o.charAt(0),r+1e4*o.charAt(1)),this.length=1e4;break;case 4:this.gridCoords=new lL(n+1e3*Math.floor(o/100),r+o%100*1e3),this.length=1e3;break;case 6:this.gridCoords=new lL(n+100*Math.floor(o/1e3),r+o%1e3*100),this.length=100;break;case 8:this.gridCoords=new lL(n+10*Math.floor(o/1e4),r+o%1e4*10),this.length=10;break;case 10:this.gridCoords=new lL(n+Math.floor(o/1e5),r+o%1e5),this.length=1;break;default:Logger("Bad grid ref length, ref="+e),this.gridCoords=null,this.length=0}},e.prototype.parse_wellformed_gb_gr_string_no_tetrads=function(e){var t,n,r,o,a;switch(t=Qk.letterMapping[e.charAt(0)],n=Qk.letterMapping[e.charAt(1)],r=e.substr(2),o=t%5*5e5+n%5*1e5-1e6,a=5e5*-Math.floor(t/5)-1e5*Math.floor(n/5)+19e5,r.length){case 2:this.gridCoords=new lL(o+1e4*r.charAt(0),a+1e4*r.charAt(1)),this.length=1e4,this.hectad=e;break;case 4:this.gridCoords=new lL(o+1e3*Math.floor(r/100),a+r%100*1e3),this.length=1e3,this.hectad=e.substr(0,3)+e.substr(4,1);break;case 6:this.gridCoords=new lL(o+100*Math.floor(r/1e3),a+r%1e3*100),this.length=100,this.hectad=e.substr(0,3)+e.substr(5,1);break;case 8:this.gridCoords=new lL(o+10*Math.floor(r/1e4),a+r%1e4*10),this.length=10,this.hectad=e.substr(0,3)+e.substr(6,1);break;case 10:this.gridCoords=new lL(o+Math.floor(r/1e5),a+r%1e5),this.length=1,this.hectad=e.substr(0,3)+e.substr(7,1);break;default:throw this.gridCoords=null,new Error("Bad grid ref length when parsing supposedly well-formed ref, ref='"+e+"'")}},e}(),dL=function(){var e=function(e,t){this.x=e,this.y=t};return(e.prototype=new oL).constructor=e,e.prototype.country="IE",e.irishGrid={0:["V","Q","L","F","A"],1:["W","R","M","G","B"],2:["X","S","N","H","C"],3:["Y","T","O","J","D"]},e.prototype.to_latLng=function(){var e=6377340.189,t=.0066705402933363,n=.0016732203841521,r=this.x-2e5,o=(5929615.3530033+(this.y-25e4)/1.000035)/6366691.7742864415,a=o+.002509826623715886*Math.sin(2*o)+36745487490091978e-22*Math.sin(4*o)+151*n*n*n/96*Math.sin(6*o),i=e/Math.sqrt(1-t*Math.sin(a)*Math.sin(a)),s=Math.tan(a)*Math.tan(a),c=.0067153352074207*Math.cos(a)*Math.cos(a),l=e*(1-t)/Math.pow(1-t*Math.sin(a)*Math.sin(a),1.5),u=r/(1.000035*i),d=a-i*Math.tan(a)/l*(u*u/2-(5+3*s+10*c-4*c*c-.0604380168667863)*u*u*u*u/24+(61+90*s+298*c+45*s*s-1.6922644722700164-3*c*c)*u*u*u*u*u*u/720);d*=Zk;var f=(u-(1+2*s+c)*u*u*u/6+(5-2*c+28*s-3*c*c+.0537226816593656+24*s*s)*u*u*u*u*u/120)/Math.cos(a);return new rL(d,f=f*Zk-8).to_WGS84()},e.prototype.to_gridref=function(t){var n=Math.floor(this.x/1e5),r=Math.floor(this.y/1e5);return e.irishGrid[n]&&e.irishGrid[n][r]?aL(e.irishGrid[n][r],this.x-1e5*n,this.y-1e5*r,t||1):null},e.prototype.to_hectad=function(){var t=Math.floor(this.x/1e5),n=Math.floor(this.y/1e5);return e.irishGrid[t]&&e.irishGrid[t][n]?e.irishGrid[t][n]+Math.floor(this.x%1e5/1e4)+Math.floor(this.y%1e5/1e4):""},e}(),fL=function(){var e=function(){};return(e.prototype=new Qk).constructor=e,e.prototype.country="IE",e.prototype.GridCoords=dL,e.gridLetter={A:[0,4],B:[1,4],C:[2,4],D:[3,4],F:[0,3],G:[1,3],H:[2,3],J:[3,3],L:[0,2],M:[1,2],N:[2,2],O:[3,2],Q:[0,1],R:[1,1],S:[2,1],T:[3,1],V:[0,0],W:[1,0],X:[2,0],Y:[3,0]},e.prototype.from_string=function(t){var n=t.replace(/[\[\]\s\t\.-]+/g,"").toUpperCase();/[ABCDEFGHIJKLMNPQRSTUVWXYZ]$/.test(n)&&(e.quadrantOffsets.hasOwnProperty(n.substr(n.length-2))?(this.quadrantCode=n.substr(n.length-2),n=n.substr(0,n.length-2)):(this.tetradLetter=n.substr(n.length-1),n=n.substr(0,n.length-1))),this.parse_gr_string_without_tetrads(n),this.length>0?this.tetradLetter||this.quadrantCode?this.tetradLetter?(this.preciseGridRef=this.hectad+this.tetradLetter,this.tetrad=this.preciseGridRef,this.length=2e3,this.gridCoords.x+=e.tetradOffsets[this.tetradLetter][0],this.gridCoords.y+=e.tetradOffsets[this.tetradLetter][1]):(this.preciseGridRef=this.hectad+this.quadrantCode,this.quadrant=this.preciseGridRef,this.length=5e3,this.gridCoords.x+=e.quadrantOffsets[this.quadrantCode][0],this.gridCoords.y+=e.quadrantOffsets[this.quadrantCode][1]):(this.preciseGridRef=n,this.length<=1e3&&this.set_tetrad()):(this.error=!0,this.errorMessage="Irish grid reference format not understood. ('"+t+"')")},e.prototype.parse_well_formed=e.prototype.from_string,e._IE_GRID_LETTERS="VQLFAWRMGBXSNHCYTOJD",e.prototype.parse_gr_string_without_tetrads=function(t){var n,r,o,a;if(/^\d{2}\/(?:\d\d){1,5}$/.test(t)){if(n=parseInt(t.charAt(0),10),r=parseInt(t.charAt(1),10),n>3||r>4)return Logger("bad grid square, ref='"+t+"' (Ireland)"),this.length=0,!1;o=t.substr(3),a=e._IE_GRID_LETTERS.charAt(5*n+r),n*=1e5,r*=1e5}else{if(t=t.replace("/",""),!/^[ABCDFGHJLMNOQRSTVWXY](?:\d\d){1,5}$/.test(t))return this.length=0,this.gridCoords=null,!1;if(!t)return Logger("Bad (empty) Irish grid ref"),this.length=0,this.gridCoords=null,!1;a=t.charAt(0);var i=e._IE_GRID_LETTERS.indexOf(a);if(-1===i)return Logger("Bad grid ref grid-letter, ref='"+t+"' (Ireland)"),this.length=0,this.gridCoords=null,!1;n=1e5*Math.floor(i/5),r=i%5*1e5,o=t.substr(1)}switch(o.length){case 2:this.gridCoords=new dL(n+1e4*o.charAt(0),r+1e4*o.charAt(1)),this.length=1e4,this.hectad=a+o;break;case 4:this.gridCoords=new dL(n+1e3*Math.floor(o/100),r+o%100*1e3),this.length=1e3,this.hectad=a+o.charAt(0)+o.charAt(2);break;case 6:this.gridCoords=new dL(n+100*Math.floor(o/1e3),r+o%1e3*100),this.length=100,this.hectad=a+o.charAt(0)+o.charAt(3);break;case 8:this.gridCoords=new dL(n+10*Math.floor(o/1e4),r+o%1e4*10),this.length=10,this.hectad=a+o.charAt(0)+o.charAt(4);break;case 10:this.gridCoords=new dL(n+Math.floor(o/1e5),r+o%1e5),this.length=1,this.hectad=a+o.charAt(0)+o.charAt(5);break;default:return Logger("Bad grid ref length, ref='"+t+"' (Ireland)"),this.length=0,this.gridCoords=null,!1}return!0},e}();Qk.from_string=function(e){var t,n=e.replace(/\s+/g,"").toUpperCase();if(!n)return!1;if(/^[A-Z]{1,2}\d{2}(?:[A-Z]|[NS][EW]|(?:\d{2}){0,4})?$/.test(n))return(t=/^.\d/.test(n)?new Qk.GridRefIE:"W"===n.charAt(0)?new cL:new uL).parse_well_formed(n),!(!t.length||t.error)&&t;if((t=new uL).from_string(n),t.length&&!t.error)return t;if("W"===n.charAt(0)){if((t=new cL).from_string(n),t.length&&!t.error)return t}else if((t=new fL).from_string(n),t.length&&!t.error)return t;return!1};var hL=lL;eL.prototype.to_os_coords=function(){var e=this.lat*$k,t=this.lng*$k,n=.0066705397616,r=Math.sin(e)*Math.sin(e),o=6375020.480988971/Math.sqrt(1-n*r),a=o*(1-n)/(1-n*r),i=o/a-1,s=t- -.03490658503988659,c=o*Math.cos(e),l=Math.pow(Math.cos(e),3),u=Math.tan(e)*Math.tan(e),d=o/6*l*(o/a-u),f=Math.pow(Math.cos(e),5),h=Math.pow(Math.tan(e),4),p=o/120*f*(5-18*u+h+14*i-58*u*i),v=4e5+s*c+Math.pow(s,3)*d+Math.pow(s,5)*p,y=tL._Marc(6353722.490487913,.0016732202503250907,.8552113334772214,e)+-1e5,m=o/2*Math.sin(e)*Math.cos(e),g=o/24*Math.sin(e)*Math.pow(Math.cos(e),3)*(5-Math.pow(Math.tan(e),2)+9*i),S=o/720*Math.sin(e)*f*(61-58*u+h),b=y+s*s*m+Math.pow(s,4)*g+Math.pow(s,6)*S;return new hL(Math.round(v),Math.round(b))};var pL=dL;rL.prototype.to_os_coords=function(){var e=this.lat*$k,t=this.lng*$k,n=.00667054015,r=Math.sin(e)*Math.sin(e),o=6377563.395906615/Math.sqrt(1-n*r),a=o*(1-n)/(1-n*r),i=o/a-1,s=t- -.13962634015954636,c=o*Math.cos(e),l=Math.pow(Math.cos(e),3),u=Math.tan(e)*Math.tan(e),d=o/6*l*(o/a-u),f=Math.pow(Math.cos(e),5),h=Math.pow(Math.tan(e),4),p=o/120*f*(5-18*u+h+14*i-58*u*i),v=2e5+s*c+Math.pow(s,3)*d+Math.pow(s,5)*p,y=tL._Marc(6356256.908205645,.0016732203841520518,.9337511498169663,e)+25e4,m=o/2*Math.sin(e)*Math.cos(e),g=o/24*Math.sin(e)*Math.pow(Math.cos(e),3)*(5-Math.pow(Math.tan(e),2)+9*i),S=o/720*Math.sin(e)*f*(61-58*u+h),b=y+s*s*m+Math.pow(s,4)*g+Math.pow(s,6)*S;return new pL(Math.round(v),Math.round(b))};var vL=iL;function yL(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}nL.prototype.to_os_coords=function(){var e=this.lat*$k,t=this.lng*$k,n=.0067226700223333,r=Math.sin(e)*Math.sin(e),o=6375836.6448/Math.sqrt(1-n*r),a=o*(1-n)/(1-n*r),i=o/a-1,s=t- -.0523598775598,c=o*Math.cos(e),l=Math.pow(Math.cos(e),3),u=Math.tan(e)*Math.tan(e),d=o/6*l*(o/a-u),f=Math.pow(Math.cos(e),5),h=Math.pow(Math.tan(e),4),p=o/120*f*(5-18*u+h+14*i-58*u*i),v=5e5+s*c+Math.pow(s,3)*d+Math.pow(s,5)*p,y=tL._Marc(6354369.181221601,.0016863406508729017,0,e)+0,m=o/2*Math.sin(e)*Math.cos(e),g=o/24*Math.sin(e)*Math.pow(Math.cos(e),3)*(5-Math.pow(Math.tan(e),2)+9*i),S=o/720*Math.sin(e)*f*(61-58*u+h),b=y+s*s*m+Math.pow(s,4)*g+Math.pow(s,6)*S;return new vL(Math.round(v),Math.round(b))};var mL=new WeakMap,gL=new WeakMap;!function(e){by(n,iI);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(e){var r;return ud(this,n),yL(gy(r=t.call(this,e)),mL,{writable:!0,value:void 0}),yL(gy(r),gL,{writable:!0,value:void 0}),hd(gy(r),"_value",""),hd(gy(r),"_inputType","text"),hd(gy(r),"_autocomplete",""),e&&(e.type&&(r._inputType=e.type),e.placeholder&&(r.placeholder=e.placeholder),e.autocomplete&&(r._autocomplete=e.autocomplete)),r}fd(n,[{key:"value",get:function(){return this._value},set:function(e){this._value=void 0===e||null==e?"":e.trim(),this.updateView()}},{key:"updateView",value:function(){this._fieldEl&&(document.getElementById(Oy(this,mL)).value=iI.cleanRawString(this._value))}},{key:"buildField",value:function(){var e=document.createElement("div");e.className="form-group",_y(this,gL,e.id=iI.nextId),_y(this,mL,iI.nextId);var t=e.appendChild(document.createElement("label"));t.htmlFor=Oy(this,mL),t.textContent=this.label;var n=e.appendChild(document.createElement("div"));n.className="input-group";var r=n.appendChild(document.createElement("input"));r.className="form-control",r.id=Oy(this,mL),r.type="text",this.placeholder&&(r.placeholder=this.placeholder),this._autocomplete&&(r.autocomplete=this._autocomplete,"off"===this._autocomplete&&(r.name=UO()));var o=n.appendChild(document.createElement("span"));if(o.className="input-group-btn",navigator.geolocation){var a=o.appendChild(document.createElement("button"));a.id=iI.nextId,a.type="button",a.className="btn btn-outline-secondary btn-sm",a.title="use GPS";var i=a.appendChild(document.createElement("span"));i.className="material-icons",i.innerText="gps_not_fixed",a.addEventListener("click",this.gpsButtonClickHandler.bind(this))}if(this.completion===iI.COMPLETION_COMPULSORY&&(r.required=!0),this.validationMessage){var s=e.appendChild(document.createElement("div"));s.className="invalid-feedback",s.innerHTML=this.validationMessage}this.helpText&&(e.appendChild(document.createElement("small")).innerHTML=this.helpText),r.addEventListener("change",this.inputChangeHandler.bind(this)),this._fieldEl=e}},{key:"markValidity",value:function(e){var t=document.getElementById(Oy(this,mL));null===e?t.classList.remove("is-invalid","is-valid"):(t.classList.remove(e?"is-invalid":"is-valid"),t.classList.add(e?"is-valid":"is-invalid"))}},{key:"inputChangeHandler",value:function(e){e.stopPropagation(),console.log("got input field change event"),this.value=iI.cleanRawString(document.getElementById(Oy(this,mL)).value),this.fireEvent(iI.EVENT_CHANGE)}},{key:"gpsButtonClickHandler",value:function(e){var t=this;console.log("got gps button click event"),navigator.geolocation.getCurrentPosition((function(e){var n=e.coords.latitude,r=e.coords.longitude;console.log("Got GPS fix ".concat(n," , ").concat(r));var o=oL.from_latlng(n,r).to_gridref(1e3);console.log("Got grid-ref: ".concat(o)),t.value=o,t.fireEvent(iI.EVENT_CHANGE)}),(function(e){console.log("gps look-up failed"),console.log(e)}))}}],[{key:"summariseImpl",value:function(e,t,n){return""!==n[e]&&null!==n[e]&&void 0!==n[e]?JO(n[e].trim()):""}}])}();var SL=function(e){by(n,pI);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(e){var r;if(ud(this,n),hd(gy(r=t.call(this)),"_occurrence",void 0),hd(gy(r),"surveyId",""),(this instanceof n?this.constructor:void 0)===n)throw new TypeError("Cannot construct OccurrenceForm instances directly, class should be overridden.");return e&&(r.model=e),r}return fd(n,[{key:"formElement",get:function(){var e=arguments,t=Mb(Ey(n.prototype),"formElement",this);return this._formFieldsBuilt||(this.buildFormFields(),t.addEventListener("change",(function(){console.log("occurrence form change event"),console.log(e)}),{capture:!1})),t}},{key:"buildContentContainer",value:function(e){var t=e.appendChild(document.createElement("div"));t.className="card mt-3 ml-0 mr-0 mb-3";var r=t.appendChild(document.createElement("div"));return r.className="card-header",r.textContent=n.sectionTitle,this._formContentContainer=t.appendChild(document.createElement("div")),this._formContentContainer.className="card-body",this._formContentContainer}},{key:"occurrenceId",get:function(){return this._occurrence?this._occurrence.id:null}},{key:"projectId",get:function(){return this._occurrence?this._occurrence.projectId:null}},{key:"initialiseFormFields",value:function(){var e=n.properties;for(var t in this.fields={},e)e.hasOwnProperty(t)&&(this.fields[t]=new e[t].field(e[t].attributes))}},{key:"updateModelFromContent",value:function(){for(var e in console.log("updating occurrence from OccurrenceForm content"),this.fields)if(this.fields.hasOwnProperty(e)){var t=this.fields[e];this._occurrence.attributes[e]=t.value}console.log({occurrence:this._occurrence})}},{key:"model",get:function(){return this._occurrence},set:function(e){this._occurrence=e,this.populateFormContent()}},{key:"changeHandler",value:function(e){console.log("occurrence form change event"),console.log({event:e}),this.fireEvent(pI.CHANGE_EVENT,{form:this})}},{key:"pingOccurrence",value:function(){this._occurrence.unsaved()&&this.fireEvent(pI.CHANGE_EVENT,{form:this})}},{key:"destructor",value:function(){this._occurrence=null,Mb(Ey(n.prototype),"destructor",this).call(this)}},{key:"getFormSectionProperties",value:function(){return n.properties}}]),n}();hd(SL,"properties",void 0),hd(SL,"sectionTitle","Occurrence form"),hd(SL,"help","Records help text, should normally be initialised with an imported html template");var bL=function e(){ud(this,e)};function NL(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return TL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?TL(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function TL(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function EL(e,t){_L(e,t),t.add(e)}function wL(e,t,n){_L(e,t),t.set(e,n)}function _L(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OL(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}hd(bL,"sectionTitle",void 0),hd(bL,"sectionSortOrder",void 0),hd(bL,"sectionNavigationKey",void 0),hd(bL,"help",""),hd(bL,"properties",void 0);var IL=new WeakMap,RL=new WeakMap,xL=new WeakMap,CL=new WeakSet,AL=new WeakSet,kL=new WeakSet,LL=new WeakSet,ML=new WeakSet,PL=new WeakSet,HL=new WeakSet,DL=new WeakSet,FL=new WeakSet,jL=new WeakSet,UL=new WeakSet,BL=new WeakSet,YL=function(e){by(n,fx);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ty(this,n)}}(n);function n(){var e;ud(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return EL(gy(e=t.call.apply(t,[this].concat(o))),BL),EL(gy(e),UL),EL(gy(e),jL),EL(gy(e),FL),EL(gy(e),DL),EL(gy(e),HL),EL(gy(e),PL),EL(gy(e),ML),EL(gy(e),LL),EL(gy(e),kL),EL(gy(e),AL),EL(gy(e),CL),hd(gy(e),"controller",void 0),wL(gy(e),IL,{writable:!0,value:{}}),wL(gy(e),RL,{writable:!0,value:void 0}),wL(gy(e),xL,{writable:!0,value:{}}),hd(gy(e),"panelKey",""),hd(gy(e),"OCCURRENCES_ARE_LAST_SECTION",!0),hd(gy(e),"occurrenceSummaryText","Placeholder occurrence summary text in MainView.js"),hd(gy(e),"welcomeContent","Placeholder welcome text in MainView.js"),hd(gy(e),"defaultRightHandSideHelp","Default right-hand side help text in MainView.js"),e}return fd(n,[{key:"initialise",value:function(){this.controller.app.addListener(Tx.EVENT_OCCURRENCE_ADDED,this.occurrenceAddedHandler.bind(this))}},{key:"setLayout",value:function(){var e=this;document.getElementById("body").innerHTML='\r\n<div class="container-fluid">\r\n    <div class="row" style="height: 90vh;">\r\n        <div class="col d-md-block pr-md-0 pt-3" id="col1panel" style="overflow-y: auto; max-height: calc(100vh - 5rem);">\r\n        </div>\r\n        <div class="col d-md-none pl-0 pr-0" id="ctrlpanel" style="background-color: aliceblue; width: 28px; max-width: 28px; overflow-y: hidden; ">\r\n            <button class="navbar-light navbar-toggler pl-0 pr-0" type="button" aria-label="Back" id="right-panel-back">\r\n                <i class="material-icons-round" style="color: gray;">view_list</i>\r\n            </button>\r\n        </div>\r\n        <div class="col d-md-block pr-md-0" id="col2panel" style="overflow-y: auto; height: 100%;">\r\n        </div>\r\n    </div>\r\n</div>\r\n',document.getElementById("right-panel-back").addEventListener("click",(function(t){t.stopPropagation(),t.preventDefault(),e.fireEvent(bI.EVENT_BACK)}))}},{key:"refreshLeftPanelAccordionState",value:function(){var e,t=document.querySelectorAll("div#".concat(this.leftPanelAccordionId,' div[data-parent="#').concat(this.leftPanelAccordionId,'"].collapse'));e=this.controller.viewSubcontext?"record"===this.controller.viewSubcontext?"record":this.controller.surveySection:"";var n,r=NL(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.getAttribute("data-sectionkey")===e?o.classList.add("show"):o.classList.remove("show")}}catch(e){r.e(e)}finally{r.f()}this._refreshOccurrenceAccordionState()}},{key:"_refreshOccurrenceAccordionState",value:function(){var e,t=document.querySelectorAll("div#".concat("occurrencelistcontainer",' div[data-parent="#').concat("occurrencelistcontainer",'"].collapse')),n=this.controller.currentOccurrenceId,r=NL(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;o.getAttribute("data-occurrenceid")===n?o.classList.add("show"):o.classList.remove("show")}}catch(e){r.e(e)}finally{r.f()}}},{key:"display",value:function(){if(this.controller.needsFullRefresh?(console.log("Full refresh triggered."),this.setLayout(),OL(this,ML,KL).call(this)):this.refreshLeftPanelAccordionState(),this.controller.needRightPanelRefresh)switch(this.controller.viewSubcontext){case"record":OL(this,AL,JL).call(this);break;case"survey":OL(this,CL,VL).call(this);break;default:OL(this,kL,GL).call(this)}this.setResponsivePanel(""===this.panelKey?"left":"right")}},{key:"refreshOccurrenceFooterControls",value:function(e){var t=this,n=e.appendChild(document.createElement("div")),r=n.appendChild(document.createElement("button"));if(r.className="btn btn-secondary btn-md-lg mt-2 mb-3 mr-2",r.type="button",r.textContent="back to list",r.setAttribute("data-buttonaction","back"),this.occurrenceIsMostRecent(this.controller.currentOccurrence)){var o=n.appendChild(document.createElement("button"));o.className="btn btn-primary btn-md-lg mt-2 mb-3 mr-2",o.type="button",o.textContent="add another",o.setAttribute("data-buttonaction","new")}if(this.OCCURRENCES_ARE_LAST_SECTION){var a=n.appendChild(document.createElement("button"));a.className="btn btn-primary btn-md-lg mt-2 mb-3",a.type="button",a.textContent="finish",a.setAttribute("data-buttonaction","finish")}else{var i=px.sections[1],s=n.appendChild(document.createElement("button"));s.className="btn btn-primary btn-md-lg mt-2 mb-3",s.type="button",s.textContent="next Â»",s.setAttribute("data-buttonaction","next"),s.title=i.sectionTitle}n.addEventListener("click",(function(e){var n=e.target.closest("button");if(n&&n.hasAttribute("data-buttonaction"))switch(n.getAttribute("data-buttonaction")){case"new":t.fireEvent(bI.EVENT_NEW_RECORD);break;case"back":t.controller.app.router.navigate("/list/record/");break;case"finish":t.controller.app.router.navigate("/list/record/"),$("#".concat("finishmodal")).modal();break;case"next":t.controller.app.router.navigate("/list/survey/".concat(nextSection.sectionNavigationKey));break;default:throw new Error("Unrecognised button action ".concat(n.getAttribute("data-buttonaction")))}}))}},{key:"occurrenceIsMostRecent",value:function(e){var t,n=NL(this.controller.occurrences.entries());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r[1].createdStamp>e.createdStamp&&!r[1].deleted)return!1}}catch(e){n.e(e)}finally{n.f()}return!0}},{key:"newButtonClickHandler",value:function(e){e.preventDefault(),e.stopPropagation(),this.fireEvent(bI.EVENT_NEW_RECORD)}},{key:"occurrenceAddedHandler",value:function(e){var t=document.getElementById("occurrencelistcontainer");if(t){var n=this.controller.occurrences.get(e.occurrenceId),r=document.createElement("div");r.className="card",r.id="card_".concat(n.id),r.innerHTML=OL(this,BL,eM).call(this,n),Oy(this,xL)[n.id]=n.addListener(mI.EVENT_MODIFIED,this.occurrenceChangeHandler.bind(this),{occurrenceId:n.id}),t.insertBefore(r,t.firstChild)}}},{key:"refreshOccurrenceValiditySummary",value:function(e){var t=document.getElementById("card_".concat(e.id));t&&(e.evaluateCompletionStatus(SL.properties).requiredFieldsPresent?t.classList.remove("is-invalid"):t.classList.add("is-invalid"))}},{key:"occurrenceChangeHandler",value:function(e){var t=this.controller.occurrences.get(e.occurrenceId),n=document.getElementById("card_".concat(e.occurrenceId));n&&(t.deleted?(n.parentElement.removeChild(n),Oy(this,xL)[e.occurrenceId]&&(t.removeListener(mI.EVENT_MODIFIED,Oy(this,xL)[e.occurrenceId]),Oy(this,xL)[e.occurrenceId]=null)):(n.innerHTML=OL(this,BL,eM).call(this,t),this.refreshOccurrenceValiditySummary(t)))}},{key:"occurrenceSummaryBodyHTML",value:function(e){var t="";for(var n in e.attributes)if(e.attributes.hasOwnProperty(n)&&SL.properties.hasOwnProperty(n)&&!SL.properties[n].field.isEmpty(e.attributes[n])){var r=SL.properties[n].field.summarise(n,SL.properties[n],e.attributes);r&&(t+='<p class="ellipsed-line mb-0">'.concat(r,"</p>"))}return Tx.devMode&&(t+='<p class="mb-0">(<i>id '.concat(e.id,"</i>)</p>")),t}},{key:"occurrenceSummaryHeadingHTML",value:function(e){var t="";if(e.attributes.hasOwnProperty("images")&&e.attributes.images.length){var n=e.attributes.images[0];t+=yx.imageLink(n,48,48,{className:"mr-1"})}return e.attributes.taxon&&e.attributes.taxon.taxonId?t+=e.taxon.formattedHTML(e.attributes.taxon.vernacularMatch):e.attributes.taxon&&e.attributes.taxon.taxonName?t+=JO(e.attributes.taxon.taxonName):t+="<span>(unnamed plant)</span>",t}},{key:"setResponsivePanel",value:function(e){var t=document.getElementById("col2panel"),n=document.getElementById("col1panel"),r=document.getElementById("ctrlpanel");switch(e){case"left":n.classList.remove("d-none"),n.classList.add("d-block"),t.classList.remove("d-block"),t.classList.add("d-none"),r.classList.remove("d-md-none"),r.classList.add("d-none");break;case"right":n.classList.remove("d-block"),n.classList.add("d-none"),t.classList.remove("d-none"),t.classList.add("d-block"),r.classList.remove("d-none"),r.classList.add("d-md-none");break;default:throw new Error("Unrecognised panel value '".concat(e))}}}]),n}();function VL(){var e=document.getElementById("col2panel"),t=this.controller.surveySection,n=px.sectionsByKey[t]?px.sectionsByKey[t].help:"";e.innerHTML=n||("welcome"===t?this.defaultRightHandSideHelp:"<p>placeholder survey help content for '".concat(t,"'</p>"))}function JL(){try{var e=this.controller.currentOccurrence,t=document.getElementById("col2panel");if(e){Oy(this,RL)&&Oy(this,RL).occurrenceId===e.id||(Oy(this,RL)&&Oy(this,RL).destructor(),_y(this,RL,e.setForm(new SL(e))),Oy(this,RL).surveyId=this.controller.app.currentSurvey.id,t.scrollTop=0),t.innerHTML="";var n=Oy(this,RL).formElement;t.appendChild(n),Oy(this,RL).populateFormContent(),this.refreshOccurrenceFooterControls(t),$("#description_".concat(e.id)).collapse("show")}else OL(this,kL,GL).call(this,SL.help)}catch(e){console.log({error:e});var r=document.getElementById("col2panel");r?r.innerHTML="<p>".concat(e.message,"</p>"):document.body.innerHTML="<h2>Internal error</h2><p>Please report this problem:</p><p>".concat(e.message,"</p>")}}function GL(e){document.getElementById("col2panel").innerHTML=e||this.defaultRightHandSideHelp}function qL(){for(var e in Oy(this,xL)){var t=this.controller.occurrences.get[e];t&&t.removeListener(mI.EVENT_MODIFIED,Oy(this,xL)[e])}_y(this,xL,{})}function KL(){var e=this,t=document.getElementById("col1panel").appendChild(document.createElement("div"));t.className="accordion",this.leftPanelAccordionId=t.id=pI.nextId,OL(this,DL,QL).call(this),OL(this,FL,zL).call(this,0,t,YL.NEXT_RECORDS),OL(this,jL,$L).call(this),OL(this,UL,ZL).call(this),t.addEventListener("click",(function(t){var n=t.target.closest("a");n&&n.hasAttribute("data-help-link")&&(t.preventDefault(),t.stopPropagation(),e.controller.app.router.navigate(n.getAttribute("data-help-link")))})),OL(this,HL,XL).call(this),OL(this,PL,WL).call(this)}function WL(){var e=this,t=document.body,n='<div class="modal fade" id="'.concat("deleteoccurrencemodal",'" tabindex="-1" role="dialog" aria-labelledby="').concat("deleteoccurrencemodal",'Title" aria-hidden="true">\n  <div class="modal-dialog modal-dialog-centered" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title" id="').concat("deleteoccurrencemodal",'Title">Delete record?</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body">\n        Please confirm that you wish to delete the record.\n      </div>\n      <div class="modal-footer">\n        <button type="button" class="btn btn-secondary" data-dismiss="modal">Back</button>\n        <button type="button" class="btn btn-danger" data-dismiss="modal" id="').concat("deleteoccurrencemodal",'confirmed">Delete record</button>\n      </div>\n    </div>\n  </div>\n</div>'),r=document.createElement("div");r.innerHTML=n,t.appendChild(r.firstChild),$("#".concat("deleteoccurrencemodal")).on("show.bs.modal",(function(e){var t=$(e.relatedTarget);if(t&&t.data("occurrenceid")){var n=t.data("occurrenceid");document.getElementById("".concat("deleteoccurrencemodal","confirmed")).setAttribute("data-occurrenceid",n)}})),document.getElementById("".concat("deleteoccurrencemodal","confirmed")).addEventListener("click",(function(t){var n=t.target.closest("button");if(n&&n.hasAttribute("data-occurrenceid")){var r=n.getAttribute("data-occurrenceid");console.log("Deleting occurrence ".concat(r,".")),e.fireEvent(bI.EVENT_DELETE_OCCURRENCE,{occurrenceId:r})}}));var o=document.createElement("div");o.innerHTML='<div class="modal fade" id="'.concat("finishmodal",'" tabindex="-1" role="dialog" aria-labelledby="').concat("finishmodal",'Title" aria-hidden="true">\n  <div class="modal-dialog modal-dialog-centered" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title" id="').concat("finishmodal",'Title">Thank you</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body">\n        <p>Thank you! Your form responses have been sent. If you wish, you can continue to make changes and edit or add further records.</p>\n        <p>If you provided an email address, then we will send you a message with a link to this form, so that you can return to it later if needed.</p>\n      </div>\n      <div class="modal-footer">\n        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\n      </div>\n    </div>\n  </div>\n</div>'),t.appendChild(o.firstChild),t.appendChild(GA.licenseModal());var a=document.createElement("div");a.innerHTML='<div class="modal fade" id="'.concat("imagemodal",'" tabindex="-1" role="dialog" aria-labelledby="').concat("imagemodal",'Title" aria-hidden="true">\n  <div class="modal-dialog modal-dialog-centered" role="document">\n    <div class="modal-content">\n      <div class="modal-header d-none d-md-flex">\n        <h5 class="modal-title" id="').concat("imagemodal",'Title">Photo</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body" style="position: relative;">\n        <picture>\n        </picture>\n      </div>\n      <div class="modal-footer">\n        <button type="button" id="').concat("imagemodaldelete",'" class="btn btn-outline-danger delete-occurrence-button mr-3" data-toggle="modal" data-target="#').concat("deleteimagemodal",'" data-imageid=""><i class="material-icons">delete</i></button>\n        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\n      </div>\n    </div>\n  </div>\n</div>'),t.appendChild(a.firstChild),document.getElementById("imagemodaldelete").addEventListener("click",(function(t){var n=t.target.closest("button");if(n&&n.hasAttribute("data-imageid")){var r=n.getAttribute("data-imageid");Oy(e,RL).fireEvent("deleteimage",{imageId:r}),$("#".concat("imagemodal")).modal("hide")}}))}function XL(){var e=this;$("#".concat("col1panel")).on("show.bs.collapse",(function(t){t.target.dataset.occurrenceid?(console.log({"left panel accordion show event (with occ id)":t}),e.fireEvent(bI.EVENT_SELECT_OCCURRENCE,{occurrenceId:t.target.dataset.occurrenceid})):t.target.dataset.sectionkey?(console.log({"left panel accordion show event (with section key)":t}),e.fireEvent(bI.EVENT_SELECT_SURVEY_SECTION,{sectionKey:t.target.dataset.sectionkey})):console.log({"left panel accordion show event (other)":t})})).on("hidden.bs.collapse",(function(t){if(console.log({"left panel accordion hide event":t}),t.target.dataset.occurrenceid){var n=e.controller.occurrences.get(t.target.dataset.occurrenceid);n.isNew&&!n.isPristine&&(n.isNew=!1,e.refreshOccurrenceValiditySummary(n)),e.controller.currentOccurrenceId===t.target.dataset.occurrenceid&&e.fireEvent(bI.EVENT_SELECT_OCCURRENCE,{occurrenceId:""})}else if(t.target.dataset.sectionkey)if("record"===t.target.dataset.sectionkey)"record"===e.controller.viewSubcontext&&e.fireEvent(bI.EVENT_SELECT_SURVEY_SECTION,{sectionKey:""});else if(Oy(e,IL)[t.target.dataset.sectionkey]){var r=Oy(e,IL)[t.target.dataset.sectionkey].validateForm();console.log({"survey section validity":r}),e.controller.surveySection===t.target.dataset.sectionkey&&e.fireEvent(bI.EVENT_SELECT_SURVEY_SECTION,{sectionKey:""})}}))}function QL(){var e=document.getElementById(this.leftPanelAccordionId),t=document.createElement("button");t.className="btn btn-primary",t.type="button",t.textContent="get started Â»",t.setAttribute("data-toggle","collapse"),t.setAttribute("data-target","#survey-0-about");var n=pI.nextId,r=document.createElement("div");r.innerHTML=this.welcomeContent,r.appendChild(t);var o=document.createElement("span");o.className="d-md-none pl-2",o.innerHTML='(<a href="/app/list/survey/welcome/help" data-navigo="list/survey/welcome/help">more info</a>)',r.appendChild(o),e.appendChild(this.card({cardId:n,cardHeadingId:pI.nextId,collapsed:"welcome"!==this.controller.surveySection,headingButtonId:pI.nextId,headingHTML:'<img src="/img/BSBIlong.png" alt="" style="float:right; max-width: 40%; max-height: 48px;"><div style="float: left;">Welcome</div>',buttonStyleString:"width: 100%",headingNonbuttonHTML:"",headingValidationWarningHTML:"",cardDescriptionId:"survey-welcome",parentContainerId:e.id,bodyContentElement:r,dataAttributes:{sectionkey:"welcome"}}))}function zL(e,t,n){var r=this,o=px.sections[e],a=new px(o);Oy(this,IL)[o.sectionNavigationKey]=a;var i=a.formElement,s=document.createElement("button");switch(s.className="btn btn-primary",s.type="button",s.textContent="next Â»",n){case YL.NEXT_RECORDS:s.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),r.fireEvent(bI.EVENT_NEXT_TO_RECORDS)}));break;case YL.NEXT_SURVEY_SECTION:var c=px.sections[e+1];s.setAttribute("data-toggle","collapse"),s.setAttribute("data-target","#survey-".concat(e+1,"-").concat(c.sectionNavigationKey)),s.title=c.sectionTitle;break;case YL.NEXT_IS_FINAL:s.textContent="finish",s.className="btn btn-primary btn-md-lg mt-2 mb-3",s.type="button",s.addEventListener("click",(function(){r.controller.app.router.navigate("/list/"),$("#".concat("finishmodal")).modal()}));break;default:throw new Error("Unrecognized next section keyword '".concat(n,"'"))}i.appendChild(s);var l=pI.nextId;t.appendChild(this.card({cardId:l,cardHeadingId:pI.nextId,collapsed:this.controller.surveySection!==o.sectionNavigationKey,headingButtonId:pI.nextId,headingHTML:o.sectionTitle,headingNonbuttonHTML:'<small class="btn d-md-none" style="margin: 0; padding: 0;">(<a href="/app/list/survey/'.concat(o.sectionNavigationKey,'/help" data-help-link="/list/survey/').concat(o.sectionNavigationKey,'/help">help</a>)</small>'),headingValidationWarningHTML:"Please check the form for some missing responses.",cardDescriptionId:"survey-".concat(e,"-").concat(o.sectionNavigationKey),parentContainerId:t.id,bodyContentElement:i,dataAttributes:{sectionkey:o.sectionNavigationKey}})),this.controller.survey.registerForm(a),a.addListener(px.EVENT_VALIDATION_STATE_CHANGE,(function(e){var t=document.getElementById(l);e.isValid?t.classList.remove("is-invalid"):t.classList.add("is-invalid")}))}function $L(){var e=document.getElementById(this.leftPanelAccordionId),t=document.createDocumentFragment();t.appendChild(document.createElement("p")).innerHTML="".concat(this.occurrenceSummaryText,'<small class="d-block d-md-none"><a href="/app/list/record/help">(help)</a></small>');var n=t.appendChild(document.createElement("button"));n.type="button",n.className="btn btn-primary btn-lg mb-2",n.innerText="Add a plant record.",n.addEventListener("click",this.newButtonClickHandler.bind(this)),t.appendChild(document.createElement("div")).id="occurrencelistcontainer",e.appendChild(this.card({cardId:pI.nextId,cardHeadingId:pI.nextId,collapsed:"record"!==this.controller.viewSubcontext,headingButtonId:pI.nextId,headingHTML:"Your plant records",cardDescriptionId:pI.nextId,parentContainerId:e.id,bodyContentElement:t,dataAttributes:{sectionkey:"record"}}))}function ZL(){var e=document.getElementById("occurrencelistcontainer");if(!e)throw new gI("Failed to find list container.");OL(this,LL,qL).call(this);var t,n=[],r=NL(function(e){return function(e){if(Array.isArray(e))return _R(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||OR(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(this.controller.occurrences.entries()).sort((function(e,t){return t[1].createdStamp-e[1].createdStamp})));try{for(r.s();!(t=r.n()).done;){var o=t.value[1];if(console.log("displaying '".concat(o.id,"'")),!o.deleted){var a=o.isNew||o.evaluateCompletionStatus(SL.properties).requiredFieldsPresent;n.push('<div class="card'.concat(a?"":" is-invalid",'" id="card_').concat(o.id,'">\n    ').concat(OL(this,BL,eM).call(this,o),"\n</div>")),Oy(this,xL)[o.id]=o.addListener(mI.EVENT_MODIFIED,this.occurrenceChangeHandler.bind(this),{occurrenceId:o.id})}}}catch(e){r.e(e)}finally{r.f()}e.className="accordion",e.innerHTML=n.join(""),e.addEventListener("click",(function(e){var t=e.target.closest("button");t&&t.hasAttribute("data-toggle")&&"modal"===t.getAttribute("data-toggle")&&(document.getElementById("".concat("deleteoccurrencemodal","confirmed")).setAttribute("data-occurrenceid",t.getAttribute("data-occurrenceid")),$(t.getAttribute("data-target")).modal(),e.preventDefault(),e.stopPropagation())}))}function eM(e){return'<div class="card-header pointer pl-2 pr-2 pt-2 pb-2" id="heading_'.concat(e.id,'" data-toggle="collapse" data-target="#description_').concat(e.id,'">\n    <div class="float-right">\n        <button type="button" class="btn btn-outline-danger delete-occurrence-button" data-toggle="modal" data-target="#').concat("deleteoccurrencemodal",'" data-occurrenceid="').concat(e.id,'"><i class="material-icons">delete</i></button>\n    </div>\n    <h2 class="mb-0 pb-0 mt-0 pt-0 pl-0 ml-0">\n        <button class="btn btn-link').concat(this.controller.currentOccurrenceId===e.id?"":" collapsed",' pt-0 pb-0 pl-0" id="headingbutton_').concat(e.id,'" type="button" data-toggle="collapse" data-target="#description_').concat(e.id,'" aria-expanded="').concat(this.controller.currentOccurrenceId===e.id?"true":"false",'" aria-controls="description_').concat(e.id,'">\n          ').concat(this.occurrenceSummaryHeadingHTML(e),'\n        </button>\n    </h2>\n    <div class="card-invalid-feedback">\n        <small>Please check for errors or missing details.</small>\n    </div>\n</div>\n<div id="description_').concat(e.id,'" class="collapse').concat(this.controller.currentOccurrenceId===e.id?" show":"",'" aria-labelledby="heading_').concat(e.id,'" data-parent="#').concat("occurrencelistcontainer",'" data-occurrenceid="').concat(e.id,'">\n  <div class="card-body">\n    ').concat(this.occurrenceSummaryBodyHTML(e),"\n  </div>\n</div>")}hd(YL,"NEXT_RECORDS","records"),hd(YL,"NEXT_SURVEY_SECTION","survey"),hd(YL,"NEXT_IS_FINAL","last");var tM=function(e){Zi(n,e);var t=os(n);function n(){var e;Xi(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return $i(ns(e=t.call.apply(t,[this].concat(o))),"projectId",2),e}return zi(n,[{key:"addSurvey",value:function(e){var t=this;if(e.projectId!==this.projectId)throw new Error("Survey project id '".concat(e.projectId," does not match with current project ('").concat(this.projectId,"')"));this.surveys.has(e.id)||(console.log("setting survey's modified/save handler"),e.addListener(vx.EVENT_MODIFIED,this,(function(e){return t.fireEvent(Tx.EVENT_SURVEYS_CHANGED),e.save()}))),this.surveys.set(e.id,e),this.fireEvent(Tx.EVENT_SURVEYS_CHANGED)}},{key:"haveExtantOccurrences",value:function(){var e,t=us(this.occurrences);try{for(t.s();!(e=t.n()).done;){if(!e.value.deleted)return!0}}catch(e){t.e(e)}finally{t.f()}return!1}},{key:"addOccurrence",value:function(e){var t=this;if(!e.surveyId)throw new gI("Survey id must set prior to registering occurrence.");0===this.occurrences.size&&(this.surveys.get(e.surveyId).createdStamp=e.createdStamp);this.occurrences.set(e.id,e),e.addListener(mI.EVENT_MODIFIED,this,(function(e){var n=t.surveys.get(e.surveyId);if(!n)throw new Error("Failed to look up survey id ".concat(e.surveyId));n.unsaved()&&n.save(),e.save(n.id)}))}},{key:"refreshFromServer",value:function(e){var t,r=this,o=new FormData,a=0,i=us(e);try{for(i.s();!(t=i.n()).done;){var s=t.value;o.append("surveyId[".concat(a++,"]"),s)}}catch(e){i.e(e)}finally{i.f()}return fetch(n.LOAD_SURVEYS_ENDPOINT,{method:"POST",body:o}).then((function(e){return e.ok?e.json():Promise.reject("Invalid response from server when refreshing survey ids")})).then((function(e){console.log({"refresh from server json response":e});var t=[];for(var n in e)if(e.hasOwnProperty(n)){var o,a=us(e[n]);try{for(a.s();!(o=a.n()).done;){var i=o.value;t.push(r._conditionallyReplaceObject(i))}}catch(e){a.e(e)}finally{a.f()}}return Promise.all(t)}))}},{key:"_conditionallyReplaceObject",value:function(e){var t=e.type,n=e.id,r="".concat(t,".").concat(n);return ld.getItem(r).then((function(t){return t&&!e.deleted&&t.modified>=e.modified?(console.log("Local copy of ".concat(r," is the same or newer than the server copy. (").concat(t.modified," >= ").concat(e.modified,") ")),Promise.resolve()):(console.log("Adding or replacing local copy of ".concat(r)),ld.setItem(r,e))}))}},{key:"seekKeys",value:function(e){return ld.keys().then((function(t){var n,r=us(t);try{for(r.s();!(n=r.n()).done;){var o,a,i=n.value,s=is(i.split(".",2),2);o=s[0],a=s[1],e.hasOwnProperty(o)?e[o].includes(a)||e[o].push(a):console.log("Unrecognised stored key type '".concat(o,"."))}}catch(e){r.e(e)}finally{r.f()}return e}))}},{key:"syncAll",value:function(){var e=this;return this.seekKeys({survey:[],occurrence:[],image:[]}).then((function(t){return e._syncLocalUnsaved(t)}),(function(e){console.log("Failed to sync all: ".concat(e))}))}},{key:"_syncLocalUnsaved",value:function(e){var t,n=[],r=us(e.survey);try{for(r.s();!(t=r.n()).done;){var o=t.value;n.push(vx.retrieveFromLocal(o,new vx).then((function(e){if(e.unsaved())return e.save()})))}}catch(e){r.e(e)}finally{r.f()}var a,i=us(e.occurrence);try{for(i.s();!(a=i.n()).done;){var s=a.value;n.push(mI.retrieveFromLocal(s,new mI).then((function(e){if(e.unsaved())return e.save()})))}}catch(e){i.e(e)}finally{i.f()}var c,l=us(e.image);try{for(l.s();!(c=l.n()).done;){var u=c.value;n.push(yx.retrieveFromLocal(u,new yx).then((function(e){if(e.unsaved())return e.save()})))}}catch(e){l.e(e)}finally{l.f()}return Promise.all(n).catch((function(e){console.log("Save failure: ".concat(e))}))}},{key:"restoreOccurrences",value:function(e){var t=this;if(this.surveys.has(e)){var n=this.surveys.get(e);if(n.isPristine)return this.currentSurvey=n,this.fireEvent(Tx.EVENT_SURVEYS_CHANGED),Promise.resolve()}var r={survey:[],occurrence:[],image:[]};return e&&(r.survey[0]=e),this.seekKeys(r).then((function(e){return e.survey.length?t.refreshFromServer(e.survey).finally((function(){return t.seekKeys(e)})):null})).finally((function(){return r.survey.length?t._restoreSurveyFromLocal(r.survey[0],r).finally((function(){return t.currentSurvey=t.surveys.get(r.survey[0]),t.currentSurvey?(t.currentSurvey.deleted?t.setNewSurvey():t.fireEvent(Tx.EVENT_SURVEYS_CHANGED),Promise.resolve()):(console.log("Failed to retrieve survey id '".concat(e,"'")),Promise.reject(new Error("Failed to retrieve survey id '".concat(e,"'"))))})):(t.setNewSurvey(),Promise.resolve())}))}},{key:"setNewSurvey",value:function(){this.currentSurvey=new vx,this.currentSurvey.projectId=this.projectId,this.currentSurvey.isPristine=!0,this.addSurvey(this.currentSurvey)}},{key:"addNewOccurrence",value:function(){var e=new mI;return e.surveyId=this.currentSurvey.id,e.projectId=this.projectId,e.isNew=!0,e.isPristine=!0,this.addOccurrence(e),this.fireEvent(n.EVENT_OCCURRENCE_ADDED,{occurrenceId:e.id,surveyId:e.surveyId}),e}},{key:"_restoreSurveyFromLocal",value:function(e,t){var n=this;return vx.retrieveFromLocal(e,new vx).then((function(r){n.clearCurrentSurvey(),n.addSurvey(r);var o,a=[],i=us(t.occurrence);try{for(i.s();!(o=i.n()).done;){var s=o.value;a.push(mI.retrieveFromLocal(s,new mI).then((function(t){t.surveyId===e&&n.addOccurrence(t)})))}}catch(e){i.e(e)}finally{i.f()}return Promise.all(a)})).finally((function(){var n,r=[],o=us(t.image);try{var a=function(){var t=n.value;r.push(yx.retrieveFromLocal(t,new yx).then((function(n){n.surveyId===e&&yx.imageCache.set(t,n)}),(function(e){console.log("Failed to retrieve an image: ".concat(e))})))};for(o.s();!(n=o.n()).done;)a()}catch(e){o.e(e)}finally{o.f()}return Promise.all(r)}))}},{key:"clearLocalForage",value:function(){return ld.clear()}}]),n}(Tx);$i(tM,"forageName","Nyph App"),$i(tM,"LOAD_SURVEYS_ENDPOINT","/loadsurveys.php"),$i(tM,"EVENT_OCCURRENCE_ADDED","occurrenceadded"),$i(tM,"EVENT_SURVEYS_CHANGED","surveyschanged"),$i(tM,"devMode",!1);var nM={exports:{}},rM={},oM=nn,aM=fn.f,iM={}.toString,sM="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];rM.f=function(e){return sM&&"[object Window]"==iM.call(e)?function(e){try{return aM(e)}catch(e){return sM.slice()}}(e):aM(oM(e))};var cM=!M((function(){return Object.isExtensible(Object.preventExtensions({}))})),lM=ur,uM=nt,dM=ne,fM=m,hM=ee.f,pM=fn,vM=rM,yM=cM,mM=!1,gM=b("meta"),SM=0,bM=Object.isExtensible||function(){return!0},NM=function(e){hM(e,gM,{value:{objectID:"O"+SM++,weakData:{}}})},TM=nM.exports={enable:function(){TM.enable=function(){},mM=!0;var e=pM.f,t=[].splice,n={};n[gM]=1,e(n).length&&(pM.f=function(n){for(var r=e(n),o=0,a=r.length;o<a;o++)if(r[o]===gM){t.call(r,o,1);break}return r},lM({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:vM.f}))},fastKey:function(e,t){if(!dM(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!fM(e,gM)){if(!bM(e))return"F";if(!t)return"E";NM(e)}return e[gM].objectID},getWeakData:function(e,t){if(!fM(e,gM)){if(!bM(e))return!0;if(!t)return!1;NM(e)}return e[gM].weakData},onFreeze:function(e){return yM&&mM&&bM(e)&&!fM(e,gM)&&NM(e),e}};uM[gM]=!0;var EM=N,wM=ne,_M=gr,OM=function(e,t,n){var r,o;return _M&&EM(r=t.constructor)&&r!==n&&wM(o=r.prototype)&&o!==n.prototype&&_M(e,o),e},IM=ur,RM=r,xM=nr,CM=z.exports,AM=nM.exports,kM=no,LM=Rr,MM=N,PM=ne,HM=M,DM=fo,FM=Tr,jM=OM,UM=function(e,t,n){var r=-1!==e.indexOf("Map"),o=-1!==e.indexOf("Weak"),a=r?"set":"add",i=RM[e],s=i&&i.prototype,c=i,l={},u=function(e){var t=s[e];CM(s,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(o&&!PM(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return o&&!PM(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(o&&!PM(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})};if(xM(e,!MM(i)||!(o||s.forEach&&!HM((function(){(new i).entries().next()})))))c=n.getConstructor(t,e,r,a),AM.enable();else if(xM(e,!0)){var d=new c,f=d[a](o?{}:-0,1)!=d,h=HM((function(){d.has(1)})),p=DM((function(e){new i(e)})),v=!o&&HM((function(){for(var e=new i,t=5;t--;)e[a](t,t);return!e.has(-0)}));p||((c=t((function(t,n){LM(t,c,e);var o=jM(new i,t,c);return null!=n&&kM(n,o[a],{that:o,AS_ENTRIES:r}),o}))).prototype=s,s.constructor=c),(h||v)&&(u("delete"),u("has"),r&&u("get")),(v||f)&&u(a),o&&s.clear&&delete s.clear}return l[e]=c,IM({global:!0,forced:c!=i},l),FM(c,e),o||n.setStrong(c,e,r),c},BM=Pr,YM=Zt,VM=p,JM=wn,GM=Ls,qM=[].push,KM=function(e){var t=1==e,n=2==e,r=3==e,o=4==e,a=6==e,i=7==e,s=5==e||a;return function(c,l,u,d){for(var f,h,p=VM(c),v=YM(p),y=BM(l,u,3),m=JM(v),g=0,S=d||GM,b=t?S(c,m):n||i?S(c,0):void 0;m>g;g++)if((s||g in v)&&(h=y(f=v[g],g,p),e))if(t)b[g]=h;else if(h)switch(e){case 3:return!0;case 5:return f;case 6:return g;case 2:qM.call(b,f)}else switch(e){case 4:return!1;case 7:qM.call(b,f)}return a?-1:r||o?o:b}},WM={forEach:KM(0),map:KM(1),filter:KM(2),some:KM(3),every:KM(4),find:KM(5),findIndex:KM(6),filterReject:KM(7)},XM=hr,QM=nM.exports.getWeakData,zM=ue,$M=ne,ZM=Rr,eP=no,tP=m,nP=yt.set,rP=yt.getterFor,oP=WM.find,aP=WM.findIndex,iP=0,sP=function(e){return e.frozen||(e.frozen=new cP)},cP=function(){this.entries=[]},lP=function(e,t){return oP(e.entries,(function(e){return e[0]===t}))};cP.prototype={get:function(e){var t=lP(this,e);if(t)return t[1]},has:function(e){return!!lP(this,e)},set:function(e,t){var n=lP(this,e);n?n[1]=t:this.entries.push([e,t])},delete:function(e){var t=aP(this.entries,(function(t){return t[0]===e}));return~t&&this.entries.splice(t,1),!!~t}};var uP,dP={getConstructor:function(e,t,n,r){var o=e((function(e,a){ZM(e,o,t),nP(e,{type:t,id:iP++,frozen:void 0}),null!=a&&eP(a,e[r],{that:e,AS_ENTRIES:n})})),a=rP(t),i=function(e,t,n){var r=a(e),o=QM(zM(t),!0);return!0===o?sP(r).set(t,n):o[r.id]=n,e};return XM(o.prototype,{delete:function(e){var t=a(this);if(!$M(e))return!1;var n=QM(e);return!0===n?sP(t).delete(e):n&&tP(n,t.id)&&delete n[t.id]},has:function(e){var t=a(this);if(!$M(e))return!1;var n=QM(e);return!0===n?sP(t).has(e):n&&tP(n,t.id)}}),XM(o.prototype,n?{get:function(e){var t=a(this);if($M(e)){var n=QM(e);return!0===n?sP(t).get(e):n?n[t.id]:void 0}},set:function(e,t){return i(this,e,t)}}:{add:function(e){return i(this,e,!0)}}),o}},fP=r,hP=hr,pP=nM.exports,vP=UM,yP=dP,mP=ne,gP=yt.enforce,SP=ze,bP=!fP.ActiveXObject&&"ActiveXObject"in fP,NP=Object.isExtensible,TP=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},EP=vP("WeakMap",TP,yP);if(SP&&bP){uP=yP.getConstructor(TP,"WeakMap",!0),pP.enable();var wP=EP.prototype,_P=wP.delete,OP=wP.has,IP=wP.get,RP=wP.set;hP(wP,{delete:function(e){if(mP(e)&&!NP(e)){var t=gP(this);return t.frozen||(t.frozen=new uP),_P.call(this,e)||t.frozen.delete(e)}return _P.call(this,e)},has:function(e){if(mP(e)&&!NP(e)){var t=gP(this);return t.frozen||(t.frozen=new uP),OP.call(this,e)||t.frozen.has(e)}return OP.call(this,e)},get:function(e){if(mP(e)&&!NP(e)){var t=gP(this);return t.frozen||(t.frozen=new uP),OP.call(this,e)?IP.call(this,e):t.frozen.get(e)}return IP.call(this,e)},set:function(e,t){if(mP(e)&&!NP(e)){var n=gP(this);n.frozen||(n.frozen=new uP),OP.call(this,e)?RP.call(this,e,t):n.frozen.set(e,t)}else RP.call(this,e,t);return this}})}var xP=new WeakMap,CP=function(e){Zi(n,e);var t=os(n);function n(e){var r;return Xi(this,n),$i(ns(r=t.call(this)),"route","/list/:action/:id"),$i(ns(r),"title","BSBI New Year Plant Hunt homepage"),$i(ns(r),"app",void 0),$i(ns(r),"view",void 0),bs(ns(r),xP,{writable:!0,value:""}),$i(ns(r),"needsFullRefresh",!0),$i(ns(r),"needRightPanelRefresh",!0),$i(ns(r),"viewSubcontext",""),$i(ns(r),"surveySection",void 0),$i(ns(r),"leftPanelBaseRoute",""),$i(ns(r),"viewContexts",{record:function(e){this.surveySection=null,e?ds(this,xP)!==e.id?(this.needRightPanelRefresh=!0,this.currentOccurrenceId=e.id?e.id:""):this.needRightPanelRefresh=!1:(this.currentOccurrenceId="",this.needRightPanelRefresh=!0),this.leftPanelBaseRoute="/list/record"},survey:function(e){console.log("in survey section ".concat(e.section)),this.currentOccurrenceId="",this.needRightPanelRefresh=!0,this.surveySection=e.section,this.leftPanelBaseRoute="/list/survey/".concat(e.section)}}),r.view=e,e.controller=ns(r),r.handle=yd.nextHandle,e.addListener(n.EVENT_SELECT_OCCURRENCE,ns(r),r.occurrenceSelectionHandler),e.addListener(n.EVENT_SELECT_SURVEY_SECTION,ns(r),r.surveyPartSelectionHandler),e.addListener(n.EVENT_NEW_RECORD,ns(r),r.newRecordHandler),e.addListener(n.EVENT_DELETE_OCCURRENCE,ns(r),r.deleteOccurrenceHandler),e.addListener(n.EVENT_BACK,ns(r),r.backHandler),e.addListener(n.EVENT_NEXT_TO_RECORDS,ns(r),r.nextTransitionToRecordsHandler),r}return zi(n,[{key:"occurrences",get:function(){return this.app.occurrences}},{key:"currentOccurrence",get:function(){if(ds(this,xP)){if(this.app.occurrences.has(ds(this,xP)))return this.app.occurrences.get(ds(this,xP));throw new Lb("Record id '".concat(ds(this,xP),"' was not found."))}return null}},{key:"currentOccurrenceId",get:function(){return ds(this,xP)},set:function(e){fs(this,xP,e)}},{key:"survey",get:function(){return this.app.currentSurvey}},{key:"nextTransitionToRecordsHandler",value:function(){console.log("in nextTransitionToRecordsHandler()"),this.app.haveExtantOccurrences()?this.app.router.navigate("/list/record/"):this.newRecordHandler()}},{key:"deleteOccurrenceHandler",value:function(e,t,n){console.log({deleting:n});var r=this.app.occurrences.get(n);if(!r)throw new gI("Occurrence id '".concat(n,"' not found when trying to delete."));r.delete(),this.currentOccurrenceId===n&&this.app.router.navigate("/list/record/")}},{key:"surveyPartSelectionHandler",value:function(e,t,n){console.log("In surveyPartSelectionHandler"),console.log({context:e,eventName:t,params:n}),"record"===n.sectionKey?this.app.router.navigate("/list/record/"):n.sectionKey?this.app.router.navigate("/list/survey/".concat(n.sectionKey)):this.app.router.navigate("/list/")}},{key:"newRecordHandler",value:function(){var e=this.app.addNewOccurrence();this.app.router.navigate("/list/record/".concat(e.id))}},{key:"occurrenceSelectionHandler",value:function(e,t,n){console.log({"In occurrenceSelectionHandler":{context:e,eventName:t,params:n}}),this.currentOccurrenceId&&n.occurrenceId&&this.currentOccurrenceId===n.occurrenceId?console.log("ignoring spurious navigation event for '".concat(n.occurrenceId,"'")):this.app.router.navigate("/list/record/".concat(n.occurrenceId))}},{key:"registerRoute",value:function(e){e.on("/list",this.mainRouteHandler.bind(this,"list","",""),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null}),e.on("/list/help",this.mainRouteHandler.bind(this,"list","","help")),e.on("/list/record/",this.mainRouteHandler.bind(this,"list","record",""),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null}),e.on("/list/record/help",this.mainRouteHandler.bind(this,"list","record","help")),e.on("/list/record/:id",this.mainRouteHandler.bind(this,"list","record","form"),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null}),e.on("/list/survey/:section",this.mainRouteHandler.bind(this,"list","survey",""),{before:this.beforeRouteHandler?this.beforeRouteHandler.bind(this):null,after:this.afterRouteHandler?this.afterRouteHandler.bind(this):null,leave:this.leaveRouteHandler?this.leaveRouteHandler.bind(this):null,already:this.alreadyRouteHandler?this.alreadyRouteHandler.bind(this):null}),e.on("/list/survey/:section/help",this.mainRouteHandler.bind(this,"list","survey","help"))}},{key:"mainRouteHandler",value:function(e,t,n,r){console.log("reached special route handler for MainController.js"),console.log({context:e,params:t,query:r}),this.app.saveRoute();try{this.viewSubcontext=t,t&&this.viewContexts[t].call(this,r),this.app.currentControllerHandle!==this.handle&&(this.needsFullRefresh=!0,this.needRightPanelRefresh=!0,this.app.currentControllerHandle=this.handle),this.view.panelKey=n,this.view.display(),this.needsFullRefresh=!1}catch(e){this.error=e,console.log({error:e});try{this.needsFullRefresh=!0,this.view.display()}catch(e){console.log({rethrownError:e}),document.body.innerHTML="<h2>Internal error</h2><p>Please report this problem:</p><p>".concat(e.message,"</p>")}}}},{key:"backHandler",value:function(){this.app.routeHistory.length>=2&&this.app.routeHistory[this.app.routeHistory.length-2].url===this.leftPanelBaseRoute?(this.app.routeHistory.length-=1,console.log("using standard back navigation"),window.history.back()):(console.log("navigating back using base address '".concat(this.leftPanelBaseRoute,"'")),this.app.router.navigate(this.leftPanelBaseRoute))}}]),n}(yd);$i(CP,"EVENT_SELECT_OCCURRENCE","selectoccurrence"),$i(CP,"EVENT_SELECT_SURVEY_SECTION","selectsurveysection"),$i(CP,"EVENT_NEW_RECORD","newrecord"),$i(CP,"EVENT_DELETE_OCCURRENCE","deleteoccurrence"),$i(CP,"EVENT_BACK","back"),$i(CP,"EVENT_NEXT_TO_RECORDS","nexttorecords"),UM("WeakSet",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),dP);var AP=M,kP=function(e,t){var n=[][e];return!!n&&AP((function(){n.call(null,t||function(){throw 1},1)}))},LP=ur,MP=nn,PP=[].join,HP=Zt!=Object,DP=kP("join",",");LP({target:"Array",proto:!0,forced:HP||!DP},{join:function(e){return PP.call(MP(this),void 0===e?",":e)}});var FP=Math.floor,jP=function(e,t){var n=e.length,r=FP(n/2);return n<8?UP(e,t):BP(jP(e.slice(0,r),t),jP(e.slice(r),t),t)},UP=function(e,t){for(var n,r,o=e.length,a=1;a<o;){for(r=a,n=e[a];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==a++&&(e[r]=n)}return e},BP=function(e,t,n){for(var r=e.length,o=t.length,a=0,i=0,s=[];a<r||i<o;)a<r&&i<o?s.push(n(e[a],t[i])<=0?e[a++]:t[i++]):s.push(a<r?e[a++]:t[i++]);return s},YP=jP,VP=O.match(/firefox\/(\d+)/i),JP=!!VP&&+VP[1],GP=/MSIE|Trident/.test(O),qP=O.match(/AppleWebKit\/(\d+)\./),KP=!!qP&&+qP[1],WP=ur,XP=me,QP=p,zP=wn,$P=bl,ZP=M,eH=YP,tH=kP,nH=JP,rH=GP,oH=L,aH=KP,iH=[],sH=iH.sort,cH=ZP((function(){iH.sort(void 0)})),lH=ZP((function(){iH.sort(null)})),uH=tH("sort"),dH=!ZP((function(){if(oH)return oH<70;if(!(nH&&nH>3)){if(rH)return!0;if(aH)return aH<603;var e,t,n,r,o="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)iH.push({k:t+r,v:n})}for(iH.sort((function(e,t){return t.v-e.v})),r=0;r<iH.length;r++)t=iH[r].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}}));WP({target:"Array",proto:!0,forced:cH||!lH||!uH||!dH},{sort:function(e){void 0!==e&&XP(e);var t=QP(this);if(dH)return void 0===e?sH.call(t):sH.call(t,e);var n,r,o=[],a=zP(t);for(r=0;r<a;r++)r in t&&o.push(t[r]);for(n=(o=eH(o,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:$P(t)>$P(n)?1:-1}}(e))).length,r=0;r<n;)t[r]=o[r++];for(;r<a;)delete t[r++];return t}});var fH="\x3c!-- begin: templates/formHelp/surveyAboutHelp.html --\x3e\r\n<h3>Background to the project</h3>\r\n<p>The majority of our ornamental plants are non-native. They contribute greatly to our enjoyment\r\nof gardens and represent a long history of plant discovery and garden design. However, some\r\nhave escaped the controlled environment of gardens, and a small minority of these are\r\nthreatening native biodiversity or are causing severe problems for infrastructure, agriculture or\r\n    forestry. Well known examples include Japanese Knotweed (<i>Reynoutria japonica</i>), <i>Rhododendron\r\n        ponticum</i> and Himalayan Balsam (<i>Impatiens glandulifera</i>).</p>\r\n<p>The period between introduction of a species and it first being noticed as a problem can be a\r\nlong one, making future control problematic. In Britain on average, this time span has been more\r\nthan one hundred years. Early detection of potentially problematic plants for further risk\r\n    assessment could greatly improve our ability to prevent plant species becoming invasive.</p>\r\n<p>This survey is based upon the assumption that it is gardeners who are most likely to notice first\r\nif a particular ornamental plant may have the potential to spread outside the garden. (Most\r\ngardeners will know which plants tend to overgrow others or tend to spread all over the\r\ngarden.) This knowledge could be invaluable in identifying potential invaders, triggering timely risk\r\n    assessment.</p>\r\n\x3c!-- end: templates/formHelp/surveyAboutHelp.html --\x3e\r\n",hH=new WeakMap,pH=function(e){Zi(n,e);var t=os(n);function n(e){var r;return Xi(this,n),bs(ns(r=t.call(this)),hH,{writable:!0,value:void 0}),$i(ns(r),"_formFieldsBuilt",!1),$i(ns(r),"section",void 0),r.section=e,r}return zi(n,[{key:"formElement",get:function(){var e=as(es(n.prototype),"formElement",this);return this._formFieldsBuilt||this.buildFormFields(),e}},{key:"updateModelFromContent",value:function(){for(var e in console.log("updating survey from NyphSurveyForm content"),this.fields)if(this.fields.hasOwnProperty(e)){var t=this.fields[e];ds(this,hH).attributes[e]=t.value}console.log({survey:ds(this,hH)})}},{key:"model",get:function(){return ds(this,hH)},set:function(e){fs(this,hH,e),this.populateFormContent()}},{key:"changeHandler",value:function(e){console.log("survey form change event"),console.log({event:e}),this.fireEvent(n.CHANGE_EVENT,{form:this})}},{key:"destructor",value:function(){as(es(n.prototype),"destructor",this).call(this),fs(this,hH,null)}},{key:"initialiseFormFields",value:function(){var e=this.section.properties;for(var t in this.fields={},e)e.hasOwnProperty(t)&&(this.fields[t]=new e[t].field(e[t].attributes))}},{key:"getFormSectionProperties",value:function(){return this.section.properties}}],[{key:"registerSection",value:function(e){n.sections[e.sectionSortOrder]=e,n.sectionsByKey[e.sectionNavigationKey]=e}}]),n}(pI);$i(pH,"sections",[]),$i(pH,"sectionsByKey",{}),pH.CHANGE_EVENT="change";var vH=function e(){Xi(this,e)};$i(vH,"sectionTitle",void 0),$i(vH,"sectionSortOrder",void 0),$i(vH,"sectionNavigationKey",void 0),$i(vH,"help",""),$i(vH,"properties",void 0);var yH=function(e){Zi(n,e);var t=os(n);function n(){return Xi(this,n),t.apply(this,arguments)}return n}(vH);$i(yH,"sectionNavigationKey","garden"),$i(yH,"sectionTitle","About your garden"),$i(yH,"sectionSortOrder",1),$i(yH,"help","\x3c!-- begin: templates/formHelp/surveyGardenHelp.html --\x3e\r\n<h2>About your garden</h2>\r\n<p>The questions in this section provide background information about the area where you live.</p>\r\n<p>Please try to answer everything, but don't worry if some details are impossible to assess.</p>\r\n<p>When you have completed this section, move on to the final part of the survey, where you can list the invasive plants in your garden.</p>\r\n\x3c!-- end: templates/formHelp/surveyGardenHelp.html --\x3e\r\n"),$i(yH,"properties",{durationAtAddress:{field:zA,attributes:{label:"Roughly how long have you lived at this address?",placeholder:"approximate years",type:"number"}},numberOfPlants:{field:bk,attributes:{label:"Could you please try to estimate how many different ornamental plants are growing in your garden?",placeholder:"please estimate",options:{"<20":{label:"fewer than 20"},"20-50":{label:"between 20 and 50"},"50-100":{label:"between 50 and 100"},">100":{label:"more than 100"},unknown:{label:"impossible to estimate"}},includeOtherFreeText:!1,completion:iI.COMPLETION_DESIRED}},introductions:{field:zA,attributes:{label:"In the last year, how many new ornamental plant species did you plant/introduce into your garden?",helpText:"please estimate",placeholder:"number of plants",autocomplete:"off",type:"number"}},acquisitions:{field:ck,attributes:{label:"In the last year, where did you get these new plants or seeds?",helpText:"<i>(tick all that apply)</i>",options:{nursery:{label:"bought from nursery"},gardencentre:{label:"bought at garden centre"},supermarket:{label:"bought at supermarket"},mailorder:{label:"mail-order"},internetorder:{label:"internet order"},friendsneighbours:{label:"from friends or neighbours"},swap:{label:"plant / seed swap"},other:{label:"other"}},includeOtherFreeText:!0}},gifts:{field:bk,attributes:{label:"In the last two years, did you give plants/seeds to friends/neighbours?",placeholder:"please select a response",options:{yes:{label:"yes"},no:{label:"no"}},includeOtherFreeText:!1}}});var mH=function(e){Zi(n,e);var t=os(n);function n(){return Xi(this,n),t.apply(this,arguments)}return n}(vH);$i(mH,"sectionNavigationKey","about"),$i(mH,"sectionTitle","About you and your survey"),$i(mH,"sectionSortOrder",0),$i(mH,"help",'\x3c!-- begin: templates/formHelp/surveyAboutHelp.html --\x3e\r\n<div class="card mt-3">\r\n    <div class="card-body">\r\n        <h5 class="card-title">Localising your records</h5>\r\n        <p class="card-text">To make sense of the national coverage of the records we receive, we need to know the approximate location\r\n        of your garden. Usually a postcode works well for this, but you can provide a grid-reference if you prefer (in Ireland please use a grid-reference as we don\'t yet have a way to convert postcodes).\r\n            We also need a place name, as a way to double check that the postcode or grid-reference makes sense.\r\n        </p>\r\n        <p><strong>Please don\'t provide your full address, as we would need to remove that from our data.</strong></p>\r\n    </div>\r\n</div>\r\n<div class="card mt-3">\r\n    <div class="card-body">\r\n        <h5 class="card-title">Your name and email</h5>\r\n        <p class="card-text">Both of these are optional, but providing an email address is important if you want to return\r\n            to your survey later or to revise your records. It is also really useful for our experts to be able to contact you\r\n            if we have questions about the records that you\'ve sent.\r\n        </p>\r\n        <p>We\'d like to be able to include your name with the records in our archive, but your email address won\'t be stored long-term\r\n            after your plant records have been checked.</p>\r\n    </div>\r\n</div>\r\n\x3c!-- end: templates/formHelp/surveyAboutHelp.html --\x3e\r\n'),$i(mH,"properties",{place:{field:zA,attributes:{label:"Where did you survey?",helpText:"e.g. town or village. Please don't give an address.",placeholder:"Nearest named place",autocomplete:"address-level2",completion:iI.COMPLETION_COMPULSORY}},georef:{field:zA,attributes:{label:"Postcode or grid-reference",helpText:"We need to be able to put your survey on our map. Detailed locations won't be made public.",placeholder:"Grid-reference or postcode",autocomplete:"postal-code",completion:iI.COMPLETION_COMPULSORY}},recorder:{field:zA,attributes:{label:"Your name",helpText:"(optional) This helps us follow-up if we have any queries about your records and allows us to properly acknowledge the origin of your observations.",placeholder:"full name",autocomplete:"name"}},namearchive:{field:bk,attributes:{label:"Can we include your name in our archive of plant records?",helpText:"",placeholder:"please choose an option",options:{yes:{label:"yes"},no:{label:"no, I'd prefer my records to be anonymous"}},includeOtherFreeText:!1,completion:iI.COMPLETION_DESIRED}},email:{field:zA,attributes:{label:"Your email address",helpText:"(optional) We'll never share your email with anyone else.",autocomplete:"email",type:"email"}}});var gH=p,SH=Math.floor,bH="".replace,NH=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,TH=/\$([$&'`]|\d{1,2})/g,EH=function(e,t,n,r,o,a){var i=n+e.length,s=r.length,c=TH;return void 0!==o&&(o=gH(o),c=NH),bH.call(a,c,(function(a,c){var l;switch(c.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(i);case"<":l=o[c.slice(1,-1)];break;default:var u=+c;if(0===u)return a;if(u>s){var d=SH(u/10);return 0===d?a:d<=s?void 0===r[d-1]?c.charAt(1):r[d-1]+c.charAt(1):a}l=r[u-1]}return void 0===l?"":l}))},wH=ju,_H=M,OH=ue,IH=N,RH=vn,xH=Tn,CH=bl,AH=f,kH=Bu,LH=Se,MH=EH,PH=qu,HH=W("replace"),DH=Math.max,FH=Math.min,jH=function(e){return void 0===e?e:String(e)},UH="$0"==="a".replace(/./,"$0"),BH=!!/./[HH]&&""===/./[HH]("a","$0");wH("replace",(function(e,t,n){var r=BH?"$":"$0";return[function(e,n){var r=AH(this),o=null==e?void 0:LH(e,HH);return o?o.call(e,r,n):t.call(CH(r),e,n)},function(e,o){var a=OH(this),i=CH(e);if("string"==typeof o&&-1===o.indexOf(r)&&-1===o.indexOf("$<")){var s=n(t,a,i,o);if(s.done)return s.value}var c=IH(o);c||(o=CH(o));var l=a.global;if(l){var u=a.unicode;a.lastIndex=0}for(var d=[];;){var f=PH(a,i);if(null===f)break;if(d.push(f),!l)break;""===CH(f[0])&&(a.lastIndex=kH(i,xH(a.lastIndex),u))}for(var h="",p=0,v=0;v<d.length;v++){f=d[v];for(var y=CH(f[0]),m=DH(FH(RH(f.index),i.length),0),g=[],S=1;S<f.length;S++)g.push(jH(f[S]));var b=f.groups;if(c){var N=[y].concat(g,m,i);void 0!==b&&N.push(b);var T=CH(o.apply(void 0,N))}else T=MH(y,i,m,g,b,o);m>=p&&(h+=i.slice(p,m)+T,p=m+y.length)}return h+i.slice(p)}]}),!!_H((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!UH||BH);var YH=new WeakMap,VH=function(e){Zi(n,e);var t=os(n);function n(e){var r;return Xi(this,n),bs(ns(r=t.call(this)),YH,{writable:!0,value:void 0}),$i(ns(r),"_formFieldsBuilt",!1),$i(ns(r),"surveyId",""),e&&(r.model=e),r}return zi(n,[{key:"formElement",get:function(){var e=arguments,t=as(es(n.prototype),"formElement",this);return this._formFieldsBuilt||(this.buildFormFields(),t.addEventListener("change",(function(){console.log("occurrence form change event"),console.log(e)}),{capture:!1})),t}},{key:"buildContentContainer",value:function(e){var t=e.appendChild(document.createElement("div"));t.className="card mt-3 ml-0 mr-0 mb-3";var r=t.appendChild(document.createElement("div"));return r.className="card-header",r.textContent=n.sectionTitle,this._formContentContainer=t.appendChild(document.createElement("div")),this._formContentContainer.className="card-body",this._formContentContainer}},{key:"occurrenceId",get:function(){return ds(this,YH)?ds(this,YH).id:null}},{key:"projectId",get:function(){return ds(this,YH)?ds(this,YH).projectId:null}},{key:"initialiseFormFields",value:function(){var e=n.properties;for(var t in this.fields={},e)e.hasOwnProperty(t)&&(this.fields[t]=new e[t].field(e[t].attributes))}},{key:"updateModelFromContent",value:function(){for(var e in console.log("updating occurrence from NyphOccurrenceForm content"),this.fields)if(this.fields.hasOwnProperty(e)){var t=this.fields[e];ds(this,YH).attributes[e]=t.value}console.log({occurrence:ds(this,YH)})}},{key:"model",get:function(){return ds(this,YH)},set:function(e){fs(this,YH,e),this.populateFormContent()}},{key:"changeHandler",value:function(e){console.log("occurrence form change event"),console.log({event:e}),this.fireEvent(n.CHANGE_EVENT,{form:this})}},{key:"pingOccurrence",value:function(){ds(this,YH).unsaved()&&this.fireEvent(n.CHANGE_EVENT,{form:this})}},{key:"destructor",value:function(){fs(this,YH,null),as(es(n.prototype),"destructor",this).call(this)}},{key:"getFormSectionProperties",value:function(){return n.properties}}]),n}(pI);$i(VH,"sectionTitle","Details of invasive garden plant"),$i(VH,"help",'\x3c!-- begin: templates/formHelp/recordsHelp.html --\x3e\r\n<p>In this section, please list the ornamental plants that are spreading in your\r\ngarden and are difficult to control.</p>\r\n<p> Many plants in your garden will spread and this is a sign that they are growing well. We only want to know about those that are spreading to an extent that\r\n    you have to control them to prevent them overgrowing other plants or parts of your garden where you do not want them.</p>\r\n<p>Please note in this project we are dealing with ornamental plants only (no vegetables, no weeds -\r\n    unless they are ornamentals that you now regard as weeds).</p>\r\n<div class="card mt-3">\r\n    <div class="card-body">\r\n        <h5 class="card-title">Using the forms</h5>\r\n        <p class="card-text">You can enter as many plant records as you need. To add another record click the \'Add a plant\' button.</p>\r\n        <p class="card-text">If you are currently online then the entries will be saved as you go, automatically. Otherwise the records\r\n            will be remembered on your device, but you will need to click \'<a href="/app/survey/save" data-navigo="survey/save">save all</a>\' (on the Surveys menu) when you have a network connection again.\r\n        </p>\r\n        <p class="card-text">To delete a plant record, find it in the list and click the red \'bin\' icon.\r\n        </p>\r\n    </div>\r\n</div>\r\n<div class="card mt-3">\r\n    <div class="card-body">\r\n        <h5 class="card-title">Identifying your plants</h5>\r\n        </p>\r\n        <h6 class="card-subtitle mb-2 text-muted">Plant names</h6>\r\n        <p class="card-text">If possible, please enter the scientific or common name of the plant, but don\'t worry if you dont know the full details.\r\n            The list of suggested names includes a very wide range of both native and horticultural plants, but if the name you need\r\n            isn\'t on the list then you can still type it in.\r\n        </p>\r\n        <h6 class="card-subtitle mb-2 text-muted">Photos</h6>\r\n        <p class="card-text">Photos of the plant will help us confirm your record. Please provide a picture showing the whole plant, but it will\r\n            also help us if you can provide close-up views of the flowers and leaves.\r\n        </p>\r\n    </div>\r\n</div>\r\n\x3c!-- begin: templates/formHelp/recordsHelp.html --\x3e\r\n'),$i(VH,"properties",{taxon:{field:Jk,attributes:{label:"plant name",validationMessage:"Please specify a taxon name or provide some photos if you cannot identify the plant.",helpText:"Type the common or scientific name of the invasive plant and, if possible, pick a suggestion from the list. If you do not know the name of the plant then please leave this blank and include some photos."},validator:function(e,t,n){return!(!n.hasOwnProperty(e)||t.field.isEmpty(n[e]))||n.hasOwnProperty("images")&&!GA.isEmpty(n.images)}},idConfidence:{field:bk,attributes:{label:"How confident are you about your identification of this plant?",helpText:"",placeholder:"please choose an option",options:{1:{label:"very sure"},2:{label:"not really sure"},3:{label:"could be wrong"}},includeOtherFreeText:!1,completion:iI.COMPLETION_DESIRED}},images:{field:GA,attributes:{label:"Please provide some photos of the plant",placeholder:"photos",helpText:'If the plant is unusual or if you are unsure of its identity then photos will help us check your record.<br><strong>Submitted images remain your property, but you agree to allow us to use the photos under the terms of a <a href="#" title="Creative Commons Attribution" data-toggle="modal" data-target="#'.concat(GA.LICENSE_MODAL,'">CC BY</a> license.</strong>')}},spread:{field:ck,attributes:{label:"How does the plant spread in your garden?",helpText:"<i>(tick all that apply)</i>",options:{seeds:{label:"seeds"},roots:{label:"roots"},runners:{label:"runners"},bulbs:{label:"bulbs"},unknown:{label:"don't know"},other:{label:"other"}},includeOtherFreeText:!0,completion:iI.COMPLETION_DESIRED},summary:{summaryPrefix:"Spread by"}},control:{field:ck,attributes:{label:"How do you control this plant?",helpText:"<i>(tick all that apply)</i>",options:{digging:{label:"digging"},pulling:{label:"pulling"},chemical:{label:"chemical"},cutting:{label:"cutting"},mulching:{label:"mulching"},other:{label:"other"}},includeOtherFreeText:!0,completion:iI.COMPLETION_DESIRED},summary:{summaryPrefix:"Controlled by"}},disposal:{field:ck,attributes:{label:"Please tell us how you dispose of this plant?",helpText:"<i>(tick all that apply)</i>",options:{homecompost:{label:"home composting"},greenwaste:{label:"green waste"},"other waste":{label:"other waste collection"},other:{label:"other"}},includeOtherFreeText:!0,completion:iI.COMPLETION_DESIRED},summary:{summaryPrefix:"Disposal by"}},problemSeverity:{field:bk,attributes:{label:"Which of the following best describes your effort to control the plant?",placeholder:"please select a response",options:{1:{label:"I don't try to control it"},2:{label:"I try to keep it confined to certain areas."},3:{label:"I am trying everything to get rid of it."},4:{label:"I have given up trying to control it."},5:{label:"I have successfully eradicated the plant."}},includeOtherFreeText:!1,completion:iI.COMPLETION_DESIRED},summary:{summaryPrefix:"Severity:"}},source:{field:ck,attributes:{label:"Please tell us how this plant came into your garden?",helpText:"<i>(tick all that apply)</i>",options:{alreadypresent:{label:"Was already in the garden"},bought:{label:"Bought the plant"},seed:{label:"Grown from seed"},someoneelse:{label:"From someone else's garden"},saleswap:{label:"Non-commercial sale/swap"},spread:{label:"Spread into my garden"},other:{label:"other"}},includeOtherFreeText:!0,completion:iI.COMPLETION_DESIRED},summary:{summaryPrefix:"Source"}},local:{field:bk,attributes:{label:"Is the plant growing locally outside your garden?",placeholder:"please select a response",options:{yes:{label:"yes"},no:{label:"no"},notknown:{label:"I don't know"}},includeOtherFreeText:!1}},warning:{field:bk,attributes:{label:"In your opinion, should the plant be sold with a label warning buyers of potential control difficulties in their garden?",placeholder:"please select a response",options:{yes:{label:"Yes",summary:"Plants should carry a warning"},no:{label:"No",summary:"Plants need not carry a warning"},unsure:{label:"Don't know",summary:"Don't know if plants should carry a warning"}},includeOtherFreeText:!1,completion:iI.COMPLETION_DESIRED},summary:{summarise:!0,summaryPrefix:""}},comments:{field:Xk,attributes:{label:"Any other comments about this plant?",helpText:"",autocomplete:"off"},summary:{summarise:!0}}}),VH.CHANGE_EVENT="change";var JH=ur,GH=Sn,qH=vn,KH=wn,WH=p,XH=Ls,QH=Is,zH=Ds("splice"),$H=Math.max,ZH=Math.min;JH({target:"Array",proto:!0,forced:!zH},{splice:function(e,t){var n,r,o,a,i,s,c=WH(this),l=KH(c),u=GH(e,l),d=arguments.length;if(0===d?n=r=0:1===d?(n=0,r=l-u):(n=d-2,r=ZH($H(qH(t),0),l-u)),l+n-r>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(o=XH(c,r),a=0;a<r;a++)(i=u+a)in c&&QH(o,a,c[i]);if(o.length=r,n<r){for(a=u;a<l-r;a++)s=a+n,(i=a+r)in c?c[s]=c[i]:delete c[s];for(a=l;a>l-r+n;a--)delete c[a-1]}else if(n>r)for(a=l-r;a>u;a--)s=a+n-1,(i=a+r-1)in c?c[s]=c[i]:delete c[s];for(a=0;a<n;a++)c[a+u]=arguments[a+2];return c.length=l-r+n,o}});var eD="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff",tD=f,nD=bl,rD="[\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff]",oD=RegExp("^"+rD+rD+"*"),aD=RegExp(rD+rD+"*$"),iD=function(e){return function(t){var n=nD(tD(t));return 1&e&&(n=n.replace(oD,"")),2&e&&(n=n.replace(aD,"")),n}},sD={start:iD(1),end:iD(2),trim:iD(3)},cD=Tt.PROPER,lD=M,uD=eD,dD=function(e){return lD((function(){return!!uD[e]()||"âÂá "!=="âÂá "[e]()||cD&&uD[e].name!==e}))},fD=sD.trim;ur({target:"String",proto:!0,forced:dD("trim")},{trim:function(){return fD(this)}});var hD=new WeakMap,pD=function(){function e(){Xi(this,e),bs(this,hD,{writable:!0,value:[]})}return zi(e,[{key:"addListener",value:function(e,t,n,r){fs(this,hD,ds(this,hD)||[]);var o="string"==typeof n?function(e,o,a){return t[n](e,o,a,r)}:function(e,o,a){return n.call(t,e,o,a,r)};return ds(this,hD)[e]?ds(this,hD)[e].push(o)-1:(ds(this,hD)[e]=[o],0)}},{key:"removeListener",value:function(e,t){ds(this,hD)[e]&&ds(this,hD)[e][t]?delete ds(this,hD)[e][t]:console.log("trying to remove non-existent event handler, event = "+e+" handle = "+t)}},{key:"destructor",value:function(){fs(this,hD,null)}},{key:"fireEvent",value:function(t,n){if(ds(this,hD))for(var r in ds(this,hD)[t])if(ds(this,hD)[t].hasOwnProperty(r)&&ds(this,hD)[t][r](this,t,arguments[1])===e.STOP_PROPAGATION)break}}]),e}();$i(pD,"STOP_PROPAGATION","STOP_PROPAGATION");var vD=function(e){Zi(n,e);var t=os(n);function n(e){var r;return Xi(this,n),$i(ns(r=t.call(this)),"_value",void 0),$i(ns(r),"_fieldEl",void 0),$i(ns(r),"label","field label"),$i(ns(r),"helpText",""),$i(ns(r),"validationMessage",""),$i(ns(r),"completion",n.COMPLETION_OPTIONAL),$i(ns(r),"parentForm",void 0),$i(ns(r),"attributeName",void 0),e&&(e.label&&(r.label=e.label),e.helpText&&(r.helpText=e.helpText),e.validationMessage&&(r.validationMessage=e.validationMessage),e.completion&&(r.completion=e.completion)),r}return zi(n,[{key:"value",get:function(){return this._value},set:function(e){}},{key:"fieldElement",get:function(){return this._fieldEl||this.buildField(),this._fieldEl}},{key:"addField",value:function(){this.parentForm.formElement.appendChild(this.fieldElement)}},{key:"markValidity",value:function(e){}}],[{key:"nextId",get:function(){var e,t,r;return"field".concat((function(e,t,n,r){ys(e,t),ms(n,"set"),vs(e,n,r)}(n,n,yD,(r=yD,ys(t=n,n),ms(r,"get"),1+(e=+ps(t,r)))),e))}},{key:"cleanRawInput",value:function(e){return e.value.trim().replace(/\s\s+/g," ")}},{key:"cleanRawString",value:function(e){return e.trim().replace(/\s\s+/g," ")}},{key:"isEmpty",value:function(e){return""===e}},{key:"isValid",value:function(e,t,r){return!t.attributes.completion||t.attributes.completion!==n.COMPLETION_COMPULSORY&&t.attributes.completion!==n.COMPLETION_DESIRED?null:!(!r.hasOwnProperty(e)||t.field.isEmpty(r[e]))}},{key:"summarise",value:function(e,t,n){return!t.summary||t.summary.hasOwnProperty("summarise")&&!0!==t.summary.summarise?"":t.field.summariseImpl(e,t,n)}},{key:"summariseImpl",value:function(e,t,n){return""}}]),n}(pD);$i(vD,"COMPLETION_COMPULSORY","compulsory"),$i(vD,"COMPLETION_DESIRED","desired"),$i(vD,"COMPLETION_OPTIONAL","optional");var yD={writable:!0,value:1};$i(vD,"EVENT_CHANGE","fieldChange");var mD=Tt.PROPER,gD=z.exports,SD=ue,bD=bl,ND=M,TD=su,ED=RegExp.prototype,wD=ED.toString,_D=ND((function(){return"/a/b"!=wD.call({source:"a",flags:"b"})})),OD=mD&&"toString"!=wD.name;(_D||OD)&&gD(RegExp.prototype,"toString",(function(){var e=SD(this),t=bD(e.source),n=e.flags;return"/"+t+"/"+bD(void 0===n&&e instanceof RegExp&&!("flags"in ED)?TD.call(e):n)}),{unsafe:!0});var ID=ee.f,RD=mc,xD=hr,CD=Pr,AD=Rr,kD=no,LD=ul,MD=Ir,PD=Z,HD=nM.exports.fastKey,DD=yt.set,FD=yt.getterFor,jD={getConstructor:function(e,t,n,r){var o=e((function(e,a){AD(e,o,t),DD(e,{type:t,index:RD(null),first:void 0,last:void 0,size:0}),PD||(e.size=0),null!=a&&kD(a,e[r],{that:e,AS_ENTRIES:n})})),a=FD(t),i=function(e,t,n){var r,o,i=a(e),c=s(e,t);return c?c.value=n:(i.last=c={index:o=HD(t,!0),key:t,value:n,previous:r=i.last,next:void 0,removed:!1},i.first||(i.first=c),r&&(r.next=c),PD?i.size++:e.size++,"F"!==o&&(i.index[o]=c)),e},s=function(e,t){var n,r=a(e),o=HD(t);if("F"!==o)return r.index[o];for(n=r.first;n;n=n.next)if(n.key==t)return n};return xD(o.prototype,{clear:function(){for(var e=a(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,PD?e.size=0:this.size=0},delete:function(e){var t=a(this),n=s(this,e);if(n){var r=n.next,o=n.previous;delete t.index[n.index],n.removed=!0,o&&(o.next=r),r&&(r.previous=o),t.first==n&&(t.first=r),t.last==n&&(t.last=o),PD?t.size--:this.size--}return!!n},forEach:function(e){for(var t,n=a(this),r=CD(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!s(this,e)}}),xD(o.prototype,n?{get:function(e){var t=s(this,e);return t&&t.value},set:function(e,t){return i(this,0===e?0:e,t)}}:{add:function(e){return i(this,e=0===e?0:e,e)}}),PD&&ID(o.prototype,"size",{get:function(){return a(this).size}}),o},setStrong:function(e,t,n){var r=t+" Iterator",o=FD(t),a=FD(r);LD(e,t,(function(e,t){DD(this,{type:r,target:e,state:o(e),kind:t,last:void 0})}),(function(){for(var e=a(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),MD(t)}};function UD(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,UD)}UM("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),jD);var BD=/^[a-fA-F0-9]{8}-(?:[a-fA-F0-9]{4}-){3}[a-fA-F0-9]{12}$/,YD=function(e){Zi(n,e);var t=os(n);function n(){var e;return Xi(this,n),$i(ns(e=t.call(this)),"_id",void 0),$i(ns(e),"_savedRemotely",!1),$i(ns(e),"_savedLocally",!1),$i(ns(e),"deleted",!1),$i(ns(e),"createdStamp",void 0),$i(ns(e),"modifiedStamp",void 0),$i(ns(e),"projectId",void 0),$i(ns(e),"isPristine",!1),e.createdStamp=Math.floor(Date.now()/1e3),e}return zi(n,[{key:"unsaved",value:function(){return!(this._savedLocally&&this._savedRemotely)}},{key:"id",get:function(){return this._id||(this._id=UD()),this._id},set:function(e){if(this._id&&e!==this._id)throw new Error("Occurrence id has already been set, when trying to set new id '".concat(e,"'."));this._id=e}},{key:"queuePost",value:function(e){var t=this;return new Promise((function(r,o){var a=function(){return console.log({"posting form data":e}),t.post(e).then(r,o)};n._tasks.push(a),n._tasks.length>1?console.log("Added post request to the queue."):(console.log("No pending tasks, starting post request immediately."),a().finally(n._next))}))}},{key:"post",value:function(e){var t=this;return fetch(this.SAVE_ENDPOINT,{method:"POST",body:e}).then((function(e){return e.ok?e.clone().json().then((function(n){switch(console.log({"returned to client after save":n}),n.saveState){case"SAVED_TO_SERVER":t._savedLocally=!0,t._savedRemotely=!0;break;case"SAVED_LOCALLY":t._savedLocally=!0,t._savedRemotely=!1;break;default:console.log("Unrecognised save state '".concat(n.saveState,"'"))}return t.createdStamp=n.created,t.modifiedStamp=n.modified,e.json()})):(console.log("Save failed, presumably service worker is missing and there is no network connection. Should write to IndexedDb here."),Promise.reject("IndexedDb storage not yet implemented"))}))}},{key:"_parseDescriptor",value:function(e){this._parseAttributes(e.attributes),this._parseSavedState(e.saveState),this.deleted=e.deleted,this.createdStamp=0+e.created,this.modifiedStamp=0+e.modified,this.projectId=0+e.projectId}},{key:"_parseAttributes",value:function(e){Array.isArray(e)?(console.log("Attributes were spuriously represented as an array rather than as an empty object"),this.attributes={}):this.attributes=e}},{key:"_parseSavedState",value:function(e){switch(e){case"SAVED_LOCALLY":this._savedRemotely=!1,this._savedLocally=!0;break;case"SAVED_TO_SERVER":this._savedRemotely=!0,this._savedLocally=!0;break;default:throw new Error("Unrecognised saved state '".concat(e))}}},{key:"touch",value:function(){this.modifiedStamp=Math.floor(Date.now()/1e3),this.isPristine&&(this.isPristine=!1,this.createdStamp=this.modifiedStamp),this._savedLocally=!1,this._savedRemotely=!1}},{key:"evaluateCompletionStatus",value:function(e){var t={},n=!0;for(var r in e)if(e.hasOwnProperty(r)){var o=e[r];t[r]=o.validator?o.validator(r,o,this.attributes):o.field.isValid(r,o,this.attributes),null!==t[r]&&(n=n&&t[r])}return{requiredFieldsPresent:n,validity:t}}}],[{key:"_next",value:function(){if(n._tasks.shift(),n._tasks.length)return console.log("Running the next task."),n._tasks[0]().finally(n._next)}},{key:"retrieveFromLocal",value:function(e,t){return ld.getItem("".concat(t.TYPE,".").concat(e)).then((function(n){return n?(t.id=e,t._parseDescriptor(n),t):Promise.reject("Failed to retrieve ".concat(t.TYPE,".").concat(e," locally"))}))}}]),n}(pD);$i(YD,"_tasks",[]);var VD=function(e){Zi(n,e);var t=os(n);function n(){var e;Xi(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return $i(ns(e=t.call.apply(t,[this].concat(o))),"file",void 0),$i(ns(e),"TYPE","image"),$i(ns(e),"SAVE_ENDPOINT","/saveimage.php"),e}return zi(n,[{key:"getUrl",value:function(){}},{key:"save",value:function(e,t,n){if(this._savedRemotely)return Promise.reject("".concat(this.id," has already been saved."));var r=new FormData;return r.append("type",this.TYPE),r.append("surveyId",e),r.append("occurrenceId",t),r.append("projectId",n.toString()),r.append("imageId",this.id),r.append("image",this.file),r.append("deleted",this.deleted.toString()),console.log("queueing image post, image id ".concat(this.id)),this.queuePost(r)}},{key:"_parseDescriptor",value:function(e){as(es(n.prototype),"_parseDescriptor",this).call(this,e),this.surveyId=e.surveyId,this.occurrenceId=e.occurrenceId,this.file=e.image}}],[{key:"fromFile",value:function(e){var t=new n;return t.file=e,t}},{key:"placeholder",value:function(e){var t=new n;return t._id=e,n.imageCache.set(e,t),t}},{key:"imageLink",value:function(e,t,n,r){t=t||0,n=n||0;var o="";r.className&&(o+=' class="'.concat(r.className,'"'));var a=t>n?'width="'.concat(t,'"'):'height="'.concat(n,'"');return'<picture><source srcset="/image.php?imageid='.concat(e,'&amp;height=128&amp;format=webp" type="image/webp"><img').concat(o,' src="/image.php?imageid=').concat(e,"&amp;width=").concat(t,"&amp;height=").concat(n,'&amp;format=jpeg" ').concat(a,' alt="photo"></picture>')}}]),n}(YD);$i(VD,"imageCache",new Map),$i(VD,"EVENT_MODIFIED","modified");var JD=new WeakMap,GD=new WeakMap,qD=new WeakMap,KD=new WeakSet,WD=new WeakSet,XD=function(e){Zi(n,e);var t=os(n);function n(e){var r;return Xi(this,n),Ns(ns(r=t.call(this,e)),WD),Ns(ns(r),KD),bs(ns(r),JD,{writable:!0,value:void 0}),bs(ns(r),GD,{writable:!0,value:void 0}),bs(ns(r),qD,{writable:!0,value:void 0}),$i(ns(r),"parentForm",void 0),$i(ns(r),"_value",{images:[]}),$i(ns(r),"includeCamera",!0),$i(ns(r),"placeholder",""),e&&(e.hasOwnProperty("includeCamera")&&(r.includeCamera=e.includeCamera),e.placeholder&&(r.placeholder=e.placeholder)),r}return zi(n,[{key:"value",get:function(){var e=[];if(this._value&&this._value.images){var t,n=us(this._value.images);try{for(n.s();!(t=n.n()).done;){var r=t.value;e[e.length]=r.id}}catch(e){n.e(e)}finally{n.f()}}return e},set:function(e){if(this._value={images:[]},e){var t,n=us(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;VD.imageCache.has(r)?this._value.images.push(VD.imageCache.get(r)):(console.log("Creating placeholder image object '".concat(r,"'")),this._value.images.push(VD.placeholder(r)))}}catch(e){n.e(e)}finally{n.f()}}this.updateView()}},{key:"updateView",value:function(){if(this._fieldEl){var e,t=[],n=us(this._value.images);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push('<picture style="cursor: pointer;" data-imageid="'.concat(r.id,'"><source srcset="/image.php?imageid=').concat(r.id,'&amp;height=128&amp;format=webp" type="image/webp"><img data-imageid="').concat(r.id,'" src="/image.php?imageid=').concat(r.id,'&amp;height=128&amp;format=jpeg" height="128" alt="photo"></picture>'))}}catch(e){n.e(e)}finally{n.f()}document.getElementById(ds(this,qD)).innerHTML=t.join("\n")}}},{key:"buildField",value:function(){var e=document.createElement("div");e.className="form-group",fs(this,GD,e.id=vD.nextId),fs(this,JD,vD.nextId);var t=e.appendChild(document.createElement("label"));t.htmlFor=ds(this,JD),t.textContent=this.label;var n=e.appendChild(document.createElement("div"));n.className="input-group";var r=document.createElement("div");r.className="custom-file",n.appendChild(r);var o=r.appendChild(document.createElement("input"));if(o.type="file",o.className="custom-file-input",o.id=ds(this,JD),o.accept="image/png, image/jpeg",o.multiple=!0,this.placeholder){var a=r.appendChild(document.createElement("label"));a.className="custom-file-label",a.htmlFor=ds(this,JD),a.textContent=this.placeholder}if(this.includeCamera){var i=document.createElement("div");i.className="input-group-append";var s=i.appendChild(document.createElement("span"));s.className="input-group-text";var c=s.appendChild(document.createElement("label"));c.className="pl-0 pr-0 ml-0 mr-0 mt-0 mb-0 pt-0 pb-0 material-icons";var l=c.appendChild(document.createElement("i"));l.className="material-icons pl-0 pr-0 ml-0 mr-0 mt-0 mb-0 pt-0 pb-0",l.textContent="add_a_photo";var u=c.appendChild(document.createElement("input"));u.type="file",u.capture="environment",u.accept="image/*",u.style.display="none",u.id=vD.nextId,n.appendChild(i),u.addEventListener("change",this.inputChangeHandler.bind(this,u.id))}this.helpText&&(e.appendChild(document.createElement("small")).innerHTML=this.helpText);var d=e.appendChild(document.createElement("p"));if(fs(this,qD,d.id=vD.nextId),d.addEventListener("click",this.imageClickHandler.bind(this)),this.validationMessage){var f=e.appendChild(document.createElement("div"));f.className="invalid-feedback",f.innerHTML=this.validationMessage}o.addEventListener("change",this.inputChangeHandler.bind(this,o.id)),this._fieldEl=e,this.parentForm.addListener("deleteimage",this,"deleteImageHandler")}},{key:"deleteImageHandler",value:function(e,t,n){var r;for(var o in console.log("delete image ".concat(n)),this._value.images)if(this._value.images.hasOwnProperty(o)&&this._value.images[o].id===n){r=this._value.images.splice(o,1)[0];break}r?(this.updateView(),this.fireEvent(vD.EVENT_CHANGE)):console.log("Failed to find image id ".concat(n))}},{key:"imageClickHandler",value:function(e){var t=e.target.closest("picture");t||(t=e.target.closest("img")),console.log({"clicked image":t});var n=t.getAttribute("data-imageid");n&&(document.getElementById("imagemodal").getElementsByTagName("picture")[0].innerHTML='<source srcset="/image.php?imageid='.concat(n,"&amp;width=").concat(window.innerWidth,'&amp;format=webp" type="image/webp">\n                <img src="/image.php?imageid=').concat(n,"&amp;width=").concat(window.innerWidth,'&amp;format=jpeg" width="auto" style="max-height: 48vh; max-width: 100%;" alt="photo">'),document.getElementById("imagemodaldelete").setAttribute("data-imageid",n),$("#".concat("imagemodal")).modal({}))}},{key:"inputChangeHandler",value:function(e,t){var n=this;t.stopPropagation(),console.log("got image field input change event");var r=document.getElementById(e);r.files.length?gs(this,KD,QD).call(this,r.files).then((function(){n.fireEvent(vD.EVENT_CHANGE)})):this.fireEvent(vD.EVENT_CHANGE)}}],[{key:"isEmpty",value:function(e){return!e||0===e.length}},{key:"licenseModal",value:function(){var e=document.createElement("div");return e.innerHTML='<div class="modal fade" id="'.concat(n.LICENSE_MODAL,'" tabindex="-1" role="dialog" aria-labelledby="').concat(n.LICENSE_MODAL,'Title" aria-hidden="true">\n  <div class="modal-dialog modal-dialog-centered" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title" id="').concat(n.LICENSE_MODAL,'Title">Image licensing</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body">\n        <p>By choosing to submit images with your plant hunt records you agree to license the image under the terms of the Creative Common Attribution 4.0 International license (CC BY 4.0).</p>\n        <p>The following is a summary of (and not a substitute for) the <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">license</a>.</p>\n        <p>Licensees are free to:</p>\n        <ul class="license-properties">\n<li>\n<strong>Share</strong> â copy and redistribute the material in any medium or format\n</li>\n<li>\n<strong>Adapt</strong> â remix, transform, and build upon the material for any purpose, even commercially.\n</li>\n</ul>\n<p>Licensees are most follow these term:</p>\n<ul>\n<li>\n<p>\n<strong>Attribution</strong> â licensees must give appropriate credit, provide a link to the license, and indicate if changes were made.\n</p>\n</li>\n</ul>\n<p>Full details of the license are here: <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0 license</a></p>\n\n      </div>\n      <div class="modal-footer">\n        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\n      </div>\n    </div>\n  </div>\n</div>'),e.firstChild}}]),n}(vD);function QD(e){this.parentForm.pingOccurrence();var t,n=[],r=us(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;n.push(VD.fromFile(o))}}catch(e){r.e(e)}finally{r.f()}return gs(this,WD,zD).call(this,n)}function zD(e){var t=this;if(e.length){var n=e.shift();return n.save(this.parentForm.surveyId,this.parentForm.occurrenceId,this.parentForm.projectId).then((function(e){console.log("Added image '".concat(n.id,"'")),console.log({jsonDescription:e}),t._value.images.push(n),t.updateView()}),(function(e){console.log("Failed to add image ".concat(n.id)),console.log({"Failure reason":e})})).finally((function(){return gs(t,WD,zD).call(t,e)}))}return Promise.resolve()}$i(XD,"LICENSE_MODAL","imagelicensemodal");pH.registerSection(mH),pH.registerSection(yH);var $D=new WeakMap,ZD=new WeakMap,eF=new WeakMap,tF=new WeakSet,nF=new WeakSet,rF=new WeakSet,oF=new WeakSet,aF=new WeakSet,iF=new WeakSet,sF=new WeakSet,cF=new WeakSet,lF=new WeakSet,uF=new WeakSet,dF=new WeakSet,fF=new WeakSet,hF=function(e){Zi(n,e);var t=os(n);function n(){var e;Xi(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ns(ns(e=t.call.apply(t,[this].concat(o))),fF),Ns(ns(e),dF),Ns(ns(e),uF),Ns(ns(e),lF),Ns(ns(e),cF),Ns(ns(e),sF),Ns(ns(e),iF),Ns(ns(e),aF),Ns(ns(e),oF),Ns(ns(e),rF),Ns(ns(e),nF),Ns(ns(e),tF),$i(ns(e),"controller",void 0),bs(ns(e),$D,{writable:!0,value:{}}),bs(ns(e),ZD,{writable:!0,value:void 0}),bs(ns(e),eF,{writable:!0,value:{}}),$i(ns(e),"panelKey",""),$i(ns(e),"OCCURRENCES_ARE_LAST_SECTION",!0),e}return zi(n,[{key:"initialise",value:function(){this.controller.app.addListener(tM.EVENT_OCCURRENCE_ADDED,this,"occurrenceAddedHandler")}},{key:"setLayout",value:function(){var e=this;document.getElementById("body").innerHTML='\r\n<div class="container-fluid">\r\n    <div class="row" style="height: 90vh;">\r\n        <div class="col d-md-block pr-md-0 pt-3" id="col1panel" style="overflow-y: auto; max-height: calc(100vh - 5rem);">\r\n        </div>\r\n        <div class="col d-md-none pl-0 pr-0" id="ctrlpanel" style="background-color: aliceblue; width: 28px; max-width: 28px; overflow-y: hidden; ">\r\n            <button class="navbar-light navbar-toggler pl-0 pr-0" type="button" aria-label="Back" id="right-panel-back">\r\n                <i class="material-icons-round" style="color: gray;">view_list</i>\r\n            </button>\r\n        </div>\r\n        <div class="col d-md-block pr-md-0" id="col2panel" style="overflow-y: auto; height: 100%;">\r\n        </div>\r\n    </div>\r\n</div>\r\n',document.getElementById("right-panel-back").addEventListener("click",(function(t){t.stopPropagation(),t.preventDefault(),e.fireEvent(bI.EVENT_BACK)}))}},{key:"refreshLeftPanelAccordionState",value:function(){var e,t=document.querySelectorAll("div#".concat(this.leftPanelAccordionId,' div[data-parent="#').concat(this.leftPanelAccordionId,'"].collapse'));e=this.controller.viewSubcontext?"record"===this.controller.viewSubcontext?"record":this.controller.surveySection:"";var n,r=us(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.getAttribute("data-sectionkey")===e?o.classList.add("show"):o.classList.remove("show")}}catch(e){r.e(e)}finally{r.f()}this._refreshOccurrenceAccordionState()}},{key:"_refreshOccurrenceAccordionState",value:function(){var e,t=document.querySelectorAll("div#".concat("occurrencelistcontainer",' div[data-parent="#').concat("occurrencelistcontainer",'"].collapse')),n=this.controller.currentOccurrenceId,r=us(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;o.getAttribute("data-occurrenceid")===n?o.classList.add("show"):o.classList.remove("show")}}catch(e){r.e(e)}finally{r.f()}}},{key:"display",value:function(){if(this.controller.needsFullRefresh?(console.log("Full refresh triggered."),this.setLayout(),gs(this,aF,gF).call(this)):this.refreshLeftPanelAccordionState(),this.controller.needRightPanelRefresh)switch(this.controller.viewSubcontext){case"record":gs(this,nF,vF).call(this);break;case"survey":gs(this,tF,pF).call(this);break;default:gs(this,rF,yF).call(this)}this.setResponsivePanel(""===this.panelKey?"left":"right")}},{key:"refreshOccurrenceFooterControls",value:function(e){var t=this,n=e.appendChild(document.createElement("div")),r=n.appendChild(document.createElement("button"));if(r.className="btn btn-secondary btn-md-lg mt-2 mb-3 mr-2",r.type="button",r.textContent="back to list",r.setAttribute("data-buttonaction","back"),this.occurrenceIsMostRecent(this.controller.currentOccurrence)){var o=n.appendChild(document.createElement("button"));o.className="btn btn-primary btn-md-lg mt-2 mb-3 mr-2",o.type="button",o.textContent="add another",o.setAttribute("data-buttonaction","new")}if(this.OCCURRENCES_ARE_LAST_SECTION){var a=n.appendChild(document.createElement("button"));a.className="btn btn-primary btn-md-lg mt-2 mb-3",a.type="button",a.textContent="finish",a.setAttribute("data-buttonaction","finish")}else{var i=pH.sections[1],s=n.appendChild(document.createElement("button"));s.className="btn btn-primary btn-md-lg mt-2 mb-3",s.type="button",s.textContent="next Â»",s.setAttribute("data-buttonaction","next"),s.title=i.sectionTitle}n.addEventListener("click",(function(e){var n=e.target.closest("button");if(n&&n.hasAttribute("data-buttonaction"))switch(n.getAttribute("data-buttonaction")){case"new":t.fireEvent(bI.EVENT_NEW_RECORD);break;case"back":t.controller.app.router.navigate("/list/record/");break;case"finish":t.controller.app.router.navigate("/list/record/"),$("#".concat("finishmodal")).modal();break;case"next":t.controller.app.router.navigate("/list/survey/".concat(nextSection.sectionNavigationKey));break;default:throw new Error("Unrecognised button action ".concat(n.getAttribute("data-buttonaction")))}}))}},{key:"occurrenceIsMostRecent",value:function(e){var t,n=us(this.controller.occurrences.entries());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r[1].createdStamp>e.createdStamp&&!r[1].deleted)return!1}}catch(e){n.e(e)}finally{n.f()}return!0}},{key:"newButtonClickHandler",value:function(e){e.preventDefault(),e.stopPropagation(),this.fireEvent(bI.EVENT_NEW_RECORD)}},{key:"occurrenceAddedHandler",value:function(e,t,n){var r=document.getElementById("occurrencelistcontainer");if(r){var o=this.controller.occurrences.get(n.occurrenceId),a=document.createElement("div");a.className="card",a.id="card_".concat(o.id),a.innerHTML=gs(this,fF,_F).call(this,o),ds(this,eF)[o.id]=o.addListener(mI.EVENT_MODIFIED,this,this.occurrenceChangeHandler,{occurrenceId:o.id}),r.insertBefore(a,r.firstChild)}}},{key:"refreshOccurrenceValiditySummary",value:function(e){var t=document.getElementById("card_".concat(e.id));t&&(e.evaluateCompletionStatus(VH.properties).requiredFieldsPresent?t.classList.remove("is-invalid"):t.classList.add("is-invalid"))}},{key:"occurrenceChangeHandler",value:function(e,t,n){var r=this.controller.occurrences.get(n.occurrenceId),o=document.getElementById("card_".concat(n.occurrenceId));o&&(r.deleted?(o.parentElement.removeChild(o),ds(this,eF)[n.occurrenceId]&&(r.removeListener(mI.EVENT_MODIFIED,ds(this,eF)[n.occurrenceId]),ds(this,eF)[n.occurrenceId]=null)):(o.innerHTML=gs(this,fF,_F).call(this,r),this.refreshOccurrenceValiditySummary(r)))}},{key:"occurrenceSummaryBodyHTML",value:function(e){var t="";for(var n in e.attributes)if(e.attributes.hasOwnProperty(n)&&VH.properties.hasOwnProperty(n)&&!VH.properties[n].field.isEmpty(e.attributes[n])){var r=VH.properties[n].field.summarise(n,VH.properties[n],e.attributes);r&&(t+='<p class="ellipsed-line mb-0">'.concat(r,"</p>"))}return tM.devMode&&(t+='<p class="mb-0">(<i>id '.concat(e.id,"</i>)</p>")),t}},{key:"occurrenceSummaryHeadingHTML",value:function(e){var t="";if(e.attributes.hasOwnProperty("images")&&e.attributes.images.length){var n=e.attributes.images[0];t+=yx.imageLink(n,48,48,{className:"mr-1"})}return e.attributes.taxon&&e.attributes.taxon.taxonId?t+=e.taxon.formattedHTML(e.attributes.taxon.vernacularMatch):e.attributes.taxon&&e.attributes.taxon.taxonName?t+=function(e){try{var t=document.createElement("textarea");return t.innerHTML=e,t.innerHTML.replace(/"/g,"&quot;")}catch(t){var n=document.createElement("pre");return n.appendChild(document.createTextNode(e)),n.innerHTML.replace(/"/g,"&quot;")}}(e.attributes.taxon.taxonName):t+="<span>(unnamed plant)</span>",t}},{key:"setResponsivePanel",value:function(e){var t=document.getElementById("col2panel"),n=document.getElementById("col1panel"),r=document.getElementById("ctrlpanel");switch(e){case"left":n.classList.remove("d-none"),n.classList.add("d-block"),t.classList.remove("d-block"),t.classList.add("d-none"),r.classList.remove("d-md-none"),r.classList.add("d-none");break;case"right":n.classList.remove("d-block"),n.classList.add("d-none"),t.classList.remove("d-none"),t.classList.add("d-block"),r.classList.remove("d-none"),r.classList.add("d-md-none");break;default:throw new Error("Unrecognised panel value '".concat(e))}}}]),n}(fx);function pF(){var e=document.getElementById("col2panel"),t=this.controller.surveySection,n=pH.sectionsByKey[t]?pH.sectionsByKey[t].help:"";e.innerHTML=n||("welcome"===t?fH:"<p>placeholder survey help content for '".concat(t,"'</p>"))}function vF(){try{var e=this.controller.currentOccurrence,t=document.getElementById("col2panel");if(e){ds(this,ZD)&&ds(this,ZD).occurrenceId===e.id||(ds(this,ZD)&&ds(this,ZD).destructor(),fs(this,ZD,e.getForm()),ds(this,ZD).surveyId=this.controller.app.currentSurvey.id,t.scrollTop=0),t.innerHTML="";var n=ds(this,ZD).formElement;t.appendChild(n),ds(this,ZD).populateFormContent(),this.refreshOccurrenceFooterControls(t),$("#description_".concat(e.id)).collapse("show")}else gs(this,rF,yF).call(this,VH.help)}catch(e){console.log({error:e});var r=document.getElementById("col2panel");r?r.innerHTML="<p>".concat(e.message,"</p>"):document.body.innerHTML="<h2>Internal error</h2><p>Please report this problem:</p><p>".concat(e.message,"</p>")}}function yF(e){document.getElementById("col2panel").innerHTML=e||fH}function mF(){for(var e in ds(this,eF)){var t=this.controller.occurrences.get[e];t&&t.removeListener(mI.EVENT_MODIFIED,ds(this,eF)[e])}fs(this,eF,{})}function gF(){var e=this,t=document.getElementById("col1panel").appendChild(document.createElement("div"));t.className="accordion",this.leftPanelAccordionId=t.id=pI.nextId,gs(this,cF,NF).call(this),gs(this,lF,TF).call(this,0,t,hF.NEXT_RECORDS),gs(this,uF,EF).call(this),gs(this,dF,wF).call(this),t.addEventListener("click",(function(t){var n=t.target.closest("a");n&&n.hasAttribute("data-help-link")&&(t.preventDefault(),t.stopPropagation(),e.controller.app.router.navigate(n.getAttribute("data-help-link")))})),gs(this,sF,bF).call(this),gs(this,iF,SF).call(this)}function SF(){var e=this,t=document.body,n='<div class="modal fade" id="'.concat("deleteoccurrencemodal",'" tabindex="-1" role="dialog" aria-labelledby="').concat("deleteoccurrencemodal",'Title" aria-hidden="true">\n  <div class="modal-dialog modal-dialog-centered" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title" id="').concat("deleteoccurrencemodal",'Title">Delete record?</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body">\n        Please confirm that you wish to delete the record.\n      </div>\n      <div class="modal-footer">\n        <button type="button" class="btn btn-secondary" data-dismiss="modal">Back</button>\n        <button type="button" class="btn btn-danger" data-dismiss="modal" id="').concat("deleteoccurrencemodal",'confirmed">Delete record</button>\n      </div>\n    </div>\n  </div>\n</div>'),r=document.createElement("div");r.innerHTML=n,t.appendChild(r.firstChild),$("#".concat("deleteoccurrencemodal")).on("show.bs.modal",(function(e){var t=$(e.relatedTarget);if(t&&t.data("occurrenceid")){var n=t.data("occurrenceid");document.getElementById("".concat("deleteoccurrencemodal","confirmed")).setAttribute("data-occurrenceid",n)}})),document.getElementById("".concat("deleteoccurrencemodal","confirmed")).addEventListener("click",(function(t){var n=t.target.closest("button");if(n&&n.hasAttribute("data-occurrenceid")){var r=n.getAttribute("data-occurrenceid");console.log("Deleting occurrence ".concat(r,".")),e.fireEvent(bI.EVENT_DELETE_OCCURRENCE,r)}}));var o=document.createElement("div");o.innerHTML='<div class="modal fade" id="'.concat("finishmodal",'" tabindex="-1" role="dialog" aria-labelledby="').concat("finishmodal",'Title" aria-hidden="true">\n  <div class="modal-dialog modal-dialog-centered" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title" id="').concat("finishmodal",'Title">Thank you</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body">\n        <p>Thank you! Your form responses have been sent. If you wish, you can continue to make changes and edit or add further records.</p>\n        <p>If you provided an email address, then we will send you a message with a link to this form, so that you can return to it later if needed.</p>\n      </div>\n      <div class="modal-footer">\n        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\n      </div>\n    </div>\n  </div>\n</div>'),t.appendChild(o.firstChild),t.appendChild(XD.licenseModal());var a=document.createElement("div");a.innerHTML='<div class="modal fade" id="'.concat("imagemodal",'" tabindex="-1" role="dialog" aria-labelledby="').concat("imagemodal",'Title" aria-hidden="true">\n  <div class="modal-dialog modal-dialog-centered" role="document">\n    <div class="modal-content">\n      <div class="modal-header d-none d-md-flex">\n        <h5 class="modal-title" id="').concat("imagemodal",'Title">Photo</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body" style="position: relative;">\n        <picture>\n        </picture>\n      </div>\n      <div class="modal-footer">\n        <button type="button" id="').concat("imagemodaldelete",'" class="btn btn-outline-danger delete-occurrence-button mr-3" data-toggle="modal" data-target="#').concat("deleteimagemodal",'" data-imageid=""><i class="material-icons">delete</i></button>\n        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\n      </div>\n    </div>\n  </div>\n</div>'),t.appendChild(a.firstChild),document.getElementById("imagemodaldelete").addEventListener("click",(function(t){var n=t.target.closest("button");if(n&&n.hasAttribute("data-imageid")){var r=n.getAttribute("data-imageid");ds(e,ZD).fireEvent("deleteimage",r),$("#".concat("imagemodal")).modal("hide")}}))}function bF(){var e=this;$("#".concat("col1panel")).on("show.bs.collapse",(function(t){t.target.dataset.occurrenceid?(console.log({"left panel accordion show event (with occ id)":t}),e.fireEvent(bI.EVENT_SELECT_OCCURRENCE,{occurrenceId:t.target.dataset.occurrenceid})):t.target.dataset.sectionkey?(console.log({"left panel accordion show event (with section key)":t}),e.fireEvent(bI.EVENT_SELECT_SURVEY_SECTION,{sectionKey:t.target.dataset.sectionkey})):console.log({"left panel accordion show event (other)":t})})).on("hidden.bs.collapse",(function(t){if(console.log({"left panel accordion hide event":t}),t.target.dataset.occurrenceid){var n=e.controller.occurrences.get(t.target.dataset.occurrenceid);n.isNew&&!n.isPristine&&(n.isNew=!1,e.refreshOccurrenceValiditySummary(n)),e.controller.currentOccurrenceId===t.target.dataset.occurrenceid&&e.fireEvent(bI.EVENT_SELECT_OCCURRENCE,{occurrenceId:""})}else if(t.target.dataset.sectionkey)if("record"===t.target.dataset.sectionkey)"record"===e.controller.viewSubcontext&&e.fireEvent(bI.EVENT_SELECT_SURVEY_SECTION,{sectionKey:""});else if(ds(e,$D)[t.target.dataset.sectionkey]){var r=ds(e,$D)[t.target.dataset.sectionkey].validateForm();console.log({"survey section validity":r}),e.controller.surveySection===t.target.dataset.sectionkey&&e.fireEvent(bI.EVENT_SELECT_SURVEY_SECTION,{sectionKey:""})}}))}function NF(){var e=document.getElementById(this.leftPanelAccordionId),t=document.createElement("button");t.className="btn btn-primary",t.type="button",t.textContent="get started Â»",t.setAttribute("data-toggle","collapse"),t.setAttribute("data-target","#survey-0-about");var n=pI.nextId,r=document.createElement("div");r.innerHTML='\x3c!-- begin: templates/welcome.html --\x3e\r\n<p>Using your experience as gardener, please help us identify\r\npotentially invasive plant species in gardens before they become a problem for\r\nbiodiversity and conservation in wild situations in Britain or Ireland.</p>\r\n<p>The survey is divided into three sections and usually takes between 15 and 20 minutes to complete. You can pause and come back\r\n    later at any point.</p>\r\n<p>The information that you provide will be used by the <a href="https://www.coventry.ac.uk/research/areas-of-research/agroecology-water-resilience/" target="_blank" title="CAWR">Centre for Agroecology, Water and Resilience</a> at Coventry University and by\r\n    <a href="https://bsbi.org/" target="_blank" title="Botanical Society of Britain and Ireland">BSBI</a> for a\r\n    study of invasive plants. We\'ll include your plant records in a permanent archive held by BSBI, to help us track\r\n    long term changes in plant distribution.</p>\r\n<p>To follow up any queries about the survey we request that you please provide your name and email address. You can choose whether or not\r\n    to include your name in our archive of plant records. Your email address (if provided) will be\r\nconfidential and won\'t be archived.</p>\r\n<p>A summary of records will appear on the project website, but the full survey details including the exact location of your garden will only be accessible to the research team.</p>\r\n\x3c!-- end: templates/welcome.html --\x3e\r\n',r.appendChild(t);var o=document.createElement("span");o.className="d-md-none pl-2",o.innerHTML='(<a href="/app/list/survey/welcome/help" data-navigo="list/survey/welcome/help">more info</a>)',r.appendChild(o),e.appendChild(this.card({cardId:n,cardHeadingId:pI.nextId,collapsed:"welcome"!==this.controller.surveySection,headingButtonId:pI.nextId,headingHTML:"Welcome",headingNonbuttonHTML:"",headingValidationWarningHTML:"",cardDescriptionId:"survey-welcome",parentContainerId:e.id,bodyContentElement:r,dataAttributes:{sectionkey:"welcome"}}))}function TF(e,t,n){var r=this,o=pH.sections[e],a=new pH(o);ds(this,$D)[o.sectionNavigationKey]=a;var i=a.formElement,s=document.createElement("button");switch(s.className="btn btn-primary",s.type="button",s.textContent="next Â»",n){case hF.NEXT_RECORDS:s.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),r.fireEvent(bI.EVENT_NEXT_TO_RECORDS)}));break;case hF.NEXT_SURVEY_SECTION:var c=pH.sections[e+1];s.setAttribute("data-toggle","collapse"),s.setAttribute("data-target","#survey-".concat(e+1,"-").concat(c.sectionNavigationKey)),s.title=c.sectionTitle;break;case hF.NEXT_IS_FINAL:s.textContent="finish",s.className="btn btn-primary btn-md-lg mt-2 mb-3",s.type="button",s.addEventListener("click",(function(){r.controller.app.router.navigate("/list/"),$("#".concat("finishmodal")).modal()}));break;default:throw new Error("Unrecognized next section keyword '".concat(n,"'"))}i.appendChild(s);var l=pI.nextId;t.appendChild(this.card({cardId:l,cardHeadingId:pI.nextId,collapsed:this.controller.surveySection!==o.sectionNavigationKey,headingButtonId:pI.nextId,headingHTML:o.sectionTitle,headingNonbuttonHTML:'<small class="btn d-md-none" style="margin: 0; padding: 0;">(<a href="/app/list/survey/'.concat(o.sectionNavigationKey,'/help" data-help-link="/list/survey/').concat(o.sectionNavigationKey,'/help">help</a>)</small>'),headingValidationWarningHTML:"Please check the form for some missing responses.",cardDescriptionId:"survey-".concat(e,"-").concat(o.sectionNavigationKey),parentContainerId:t.id,bodyContentElement:i,dataAttributes:{sectionkey:o.sectionNavigationKey}})),this.controller.survey.registerForm(a),a.addListener(pH.EVENT_VALIDATION_STATE_CHANGE,this,(function(e,t,n){var r=document.getElementById(l);n?r.classList.remove("is-invalid"):r.classList.add("is-invalid")}))}function EF(){var e=document.getElementById(this.leftPanelAccordionId),t=document.createDocumentFragment();t.appendChild(document.createElement("p")).innerHTML='Records of invasive plants in your garden.<small class="d-block d-md-none"><a href="/app/list/record/help">(help)</a></small>';var n=t.appendChild(document.createElement("button"));n.type="button",n.className="btn btn-primary btn-lg mb-2",n.innerText="Add a plant record.",n.addEventListener("click",this.newButtonClickHandler.bind(this)),t.appendChild(document.createElement("div")).id="occurrencelistcontainer",e.appendChild(this.card({cardId:pI.nextId,cardHeadingId:pI.nextId,collapsed:"record"!==this.controller.viewSubcontext,headingButtonId:pI.nextId,headingHTML:"Your plant records",cardDescriptionId:pI.nextId,parentContainerId:e.id,bodyContentElement:t,dataAttributes:{sectionkey:"record"}}))}function wF(){var e=document.getElementById("occurrencelistcontainer");if(!e)throw new gI("Failed to find list container.");gs(this,oF,mF).call(this);var t,n=[],r=us(ss(this.controller.occurrences.entries()).sort((function(e,t){return t[1].createdStamp-e[1].createdStamp})));try{for(r.s();!(t=r.n()).done;){var o=t.value[1];if(!o.deleted){var a=o.isNew||o.evaluateCompletionStatus(VH.properties).requiredFieldsPresent;n.push('<div class="card'.concat(a?"":" is-invalid",'" id="card_').concat(o.id,'">\n    ').concat(gs(this,fF,_F).call(this,o),"\n</div>")),ds(this,eF)[o.id]=o.addListener(mI.EVENT_MODIFIED,this,this.occurrenceChangeHandler,{occurrenceId:o.id})}}}catch(e){r.e(e)}finally{r.f()}e.className="accordion",e.innerHTML=n.join(""),e.addEventListener("click",(function(e){var t=e.target.closest("button");t&&t.hasAttribute("data-toggle")&&"modal"===t.getAttribute("data-toggle")&&(document.getElementById("".concat("deleteoccurrencemodal","confirmed")).setAttribute("data-occurrenceid",t.getAttribute("data-occurrenceid")),$(t.getAttribute("data-target")).modal(),e.preventDefault(),e.stopPropagation())}))}function _F(e){return'<div class="card-header pointer pl-2 pr-2 pt-2 pb-2" id="heading_'.concat(e.id,'" data-toggle="collapse" data-target="#description_').concat(e.id,'">\n    <div class="float-right">\n        <button type="button" class="btn btn-outline-danger delete-occurrence-button" data-toggle="modal" data-target="#').concat("deleteoccurrencemodal",'" data-occurrenceid="').concat(e.id,'"><i class="material-icons">delete</i></button>\n    </div>\n    <h2 class="mb-0 pb-0 mt-0 pt-0 pl-0 ml-0">\n        <button class="btn btn-link').concat(this.controller.currentOccurrenceId===e.id?"":" collapsed",' pt-0 pb-0 pl-0" id="headingbutton_').concat(e.id,'" type="button" data-toggle="collapse" data-target="#description_').concat(e.id,'" aria-expanded="').concat(this.controller.currentOccurrenceId===e.id?"true":"false",'" aria-controls="description_').concat(e.id,'">\n          ').concat(this.occurrenceSummaryHeadingHTML(e),'\n        </button>\n    </h2>\n    <div class="card-invalid-feedback">\n        <small>Please check for errors or missing details.</small>\n    </div>\n</div>\n<div id="description_').concat(e.id,'" class="collapse').concat(this.controller.currentOccurrenceId===e.id?" show":"",'" aria-labelledby="heading_').concat(e.id,'" data-parent="#').concat("occurrencelistcontainer",'" data-occurrenceid="').concat(e.id,'">\n  <div class="card-body">\n    ').concat(this.occurrenceSummaryBodyHTML(e),"\n  </div>\n</div>")}$i(hF,"NEXT_RECORDS","records"),$i(hF,"NEXT_SURVEY_SECTION","survey"),$i(hF,"NEXT_IS_FINAL","last");var OF=function(e){Zi(n,e);var t=os(n);function n(){return Xi(this,n),t.apply(this,arguments)}return zi(n,[{key:"body",value:function(){document.getElementById("body").innerHTML='\x3c!-- begin: templates/helpPage.html --\x3e\r\n<div class="accordion" id="helpaccordion">\r\n    <div class="card">\r\n        <div class="card-header" id="helphelpheadingOne">\r\n            <h5 class="mb-0">\r\n                <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">\r\n                    About the invasive plants survey\r\n                </button>\r\n            </h5>\r\n        </div>\r\n\r\n        <div id="collapseOne" class="collapse show" aria-labelledby="helpheadingOne" data-parent="#helpaccordion">\r\n            <div class="card-body">\r\n                <div style="float: right; padding-left: 12px; margin: 0;" class="d-none d-md-block"><a href="/Plant_Alert_Flyer.pdf" target="_blank" title="Plant Alert introductory leaflet (pdf)"><img src="/img/leaflet_thumb-or8.png" alt="" width="196"><p>download Plant Alert leaflet (pdf)</p></a></div>\r\n                <p>Invasive non-native plants are causing major problems\r\n                for native biodiversity, ecosystems, infrastructure, the\r\n                built environment and human health. Most of our\r\n                invasive plants were introduced as ornamental garden\r\n                    plants but then escaped into the wider environment.</p>\r\n                <p>While maintaining the benefits and contributions of nonnative plants to our gardens we need to know\r\n                    early which plants might endanger natural habitats in the future. Gardeners can play a crucial role\r\n                    as they may be the first to notice any ornamental plants that show signs of invasiveness.</p>\r\n                <p class="d-block d-md-none"><a href="/Plant_Alert_Flyer.pdf" target="_blank" title="Plant Alert introductory leaflet (pdf)">Download the Plant Alert Leaflet</a></p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="card">\r\n        <div class="card-header" id="helpheadingTwo">\r\n            <h5 class="mb-0">\r\n                <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">\r\n                    What happens to my records?\r\n                </button>\r\n            </h5>\r\n        </div>\r\n        <div id="collapseTwo" class="collapse" aria-labelledby="helpheadingTwo" data-parent="#helpaccordion">\r\n            <div class="card-body">\r\n                <p>A list of reported plants can be accessed on the website. At least once a year we will publish a summary of all records received on the webpage and in the <a href="https://bsbi.org/">BSBI\'s newsletter</a>.\r\n                Data collected will be used in risk assessments of species as well as to provide gardeners and nurseries with advice on which plants could also\r\n                    become difficult to manage in gardens.</p>\r\n                <p>The data will also be included in BSBI\'s permanent archive of plant occurrence records.</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="card">\r\n        <div class="card-header" id="helpheadingwhatreport">\r\n            <h5 class="mb-0">\r\n                <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseWhatReport" aria-expanded="false" aria-controls="collapseThree">\r\n                    Which plants should be reported?\r\n                </button>\r\n            </h5>\r\n        </div>\r\n        <div id="collapseWhatReport" class="collapse" aria-labelledby="helpheadingwhatreport" data-parent="#helpaccordion">\r\n            <div class="card-body">\r\n                <p>Many ornamental plants in your garden will spread\r\n                    and this is a sign that they are growing well. We only\r\n                    want to know about those that are spreading to an\r\n                    extent that you have to control them to prevent them\r\n                    overgrowing other plants or parts of your garden\r\n                    where you do not want them.</p>\r\n                    <p>If you do not know a plant you want to report or are\r\n                    not sure, you can submit photographs we will use to\r\n                    help with identification</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="card">\r\n        <div class="card-header" id="helpheadingThree">\r\n            <h5 class="mb-0">\r\n                <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">\r\n                    Help and support\r\n                </button>\r\n            </h5>\r\n        </div>\r\n        <div id="collapseThree" class="collapse" aria-labelledby="helpheadingThree" data-parent="#helpaccordion">\r\n            <div class="card-body">\r\n                <p>If you encounter problems, would like to provide feedback about the survey or for more information about Nyph, please contact\r\n                <a href="mailto:support@nyph.bsbi.org">support@nyph.bsbi.org</a>.</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="card">\r\n        <div class="card-header" id="helpheadingFour">\r\n            <h5 class="mb-0">\r\n                <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseThree">\r\n                    Links to further information\r\n                </button>\r\n            </h5>\r\n        </div>\r\n        <div id="collapseFour" class="collapse" aria-labelledby="helpheadingFour" data-parent="#helpaccordion">\r\n            <div class="card-body">\r\n                <p>Introductory article published in BSBI news.<br>\r\n                    Judith Conroy &amp; Katharina Dehnen-Schmutz. 2018. <a href="/GardenOrnamentals_BSBI_News_2018.pdf" target="_blank">Can gardeners help identify ornamental plants at risk\r\n                    of becoming invasive?</a> BSBI News. <strong>139</strong>: 51.</p>\r\n                <p>The findings of a pilot study for Nyph have been published:<br>\r\n                    Dehnen-Schmutz, K. &amp; Conroy, J. Biol Invasions (2018) <strong>20</strong>: 3069. <a href="https://doi.org/10.1007/s10530-018-1759-3" target="_blank">https://doi.org/10.1007/s10530-018-1759-3</a></p>\r\n                <p>Background information about invasive species can be found on the <a href="http://www.nonnativespecies.org/" target="_blank">GB Non-native Species Secretariat</a> website.</p>\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="card">\r\n        <div class="card-header" id="helpheadingFive">\r\n            <h5 class="mb-0">\r\n                <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseFive" aria-expanded="false" aria-controls="collapseThree">\r\n                    About us\r\n                </button>\r\n            </h5>\r\n        </div>\r\n        <div id="collapseFive" class="collapse" aria-labelledby="helpheadingFive" data-parent="#helpaccordion">\r\n            <div class="card-body">\r\n                Nyph is a collaboration between and the <a href="https://www.coventry.ac.uk/research/areas-of-research/agroecology-water-resilience/" title="CAWR" target="_blank">Centre for Agroecology, Water and Resilience</a> at Coventry University and the <a href="https://bsbi.org/" target="_blank" title="BSBI">Botanical Society of Britain and Ireland</a>.\r\n                <p>For more information, please contact <a href="mailto:support@nyph.bsbi.org">support@nyph.bsbi.org</a>.</p>\r\n                <p>Follow us on twitter <a href="https://twitter.com/Plant_Alert" target="_blank">@Plant_Alert</a></p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\x3c!-- end: templates/helpPage.html --\x3e\r\n<p>Version 1.0.1.1634305096</p>'}}]),n}(fx),IF=ue,RF=Tn,xF=bl,CF=f,AF=Se,kF=Bu,LF=qu;ju("match",(function(e,t,n){return[function(t){var n=CF(this),r=null==t?void 0:AF(t,e);return r?r.call(t,n):new RegExp(t)[e](xF(n))},function(e){var r=IF(this),o=xF(e),a=n(t,r,o);if(a.done)return a.value;if(!r.global)return LF(r,o);var i=r.unicode;r.lastIndex=0;for(var s,c=[],l=0;null!==(s=LF(r,o));){var u=xF(s[0]);c[l]=u,""===u&&(r.lastIndex=kF(o,RF(r.lastIndex),i)),l++}return 0===l?null:c}]}));var MF=function(e){Zi(n,e);var t=os(n);function n(e){var r;return Xi(this,n),$i(ns(r=t.call(this)),"route","/survey/:action/:id"),$i(ns(r),"title","NYPH survey picker"),$i(ns(r),"app",void 0),$i(ns(r),"view",void 0),r.view=e,e.controller=ns(r),r.handle=yd.nextHandle,r}return zi(n,[{key:"survey",get:function(){return this.app.currentSurvey}},{key:"registerRoute",value:function(e){e.on("/survey",this.mainRouteHandler.bind(this,"survey","",""),{}),e.on("/survey/new",this.newSurveyHandler.bind(this,"survey","new",""),{before:this.beforeNewHandler.bind(this)}),e.on("/survey/reset",this.mainRouteHandler.bind(this,"survey","reset",""),{before:this.beforeResetHandler.bind(this)}),e.on("/survey/save",this.mainRouteHandler.bind(this,"survey","save",""),{before:this.beforeSaveAllHandler.bind(this)}),e.on("/survey/add/:surveyId",this.addSurveyHandler.bind(this,"survey","add","")),this.app.addListener(Tx.EVENT_ADD_SURVEY_USER_REQUEST,this,this.addNewSurveyHandler),this.app.addListener(Tx.EVENT_RESET_SURVEYS,this,this.resetSurveysHandler)}},{key:"beforeNewHandler",value:function(e){$("#".concat(wx.NEW_SURVEY_MODAL_ID)).modal(),this.app.router.pause(),window.history.back(),this.app.router.resume(),e(!1)}},{key:"beforeResetHandler",value:function(e){$("#".concat(wx.RESET_MODAL_ID)).modal(),this.app.router.pause(),window.history.back(),this.app.router.resume(),e(!1)}},{key:"beforeSaveAllHandler",value:function(e){this.app.syncAll().then((function(e){console.log("In save all handler, success result: ".concat(e)),$("#".concat(wx.SAVE_ALL_SUCCESS_MODAL_ID)).modal()}),(function(e){console.log("In save all handler, failure result: ".concat(e)),$("#".concat(wx.SAVE_ALL_FAILURE_MODAL_ID)).modal()})).finally((function(){})),this.app.router.pause(),window.history.back(),this.app.router.resume(),e(!1)}},{key:"newSurveyHandler",value:function(e,t,n,r){}},{key:"addNewSurveyHandler",value:function(){console.log("reached addNewSurveyHandler"),this.app.currentControllerHandle=this.handle,this.app.clearCurrentSurvey(),this.app.setNewSurvey(),this.app.router.pause(),this.app.router.navigate("/list/survey/welcome").resume(),this.app.router.resolve()}},{key:"resetSurveysHandler",value:function(){var e=this;this.app.clearLocalForage().then((function(){e.app.reset(),e.addNewSurveyHandler()}))}},{key:"addSurveyHandler",value:function(e,t,n,r){var o=this;console.log("reached addSurveyHandler"),console.log({context:e,params:t,query:r}),this.app.currentControllerHandle=this.handle;var a=r.surveyId;if(!a||!a.match(BD))throw new Lb("Failed to match survey id '".concat(a,"', the id format appears to be incorrect"));a=a.toLowerCase(),this.app.restoreOccurrences(a).then((function(){o.app.markAllNotPristine(),o.app.router.pause(),o.app.router.navigate("/list").resume(),o.app.router.resolve()}),(function(e){console.log({"failed survey restoration":e})}))}},{key:"mainRouteHandler",value:function(e,t,n,r){console.log("reached special route handler for SurveyPickerController.js"),console.log({context:e,params:t,query:r})}}]),n}(yd);$i(MF,"EVENT_BACK","back");var PF=function(e){Zi(n,e);var t=os(n);function n(){return Xi(this,n),t.apply(this,arguments)}return zi(n,[{key:"body",value:function(){document.getElementById("body").innerHTML="<p>Placeholder survey picker content.</p>"}}]),n}(function(e){Zi(n,e);var t=os(n);function n(){var e;Xi(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return $i(ns(e=t.call.apply(t,[this].concat(o))),"controller",void 0),e}return zi(n,[{key:"initialise",value:function(){}},{key:"display",value:function(){console.log("got to view display"),this.refreshHeader(),this.body()}},{key:"refreshHeader",value:function(){}},{key:"body",value:function(){}},{key:"card",value:function(e){var t=document.createElement("div");t.id=e.cardId,t.className="card";var n=t.appendChild(document.createElement("div"));n.className="card-header pointer",e.cardHeadingId&&(n.id=e.cardHeadingId),n.setAttribute("data-toggle","collapse"),n.setAttribute("data-target","#".concat(e.cardDescriptionId));var r=n.appendChild(document.createElement("h2"));r.className="mb-0";var o=r.appendChild(document.createElement("button"));if(o.className="btn btn-link".concat(e.collapsed?" collapsed":""),e.headingButtonId&&(o.id=e.headingButtonId),o.type="button",o.setAttribute("data-toggle","collapse"),e.cardDescriptionId&&(o.setAttribute("data-target","#".concat(e.cardDescriptionId)),o.setAttribute("aria-controls",e.cardDescriptionId)),o.setAttribute("aria-expanded",e.collapsed?"false":"true"),o.innerHTML=e.headingHTML,e.headingNonbuttonHTML){var a=r.appendChild(document.createElement("span"));a.style.display="inline-block",a.innerHTML=e.headingNonbuttonHTML}if(e.headingValidationWarningHTML){var i=n.appendChild(document.createElement("div"));i.className="card-invalid-feedback",i.innerHTML="<small>".concat(e.headingValidationWarningHTML,"</small>")}var s=t.appendChild(document.createElement("div"));if(e.cardDescriptionId&&(s.id=e.cardDescriptionId),s.className="collapse".concat(e.collapsed?"":" show"),e.cardHeadingId&&s.setAttribute("aria-labelledby",e.cardHeadingId),s.setAttribute("data-parent","#".concat(e.parentContainerId)),e.dataAttributes)for(var c in e.dataAttributes)e.dataAttributes.hasOwnProperty(c)&&s.setAttribute("data-".concat(c),e.dataAttributes[c]);var l=s.appendChild(document.createElement("div"));return l.className="card-body pl-2 pr-2 pl-md-3 pr-md-3",l.appendChild(e.bodyContentElement),t}}]),n}(pD)),HF=function(e){Zi(n,e);var t=os(n);function n(){var e;Xi(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return $i(ns(e=t.call.apply(t,[this].concat(o))),"surveysMenuId","surveysmenu"),e}return n}(wx),DF={},FF=W;DF.f=FF;var jF=r,UF=m,BF=DF,YF=ee.f,VF=function(e){var t=jF.Symbol||(jF.Symbol={});UF(t,e)||YF(t,e,{value:BF.f(e)})},JF=ur,GF=r,qF=_,KF=Z,WF=D,XF=M,QF=m,zF=Es,$F=N,ZF=ne,ej=he,tj=ue,nj=p,rj=nn,oj=Ae,aj=bl,ij=De,sj=mc,cj=tc,lj=fn,uj=rM,dj=Fn,fj=qt,hj=ee,pj=Kt,vj=z.exports,yj=o.exports,mj=nt,gj=b,Sj=W,bj=DF,Nj=VF,Tj=Tr,Ej=yt,wj=WM.forEach,_j=tt("hidden"),Oj=Sj("toPrimitive"),Ij=Ej.set,Rj=Ej.getterFor("Symbol"),xj=Object.prototype,Cj=GF.Symbol,Aj=qF("JSON","stringify"),kj=fj.f,Lj=hj.f,Mj=uj.f,Pj=pj.f,Hj=yj("symbols"),Dj=yj("op-symbols"),Fj=yj("string-to-symbol-registry"),jj=yj("symbol-to-string-registry"),Uj=yj("wks"),Bj=GF.QObject,Yj=!Bj||!Bj.prototype||!Bj.prototype.findChild,Vj=KF&&XF((function(){return 7!=sj(Lj({},"a",{get:function(){return Lj(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=kj(xj,t);r&&delete xj[t],Lj(e,t,n),r&&e!==xj&&Lj(xj,t,r)}:Lj,Jj=function(e,t){var n=Hj[e]=sj(Cj.prototype);return Ij(n,{type:"Symbol",tag:e,description:t}),KF||(n.description=t),n},Gj=function(e,t,n){e===xj&&Gj(Dj,t,n),tj(e);var r=oj(t);return tj(n),QF(Hj,r)?(n.enumerable?(QF(e,_j)&&e[_j][r]&&(e[_j][r]=!1),n=sj(n,{enumerable:ij(0,!1)})):(QF(e,_j)||Lj(e,_j,ij(1,{})),e[_j][r]=!0),Vj(e,r,n)):Lj(e,r,n)},qj=function(e,t){tj(e);var n=rj(t),r=cj(n).concat(Qj(n));return wj(r,(function(t){KF&&!Kj.call(n,t)||Gj(e,t,n[t])})),e},Kj=function(e){var t=oj(e),n=Pj.call(this,t);return!(this===xj&&QF(Hj,t)&&!QF(Dj,t))&&(!(n||!QF(this,t)||!QF(Hj,t)||QF(this,_j)&&this[_j][t])||n)},Wj=function(e,t){var n=rj(e),r=oj(t);if(n!==xj||!QF(Hj,r)||QF(Dj,r)){var o=kj(n,r);return!o||!QF(Hj,r)||QF(n,_j)&&n[_j][r]||(o.enumerable=!0),o}},Xj=function(e){var t=Mj(rj(e)),n=[];return wj(t,(function(e){QF(Hj,e)||QF(mj,e)||n.push(e)})),n},Qj=function(e){var t=e===xj,n=Mj(t?Dj:rj(e)),r=[];return wj(n,(function(e){!QF(Hj,e)||t&&!QF(xj,e)||r.push(Hj[e])})),r};(WF||(vj((Cj=function(){if(this instanceof Cj)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?aj(arguments[0]):void 0,t=gj(e),n=function(e){this===xj&&n.call(Dj,e),QF(this,_j)&&QF(this[_j],t)&&(this[_j][t]=!1),Vj(this,t,ij(1,e))};return KF&&Yj&&Vj(xj,t,{configurable:!0,set:n}),Jj(t,e)}).prototype,"toString",(function(){return Rj(this).tag})),vj(Cj,"withoutSetter",(function(e){return Jj(gj(e),e)})),pj.f=Kj,hj.f=Gj,fj.f=Wj,lj.f=uj.f=Xj,dj.f=Qj,bj.f=function(e){return Jj(Sj(e),e)},KF&&(Lj(Cj.prototype,"description",{configurable:!0,get:function(){return Rj(this).description}}),vj(xj,"propertyIsEnumerable",Kj,{unsafe:!0}))),JF({global:!0,wrap:!0,forced:!WF,sham:!WF},{Symbol:Cj}),wj(cj(Uj),(function(e){Nj(e)})),JF({target:"Symbol",stat:!0,forced:!WF},{for:function(e){var t=aj(e);if(QF(Fj,t))return Fj[t];var n=Cj(t);return Fj[t]=n,jj[n]=t,n},keyFor:function(e){if(!ej(e))throw TypeError(e+" is not a symbol");if(QF(jj,e))return jj[e]},useSetter:function(){Yj=!0},useSimple:function(){Yj=!1}}),JF({target:"Object",stat:!0,forced:!WF,sham:!KF},{create:function(e,t){return void 0===t?sj(e):qj(sj(e),t)},defineProperty:Gj,defineProperties:qj,getOwnPropertyDescriptor:Wj}),JF({target:"Object",stat:!0,forced:!WF},{getOwnPropertyNames:Xj,getOwnPropertySymbols:Qj}),JF({target:"Object",stat:!0,forced:XF((function(){dj.f(1)}))},{getOwnPropertySymbols:function(e){return dj.f(nj(e))}}),Aj)&&JF({target:"JSON",stat:!0,forced:!WF||XF((function(){var e=Cj();return"[null]"!=Aj([e])||"{}"!=Aj({a:e})||"{}"!=Aj(Object(e))}))},{stringify:function(e,t,n){for(var r,o=[e],a=1;arguments.length>a;)o.push(arguments[a++]);if(r=t,(ZF(t)||void 0!==e)&&!ej(e))return zF(t)||(t=function(e,t){if($F(r)&&(t=r.call(this,e,t)),!ej(t))return t}),o[1]=t,Aj.apply(null,o)}});if(!Cj.prototype[Oj]){var zj=Cj.prototype.valueOf;vj(Cj.prototype,Oj,(function(){return zj.apply(this,arguments)}))}Tj(Cj,"Symbol"),mj[_j]=!0;var $j=ur,Zj=Z,eU=r,tU=m,nU=N,rU=ne,oU=ee.f,aU=Kn,iU=eU.Symbol;if(Zj&&nU(iU)&&(!("description"in iU.prototype)||void 0!==iU().description)){var sU={},cU=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof cU?new iU(e):void 0===e?iU():iU(e);return""===e&&(sU[t]=!0),t};aU(cU,iU);var lU=cU.prototype=iU.prototype;lU.constructor=cU;var uU=lU.toString,dU="Symbol(test)"==String(iU("test")),fU=/^Symbol\((.*)\)[^)]+$/;oU(lU,"description",{configurable:!0,get:function(){var e=rU(this)?this.valueOf():this,t=uU.call(e);if(tU(sU,e))return"";var n=dU?t.slice(7,-1):t.replace(fU,"$1");return""===n?void 0:n}}),$j({global:!0,forced:!0},{Symbol:cU})}VF("asyncIterator"),VF("hasInstance"),VF("isConcatSpreadable"),VF("iterator"),VF("match"),VF("matchAll"),VF("replace"),VF("search"),VF("species"),VF("split"),VF("toPrimitive"),VF("toStringTag"),VF("unscopables");var hU=ne,pU=Ue,vU=ur,yU=Lc,mU=gr,gU=Kn,SU=mc,bU=Ue,NU=De,TU=function(e,t){hU(t)&&"cause"in t&&pU(e,"cause",t.cause)},EU=no,wU=bl,_U=function(e,t){var n=this,r=arguments.length>2?arguments[2]:void 0;if(!(n instanceof _U))return new _U(e,t,r);mU&&(n=mU(new Error(void 0),yU(n))),void 0!==t&&bU(n,"message",wU(t)),TU(n,r);var o=[];return EU(e,o.push,{that:o}),bU(n,"errors",o),n};mU?mU(_U,Error):gU(_U,Error),_U.prototype=SU(Error.prototype,{constructor:NU(1,_U),message:NU(1,""),name:NU(1,"AggregateError")}),vU({global:!0},{AggregateError:_U});var OU=p,IU=wn,RU=vn,xU=_c;ur({target:"Array",proto:!0},{at:function(e){var t=OU(this),n=IU(t),r=RU(e),o=r>=0?r:n+r;return o<0||o>=n?void 0:t[o]}}),xU("at");var CU=p,AU=Sn,kU=wn,LU=Math.min,MU=[].copyWithin||function(e,t){var n=CU(this),r=kU(n),o=AU(e,r),a=AU(t,r),i=arguments.length>2?arguments[2]:void 0,s=LU((void 0===i?r:AU(i,r))-a,r-o),c=1;for(a<o&&o<a+s&&(c=-1,a+=s-1,o+=s-1);s-- >0;)a in n?n[o]=n[a]:delete n[o],o+=c,a+=c;return n},PU=_c;ur({target:"Array",proto:!0},{copyWithin:MU}),PU("copyWithin");var HU=WM.every;ur({target:"Array",proto:!0,forced:!kP("every")},{every:function(e){return HU(this,e,arguments.length>1?arguments[1]:void 0)}});var DU=p,FU=Sn,jU=wn,UU=function(e){for(var t=DU(this),n=jU(t),r=arguments.length,o=FU(r>1?arguments[1]:void 0,n),a=r>2?arguments[2]:void 0,i=void 0===a?n:FU(a,n);i>o;)t[o++]=e;return t},BU=_c;ur({target:"Array",proto:!0},{fill:UU}),BU("fill");var YU=WM.filter;ur({target:"Array",proto:!0,forced:!Ds("filter")},{filter:function(e){return YU(this,e,arguments.length>1?arguments[1]:void 0)}});var VU=ur,JU=WM.find,GU=_c,qU=!0;"find"in[]&&Array(1).find((function(){qU=!1})),VU({target:"Array",proto:!0,forced:qU},{find:function(e){return JU(this,e,arguments.length>1?arguments[1]:void 0)}}),GU("find");var KU=ur,WU=WM.findIndex,XU=_c,QU=!0;"findIndex"in[]&&Array(1).findIndex((function(){QU=!1})),KU({target:"Array",proto:!0,forced:QU},{findIndex:function(e){return WU(this,e,arguments.length>1?arguments[1]:void 0)}}),XU("findIndex");var zU=Es,$U=wn,ZU=Pr,eB=function(e,t,n,r,o,a,i,s){for(var c,l,u=o,d=0,f=!!i&&ZU(i,s,3);d<r;){if(d in n){if(c=f?f(n[d],d,t):n[d],a>0&&zU(c))l=$U(c),u=eB(e,t,c,l,u,a-1)-1;else{if(u>=9007199254740991)throw TypeError("Exceed the acceptable array length");e[u]=c}u++}d++}return u},tB=eB,nB=tB,rB=p,oB=wn,aB=vn,iB=Ls;ur({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=rB(this),n=oB(t),r=iB(t,0);return r.length=nB(r,t,t,n,0,void 0===e?1:aB(e)),r}});var sB=tB,cB=me,lB=p,uB=wn,dB=Ls;ur({target:"Array",proto:!0},{flatMap:function(e){var t,n=lB(this),r=uB(n);return cB(e),(t=dB(n,0)).length=sB(t,n,n,r,0,1,e,arguments.length>1?arguments[1]:void 0),t}});var fB=WM.forEach,hB=kP("forEach")?[].forEach:function(e){return fB(this,e,arguments.length>1?arguments[1]:void 0)};ur({target:"Array",proto:!0,forced:[].forEach!=hB},{forEach:hB});var pB=ue,vB=Kr,yB=Pr,mB=p,gB=function(e,t,n,r){try{return r?t(pB(n)[0],n[1]):t(n)}catch(t){vB(e,"throw",t)}},SB=Lr,bB=Eo,NB=wn,TB=Is,EB=Jr,wB=Ur,_B=function(e){var t=mB(e),n=bB(this),r=arguments.length,o=r>1?arguments[1]:void 0,a=void 0!==o;a&&(o=yB(o,r>2?arguments[2]:void 0,2));var i,s,c,l,u,d,f=wB(t),h=0;if(!f||this==Array&&SB(f))for(i=NB(t),s=n?new this(i):Array(i);i>h;h++)d=a?o(t[h],h):t[h],TB(s,h,d);else for(u=(l=EB(t,f)).next,s=n?new this:[];!(c=u.call(l)).done;h++)d=a?gB(l,o,[c.value,h],!0):c.value,TB(s,h,d);return s.length=h,s},OB=_B;ur({target:"Array",stat:!0,forced:!fo((function(e){Array.from(e)}))},{from:OB});var IB=ur,RB=xn.indexOf,xB=kP,CB=[].indexOf,AB=!!CB&&1/[1].indexOf(1,-0)<0,kB=xB("indexOf");IB({target:"Array",proto:!0,forced:AB||!kB},{indexOf:function(e){return AB?CB.apply(this,arguments)||0:RB(this,e,arguments.length>1?arguments[1]:void 0)}}),ur({target:"Array",stat:!0},{isArray:Es});var LB=nn,MB=vn,PB=wn,HB=kP,DB=Math.min,FB=[].lastIndexOf,jB=!!FB&&1/[1].lastIndexOf(1,-0)<0,UB=HB("lastIndexOf"),BB=jB||!UB?function(e){if(jB)return FB.apply(this,arguments)||0;var t=LB(this),n=PB(t),r=n-1;for(arguments.length>1&&(r=DB(r,MB(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}:FB;ur({target:"Array",proto:!0,forced:BB!==[].lastIndexOf},{lastIndexOf:BB});var YB=WM.map;ur({target:"Array",proto:!0,forced:!Ds("map")},{map:function(e){return YB(this,e,arguments.length>1?arguments[1]:void 0)}});var VB=Eo,JB=Is;ur({target:"Array",stat:!0,forced:M((function(){function e(){}return!(Array.of.call(e)instanceof e)}))},{of:function(){for(var e=0,t=arguments.length,n=new(VB(this)?this:Array)(t);t>e;)JB(n,e,arguments[e++]);return n.length=t,n}});var GB=me,qB=p,KB=Zt,WB=wn,XB=function(e){return function(t,n,r,o){GB(n);var a=qB(t),i=KB(a),s=WB(a),c=e?s-1:0,l=e?-1:1;if(r<2)for(;;){if(c in i){o=i[c],c+=l;break}if(c+=l,e?c<0:s<=c)throw TypeError("Reduce of empty array with no initial value")}for(;e?c>=0:s>c;c+=l)c in i&&(o=n(o,i[c],c,a));return o}},QB={left:XB(!1),right:XB(!0)},zB=QB.left,$B=L,ZB=Lo;ur({target:"Array",proto:!0,forced:!kP("reduce")||!ZB&&$B>79&&$B<83},{reduce:function(e){return zB(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var eY=QB.right,tY=L,nY=Lo;ur({target:"Array",proto:!0,forced:!kP("reduceRight")||!nY&&tY>79&&tY<83},{reduceRight:function(e){return eY(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var rY=Es,oY=[].reverse,aY=[1,2];ur({target:"Array",proto:!0,forced:String(aY)===String(aY.reverse())},{reverse:function(){return rY(this)&&(this.length=this.length),oY.call(this)}});var iY=ur,sY=Es,cY=Eo,lY=ne,uY=Sn,dY=wn,fY=nn,hY=Is,pY=W,vY=Ds("slice"),yY=pY("species"),mY=[].slice,gY=Math.max;iY({target:"Array",proto:!0,forced:!vY},{slice:function(e,t){var n,r,o,a=fY(this),i=dY(a),s=uY(e,i),c=uY(void 0===t?i:t,i);if(sY(a)&&(n=a.constructor,(cY(n)&&(n===Array||sY(n.prototype))||lY(n)&&null===(n=n[yY]))&&(n=void 0),n===Array||void 0===n))return mY.call(a,s,c);for(r=new(void 0===n?Array:n)(gY(c-s,0)),o=0;s<c;s++,o++)s in a&&hY(r,o,a[s]);return r.length=o,r}});var SY=WM.some;ur({target:"Array",proto:!0,forced:!kP("some")},{some:function(e){return SY(this,e,arguments.length>1?arguments[1]:void 0)}}),Ir("Array"),_c("flat"),_c("flatMap");var bY="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,NY=vn,TY=Tn,EY=function(e){if(void 0===e)return 0;var t=NY(e),n=TY(t);if(t!==n)throw RangeError("Wrong length or index");return n},wY=Math.abs,_Y=Math.pow,OY=Math.floor,IY=Math.log,RY=Math.LN2,xY=r,CY=Z,AY=bY,kY=Tt,LY=Ue,MY=hr,PY=M,HY=Rr,DY=vn,FY=Tn,jY=EY,UY={pack:function(e,t,n){var r,o,a,i=new Array(n),s=8*n-t-1,c=(1<<s)-1,l=c>>1,u=23===t?_Y(2,-24)-_Y(2,-77):0,d=e<0||0===e&&1/e<0?1:0,f=0;for((e=wY(e))!=e||e===1/0?(o=e!=e?1:0,r=c):(r=OY(IY(e)/RY),e*(a=_Y(2,-r))<1&&(r--,a*=2),(e+=r+l>=1?u/a:u*_Y(2,1-l))*a>=2&&(r++,a/=2),r+l>=c?(o=0,r=c):r+l>=1?(o=(e*a-1)*_Y(2,t),r+=l):(o=e*_Y(2,l-1)*_Y(2,t),r=0));t>=8;i[f++]=255&o,o/=256,t-=8);for(r=r<<t|o,s+=t;s>0;i[f++]=255&r,r/=256,s-=8);return i[--f]|=128*d,i},unpack:function(e,t){var n,r=e.length,o=8*r-t-1,a=(1<<o)-1,i=a>>1,s=o-7,c=r-1,l=e[c--],u=127&l;for(l>>=7;s>0;u=256*u+e[c],c--,s-=8);for(n=u&(1<<-s)-1,u>>=-s,s+=t;s>0;n=256*n+e[c],c--,s-=8);if(0===u)u=1-i;else{if(u===a)return n?NaN:l?-1/0:1/0;n+=_Y(2,t),u-=i}return(l?-1:1)*n*_Y(2,u-t)}},BY=Lc,YY=gr,VY=fn.f,JY=ee.f,GY=UU,qY=Tr,KY=kY.PROPER,WY=kY.CONFIGURABLE,XY=yt.get,QY=yt.set,zY=xY.ArrayBuffer,$Y=zY,ZY=xY.DataView,eV=ZY&&ZY.prototype,tV=Object.prototype,nV=xY.RangeError,rV=UY.pack,oV=UY.unpack,aV=function(e){return[255&e]},iV=function(e){return[255&e,e>>8&255]},sV=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},cV=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},lV=function(e){return rV(e,23,4)},uV=function(e){return rV(e,52,8)},dV=function(e,t){JY(e.prototype,t,{get:function(){return XY(this)[t]}})},fV=function(e,t,n,r){var o=jY(n),a=XY(e);if(o+t>a.byteLength)throw nV("Wrong index");var i=XY(a.buffer).bytes,s=o+a.byteOffset,c=i.slice(s,s+t);return r?c:c.reverse()},hV=function(e,t,n,r,o,a){var i=jY(n),s=XY(e);if(i+t>s.byteLength)throw nV("Wrong index");for(var c=XY(s.buffer).bytes,l=i+s.byteOffset,u=r(+o),d=0;d<t;d++)c[l+d]=u[a?d:t-d-1]};if(AY){var pV=KY&&"ArrayBuffer"!==zY.name;if(PY((function(){zY(1)}))&&PY((function(){new zY(-1)}))&&!PY((function(){return new zY,new zY(1.5),new zY(NaN),pV&&!WY})))pV&&WY&&LY(zY,"name","ArrayBuffer");else{for(var vV,yV=($Y=function(e){return HY(this,$Y),new zY(jY(e))}).prototype=zY.prototype,mV=VY(zY),gV=0;mV.length>gV;)(vV=mV[gV++])in $Y||LY($Y,vV,zY[vV]);yV.constructor=$Y}YY&&BY(eV)!==tV&&YY(eV,tV);var SV=new ZY(new $Y(2)),bV=eV.setInt8;SV.setInt8(0,2147483648),SV.setInt8(1,2147483649),!SV.getInt8(0)&&SV.getInt8(1)||MY(eV,{setInt8:function(e,t){bV.call(this,e,t<<24>>24)},setUint8:function(e,t){bV.call(this,e,t<<24>>24)}},{unsafe:!0})}else $Y=function(e){HY(this,$Y,"ArrayBuffer");var t=jY(e);QY(this,{bytes:GY.call(new Array(t),0),byteLength:t}),CY||(this.byteLength=t)},ZY=function(e,t,n){HY(this,ZY,"DataView"),HY(e,$Y,"DataView");var r=XY(e).byteLength,o=DY(t);if(o<0||o>r)throw nV("Wrong offset");if(o+(n=void 0===n?r-o:FY(n))>r)throw nV("Wrong length");QY(this,{buffer:e,byteLength:n,byteOffset:o}),CY||(this.buffer=e,this.byteLength=n,this.byteOffset=o)},CY&&(dV($Y,"byteLength"),dV(ZY,"buffer"),dV(ZY,"byteLength"),dV(ZY,"byteOffset")),MY(ZY.prototype,{getInt8:function(e){return fV(this,1,e)[0]<<24>>24},getUint8:function(e){return fV(this,1,e)[0]},getInt16:function(e){var t=fV(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=fV(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return cV(fV(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return cV(fV(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return oV(fV(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return oV(fV(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){hV(this,1,e,aV,t)},setUint8:function(e,t){hV(this,1,e,aV,t)},setInt16:function(e,t){hV(this,2,e,iV,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){hV(this,2,e,iV,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){hV(this,4,e,sV,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){hV(this,4,e,sV,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){hV(this,4,e,lV,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){hV(this,8,e,uV,t,arguments.length>2?arguments[2]:void 0)}});qY($Y,"ArrayBuffer"),qY(ZY,"DataView");var NV={ArrayBuffer:$Y,DataView:ZY},TV=Ir,EV=NV.ArrayBuffer;ur({global:!0,forced:r.ArrayBuffer!==EV},{ArrayBuffer:EV}),TV("ArrayBuffer");var wV,_V,OV,IV=bY,RV=Z,xV=r,CV=N,AV=ne,kV=m,LV=Ut,MV=pe,PV=Ue,HV=z.exports,DV=ee.f,FV=Lc,jV=gr,UV=W,BV=b,YV=xV.Int8Array,VV=YV&&YV.prototype,JV=xV.Uint8ClampedArray,GV=JV&&JV.prototype,qV=YV&&FV(YV),KV=VV&&FV(VV),WV=Object.prototype,XV=WV.isPrototypeOf,QV=UV("toStringTag"),zV=BV("TYPED_ARRAY_TAG"),$V=BV("TYPED_ARRAY_CONSTRUCTOR"),ZV=IV&&!!jV&&"Opera"!==LV(xV.opera),eJ=!1,tJ={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},nJ={BigInt64Array:8,BigUint64Array:8},rJ=function(e){if(!AV(e))return!1;var t=LV(e);return kV(tJ,t)||kV(nJ,t)};for(wV in tJ)(OV=(_V=xV[wV])&&_V.prototype)?PV(OV,$V,_V):ZV=!1;for(wV in nJ)(OV=(_V=xV[wV])&&_V.prototype)&&PV(OV,$V,_V);if((!ZV||!CV(qV)||qV===Function.prototype)&&(qV=function(){throw TypeError("Incorrect invocation")},ZV))for(wV in tJ)xV[wV]&&jV(xV[wV],qV);if((!ZV||!KV||KV===WV)&&(KV=qV.prototype,ZV))for(wV in tJ)xV[wV]&&jV(xV[wV].prototype,KV);if(ZV&&FV(GV)!==KV&&jV(GV,KV),RV&&!kV(KV,QV))for(wV in eJ=!0,DV(KV,QV,{get:function(){return AV(this)?this[zV]:void 0}}),tJ)xV[wV]&&PV(xV[wV],zV,wV);var oJ={NATIVE_ARRAY_BUFFER_VIEWS:ZV,TYPED_ARRAY_CONSTRUCTOR:$V,TYPED_ARRAY_TAG:eJ&&zV,aTypedArray:function(e){if(rJ(e))return e;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(e){if(CV(e)&&(!jV||XV.call(qV,e)))return e;throw TypeError(MV(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n){if(RV){if(n)for(var r in tJ){var o=xV[r];if(o&&kV(o.prototype,e))try{delete o.prototype[e]}catch(e){}}KV[e]&&!n||HV(KV,e,n?t:ZV&&VV[e]||t)}},exportTypedArrayStaticMethod:function(e,t,n){var r,o;if(RV){if(jV){if(n)for(r in tJ)if((o=xV[r])&&kV(o,e))try{delete o[e]}catch(e){}if(qV[e]&&!n)return;try{return HV(qV,e,n?t:ZV&&qV[e]||t)}catch(e){}}for(r in tJ)!(o=xV[r])||o[e]&&!n||HV(o,e,t)}},isView:function(e){if(!AV(e))return!1;var t=LV(e);return"DataView"===t||kV(tJ,t)||kV(nJ,t)},isTypedArray:rJ,TypedArray:qV,TypedArrayPrototype:KV};ur({target:"ArrayBuffer",stat:!0,forced:!oJ.NATIVE_ARRAY_BUFFER_VIEWS},{isView:oJ.isView});var aJ=ur,iJ=M,sJ=ue,cJ=Sn,lJ=Tn,uJ=Co,dJ=NV.ArrayBuffer,fJ=NV.DataView,hJ=dJ.prototype.slice;aJ({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:iJ((function(){return!new dJ(2).slice(1,void 0).byteLength}))},{slice:function(e,t){if(void 0!==hJ&&void 0===t)return hJ.call(sJ(this),e);for(var n=sJ(this).byteLength,r=cJ(e,n),o=cJ(void 0===t?n:t,n),a=new(uJ(this,dJ))(lJ(o-r)),i=new fJ(this),s=new fJ(a),c=0;r<o;)s.setUint8(c++,i.getUint8(r++));return a}}),ur({global:!0,forced:!bY},{DataView:NV.DataView});var pJ=ur,vJ=M((function(){return 120!==new Date(16e11).getYear()})),yJ=Date.prototype.getFullYear;pJ({target:"Date",proto:!0,forced:vJ},{getYear:function(){return yJ.call(this)-1900}}),ur({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}});var mJ=ur,gJ=vn,SJ=Date.prototype.getTime,bJ=Date.prototype.setFullYear;mJ({target:"Date",proto:!0},{setYear:function(e){SJ.call(this);var t=gJ(e),n=0<=t&&t<=99?t+1900:t;return bJ.call(this,n)}}),ur({target:"Date",proto:!0},{toGMTString:Date.prototype.toUTCString});var NJ=vn,TJ=bl,EJ=f,wJ=function(e){var t=TJ(EJ(this)),n="",r=NJ(e);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n},_J=Tn,OJ=bl,IJ=wJ,RJ=f,xJ=Math.ceil,CJ=function(e){return function(t,n,r){var o,a,i=OJ(RJ(t)),s=_J(n),c=i.length,l=void 0===r?" ":OJ(r);return s<=c||""==l?i:(o=s-c,(a=IJ.call(l,xJ(o/l.length))).length>o&&(a=a.slice(0,o)),e?i+a:a+i)}},AJ={start:CJ(!1),end:CJ(!0)},kJ=M,LJ=AJ.start,MJ=Math.abs,PJ=Date.prototype,HJ=PJ.getTime,DJ=PJ.toISOString,FJ=kJ((function(){return"0385-07-25T07:06:39.999Z"!=DJ.call(new Date(-50000000000001))}))||!kJ((function(){DJ.call(new Date(NaN))}))?function(){if(!isFinite(HJ.call(this)))throw RangeError("Invalid time value");var e=this.getUTCFullYear(),t=this.getUTCMilliseconds(),n=e<0?"-":e>9999?"+":"";return n+LJ(MJ(e),n?6:4,0)+"-"+LJ(this.getUTCMonth()+1,2,0)+"-"+LJ(this.getUTCDate(),2,0)+"T"+LJ(this.getUTCHours(),2,0)+":"+LJ(this.getUTCMinutes(),2,0)+":"+LJ(this.getUTCSeconds(),2,0)+"."+LJ(t,3,0)+"Z"}:DJ;ur({target:"Date",proto:!0,forced:Date.prototype.toISOString!==FJ},{toISOString:FJ});var jJ=p,UJ=Re;ur({target:"Date",proto:!0,forced:M((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}))},{toJSON:function(e){var t=jJ(this),n=UJ(t,"number");return"number"!=typeof n||isFinite(n)?t.toISOString():null}});var BJ=ue,YJ=Te,VJ=z.exports,JJ=function(e){if(BJ(this),"string"===e||"default"===e)e="string";else if("number"!==e)throw TypeError("Incorrect hint");return YJ(this,e)},GJ=W("toPrimitive"),qJ=Date.prototype;GJ in qJ||VJ(qJ,GJ,JJ);var KJ=z.exports,WJ=Date.prototype,XJ=WJ.toString,QJ=WJ.getTime;"Invalid Date"!=String(new Date(NaN))&&KJ(WJ,"toString",(function(){var e=QJ.call(this);return e==e?XJ.call(this):"Invalid Date"}));var zJ=bl,$J=/[\w*+\-./@]/,ZJ=function(e,t){for(var n=e.toString(16);n.length<t;)n="0"+n;return n};ur({global:!0},{escape:function(e){for(var t,n,r=zJ(e),o="",a=r.length,i=0;i<a;)t=r.charAt(i++),$J.test(t)?o+=t:o+=(n=t.charCodeAt(0))<256?"%"+ZJ(n,2):"%u"+ZJ(n,4).toUpperCase();return o}});var eG=me,tG=ne,nG=[].slice,rG={},oG=function(e,t,n){if(!(t in rG)){for(var r=[],o=0;o<t;o++)r[o]="a["+o+"]";rG[t]=Function("C,a","return new C("+r.join(",")+")")}return rG[t](e,n)},aG=Function.bind||function(e){var t=eG(this),n=nG.call(arguments,1),r=function(){var o=n.concat(nG.call(arguments));return this instanceof r?oG(t,o.length,o):t.apply(e,o)};return tG(t.prototype)&&(r.prototype=t.prototype),r};ur({target:"Function",proto:!0},{bind:aG});var iG=N,sG=ne,cG=ee,lG=Lc,uG=W("hasInstance"),dG=Function.prototype;uG in dG||cG.f(dG,uG,{value:function(e){if(!iG(this)||!sG(e))return!1;if(!sG(this.prototype))return e instanceof this;for(;e=lG(e);)if(this.prototype===e)return!0;return!1}});var fG=Z,hG=Tt.EXISTS,pG=ee.f,vG=Function.prototype,yG=vG.toString,mG=/^\s*function ([^ (]*)/;fG&&!hG&&pG(vG,"name",{configurable:!0,get:function(){try{return yG.call(this).match(mG)[1]}catch(e){return""}}}),ur({global:!0},{globalThis:r});var gG=ur,SG=M,bG=_("JSON","stringify"),NG=/[\uD800-\uDFFF]/g,TG=/^[\uD800-\uDBFF]$/,EG=/^[\uDC00-\uDFFF]$/,wG=function(e,t,n){var r=n.charAt(t-1),o=n.charAt(t+1);return TG.test(e)&&!EG.test(o)||EG.test(e)&&!TG.test(r)?"\\u"+e.charCodeAt(0).toString(16):e},_G=SG((function(){return'"\\udf06\\ud834"'!==bG("\udf06\ud834")||'"\\udead"'!==bG("\udead")}));bG&&gG({target:"JSON",stat:!0,forced:_G},{stringify:function(e,t,n){var r=bG.apply(null,arguments);return"string"==typeof r?r.replace(NG,wG):r}}),Tr(r.JSON,"JSON",!0);var OG=Math.log,IG=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:OG(1+e)},RG=ur,xG=IG,CG=Math.acosh,AG=Math.log,kG=Math.sqrt,LG=Math.LN2;RG({target:"Math",stat:!0,forced:!CG||710!=Math.floor(CG(Number.MAX_VALUE))||CG(1/0)!=1/0},{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?AG(e)+LG:xG(e-1+kG(e-1)*kG(e+1))}});var MG=ur,PG=Math.asinh,HG=Math.log,DG=Math.sqrt;MG({target:"Math",stat:!0,forced:!(PG&&1/PG(0)>0)},{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):HG(t+DG(t*t+1)):t}});var FG=ur,jG=Math.atanh,UG=Math.log;FG({target:"Math",stat:!0,forced:!(jG&&1/jG(-0)<0)},{atanh:function(e){return 0==(e=+e)?e:UG((1+e)/(1-e))/2}});var BG=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1},YG=ur,VG=BG,JG=Math.abs,GG=Math.pow;YG({target:"Math",stat:!0},{cbrt:function(e){return VG(e=+e)*GG(JG(e),1/3)}});var qG=ur,KG=Math.floor,WG=Math.log,XG=Math.LOG2E;qG({target:"Math",stat:!0},{clz32:function(e){return(e>>>=0)?31-KG(WG(e+.5)*XG):32}});var QG=Math.expm1,zG=Math.exp,$G=!QG||QG(10)>22025.465794806718||QG(10)<22025.465794806718||-2e-17!=QG(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:zG(e)-1}:QG,ZG=ur,eq=$G,tq=Math.cosh,nq=Math.abs,rq=Math.E;ZG({target:"Math",stat:!0,forced:!tq||tq(710)===1/0},{cosh:function(e){var t=eq(nq(e)-1)+1;return(t+1/(t*rq*rq))*(rq/2)}});var oq=$G;ur({target:"Math",stat:!0,forced:oq!=Math.expm1},{expm1:oq});var aq=BG,iq=Math.abs,sq=Math.pow,cq=sq(2,-52),lq=sq(2,-23),uq=sq(2,127)*(2-lq),dq=sq(2,-126);ur({target:"Math",stat:!0},{fround:Math.fround||function(e){var t,n,r=iq(e),o=aq(e);return r<dq?o*function(e){return e+1/cq-1/cq}(r/dq/lq)*dq*lq:(n=(t=(1+lq/cq)*r)-(t-r))>uq||n!=n?o*(1/0):o*n}});var fq=ur,hq=Math.hypot,pq=Math.abs,vq=Math.sqrt;fq({target:"Math",stat:!0,forced:!!hq&&hq(1/0,NaN)!==1/0},{hypot:function(e,t){for(var n,r,o=0,a=0,i=arguments.length,s=0;a<i;)s<(n=pq(arguments[a++]))?(o=o*(r=s/n)*r+1,s=n):o+=n>0?(r=n/s)*r:n;return s===1/0?1/0:s*vq(o)}});var yq=ur,mq=M,gq=Math.imul;yq({target:"Math",stat:!0,forced:mq((function(){return-5!=gq(4294967295,5)||2!=gq.length}))},{imul:function(e,t){var n=+e,r=+t,o=65535&n,a=65535&r;return 0|o*a+((65535&n>>>16)*a+o*(65535&r>>>16)<<16>>>0)}});var Sq=ur,bq=Math.log,Nq=Math.LOG10E;Sq({target:"Math",stat:!0},{log10:function(e){return bq(e)*Nq}}),ur({target:"Math",stat:!0},{log1p:IG});var Tq=ur,Eq=Math.log,wq=Math.LN2;Tq({target:"Math",stat:!0},{log2:function(e){return Eq(e)/wq}}),ur({target:"Math",stat:!0},{sign:BG});var _q=ur,Oq=M,Iq=$G,Rq=Math.abs,xq=Math.exp,Cq=Math.E;_q({target:"Math",stat:!0,forced:Oq((function(){return-2e-17!=Math.sinh(-2e-17)}))},{sinh:function(e){return Rq(e=+e)<1?(Iq(e)-Iq(-e))/2:(xq(e-1)-xq(-e-1))*(Cq/2)}});var Aq=ur,kq=$G,Lq=Math.exp;Aq({target:"Math",stat:!0},{tanh:function(e){var t=kq(e=+e),n=kq(-e);return t==1/0?1:n==1/0?-1:(t-n)/(Lq(e)+Lq(-e))}}),Tr(Math,"Math",!0);var Mq=ur,Pq=Math.ceil,Hq=Math.floor;Mq({target:"Math",stat:!0},{trunc:function(e){return(e>0?Hq:Pq)(e)}});var Dq=1..valueOf,Fq=function(e){return Dq.call(e)},jq=Z,Uq=r,Bq=nr,Yq=z.exports,Vq=m,Jq=OM,Gq=he,qq=Re,Kq=M,Wq=fn.f,Xq=qt.f,Qq=ee.f,zq=Fq,$q=sD.trim,Zq=Uq.Number,eK=Zq.prototype,tK=function(e){var t=qq(e,"number");return"bigint"==typeof t?t:nK(t)},nK=function(e){var t,n,r,o,a,i,s,c,l=qq(e,"number");if(Gq(l))throw TypeError("Cannot convert a Symbol value to a number");if("string"==typeof l&&l.length>2)if(43===(t=(l=$q(l)).charCodeAt(0))||45===t){if(88===(n=l.charCodeAt(2))||120===n)return NaN}else if(48===t){switch(l.charCodeAt(1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+l}for(i=(a=l.slice(2)).length,s=0;s<i;s++)if((c=a.charCodeAt(s))<48||c>o)return NaN;return parseInt(a,r)}return+l};if(Bq("Number",!Zq(" 0o1")||!Zq("0b1")||Zq("+0x1"))){for(var rK,oK=function(e){var t=arguments.length<1?0:Zq(tK(e)),n=this;return n instanceof oK&&Kq((function(){zq(n)}))?Jq(Object(t),n,oK):t},aK=jq?Wq(Zq):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),iK=0;aK.length>iK;iK++)Vq(Zq,rK=aK[iK])&&!Vq(oK,rK)&&Qq(oK,rK,Xq(Zq,rK));oK.prototype=eK,eK.constructor=oK,Yq(Uq,"Number",oK)}ur({target:"Number",stat:!0},{EPSILON:Math.pow(2,-52)});var sK=r.isFinite;ur({target:"Number",stat:!0},{isFinite:Number.isFinite||function(e){return"number"==typeof e&&sK(e)}});var cK=ne,lK=Math.floor,uK=Number.isInteger||function(e){return!cK(e)&&isFinite(e)&&lK(e)===e};ur({target:"Number",stat:!0},{isInteger:uK}),ur({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});var dK=ur,fK=uK,hK=Math.abs;dK({target:"Number",stat:!0},{isSafeInteger:function(e){return fK(e)&&hK(e)<=9007199254740991}}),ur({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991}),ur({target:"Number",stat:!0},{MIN_SAFE_INTEGER:-9007199254740991});var pK=r,vK=M,yK=bl,mK=sD.trim,gK=pK.parseFloat,SK=pK.Symbol,bK=SK&&SK.iterator,NK=1/gK("\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff-0")!=-1/0||bK&&!vK((function(){gK(Object(bK))}))?function(e){var t=mK(yK(e)),n=gK(t);return 0===n&&"-"==t.charAt(0)?-0:n}:gK,TK=NK;ur({target:"Number",stat:!0,forced:Number.parseFloat!=TK},{parseFloat:TK});var EK=r,wK=M,_K=bl,OK=sD.trim,IK=EK.parseInt,RK=EK.Symbol,xK=RK&&RK.iterator,CK=/^[+-]?0x/i,AK=8!==IK("\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff08")||22!==IK("\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff0x16")||xK&&!wK((function(){IK(Object(xK))}))?function(e,t){var n=OK(_K(e));return IK(n,t>>>0||(CK.test(n)?16:10))}:IK,kK=AK;ur({target:"Number",stat:!0,forced:Number.parseInt!=kK},{parseInt:kK});var LK=ur,MK=vn,PK=Fq,HK=wJ,DK=M,FK=1..toFixed,jK=Math.floor,UK=function(e,t,n){return 0===t?n:t%2==1?UK(e,t-1,n*e):UK(e*e,t/2,n)},BK=function(e,t,n){for(var r=-1,o=n;++r<6;)o+=t*e[r],e[r]=o%1e7,o=jK(o/1e7)},YK=function(e,t){for(var n=6,r=0;--n>=0;)r+=e[n],e[n]=jK(r/t),r=r%t*1e7},VK=function(e){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==e[t]){var r=String(e[t]);n=""===n?r:n+HK.call("0",7-r.length)+r}return n};LK({target:"Number",proto:!0,forced:FK&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!DK((function(){FK.call({})}))},{toFixed:function(e){var t,n,r,o,a=PK(this),i=MK(e),s=[0,0,0,0,0,0],c="",l="0";if(i<0||i>20)throw RangeError("Incorrect fraction digits");if(a!=a)return"NaN";if(a<=-1e21||a>=1e21)return String(a);if(a<0&&(c="-",a=-a),a>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(a*UK(2,69,1))-69)<0?a*UK(2,-t,1):a/UK(2,t,1),n*=4503599627370496,(t=52-t)>0){for(BK(s,0,n),r=i;r>=7;)BK(s,1e7,0),r-=7;for(BK(s,UK(10,r,1),0),r=t-1;r>=23;)YK(s,1<<23),r-=23;YK(s,1<<r),BK(s,1,1),YK(s,2),l=VK(s)}else BK(s,0,n),BK(s,1<<-t,0),l=VK(s)+HK.call("0",i);return l=i>0?c+((o=l.length)<=i?"0."+HK.call("0",i-o)+l:l.slice(0,o-i)+"."+l.slice(o-i)):c+l}});var JK=M,GK=Fq,qK=1..toPrecision;ur({target:"Number",proto:!0,forced:JK((function(){return"1"!==qK.call(1,void 0)}))||!JK((function(){qK.call({})}))},{toPrecision:function(e){return void 0===e?qK.call(GK(this)):qK.call(GK(this),e)}});var KK=Z,WK=M,XK=tc,QK=Fn,zK=Kt,$K=p,ZK=Zt,eW=Object.assign,tW=Object.defineProperty,nW=!eW||WK((function(){if(KK&&1!==eW({b:1},eW(tW({},"a",{enumerable:!0,get:function(){tW(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=eW({},e)[n]||"abcdefghijklmnopqrst"!=XK(eW({},t)).join("")}))?function(e,t){for(var n=$K(e),r=arguments.length,o=1,a=QK.f,i=zK.f;r>o;)for(var s,c=ZK(arguments[o++]),l=a?XK(c).concat(a(c)):XK(c),u=l.length,d=0;u>d;)s=l[d++],KK&&!i.call(c,s)||(n[s]=c[s]);return n}:eW,rW=nW;ur({target:"Object",stat:!0,forced:Object.assign!==rW},{assign:rW}),ur({target:"Object",stat:!0,sham:!Z},{create:mc});var oW=r,aW=KP,iW=!M((function(){if(!(aW&&aW<535)){var e=Math.random();__defineSetter__.call(null,e,(function(){})),delete oW[e]}})),sW=me,cW=p,lW=ee;Z&&ur({target:"Object",proto:!0,forced:iW},{__defineGetter__:function(e,t){lW.f(cW(this),e,{get:sW(t),enumerable:!0,configurable:!0})}});ur({target:"Object",stat:!0,forced:!Z,sham:!Z},{defineProperties:ac});ur({target:"Object",stat:!0,forced:!Z,sham:!Z},{defineProperty:ee.f});var uW=me,dW=p,fW=ee;Z&&ur({target:"Object",proto:!0,forced:iW},{__defineSetter__:function(e,t){fW.f(dW(this),e,{set:uW(t),enumerable:!0,configurable:!0})}});var hW=Z,pW=tc,vW=nn,yW=Kt.f,mW=function(e){return function(t){for(var n,r=vW(t),o=pW(r),a=o.length,i=0,s=[];a>i;)n=o[i++],hW&&!yW.call(r,n)||s.push(e?[n,r[n]]:r[n]);return s}},gW={entries:mW(!0),values:mW(!1)},SW=gW.entries;ur({target:"Object",stat:!0},{entries:function(e){return SW(e)}});var bW=ur,NW=cM,TW=M,EW=ne,wW=nM.exports.onFreeze,_W=Object.freeze;bW({target:"Object",stat:!0,forced:TW((function(){_W(1)})),sham:!NW},{freeze:function(e){return _W&&EW(e)?_W(wW(e)):e}});var OW=no,IW=Is;ur({target:"Object",stat:!0},{fromEntries:function(e){var t={};return OW(e,(function(e,n){IW(t,e,n)}),{AS_ENTRIES:!0}),t}});var RW=ur,xW=M,CW=nn,AW=qt.f,kW=Z,LW=xW((function(){AW(1)}));RW({target:"Object",stat:!0,forced:!kW||LW,sham:!kW},{getOwnPropertyDescriptor:function(e,t){return AW(CW(e),t)}});var MW=Yn,PW=nn,HW=qt,DW=Is;ur({target:"Object",stat:!0,sham:!Z},{getOwnPropertyDescriptors:function(e){for(var t,n,r=PW(e),o=HW.f,a=MW(r),i={},s=0;a.length>s;)void 0!==(n=o(r,t=a[s++]))&&DW(i,t,n);return i}});var FW=ur,jW=M,UW=rM.f;FW({target:"Object",stat:!0,forced:jW((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:UW});var BW=p,YW=Lc,VW=Oc;ur({target:"Object",stat:!0,forced:M((function(){YW(1)})),sham:!VW},{getPrototypeOf:function(e){return YW(BW(e))}}),ur({target:"Object",stat:!0},{hasOwn:m});var JW=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};ur({target:"Object",stat:!0},{is:JW});var GW=ur,qW=M,KW=ne,WW=Object.isExtensible;GW({target:"Object",stat:!0,forced:qW((function(){WW(1)}))},{isExtensible:function(e){return!!KW(e)&&(!WW||WW(e))}});var XW=ur,QW=M,zW=ne,$W=Object.isFrozen;XW({target:"Object",stat:!0,forced:QW((function(){$W(1)}))},{isFrozen:function(e){return!zW(e)||!!$W&&$W(e)}});var ZW=ur,eX=M,tX=ne,nX=Object.isSealed;ZW({target:"Object",stat:!0,forced:eX((function(){nX(1)}))},{isSealed:function(e){return!tX(e)||!!nX&&nX(e)}});var rX=p,oX=tc;ur({target:"Object",stat:!0,forced:M((function(){oX(1)}))},{keys:function(e){return oX(rX(e))}});var aX=ur,iX=Z,sX=iW,cX=p,lX=Ae,uX=Lc,dX=qt.f;iX&&aX({target:"Object",proto:!0,forced:sX},{__lookupGetter__:function(e){var t,n=cX(this),r=lX(e);do{if(t=dX(n,r))return t.get}while(n=uX(n))}});var fX=ur,hX=Z,pX=iW,vX=p,yX=Ae,mX=Lc,gX=qt.f;hX&&fX({target:"Object",proto:!0,forced:pX},{__lookupSetter__:function(e){var t,n=vX(this),r=yX(e);do{if(t=gX(n,r))return t.set}while(n=mX(n))}});var SX=ur,bX=ne,NX=nM.exports.onFreeze,TX=cM,EX=M,wX=Object.preventExtensions;SX({target:"Object",stat:!0,forced:EX((function(){wX(1)})),sham:!TX},{preventExtensions:function(e){return wX&&bX(e)?wX(NX(e)):e}});var _X=ur,OX=ne,IX=nM.exports.onFreeze,RX=cM,xX=M,CX=Object.seal;_X({target:"Object",stat:!0,forced:xX((function(){CX(1)})),sham:!RX},{seal:function(e){return CX&&OX(e)?CX(IX(e)):e}}),ur({target:"Object",stat:!0},{setPrototypeOf:gr});var AX=gW.values;ur({target:"Object",stat:!0},{values:function(e){return AX(e)}});ur({global:!0,forced:parseFloat!=NK},{parseFloat:NK});ur({global:!0,forced:parseInt!=AK},{parseInt:AK});var kX=me,LX=_a,MX=Da,PX=no;ur({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=LX.f(t),r=n.resolve,o=n.reject,a=MX((function(){var n=kX(t.resolve),o=[],a=0,i=1;PX(e,(function(e){var s=a++,c=!1;o.push(void 0),i++,n.call(t,e).then((function(e){c||(c=!0,o[s]={status:"fulfilled",value:e},--i||r(o))}),(function(e){c||(c=!0,o[s]={status:"rejected",reason:e},--i||r(o))}))})),--i||r(o)}));return a.error&&o(a.value),n.promise}});var HX=me,DX=_,FX=_a,jX=Da,UX=no;ur({target:"Promise",stat:!0},{any:function(e){var t=this,n=FX.f(t),r=n.resolve,o=n.reject,a=jX((function(){var n=HX(t.resolve),a=[],i=0,s=1,c=!1;UX(e,(function(e){var l=i++,u=!1;a.push(void 0),s++,n.call(t,e).then((function(e){u||c||(c=!0,r(e))}),(function(e){u||c||(u=!0,a[l]=e,--s||o(new(DX("AggregateError"))(a,"No one promise resolved")))}))})),--s||o(new(DX("AggregateError"))(a,"No one promise resolved"))}));return a.error&&o(a.value),n.promise}});var BX=ur,YX=me,VX=ue,JX=M,GX=_("Reflect","apply"),qX=Function.apply;BX({target:"Reflect",stat:!0,forced:!JX((function(){GX((function(){}))}))},{apply:function(e,t,n){return YX(e),VX(n),GX?GX(e,t,n):qX.call(e,t,n)}});var KX=ur,WX=Oo,XX=ue,QX=ne,zX=mc,$X=aG,ZX=M,eQ=_("Reflect","construct"),tQ=ZX((function(){function e(){}return!(eQ((function(){}),[],e)instanceof e)})),nQ=!ZX((function(){eQ((function(){}))})),rQ=tQ||nQ;KX({target:"Reflect",stat:!0,forced:rQ,sham:rQ},{construct:function(e,t){WX(e),XX(t);var n=arguments.length<3?e:WX(arguments[2]);if(nQ&&!tQ)return eQ(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new($X.apply(e,r))}var o=n.prototype,a=zX(QX(o)?o:Object.prototype),i=Function.apply.call(e,a,t);return QX(i)?i:a}});var oQ=Z,aQ=ue,iQ=Ae,sQ=ee;ur({target:"Reflect",stat:!0,forced:M((function(){Reflect.defineProperty(sQ.f({},1,{value:1}),1,{value:2})})),sham:!oQ},{defineProperty:function(e,t,n){aQ(e);var r=iQ(t);aQ(n);try{return sQ.f(e,r,n),!0}catch(e){return!1}}});var cQ=ur,lQ=ue,uQ=qt.f;cQ({target:"Reflect",stat:!0},{deleteProperty:function(e,t){var n=uQ(lQ(e),t);return!(n&&!n.configurable)&&delete e[t]}});var dQ=m,fQ=function(e){return void 0!==e&&(dQ(e,"value")||dQ(e,"writable"))},hQ=ne,pQ=ue,vQ=fQ,yQ=qt,mQ=Lc;ur({target:"Reflect",stat:!0},{get:function e(t,n){var r,o,a=arguments.length<3?t:arguments[2];return pQ(t)===a?t[n]:(r=yQ.f(t,n))?vQ(r)?r.value:void 0===r.get?void 0:r.get.call(a):hQ(o=mQ(t))?e(o,n,a):void 0}});var gQ=ue,SQ=qt;ur({target:"Reflect",stat:!0,sham:!Z},{getOwnPropertyDescriptor:function(e,t){return SQ.f(gQ(e),t)}});var bQ=ue,NQ=Lc;ur({target:"Reflect",stat:!0,sham:!Oc},{getPrototypeOf:function(e){return NQ(bQ(e))}}),ur({target:"Reflect",stat:!0},{has:function(e,t){return t in e}});var TQ=ur,EQ=ue,wQ=Object.isExtensible;TQ({target:"Reflect",stat:!0},{isExtensible:function(e){return EQ(e),!wQ||wQ(e)}}),ur({target:"Reflect",stat:!0},{ownKeys:Yn});var _Q=_,OQ=ue;ur({target:"Reflect",stat:!0,sham:!cM},{preventExtensions:function(e){OQ(e);try{var t=_Q("Object","preventExtensions");return t&&t(e),!0}catch(e){return!1}}});var IQ=ue,RQ=ne,xQ=fQ,CQ=ee,AQ=qt,kQ=Lc,LQ=De;ur({target:"Reflect",stat:!0,forced:M((function(){var e=function(){},t=CQ.f(new e,"a",{configurable:!0});return!1!==Reflect.set(e.prototype,"a",1,t)}))},{set:function e(t,n,r){var o,a,i,s=arguments.length<4?t:arguments[3],c=AQ.f(IQ(t),n);if(!c){if(RQ(a=kQ(t)))return e(a,n,r,s);c=LQ(0)}if(xQ(c)){if(!1===c.writable||!RQ(s))return!1;if(o=AQ.f(s,n)){if(o.get||o.set||!1===o.writable)return!1;o.value=r,CQ.f(s,n,o)}else CQ.f(s,n,LQ(0,r))}else{if(void 0===(i=c.set))return!1;i.call(s,r)}return!0}});var MQ=ue,PQ=vr,HQ=gr;HQ&&ur({target:"Reflect",stat:!0},{setPrototypeOf:function(e,t){MQ(e),PQ(t);try{return HQ(e,t),!0}catch(e){return!1}}});var DQ=r,FQ=Tr;ur({global:!0},{Reflect:{}}),FQ(DQ.Reflect,"Reflect",!0);var jQ=Z,UQ=r,BQ=nr,YQ=OM,VQ=Ue,JQ=ee.f,GQ=fn.f,qQ=$l,KQ=bl,WQ=su,XQ=cu,QQ=z.exports,zQ=M,$Q=m,ZQ=yt.enforce,ez=Ir,tz=hu,nz=yu,rz=W("match"),oz=UQ.RegExp,az=oz.prototype,iz=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,sz=/a/g,cz=/a/g,lz=new oz(sz)!==sz,uz=XQ.UNSUPPORTED_Y,dz=jQ&&(!lz||uz||tz||nz||zQ((function(){return cz[rz]=!1,oz(sz)!=sz||oz(cz)==cz||"/a/i"!=oz(sz,"i")})));if(BQ("RegExp",dz)){for(var fz=function(e,t){var n,r,o,a,i,s,c=this instanceof fz,l=qQ(e),u=void 0===t,d=[],f=e;if(!c&&l&&u&&e.constructor===fz)return e;if((l||e instanceof fz)&&(e=e.source,u&&(t="flags"in f?f.flags:WQ.call(f))),e=void 0===e?"":KQ(e),t=void 0===t?"":KQ(t),f=e,tz&&"dotAll"in sz&&(r=!!t&&t.indexOf("s")>-1)&&(t=t.replace(/s/g,"")),n=t,uz&&"sticky"in sz&&(o=!!t&&t.indexOf("y")>-1)&&(t=t.replace(/y/g,"")),nz&&(e=(a=function(e){for(var t,n=e.length,r=0,o="",a=[],i={},s=!1,c=!1,l=0,u="";r<=n;r++){if("\\"===(t=e.charAt(r)))t+=e.charAt(++r);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:iz.test(e.slice(r+1))&&(r+=2,c=!0),o+=t,l++;continue;case">"===t&&c:if(""===u||$Q(i,u))throw new SyntaxError("Invalid capture group name");i[u]=!0,a.push([u,l]),c=!1,u="";continue}c?u+=t:o+=t}return[o,a]}(e))[0],d=a[1]),i=YQ(oz(e,t),c?this:az,fz),(r||o||d.length)&&(s=ZQ(i),r&&(s.dotAll=!0,s.raw=fz(function(e){for(var t,n=e.length,r=0,o="",a=!1;r<=n;r++)"\\"!==(t=e.charAt(r))?a||"."!==t?("["===t?a=!0:"]"===t&&(a=!1),o+=t):o+="[\\s\\S]":o+=t+e.charAt(++r);return o}(e),n)),o&&(s.sticky=!0),d.length&&(s.groups=d)),e!==f)try{VQ(i,"source",""===f?"(?:)":f)}catch(e){}return i},hz=function(e){e in fz||JQ(fz,e,{configurable:!0,get:function(){return oz[e]},set:function(t){oz[e]=t}})},pz=GQ(oz),vz=0;pz.length>vz;)hz(pz[vz++]);az.constructor=fz,fz.prototype=az,QQ(UQ,"RegExp",fz)}ez("RegExp");var yz=Z,mz=hu,gz=ee.f,Sz=yt.get,bz=RegExp.prototype;yz&&mz&&gz(bz,"dotAll",{configurable:!0,get:function(){if(this!==bz){if(this instanceof RegExp)return!!Sz(this).dotAll;throw TypeError("Incompatible receiver, RegExp required")}}});var Nz=ee,Tz=su;Z&&M((function(){return"sy"!==Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get.call({dotAll:!0,sticky:!0})}))&&Nz.f(RegExp.prototype,"flags",{configurable:!0,get:Tz});var Ez=Z,wz=cu.UNSUPPORTED_Y,_z=ee.f,Oz=yt.get,Iz=RegExp.prototype;Ez&&wz&&_z(Iz,"sticky",{configurable:!0,get:function(){if(this!==Iz){if(this instanceof RegExp)return!!Oz(this).sticky;throw TypeError("Incompatible receiver, RegExp required")}}});var Rz=ur,xz=N,Cz=ne,Az=function(){var e=!1,t=/[ac]/;return t.exec=function(){return e=!0,/./.exec.apply(this,arguments)},!0===t.test("abc")&&e}(),kz=/./.test;Rz({target:"RegExp",proto:!0,forced:!Az},{test:function(e){var t=this.exec;if(!xz(t))return kz.call(this,e);var n=t.call(this,e);if(null!==n&&!Cz(n))throw new Error("RegExp exec method returned something other than an Object or null");return!!n}}),UM("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),jD);var Lz=f,Mz=vn,Pz=bl;ur({target:"String",proto:!0,forced:M((function(){return"\ud842"!=="ð ®·".at(0)}))},{at:function(e){var t=Pz(Lz(this)),n=t.length,r=Mz(e),o=r>=0?r:n+r;return o<0||o>=n?void 0:t.charAt(o)}});var Hz=_l.codeAt;ur({target:"String",proto:!0},{codePointAt:function(e){return Hz(this,e)}});var Dz,Fz=ur,jz=qt.f,Uz=Tn,Bz=bl,Yz=eu,Vz=f,Jz=nu,Gz="".endsWith,qz=Math.min,Kz=Jz("endsWith");Fz({target:"String",proto:!0,forced:!!(Kz||(Dz=jz(String.prototype,"endsWith"),!Dz||Dz.writable))&&!Kz},{endsWith:function(e){var t=Bz(Vz(this));Yz(e);var n=arguments.length>1?arguments[1]:void 0,r=t.length,o=void 0===n?r:qz(Uz(n),r),a=Bz(e);return Gz?Gz.call(t,a,o):t.slice(o-a.length,o)===a}});var Wz=ur,Xz=Sn,Qz=String.fromCharCode,zz=String.fromCodePoint;Wz({target:"String",stat:!0,forced:!!zz&&1!=zz.length},{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,o=0;r>o;){if(t=+arguments[o++],Xz(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?Qz(t):Qz(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}});var $z=ur,Zz=Kc,e$=f,t$=Tn,n$=bl,r$=ue,o$=$l,a$=su,i$=Se,s$=z.exports,c$=M,l$=Co,u$=Bu,d$=qu,f$=yt,h$=W("matchAll"),p$=f$.set,v$=f$.getterFor("RegExp String Iterator"),y$=RegExp.prototype,m$="".matchAll,g$=!!m$&&!c$((function(){"a".matchAll(/./)})),S$=Zz((function(e,t,n,r){p$(this,{type:"RegExp String Iterator",regexp:e,string:t,global:n,unicode:r,done:!1})}),"RegExp String",(function(){var e=v$(this);if(e.done)return{value:void 0,done:!0};var t=e.regexp,n=e.string,r=d$(t,n);return null===r?{value:void 0,done:e.done=!0}:e.global?(""===n$(r[0])&&(t.lastIndex=u$(n,t$(t.lastIndex),e.unicode)),{value:r,done:!1}):(e.done=!0,{value:r,done:!1})})),b$=function(e){var t,n,r,o,a,i,s=r$(this),c=n$(e);return t=l$(s,RegExp),void 0===(n=s.flags)&&s instanceof RegExp&&!("flags"in y$)&&(n=a$.call(s)),r=void 0===n?"":n$(n),o=new t(t===RegExp?s.source:s,r),a=!!~r.indexOf("g"),i=!!~r.indexOf("u"),o.lastIndex=t$(s.lastIndex),new S$(o,c,a,i)};$z({target:"String",proto:!0,forced:g$},{matchAll:function(e){var t,n,r=e$(this);if(null!=e){if(o$(e)&&!~n$(e$("flags"in y$?e.flags:a$.call(e))).indexOf("g"))throw TypeError("`.matchAll` does not allow non-global regexes");if(g$)return m$.apply(r,arguments);if(n=i$(e,h$))return n.call(e,r)}else if(g$)return m$.apply(r,arguments);return t=n$(r),new RegExp(e,"g")[h$](t)}}),h$ in y$||s$(y$,h$,b$);var N$=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(O),T$=AJ.end;ur({target:"String",proto:!0,forced:N$},{padEnd:function(e){return T$(this,e,arguments.length>1?arguments[1]:void 0)}});var E$=AJ.start;ur({target:"String",proto:!0,forced:N$},{padStart:function(e){return E$(this,e,arguments.length>1?arguments[1]:void 0)}});var w$=ur,_$=nn,O$=p,I$=bl,R$=wn,x$=Array.prototype,C$=x$.push,A$=x$.join;w$({target:"String",stat:!0},{raw:function(e){for(var t=_$(O$(e).raw),n=R$(t),r=arguments.length,o=[],a=0;n>a;){if(C$.call(o,I$(t[a++])),a===n)return A$.call(o,"");a<r&&C$.call(o,I$(arguments[a]))}}}),ur({target:"String",proto:!0},{repeat:wJ});var k$=ur,L$=f,M$=N,P$=$l,H$=bl,D$=Se,F$=su,j$=EH,U$=W("replace"),B$=RegExp.prototype,Y$=Math.max,V$=function(e,t,n){return n>e.length?-1:""===t?n:e.indexOf(t,n)};k$({target:"String",proto:!0},{replaceAll:function(e,t){var n,r,o,a,i,s,c,l=L$(this),u=0,d=0,f="";if(null!=e){if(P$(e)&&!~H$(L$("flags"in B$?e.flags:F$.call(e))).indexOf("g"))throw TypeError("`.replaceAll` does not allow non-global regexes");if(n=D$(e,U$))return n.call(e,l,t)}for(r=H$(l),o=H$(e),(a=M$(t))||(t=H$(t)),i=o.length,s=Y$(1,i),u=V$(r,o,0);-1!==u;)c=a?H$(t(o,u,r)):j$(o,r,u,[],void 0,t),f+=r.slice(d,u)+c,d=u+i,u=V$(r,o,u+s);return d<r.length&&(f+=r.slice(d)),f}});var J$=ue,G$=f,q$=JW,K$=bl,W$=Se,X$=qu;ju("search",(function(e,t,n){return[function(t){var n=G$(this),r=null==t?void 0:W$(t,e);return r?r.call(t,n):new RegExp(t)[e](K$(n))},function(e){var r=J$(this),o=K$(e),a=n(t,r,o);if(a.done)return a.value;var i=r.lastIndex;q$(i,0)||(r.lastIndex=0);var s=X$(r,o);return q$(r.lastIndex,i)||(r.lastIndex=i),null===s?-1:s.index}]}));var Q$=ur,z$=qt.f,$$=Tn,Z$=bl,eZ=eu,tZ=f,nZ=nu,rZ="".startsWith,oZ=Math.min,aZ=nZ("startsWith");Q$({target:"String",proto:!0,forced:!(!aZ&&!!function(){var e=z$(String.prototype,"startsWith");return e&&!e.writable}())&&!aZ},{startsWith:function(e){var t=Z$(tZ(this));eZ(e);var n=$$(oZ(arguments.length>1?arguments[1]:void 0,t.length)),r=Z$(e);return rZ?rZ.call(t,r,n):t.slice(n,n+r.length)===r}});var iZ=ur,sZ=f,cZ=vn,lZ=bl,uZ="".slice,dZ=Math.max,fZ=Math.min;iZ({target:"String",proto:!0,forced:!"".substr||"b"!=="ab".substr(-1)},{substr:function(e,t){var n,r,o=lZ(sZ(this)),a=o.length,i=cZ(e);return i===1/0&&(i=0),i<0&&(i=dZ(a+i,0)),(n=void 0===t?a:cZ(t))<=0||n===1/0||i>=(r=fZ(i+n,a))?"":uZ.call(o,i,r)}});var hZ=ur,pZ=sD.end,vZ=dD("trimEnd"),yZ=vZ?function(){return pZ(this)}:"".trimEnd;hZ({target:"String",proto:!0,name:"trimEnd",forced:vZ},{trimEnd:yZ,trimRight:yZ});var mZ=ur,gZ=sD.start,SZ=dD("trimStart"),bZ=SZ?function(){return gZ(this)}:"".trimStart;mZ({target:"String",proto:!0,name:"trimStart",forced:SZ},{trimStart:bZ,trimLeft:bZ});var NZ=f,TZ=bl,EZ=/"/g,wZ=function(e,t,n,r){var o=TZ(NZ(e)),a="<"+t;return""!==n&&(a+=" "+n+'="'+TZ(r).replace(EZ,"&quot;")+'"'),a+">"+o+"</"+t+">"},_Z=M,OZ=function(e){return _Z((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))},IZ=wZ;ur({target:"String",proto:!0,forced:OZ("anchor")},{anchor:function(e){return IZ(this,"a","name",e)}});var RZ=wZ;ur({target:"String",proto:!0,forced:OZ("big")},{big:function(){return RZ(this,"big","","")}});var xZ=wZ;ur({target:"String",proto:!0,forced:OZ("blink")},{blink:function(){return xZ(this,"blink","","")}});var CZ=wZ;ur({target:"String",proto:!0,forced:OZ("bold")},{bold:function(){return CZ(this,"b","","")}});var AZ=wZ;ur({target:"String",proto:!0,forced:OZ("fixed")},{fixed:function(){return AZ(this,"tt","","")}});var kZ=wZ;ur({target:"String",proto:!0,forced:OZ("fontcolor")},{fontcolor:function(e){return kZ(this,"font","color",e)}});var LZ=wZ;ur({target:"String",proto:!0,forced:OZ("fontsize")},{fontsize:function(e){return LZ(this,"font","size",e)}});var MZ=wZ;ur({target:"String",proto:!0,forced:OZ("italics")},{italics:function(){return MZ(this,"i","","")}});var PZ=wZ;ur({target:"String",proto:!0,forced:OZ("link")},{link:function(e){return PZ(this,"a","href",e)}});var HZ=wZ;ur({target:"String",proto:!0,forced:OZ("small")},{small:function(){return HZ(this,"small","","")}});var DZ=wZ;ur({target:"String",proto:!0,forced:OZ("strike")},{strike:function(){return DZ(this,"strike","","")}});var FZ=wZ;ur({target:"String",proto:!0,forced:OZ("sub")},{sub:function(){return FZ(this,"sub","","")}});var jZ=wZ;ur({target:"String",proto:!0,forced:OZ("sup")},{sup:function(){return jZ(this,"sup","","")}});var UZ={exports:{}},BZ=r,YZ=M,VZ=fo,JZ=oJ.NATIVE_ARRAY_BUFFER_VIEWS,GZ=BZ.ArrayBuffer,qZ=BZ.Int8Array,KZ=!JZ||!YZ((function(){qZ(1)}))||!YZ((function(){new qZ(-1)}))||!VZ((function(e){new qZ,new qZ(null),new qZ(1.5),new qZ(e)}),!0)||YZ((function(){return 1!==new qZ(new GZ(2),1,void 0).length})),WZ=vn,XZ=function(e){var t=WZ(e);if(t<0)throw RangeError("The argument can't be less than 0");return t},QZ=function(e,t){var n=XZ(e);if(n%t)throw RangeError("Wrong offset");return n},zZ=Oo,$Z=p,ZZ=wn,e0=Jr,t0=Ur,n0=Lr,r0=Pr,o0=oJ.aTypedArrayConstructor,a0=function(e){var t,n,r,o,a,i,s=zZ(this),c=$Z(e),l=arguments.length,u=l>1?arguments[1]:void 0,d=void 0!==u,f=t0(c);if(f&&!n0(f))for(i=(a=e0(c,f)).next,c=[];!(o=i.call(a)).done;)c.push(o.value);for(d&&l>2&&(u=r0(u,arguments[2],2)),n=ZZ(c),r=new(o0(s))(n),t=0;n>t;t++)r[t]=d?u(c[t],t):c[t];return r},i0=ur,s0=r,c0=Z,l0=KZ,u0=oJ,d0=NV,f0=Rr,h0=De,p0=Ue,v0=uK,y0=Tn,m0=EY,g0=QZ,S0=Ae,b0=m,N0=Ut,T0=ne,E0=he,w0=mc,_0=gr,O0=fn.f,I0=a0,R0=WM.forEach,x0=Ir,C0=ee,A0=qt,k0=OM,L0=yt.get,M0=yt.set,P0=C0.f,H0=A0.f,D0=Math.round,F0=s0.RangeError,j0=d0.ArrayBuffer,U0=d0.DataView,B0=u0.NATIVE_ARRAY_BUFFER_VIEWS,Y0=u0.TYPED_ARRAY_CONSTRUCTOR,V0=u0.TYPED_ARRAY_TAG,J0=u0.TypedArray,G0=u0.TypedArrayPrototype,q0=u0.aTypedArrayConstructor,K0=u0.isTypedArray,W0=function(e,t){for(var n=0,r=t.length,o=new(q0(e))(r);r>n;)o[n]=t[n++];return o},X0=function(e,t){P0(e,t,{get:function(){return L0(this)[t]}})},Q0=function(e){var t;return e instanceof j0||"ArrayBuffer"==(t=N0(e))||"SharedArrayBuffer"==t},z0=function(e,t){return K0(e)&&!E0(t)&&t in e&&v0(+t)&&t>=0},$0=function(e,t){return t=S0(t),z0(e,t)?h0(2,e[t]):H0(e,t)},Z0=function(e,t,n){return t=S0(t),!(z0(e,t)&&T0(n)&&b0(n,"value"))||b0(n,"get")||b0(n,"set")||n.configurable||b0(n,"writable")&&!n.writable||b0(n,"enumerable")&&!n.enumerable?P0(e,t,n):(e[t]=n.value,e)};c0?(B0||(A0.f=$0,C0.f=Z0,X0(G0,"buffer"),X0(G0,"byteOffset"),X0(G0,"byteLength"),X0(G0,"length")),i0({target:"Object",stat:!0,forced:!B0},{getOwnPropertyDescriptor:$0,defineProperty:Z0}),UZ.exports=function(e,t,n){var r=e.match(/\d+$/)[0]/8,o=e+(n?"Clamped":"")+"Array",a="get"+e,i="set"+e,s=s0[o],c=s,l=c&&c.prototype,u={},d=function(e,t){P0(e,t,{get:function(){return function(e,t){var n=L0(e);return n.view[a](t*r+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,o){var a=L0(e);n&&(o=(o=D0(o))<0?0:o>255?255:255&o),a.view[i](t*r+a.byteOffset,o,!0)}(this,t,e)},enumerable:!0})};B0?l0&&(c=t((function(e,t,n,a){return f0(e,c,o),k0(T0(t)?Q0(t)?void 0!==a?new s(t,g0(n,r),a):void 0!==n?new s(t,g0(n,r)):new s(t):K0(t)?W0(c,t):I0.call(c,t):new s(m0(t)),e,c)})),_0&&_0(c,J0),R0(O0(s),(function(e){e in c||p0(c,e,s[e])})),c.prototype=l):(c=t((function(e,t,n,a){f0(e,c,o);var i,s,l,u=0,f=0;if(T0(t)){if(!Q0(t))return K0(t)?W0(c,t):I0.call(c,t);i=t,f=g0(n,r);var h=t.byteLength;if(void 0===a){if(h%r)throw F0("Wrong length");if((s=h-f)<0)throw F0("Wrong length")}else if((s=y0(a)*r)+f>h)throw F0("Wrong length");l=s/r}else l=m0(t),i=new j0(s=l*r);for(M0(e,{buffer:i,byteOffset:f,byteLength:s,length:l,view:new U0(i)});u<l;)d(e,u++)})),_0&&_0(c,J0),l=c.prototype=w0(G0)),l.constructor!==c&&p0(l,"constructor",c),p0(l,Y0,c),V0&&p0(l,V0,o),u[o]=c,i0({global:!0,forced:c!=s,sham:!B0},u),"BYTES_PER_ELEMENT"in c||p0(c,"BYTES_PER_ELEMENT",r),"BYTES_PER_ELEMENT"in l||p0(l,"BYTES_PER_ELEMENT",r),x0(o)}):UZ.exports=function(){},(0,UZ.exports)("Float32",(function(e){return function(t,n,r){return e(this,t,n,r)}})),(0,UZ.exports)("Float64",(function(e){return function(t,n,r){return e(this,t,n,r)}})),(0,UZ.exports)("Int8",(function(e){return function(t,n,r){return e(this,t,n,r)}})),(0,UZ.exports)("Int16",(function(e){return function(t,n,r){return e(this,t,n,r)}})),(0,UZ.exports)("Int32",(function(e){return function(t,n,r){return e(this,t,n,r)}})),(0,UZ.exports)("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}})),(0,UZ.exports)("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}),!0),(0,UZ.exports)("Uint16",(function(e){return function(t,n,r){return e(this,t,n,r)}})),(0,UZ.exports)("Uint32",(function(e){return function(t,n,r){return e(this,t,n,r)}}));var e1=wn,t1=vn,n1=oJ.aTypedArray;(0,oJ.exportTypedArrayMethod)("at",(function(e){var t=n1(this),n=e1(t),r=t1(e),o=r>=0?r:n+r;return o<0||o>=n?void 0:t[o]}));var r1=MU,o1=oJ.aTypedArray;(0,oJ.exportTypedArrayMethod)("copyWithin",(function(e,t){return r1.call(o1(this),e,t,arguments.length>2?arguments[2]:void 0)}));var a1=WM.every,i1=oJ.aTypedArray;(0,oJ.exportTypedArrayMethod)("every",(function(e){return a1(i1(this),e,arguments.length>1?arguments[1]:void 0)}));var s1=UU,c1=oJ.aTypedArray;(0,oJ.exportTypedArrayMethod)("fill",(function(e){return s1.apply(c1(this),arguments)}));var l1=Co,u1=oJ.TYPED_ARRAY_CONSTRUCTOR,d1=oJ.aTypedArrayConstructor,f1=function(e){return d1(l1(e,e[u1]))},h1=function(e,t){for(var n=0,r=t.length,o=new e(r);r>n;)o[n]=t[n++];return o},p1=f1,v1=WM.filter,y1=function(e,t){return h1(p1(e),t)},m1=oJ.aTypedArray;(0,oJ.exportTypedArrayMethod)("filter",(function(e){var t=v1(m1(this),e,arguments.length>1?arguments[1]:void 0);return y1(this,t)}));var g1=WM.find,S1=oJ.aTypedArray;(0,oJ.exportTypedArrayMethod)("find",(function(e){return g1(S1(this),e,arguments.length>1?arguments[1]:void 0)}));var b1=WM.findIndex,N1=oJ.aTypedArray;(0,oJ.exportTypedArrayMethod)("findIndex",(function(e){return b1(N1(this),e,arguments.length>1?arguments[1]:void 0)}));var T1=WM.forEach,E1=oJ.aTypedArray;(0,oJ.exportTypedArrayMethod)("forEach",(function(e){T1(E1(this),e,arguments.length>1?arguments[1]:void 0)})),(0,oJ.exportTypedArrayStaticMethod)("from",a0,KZ);var w1=xn.includes,_1=oJ.aTypedArray;(0,oJ.exportTypedArrayMethod)("includes",(function(e){return w1(_1(this),e,arguments.length>1?arguments[1]:void 0)}));var O1=xn.indexOf,I1=oJ.aTypedArray;(0,oJ.exportTypedArrayMethod)("indexOf",(function(e){return O1(I1(this),e,arguments.length>1?arguments[1]:void 0)}));var R1=r,x1=Tt.PROPER,C1=oJ,A1=gl,k1=W("iterator"),L1=R1.Uint8Array,M1=A1.values,P1=A1.keys,H1=A1.entries,D1=C1.aTypedArray,F1=C1.exportTypedArrayMethod,j1=L1&&L1.prototype[k1],U1=!!j1&&"values"===j1.name,B1=function(){return M1.call(D1(this))};F1("entries",(function(){return H1.call(D1(this))})),F1("keys",(function(){return P1.call(D1(this))})),F1("values",B1,x1&&!U1),F1(k1,B1,x1&&!U1);var Y1=oJ.aTypedArray,V1=[].join;(0,oJ.exportTypedArrayMethod)("join",(function(e){return V1.apply(Y1(this),arguments)}));var J1=BB,G1=oJ.aTypedArray;(0,oJ.exportTypedArrayMethod)("lastIndexOf",(function(e){return J1.apply(G1(this),arguments)}));var q1=WM.map,K1=f1,W1=oJ.aTypedArray;(0,oJ.exportTypedArrayMethod)("map",(function(e){return q1(W1(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(K1(e))(t)}))}));var X1=oJ.aTypedArrayConstructor;(0,oJ.exportTypedArrayStaticMethod)("of",(function(){for(var e=0,t=arguments.length,n=new(X1(this))(t);t>e;)n[e]=arguments[e++];return n}),KZ);var Q1=QB.left,z1=oJ.aTypedArray;(0,oJ.exportTypedArrayMethod)("reduce",(function(e){return Q1(z1(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}));var $1=QB.right,Z1=oJ.aTypedArray;(0,oJ.exportTypedArrayMethod)("reduceRight",(function(e){return $1(Z1(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}));var e2=oJ.aTypedArray,t2=oJ.exportTypedArrayMethod,n2=Math.floor;t2("reverse",(function(){for(var e,t=e2(this).length,n=n2(t/2),r=0;r<n;)e=this[r],this[r++]=this[--t],this[t]=e;return this}));var r2=wn,o2=QZ,a2=p,i2=oJ.aTypedArray;(0,oJ.exportTypedArrayMethod)("set",(function(e){i2(this);var t=o2(arguments.length>1?arguments[1]:void 0,1),n=this.length,r=a2(e),o=r2(r),a=0;if(o+t>n)throw RangeError("Wrong length");for(;a<o;)this[t+a]=r[a++]}),M((function(){new Int8Array(1).set({})})));var s2=f1,c2=oJ.aTypedArray,l2=[].slice;(0,oJ.exportTypedArrayMethod)("slice",(function(e,t){for(var n=l2.call(c2(this),e,t),r=s2(this),o=0,a=n.length,i=new r(a);a>o;)i[o]=n[o++];return i}),M((function(){new Int8Array(1).slice()})));var u2=WM.some,d2=oJ.aTypedArray;(0,oJ.exportTypedArrayMethod)("some",(function(e){return u2(d2(this),e,arguments.length>1?arguments[1]:void 0)}));var f2=M,h2=me,p2=wn,v2=YP,y2=JP,m2=GP,g2=L,S2=KP,b2=oJ.aTypedArray,N2=oJ.exportTypedArrayMethod,T2=r.Uint16Array,E2=T2&&T2.prototype.sort,w2=!!E2&&!f2((function(){var e=new T2(2);e.sort(null),e.sort({})})),_2=!!E2&&!f2((function(){if(g2)return g2<74;if(y2)return y2<67;if(m2)return!0;if(S2)return S2<602;var e,t,n=new T2(516),r=Array(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,r[e]=e-2*t+3;for(n.sort((function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==r[e])return!0}));N2("sort",(function(e){if(void 0!==e&&h2(e),_2)return E2.call(this,e);b2(this);var t,n=p2(this),r=Array(n);for(t=0;t<n;t++)r[t]=this[t];for(r=v2(this,function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!=n?-1:t!=t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}}(e)),t=0;t<n;t++)this[t]=r[t];return this}),!_2||w2);var O2=Tn,I2=Sn,R2=f1,x2=oJ.aTypedArray;(0,oJ.exportTypedArrayMethod)("subarray",(function(e,t){var n=x2(this),r=n.length,o=I2(e,r);return new(R2(n))(n.buffer,n.byteOffset+o*n.BYTES_PER_ELEMENT,O2((void 0===t?r:I2(t,r))-o))}));var C2=oJ,A2=M,k2=r.Int8Array,L2=C2.aTypedArray,M2=C2.exportTypedArrayMethod,P2=[].toLocaleString,H2=[].slice,D2=!!k2&&A2((function(){P2.call(new k2(1))}));M2("toLocaleString",(function(){return P2.apply(D2?H2.call(L2(this)):L2(this),arguments)}),A2((function(){return[1,2].toLocaleString()!=new k2([1,2]).toLocaleString()}))||!A2((function(){k2.prototype.toLocaleString.call([1,2])})));var F2=oJ.exportTypedArrayMethod,j2=M,U2=r.Uint8Array,B2=U2&&U2.prototype||{},Y2=[].toString,V2=[].join;j2((function(){Y2.call({})}))&&(Y2=function(){return V2.call(this)});var J2=B2.toString!=Y2;F2("toString",Y2,J2);var G2=ur,q2=bl,K2=String.fromCharCode,W2=/^[\da-f]{2}$/i,X2=/^[\da-f]{4}$/i;G2({global:!0},{unescape:function(e){for(var t,n,r=q2(e),o="",a=r.length,i=0;i<a;){if("%"===(t=r.charAt(i++)))if("u"===r.charAt(i)){if(n=r.slice(i+1,i+5),X2.test(n)){o+=K2(parseInt(n,16)),i+=5;continue}}else if(n=r.slice(i,i+2),W2.test(n)){o+=K2(parseInt(n,16)),i+=2;continue}o+=t}return o}});var Q2=r,z2=kl,$2=Pl,Z2=hB,e3=Ue,t3=function(e){if(e&&e.forEach!==Z2)try{e3(e,"forEach",Z2)}catch(t){e.forEach=Z2}};for(var n3 in z2)z2[n3]&&t3(Q2[n3]&&Q2[n3].prototype);t3($2);var r3=r,o3=sa;ur({global:!0,bind:!0,enumerable:!0,forced:!r3.setImmediate||!r3.clearImmediate},{setImmediate:o3.set,clearImmediate:o3.clear});var a3=ur,i3=wa,s3=Lo,c3=r.process;a3({global:!0,enumerable:!0,noTargetGet:!0},{queueMicrotask:function(e){var t=s3&&c3.domain;i3(t?t.bind(e):e)}});var l3=r,u3=N,d3=[].slice,f3=function(e){return function(t,n){var r=arguments.length>2,o=r?d3.call(arguments,2):void 0;return e(r?function(){(u3(t)?t:Function(t)).apply(this,o)}:t,n)}};ur({global:!0,bind:!0,forced:/MSIE .\./.test(O)},{setTimeout:f3(l3.setTimeout),setInterval:f3(l3.setInterval)});var h3=M,p3=W("iterator"),v3=!h3((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,r){t.delete("b"),n+=r+e})),!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[p3]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://ÑÐµÑÑ").host||"#%D0%B1"!==new URL("http://a#Ð±").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host})),y3=/[^\0-\u007E]/,m3=/[.\u3002\uFF0E\uFF61]/g,g3="Overflow: input needs wider integers to process",S3=Math.floor,b3=String.fromCharCode,N3=function(e){return e+22+75*(e<26)},T3=function(e,t,n){var r=0;for(e=n?S3(e/700):e>>1,e+=S3(e/t);e>455;r+=36)e=S3(e/35);return S3(r+36*e/(e+38))},E3=function(e){var t,n,r=[],o=(e=function(e){for(var t=[],n=0,r=e.length;n<r;){var o=e.charCodeAt(n++);if(o>=55296&&o<=56319&&n<r){var a=e.charCodeAt(n++);56320==(64512&a)?t.push(((1023&o)<<10)+(1023&a)+65536):(t.push(o),n--)}else t.push(o)}return t}(e)).length,a=128,i=0,s=72;for(t=0;t<e.length;t++)(n=e[t])<128&&r.push(b3(n));var c=r.length,l=c;for(c&&r.push("-");l<o;){var u=2147483647;for(t=0;t<e.length;t++)(n=e[t])>=a&&n<u&&(u=n);var d=l+1;if(u-a>S3((2147483647-i)/d))throw RangeError(g3);for(i+=(u-a)*d,a=u,t=0;t<e.length;t++){if((n=e[t])<a&&++i>2147483647)throw RangeError(g3);if(n==a){for(var f=i,h=36;;h+=36){var p=h<=s?1:h>=s+26?26:h-s;if(f<p)break;var v=f-p,y=36-p;r.push(b3(N3(p+v%y))),f=S3(v/y)}r.push(b3(N3(f))),s=T3(i,d,l==c),i=0,++l}}++i,++a}return r.join("")},w3=ur,_3=_,O3=v3,I3=z.exports,R3=hr,x3=Tr,C3=Kc,A3=yt,k3=Rr,L3=N,M3=m,P3=Pr,H3=Ut,D3=ue,F3=ne,j3=bl,U3=mc,B3=De,Y3=Jr,V3=Ur,J3=W,G3=_3("fetch"),q3=_3("Request"),K3=q3&&q3.prototype,W3=_3("Headers"),X3=J3("iterator"),Q3=A3.set,z3=A3.getterFor("URLSearchParams"),$3=A3.getterFor("URLSearchParamsIterator"),Z3=/\+/g,e5=Array(4),t5=function(e){return e5[e-1]||(e5[e-1]=RegExp("((?:%[\\da-f]{2}){"+e+"})","gi"))},n5=function(e){try{return decodeURIComponent(e)}catch(t){return e}},r5=function(e){var t=e.replace(Z3," "),n=4;try{return decodeURIComponent(t)}catch(e){for(;n;)t=t.replace(t5(n--),n5);return t}},o5=/[!'()~]|%20/g,a5={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},i5=function(e){return a5[e]},s5=function(e){return encodeURIComponent(e).replace(o5,i5)},c5=function(e,t){if(t)for(var n,r,o=t.split("&"),a=0;a<o.length;)(n=o[a++]).length&&(r=n.split("="),e.push({key:r5(r.shift()),value:r5(r.join("="))}))},l5=function(e){this.entries.length=0,c5(this.entries,e)},u5=function(e,t){if(e<t)throw TypeError("Not enough arguments")},d5=C3((function(e,t){Q3(this,{type:"URLSearchParamsIterator",iterator:Y3(z3(e).entries),kind:t})}),"Iterator",(function(){var e=$3(this),t=e.kind,n=e.iterator.next(),r=n.value;return n.done||(n.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),n})),f5=function(){k3(this,f5,"URLSearchParams");var e,t,n,r,o,a,i,s,c,l=arguments.length>0?arguments[0]:void 0,u=this,d=[];if(Q3(u,{type:"URLSearchParams",entries:d,updateURL:function(){},updateSearchParams:l5}),void 0!==l)if(F3(l))if(e=V3(l))for(n=(t=Y3(l,e)).next;!(r=n.call(t)).done;){if((i=(a=(o=Y3(D3(r.value))).next).call(o)).done||(s=a.call(o)).done||!a.call(o).done)throw TypeError("Expected sequence with length 2");d.push({key:j3(i.value),value:j3(s.value)})}else for(c in l)M3(l,c)&&d.push({key:c,value:j3(l[c])});else c5(d,"string"==typeof l?"?"===l.charAt(0)?l.slice(1):l:j3(l))},h5=f5.prototype;if(R3(h5,{append:function(e,t){u5(arguments.length,2);var n=z3(this);n.entries.push({key:j3(e),value:j3(t)}),n.updateURL()},delete:function(e){u5(arguments.length,1);for(var t=z3(this),n=t.entries,r=j3(e),o=0;o<n.length;)n[o].key===r?n.splice(o,1):o++;t.updateURL()},get:function(e){u5(arguments.length,1);for(var t=z3(this).entries,n=j3(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){u5(arguments.length,1);for(var t=z3(this).entries,n=j3(e),r=[],o=0;o<t.length;o++)t[o].key===n&&r.push(t[o].value);return r},has:function(e){u5(arguments.length,1);for(var t=z3(this).entries,n=j3(e),r=0;r<t.length;)if(t[r++].key===n)return!0;return!1},set:function(e,t){u5(arguments.length,1);for(var n,r=z3(this),o=r.entries,a=!1,i=j3(e),s=j3(t),c=0;c<o.length;c++)(n=o[c]).key===i&&(a?o.splice(c--,1):(a=!0,n.value=s));a||o.push({key:i,value:s}),r.updateURL()},sort:function(){var e,t,n,r=z3(this),o=r.entries,a=o.slice();for(o.length=0,n=0;n<a.length;n++){for(e=a[n],t=0;t<n;t++)if(o[t].key>e.key){o.splice(t,0,e);break}t===n&&o.push(e)}r.updateURL()},forEach:function(e){for(var t,n=z3(this).entries,r=P3(e,arguments.length>1?arguments[1]:void 0,3),o=0;o<n.length;)r((t=n[o++]).value,t.key,this)},keys:function(){return new d5(this,"keys")},values:function(){return new d5(this,"values")},entries:function(){return new d5(this,"entries")}},{enumerable:!0}),I3(h5,X3,h5.entries,{name:"entries"}),I3(h5,"toString",(function(){for(var e,t=z3(this).entries,n=[],r=0;r<t.length;)e=t[r++],n.push(s5(e.key)+"="+s5(e.value));return n.join("&")}),{enumerable:!0}),x3(f5,"URLSearchParams"),w3({global:!0,forced:!O3},{URLSearchParams:f5}),!O3&&L3(W3)){var p5=function(e){if(F3(e)){var t,n=e.body;if("URLSearchParams"===H3(n))return(t=e.headers?new W3(e.headers):new W3).has("content-type")||t.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),U3(e,{body:B3(0,String(n)),headers:B3(0,t)})}return e};if(L3(G3)&&w3({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return G3(e,arguments.length>1?p5(arguments[1]):{})}}),L3(q3)){var v5=function(e){return k3(this,v5,"Request"),new q3(e,arguments.length>1?p5(arguments[1]):{})};K3.constructor=v5,v5.prototype=K3,w3({global:!0,forced:!0},{Request:v5})}}var y5,m5={URLSearchParams:f5,getState:z3},g5=ur,S5=Z,b5=v3,N5=r,T5=ac,E5=z.exports,w5=Rr,_5=m,O5=nW,I5=_B,R5=_l.codeAt,x5=function(e){var t,n,r=[],o=e.toLowerCase().replace(m3,".").split(".");for(t=0;t<o.length;t++)n=o[t],r.push(y3.test(n)?"xn--"+E3(n):n);return r.join(".")},C5=bl,A5=Tr,k5=m5,L5=yt,M5=N5.URL,P5=k5.URLSearchParams,H5=k5.getState,D5=L5.set,F5=L5.getterFor("URL"),j5=Math.floor,U5=Math.pow,B5=/[a-z]/i,Y5=/[\d+-.a-z]/i,V5=/\d/,J5=/^0x/i,G5=/^[0-7]+$/,q5=/^\d+$/,K5=/^[\da-f]+$/i,W5=/[\0\t\n\r #%/:<>?@[\\\]^|]/,X5=/[\0\t\n\r #/:<>?@[\\\]^|]/,Q5=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,z5=/[\t\n\r]/g,$5=function(e,t){var n,r,o;if("["==t.charAt(0)){if("]"!=t.charAt(t.length-1))return"Invalid host";if(!(n=e4(t.slice(1,-1))))return"Invalid host";e.host=n}else if(c4(e)){if(t=x5(t),W5.test(t))return"Invalid host";if(null===(n=Z5(t)))return"Invalid host";e.host=n}else{if(X5.test(t))return"Invalid host";for(n="",r=I5(t),o=0;o<r.length;o++)n+=i4(r[o],n4);e.host=n}},Z5=function(e){var t,n,r,o,a,i,s,c=e.split(".");if(c.length&&""==c[c.length-1]&&c.pop(),(t=c.length)>4)return e;for(n=[],r=0;r<t;r++){if(""==(o=c[r]))return e;if(a=10,o.length>1&&"0"==o.charAt(0)&&(a=J5.test(o)?16:8,o=o.slice(8==a?1:2)),""===o)i=0;else{if(!(10==a?q5:8==a?G5:K5).test(o))return e;i=parseInt(o,a)}n.push(i)}for(r=0;r<t;r++)if(i=n[r],r==t-1){if(i>=U5(256,5-t))return null}else if(i>255)return null;for(s=n.pop(),r=0;r<n.length;r++)s+=n[r]*U5(256,3-r);return s},e4=function(e){var t,n,r,o,a,i,s,c=[0,0,0,0,0,0,0,0],l=0,u=null,d=0,f=function(){return e.charAt(d)};if(":"==f()){if(":"!=e.charAt(1))return;d+=2,u=++l}for(;f();){if(8==l)return;if(":"!=f()){for(t=n=0;n<4&&K5.test(f());)t=16*t+parseInt(f(),16),d++,n++;if("."==f()){if(0==n)return;if(d-=n,l>6)return;for(r=0;f();){if(o=null,r>0){if(!("."==f()&&r<4))return;d++}if(!V5.test(f()))return;for(;V5.test(f());){if(a=parseInt(f(),10),null===o)o=a;else{if(0==o)return;o=10*o+a}if(o>255)return;d++}c[l]=256*c[l]+o,2!=++r&&4!=r||l++}if(4!=r)return;break}if(":"==f()){if(d++,!f())return}else if(f())return;c[l++]=t}else{if(null!==u)return;d++,u=++l}}if(null!==u)for(i=l-u,l=7;0!=l&&i>0;)s=c[l],c[l--]=c[u+i-1],c[u+--i]=s;else if(8!=l)return;return c},t4=function(e){var t,n,r,o;if("number"==typeof e){for(t=[],n=0;n<4;n++)t.unshift(e%256),e=j5(e/256);return t.join(".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,n=1,r=null,o=0,a=0;a<8;a++)0!==e[a]?(o>n&&(t=r,n=o),r=null,o=0):(null===r&&(r=a),++o);return o>n&&(t=r,n=o),t}(e),n=0;n<8;n++)o&&0===e[n]||(o&&(o=!1),r===n?(t+=n?":":"::",o=!0):(t+=e[n].toString(16),n<7&&(t+=":")));return"["+t+"]"}return e},n4={},r4=O5({},n4,{" ":1,'"':1,"<":1,">":1,"`":1}),o4=O5({},r4,{"#":1,"?":1,"{":1,"}":1}),a4=O5({},o4,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),i4=function(e,t){var n=R5(e,0);return n>32&&n<127&&!_5(t,e)?e:encodeURIComponent(e)},s4={ftp:21,file:null,http:80,https:443,ws:80,wss:443},c4=function(e){return _5(s4,e.scheme)},l4=function(e){return""!=e.username||""!=e.password},u4=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},d4=function(e,t){var n;return 2==e.length&&B5.test(e.charAt(0))&&(":"==(n=e.charAt(1))||!t&&"|"==n)},f4=function(e){var t;return e.length>1&&d4(e.slice(0,2))&&(2==e.length||"/"===(t=e.charAt(2))||"\\"===t||"?"===t||"#"===t)},h4=function(e){var t=e.path,n=t.length;!n||"file"==e.scheme&&1==n&&d4(t[0],!0)||t.pop()},p4=function(e){return"."===e||"%2e"===e.toLowerCase()},v4={},y4={},m4={},g4={},S4={},b4={},N4={},T4={},E4={},w4={},_4={},O4={},I4={},R4={},x4={},C4={},A4={},k4={},L4={},M4={},P4={},H4=function(e,t,n,r){var o,a,i,s,c,l=n||v4,u=0,d="",f=!1,h=!1,p=!1;for(n||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=t.replace(Q5,"")),t=t.replace(z5,""),o=I5(t);u<=o.length;){switch(a=o[u],l){case v4:if(!a||!B5.test(a)){if(n)return"Invalid scheme";l=m4;continue}d+=a.toLowerCase(),l=y4;break;case y4:if(a&&(Y5.test(a)||"+"==a||"-"==a||"."==a))d+=a.toLowerCase();else{if(":"!=a){if(n)return"Invalid scheme";d="",l=m4,u=0;continue}if(n&&(c4(e)!=_5(s4,d)||"file"==d&&(l4(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=d,n)return void(c4(e)&&s4[e.scheme]==e.port&&(e.port=null));d="","file"==e.scheme?l=R4:c4(e)&&r&&r.scheme==e.scheme?l=g4:c4(e)?l=T4:"/"==o[u+1]?(l=S4,u++):(e.cannotBeABaseURL=!0,e.path.push(""),l=L4)}break;case m4:if(!r||r.cannotBeABaseURL&&"#"!=a)return"Invalid scheme";if(r.cannotBeABaseURL&&"#"==a){e.scheme=r.scheme,e.path=r.path.slice(),e.query=r.query,e.fragment="",e.cannotBeABaseURL=!0,l=P4;break}l="file"==r.scheme?R4:b4;continue;case g4:if("/"!=a||"/"!=o[u+1]){l=b4;continue}l=E4,u++;break;case S4:if("/"==a){l=w4;break}l=k4;continue;case b4:if(e.scheme=r.scheme,a==y5)e.username=r.username,e.password=r.password,e.host=r.host,e.port=r.port,e.path=r.path.slice(),e.query=r.query;else if("/"==a||"\\"==a&&c4(e))l=N4;else if("?"==a)e.username=r.username,e.password=r.password,e.host=r.host,e.port=r.port,e.path=r.path.slice(),e.query="",l=M4;else{if("#"!=a){e.username=r.username,e.password=r.password,e.host=r.host,e.port=r.port,e.path=r.path.slice(),e.path.pop(),l=k4;continue}e.username=r.username,e.password=r.password,e.host=r.host,e.port=r.port,e.path=r.path.slice(),e.query=r.query,e.fragment="",l=P4}break;case N4:if(!c4(e)||"/"!=a&&"\\"!=a){if("/"!=a){e.username=r.username,e.password=r.password,e.host=r.host,e.port=r.port,l=k4;continue}l=w4}else l=E4;break;case T4:if(l=E4,"/"!=a||"/"!=d.charAt(u+1))continue;u++;break;case E4:if("/"!=a&&"\\"!=a){l=w4;continue}break;case w4:if("@"==a){f&&(d="%40"+d),f=!0,i=I5(d);for(var v=0;v<i.length;v++){var y=i[v];if(":"!=y||p){var m=i4(y,a4);p?e.password+=m:e.username+=m}else p=!0}d=""}else if(a==y5||"/"==a||"?"==a||"#"==a||"\\"==a&&c4(e)){if(f&&""==d)return"Invalid authority";u-=I5(d).length+1,d="",l=_4}else d+=a;break;case _4:case O4:if(n&&"file"==e.scheme){l=C4;continue}if(":"!=a||h){if(a==y5||"/"==a||"?"==a||"#"==a||"\\"==a&&c4(e)){if(c4(e)&&""==d)return"Invalid host";if(n&&""==d&&(l4(e)||null!==e.port))return;if(s=$5(e,d))return s;if(d="",l=A4,n)return;continue}"["==a?h=!0:"]"==a&&(h=!1),d+=a}else{if(""==d)return"Invalid host";if(s=$5(e,d))return s;if(d="",l=I4,n==O4)return}break;case I4:if(!V5.test(a)){if(a==y5||"/"==a||"?"==a||"#"==a||"\\"==a&&c4(e)||n){if(""!=d){var g=parseInt(d,10);if(g>65535)return"Invalid port";e.port=c4(e)&&g===s4[e.scheme]?null:g,d=""}if(n)return;l=A4;continue}return"Invalid port"}d+=a;break;case R4:if(e.scheme="file","/"==a||"\\"==a)l=x4;else{if(!r||"file"!=r.scheme){l=k4;continue}if(a==y5)e.host=r.host,e.path=r.path.slice(),e.query=r.query;else if("?"==a)e.host=r.host,e.path=r.path.slice(),e.query="",l=M4;else{if("#"!=a){f4(o.slice(u).join(""))||(e.host=r.host,e.path=r.path.slice(),h4(e)),l=k4;continue}e.host=r.host,e.path=r.path.slice(),e.query=r.query,e.fragment="",l=P4}}break;case x4:if("/"==a||"\\"==a){l=C4;break}r&&"file"==r.scheme&&!f4(o.slice(u).join(""))&&(d4(r.path[0],!0)?e.path.push(r.path[0]):e.host=r.host),l=k4;continue;case C4:if(a==y5||"/"==a||"\\"==a||"?"==a||"#"==a){if(!n&&d4(d))l=k4;else if(""==d){if(e.host="",n)return;l=A4}else{if(s=$5(e,d))return s;if("localhost"==e.host&&(e.host=""),n)return;d="",l=A4}continue}d+=a;break;case A4:if(c4(e)){if(l=k4,"/"!=a&&"\\"!=a)continue}else if(n||"?"!=a)if(n||"#"!=a){if(a!=y5&&(l=k4,"/"!=a))continue}else e.fragment="",l=P4;else e.query="",l=M4;break;case k4:if(a==y5||"/"==a||"\\"==a&&c4(e)||!n&&("?"==a||"#"==a)){if(".."===(c=(c=d).toLowerCase())||"%2e."===c||".%2e"===c||"%2e%2e"===c?(h4(e),"/"==a||"\\"==a&&c4(e)||e.path.push("")):p4(d)?"/"==a||"\\"==a&&c4(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&d4(d)&&(e.host&&(e.host=""),d=d.charAt(0)+":"),e.path.push(d)),d="","file"==e.scheme&&(a==y5||"?"==a||"#"==a))for(;e.path.length>1&&""===e.path[0];)e.path.shift();"?"==a?(e.query="",l=M4):"#"==a&&(e.fragment="",l=P4)}else d+=i4(a,o4);break;case L4:"?"==a?(e.query="",l=M4):"#"==a?(e.fragment="",l=P4):a!=y5&&(e.path[0]+=i4(a,n4));break;case M4:n||"#"!=a?a!=y5&&("'"==a&&c4(e)?e.query+="%27":e.query+="#"==a?"%23":i4(a,n4)):(e.fragment="",l=P4);break;case P4:a!=y5&&(e.fragment+=i4(a,r4))}u++}},D4=function(e){var t,n,r=w5(this,D4,"URL"),o=arguments.length>1?arguments[1]:void 0,a=C5(e),i=D5(r,{type:"URL"});if(void 0!==o)if(o instanceof D4)t=F5(o);else if(n=H4(t={},C5(o)))throw TypeError(n);if(n=H4(i,a,null,t))throw TypeError(n);var s=i.searchParams=new P5,c=H5(s);c.updateSearchParams(i.query),c.updateURL=function(){i.query=String(s)||null},S5||(r.href=j4.call(r),r.origin=U4.call(r),r.protocol=B4.call(r),r.username=Y4.call(r),r.password=V4.call(r),r.host=J4.call(r),r.hostname=G4.call(r),r.port=q4.call(r),r.pathname=K4.call(r),r.search=W4.call(r),r.searchParams=X4.call(r),r.hash=Q4.call(r))},F4=D4.prototype,j4=function(){var e=F5(this),t=e.scheme,n=e.username,r=e.password,o=e.host,a=e.port,i=e.path,s=e.query,c=e.fragment,l=t+":";return null!==o?(l+="//",l4(e)&&(l+=n+(r?":"+r:"")+"@"),l+=t4(o),null!==a&&(l+=":"+a)):"file"==t&&(l+="//"),l+=e.cannotBeABaseURL?i[0]:i.length?"/"+i.join("/"):"",null!==s&&(l+="?"+s),null!==c&&(l+="#"+c),l},U4=function(){var e=F5(this),t=e.scheme,n=e.port;if("blob"==t)try{return new D4(t.path[0]).origin}catch(e){return"null"}return"file"!=t&&c4(e)?t+"://"+t4(e.host)+(null!==n?":"+n:""):"null"},B4=function(){return F5(this).scheme+":"},Y4=function(){return F5(this).username},V4=function(){return F5(this).password},J4=function(){var e=F5(this),t=e.host,n=e.port;return null===t?"":null===n?t4(t):t4(t)+":"+n},G4=function(){var e=F5(this).host;return null===e?"":t4(e)},q4=function(){var e=F5(this).port;return null===e?"":String(e)},K4=function(){var e=F5(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+t.join("/"):""},W4=function(){var e=F5(this).query;return e?"?"+e:""},X4=function(){return F5(this).searchParams},Q4=function(){var e=F5(this).fragment;return e?"#"+e:""},z4=function(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}};if(S5&&T5(F4,{href:z4(j4,(function(e){var t=F5(this),n=C5(e),r=H4(t,n);if(r)throw TypeError(r);H5(t.searchParams).updateSearchParams(t.query)})),origin:z4(U4),protocol:z4(B4,(function(e){var t=F5(this);H4(t,C5(e)+":",v4)})),username:z4(Y4,(function(e){var t=F5(this),n=I5(C5(e));if(!u4(t)){t.username="";for(var r=0;r<n.length;r++)t.username+=i4(n[r],a4)}})),password:z4(V4,(function(e){var t=F5(this),n=I5(C5(e));if(!u4(t)){t.password="";for(var r=0;r<n.length;r++)t.password+=i4(n[r],a4)}})),host:z4(J4,(function(e){var t=F5(this);t.cannotBeABaseURL||H4(t,C5(e),_4)})),hostname:z4(G4,(function(e){var t=F5(this);t.cannotBeABaseURL||H4(t,C5(e),O4)})),port:z4(q4,(function(e){var t=F5(this);u4(t)||(""==(e=C5(e))?t.port=null:H4(t,e,I4))})),pathname:z4(K4,(function(e){var t=F5(this);t.cannotBeABaseURL||(t.path=[],H4(t,C5(e),A4))})),search:z4(W4,(function(e){var t=F5(this);""==(e=C5(e))?t.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),t.query="",H4(t,e,M4)),H5(t.searchParams).updateSearchParams(t.query)})),searchParams:z4(X4),hash:z4(Q4,(function(e){var t=F5(this);""!=(e=C5(e))?("#"==e.charAt(0)&&(e=e.slice(1)),t.fragment="",H4(t,e,P4)):t.fragment=null}))}),E5(F4,"toJSON",(function(){return j4.call(this)}),{enumerable:!0}),E5(F4,"toString",(function(){return j4.call(this)}),{enumerable:!0}),M5){var $4=M5.createObjectURL,Z4=M5.revokeObjectURL;$4&&E5(D4,"createObjectURL",(function(e){return $4.apply(M5,arguments)})),Z4&&E5(D4,"revokeObjectURL",(function(e){return Z4.apply(M5,arguments)}))}A5(D4,"URL"),g5({global:!0,forced:!b5,sham:!S5},{URL:D4}),ur({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}}),"undefined"!=typeof Element&&(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}));var e6="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==e6&&e6,t6="URLSearchParams"in e6,n6="Symbol"in e6&&"iterator"in Symbol,r6="FileReader"in e6&&"Blob"in e6&&function(){try{return new Blob,!0}catch(e){return!1}}(),o6="FormData"in e6,a6="ArrayBuffer"in e6;if(a6)var i6=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s6=ArrayBuffer.isView||function(e){return e&&i6.indexOf(Object.prototype.toString.call(e))>-1};function c6(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function l6(e){return"string"!=typeof e&&(e=String(e)),e}function u6(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n6&&(t[Symbol.iterator]=function(){return t}),t}function d6(e){this.map={},e instanceof d6?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function f6(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function h6(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function p6(e){var t=new FileReader,n=h6(t);return t.readAsArrayBuffer(e),n}function v6(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y6(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:r6&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o6&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:t6&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a6&&r6&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=v6(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a6&&(ArrayBuffer.prototype.isPrototypeOf(e)||s6(e))?this._bodyArrayBuffer=v6(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t6&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r6&&(this.blob=function(){var e=f6(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=f6(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(p6)}),this.text=function(){var e=f6(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=h6(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o6&&(this.formData=function(){return this.text().then(S6)}),this.json=function(){return this.text().then(JSON.parse)},this}d6.prototype.append=function(e,t){e=c6(e),t=l6(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},d6.prototype.delete=function(e){delete this.map[c6(e)]},d6.prototype.get=function(e){return e=c6(e),this.has(e)?this.map[e]:null},d6.prototype.has=function(e){return this.map.hasOwnProperty(c6(e))},d6.prototype.set=function(e,t){this.map[c6(e)]=l6(t)},d6.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},d6.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),u6(e)},d6.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),u6(e)},d6.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),u6(e)},n6&&(d6.prototype[Symbol.iterator]=d6.prototype.entries);var m6=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function g6(e,t){if(!(this instanceof g6))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n=(t=t||{}).body;if(e instanceof g6){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d6(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new d6(t.headers)),this.method=function(e){var t=e.toUpperCase();return m6.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(n),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var r=/([?&])_=[^&]*/;if(r.test(this.url))this.url=this.url.replace(r,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function S6(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(o))}})),t}function b6(e,t){if(!(this instanceof b6))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new d6(t.headers),this.url=t.url||"",this._initBody(e)}g6.prototype.clone=function(){return new g6(this,{body:this._bodyInit})},y6.call(g6.prototype),y6.call(b6.prototype),b6.prototype.clone=function(){return new b6(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d6(this.headers),url:this.url})},b6.error=function(){var e=new b6(null,{status:0,statusText:""});return e.type="error",e};var N6=[301,302,303,307,308];b6.redirect=function(e,t){if(-1===N6.indexOf(t))throw new RangeError("Invalid status code");return new b6(null,{status:t,headers:{location:e}})};var T6=e6.DOMException;try{new T6}catch(e){(T6=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),T6.prototype.constructor=T6}function E6(e,t){return new Promise((function(n,r){var o=new g6(e,t);if(o.signal&&o.signal.aborted)return r(new T6("Aborted","AbortError"));var a=new XMLHttpRequest;function i(){a.abort()}a.onload=function(){var e,t,r={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new d6,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();t.append(r,o)}})),t)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var o="response"in a?a.response:a.responseText;setTimeout((function(){n(new b6(o,r))}),0)},a.onerror=function(){setTimeout((function(){r(new TypeError("Network request failed"))}),0)},a.ontimeout=function(){setTimeout((function(){r(new TypeError("Network request failed"))}),0)},a.onabort=function(){setTimeout((function(){r(new T6("Aborted","AbortError"))}),0)},a.open(o.method,function(e){try{return""===e&&e6.location.href?e6.location.href:e}catch(t){return e}}(o.url),!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&(r6?a.responseType="blob":a6&&o.headers.get("Content-Type")&&-1!==o.headers.get("Content-Type").indexOf("application/octet-stream")&&(a.responseType="arraybuffer")),!t||"object"!=typeof t.headers||t.headers instanceof d6?o.headers.forEach((function(e,t){a.setRequestHeader(t,e)})):Object.getOwnPropertyNames(t.headers).forEach((function(e){a.setRequestHeader(e,l6(t.headers[e]))})),o.signal&&(o.signal.addEventListener("abort",i),a.onreadystatechange=function(){4===a.readyState&&o.signal.removeEventListener("abort",i)}),a.send(void 0===o._bodyInit?null:o._bodyInit)}))}E6.polyfill=!0,e6.fetch||(e6.fetch=E6,e6.Headers=d6,e6.Request=g6,e6.Response=b6),ld.config({name:tM.forageName}),Promise.prototype.finally||(Promise.prototype.finally=function(e){return this.then(e).catch(e)}),console.log("if you have sourcemaps enabled in your devtools, click on main.js:5 --\x3e"),navigator.serviceWorker&&(navigator.serviceWorker.register("/app/serviceworker.js",{}),navigator.serviceWorker.addEventListener("controllerchange",(function(){window.location.reload(!0)})));var w6=new tM;w6.router=new pC("https://nyphtest.bsbi.org/app/"),w6.containerId="appcontainer",w6.setLayout(new HF),w6.registerController(new NI(new OF,"/help")),w6.registerController(new CP(new hF)),w6.registerController(new MF(new PF)),w6.restoreOccurrences().then((function(e){console.log({"result from restoreOccurrences":e})}),(function(e){console.log({"failed result from restoreOccurrences":e})})).finally((function(){CA.onceTaxaLoaded().then((function(){w6.initialise(),w6.display()}))}))}();
//# sourceMappingURL=app.js.map
